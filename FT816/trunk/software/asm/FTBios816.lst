Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
FTBios816.asm

                                        ; ============================================================================
                                        ; FTBios816.asm
                                        ;        __
                                        ;   \\__/ o\    (C) 2014-2017  Robert Finch, Waterloo
                                        ;    \  __ /    All rights reserved.
                                        ;     \/_//     robfinch<remove>@finitron.ca
                                        ;       ||
                                        ;  
                                        ;
                                        ; This source file is free software: you can redistribute it and/or modify 
                                        ; it under the terms of the GNU Lesser General Public License as published 
                                        ; by the Free Software Foundation, either version 3 of the License, or     
                                        ; (at your option) any later version.                                      
                                        ;                                                                          
                                        ; This source file is distributed in the hope that it will be useful,      
                                        ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                        ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                        ; GNU General Public License for more details.                             
                                        ;                                                                          
                                        ; You should have received a copy of the GNU General Public License        
                                        ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                        ;                                                                          
                                        ; ============================================================================
                                        ;
     25 = 000000000000000D                            CR			EQU		13
     26 = 000000000000000A                            LF			EQU		10
     27 = 000000000000001B                            ESC			EQU		$1B
     28 = 0000000000000008                            BS			EQU		8
     29 = 0000000000000003                            CTRLC		EQU		3
                                        
     31 = 0000000000000012                            SC_LSHIFT	EQU		$12
     32 = 0000000000000059                            SC_RSHIFT	EQU		$59
     33 = 00000000000000F0                            SC_KEYUP	EQU		$F0
     34 = 00000000000000E0                            SC_EXTEND	EQU		$E0
     35 = 0000000000000014                            SC_CTRL		EQU		$14
     36 = 0000000000000011                            SC_ALT		EQU		$11
     37 = 0000000000000071                            SC_DEL		EQU		$71		; extend
     38 = 0000000000000058                            SC_LCTRL	EQU		$58
     39 = 0000000000000077                            SC_NUMLOCK	EQU		$77
     40 = 000000000000007E                            SC_SCROLLLOCK	EQU	$7E
     41 = 0000000000000058                            SC_CAPSLOCK	EQU		$58
                                        
     43 = 000000000000001F                            TEXTROWS	EQU		31
     44 = 0000000000000054                            TEXTCOLS	EQU		84
                                        
     46 = 0000000000000004                            TickCount	EQU		$4
     47 = 0000000000000008                            KeyState1	EQU		$8
     48 = 0000000000000009                            KeyState2	EQU		$9
     49 = 000000000000000A                            KeybdLEDs	EQU		$A
     50 = 000000000000000B                            KeybdWaitFlag	EQU	$B
     51 = 000000000000000C                            NumWorkArea	EQU		$C
                                        
                                        ; Range $10 to $1F reserved for hardware counters
     54 = 0000000000000010                            CNT0L		EQU		$10
     55 = 0000000000000011                            CNT0M		EQU		$11
     56 = 0000000000000012                            CNT0H		EQU		$12
     57 = 0000000000000020                            RangeStart	EQU		$20
     58 = 0000000000000024                            RangeEnd	EQU		$24
     59 = 0000000000000030                            CursorX		EQU		$30
     60 = 0000000000000032                            CursorY		EQU		$32
     61 = 0000000000000034                            VideoPos	EQU		$34
     62 = 0000000000000036                            NormAttr	EQU		$36
     63 = 0000000000000038                            StringPos	EQU		$38
     64 = 000000000000003C                            EscState	EQU		$3C
     65 = 0000000000000040                            Vidptr		EQU		$40
     66 = 0000000000000046                            Vidregs		EQU		$46
     67 = 000000000000004C                            Textcols	EQU		$4C
     68 = 000000000000004E                            Textrows	EQU		$4E
                                        
     70 = 0000000000000080                            reg_cs		EQU		$80
     71 = 00000084                      reg_ds		EQU		reg_cs + 4
     72 = 00000088                      reg_ss		EQU		reg_ds + 4
     73 = 0000008C                      reg_pc		EQU		reg_ss + 4
     74 = 00000090                      reg_a		EQU		reg_pc + 4
     75 = 00000094                      reg_x		EQU		reg_a + 4
     76 = 00000098                      reg_y		EQU		reg_x + 4
     77 = 0000009C                      reg_sp		EQU		reg_y + 4
     78 = 000000A0                      reg_sr		EQU		reg_sp + 4
     79 = 000000A4                      reg_db		EQU		reg_sr + 4
     80 = 000000A8                      reg_dp		EQU		reg_db + 4
     81 = 000000AC                      reg_bl		EQU		reg_dp + 4
     82 = 000000B0                      reg_mp		EQU		reg_bl + 4
                                        
     84 = 0000000000000080                            cs_save		EQU		$80
     85 = 0000000000000084                            ds_save		EQU		$84
     86 = 0000000000000088                            pc_save		EQU		$88
     87 = 000000000000008C                            pb_save		EQU		$8C
     88 = 0000000000000090                            acc_save	EQU		$90
     89 = 0000000000000094                            x_save		EQU		$94
     90 = 0000000000000098                            y_save		EQU		$98
     91 = 000000000000009C                            sp_save		EQU		$9C
     92 = 00000000000000A0                            sr_save		EQU		$A0
     93 = 00000000000000A4                            srx_save	EQU		$A4
     94 = 00000000000000A8                            db_save		EQU		$A8
     95 = 00000000000000AC                            dpr_save	EQU		$AC
                                        
                                        ;running_task	EQU		$B8
                                        
     99 = 00000000000000BA                            keybd_char	EQU		$BA
    100 = 00000000000000BA                            rw_flag		EQU		$BA
    101 = 00000000000000BC                            keybd_cmd	EQU		$BC
    102 = 00000000000000BE                            WorkTR		EQU		$BE
    103 = 00000000000000C0                            ExitCode	EQU		$C0
    104 = 00000000000000C4                            secnum		EQU		$C4
    105 = 00000000000000C8                            bufptr		EQU		$C8
    106 = 00000000000000CC                            qcnt		EQU		$CC
    107 = 00000000000000CE                            IOFocusTask	EQU		$CE
    108 = 00000000000000D0                            TaskSwitchEn	EQU	$D0
    109 = 00000000000000D2                            TimeoutList	EQU		$D2
    110 = 0000000000000100                            ldtrec		EQU		$100
    111 = 0000000000000104                            timeout1	EQU		$104
                                        
    113 = 0000000000000300                            RTCBuf		EQU		$300
    114 = 00000000000003F0                            OutputVec	EQU		$03F0
                                        
    116 = 000000000000B000                            PCS0		EQU		$B000
    117 = 0000B002                      PCS1		EQU		PCS0 + 2
    118 = 0000B004                      PCS2		EQU		PCS1 + 2
    119 = 0000B006                      PCS3		EQU		PCS2 + 2
    120 = 0000B008                      PCS4	    EQU		PCS3 + 2
    121 = 0000B00A                      PCS5		EQU		PCS4 + 2
    122 = 0000B010                      CTR0_LMT	EQU		PCS0 + 16
    123 = 0000B013                      CTR0_CTRL	EQU		CTR0_LMT + 3
    124 = 0000B014                      CTR1_LMT	EQU		CTR0_CTRL + 1
    125 = 0000B017                      CTR1_CTRL	EQU		CTR1_LMT + 3
    126 = 000000000000B01F                            MPU_IRQ_STATUS	EQU		$B01F
                                        
    128 = 00000000000D0000                            VIDBUF		EQU		$D0000		; FD0000
    129 = 00000000000EA000                            VIDREGS		EQU		$EA000
    130 = 00000000000EA100                            PRNG		EQU		$EA100
    131 = 00000000000EA110                            KEYBD		EQU		$EA110
    132 = 00000000000EA200                            FAC1		EQU		$EA200
                                        
    134 = 0000000000FEC000                            SPIMASTER	EQU		$00FEC000
    135 = 00FEC000                      SPI_MASTER_VERSION_REG	EQU	SPIMASTER+$00
    136 = 00FEC001                      SPI_MASTER_CONTROL_REG	EQU	SPIMASTER+$01
    137 = 00FEC002                      SPI_TRANS_TYPE_REG	EQU		SPIMASTER+$02
    138 = 00FEC003                      SPI_TRANS_CTRL_REG	EQU		SPIMASTER+$03
    139 = 00FEC004                      SPI_TRANS_STATUS_REG	EQU	SPIMASTER+$04
    140 = 00FEC005                      SPI_TRANS_ERROR_REG		EQU	SPIMASTER+$05
    141 = 00FEC006                      SPI_DIRECT_ACCESS_DATA_REG		EQU	SPIMASTER+$06
    142 = 00FEC007                      SPI_SD_SECT_7_0_REG		EQU	SPIMASTER+$07
    143 = 00FEC008                      SPI_SD_SECT_15_8_REG	EQU	SPIMASTER+$08
    144 = 00FEC009                      SPI_SD_SECT_23_16_REG	EQU	SPIMASTER+$09
    145 = 00FEC00A                      SPI_SD_SECT_31_24_REG	EQU	SPIMASTER+$0A
    146 = 00FEC010                      SPI_RX_FIFO_DATA_REG	EQU	SPIMASTER+$10
    147 = 00FEC011                      SPI_RX_FIFO_DATA_COUNT_MSB	EQU	SPIMASTER+$11
    148 = 00FEC012                      SPI_RX_FIFO_DATA_COUNT_LSB  EQU SPIMASTER+$12
    149 = 00FEC014                      SPI_RX_FIFO_CTRL_REG		EQU	SPIMASTER+$14
    150 = 00FEC020                      SPI_TX_FIFO_DATA_REG	EQU	SPIMASTER+$20
    151 = 00FEC024                      SPI_TX_FIFO_CTRL_REG	EQU	SPIMASTER+$24
    152 = 00FEC030                      SPI_RESP_BYTE1			EQU	SPIMASTER+$30
    153 = 00FEC031                      SPI_RESP_BYTE2			EQU	SPIMASTER+$31
    154 = 00FEC032                      SPI_RESP_BYTE3			EQU	SPIMASTER+$32
    155 = 00FEC033                      SPI_RESP_BYTE4			EQU	SPIMASTER+$33
                                        
    157 = 0000000000000001                            SPI_INIT_SD			EQU		$01
    158 = 0000000000000001                            SPI_TRANS_START		EQU		$01
    159 = 0000000000000001                            SPI_TRANS_BUSY		EQU		$01
    160 = 0000000000000000                            SPI_INIT_NO_ERROR	EQU		$00
    161 = 0000000000000000                            SPI_READ_NO_ERROR	EQU		$00
    162 = 0000000000000000                            SPI_WRITE_NO_ERROR	EQU		$00
    163 = 0000000000000002                            SPI_RW_READ_SD_BLOCK	EQU		$02
    164 = 0000000000000003                            SPI_RW_WRITE_SD_BLOCK	EQU		$03
                                        
    166 = 0000000000FEC100                            I2C_MASTER		EQU		$00FEC100
    167 = 00FEC100                      I2C_PRESCALE_LO	EQU		I2C_MASTER+$00
    168 = 00FEC101                      I2C_PRESCALE_HI	EQU		I2C_MASTER+$01
    169 = 00FEC102                      I2C_CONTROL		EQU		I2C_MASTER+$02
    170 = 00FEC103                      I2C_TX			EQU		I2C_MASTER+$03
    171 = 00FEC103                      I2C_RX			EQU		I2C_MASTER+$03
    172 = 00FEC104                      I2C_CMD			EQU		I2C_MASTER+$04
    173 = 00FEC104                      I2C_STAT		EQU		I2C_MASTER+$04
                                        
    175 = 0000000000FEC200                            READY_FIFO		EQU		$00FEC200
    176 = 0000000000FEC210                            READY_FIFO_CNT	EQU		$00FEC210
    177 = 0000000000FEC300                            TIMEOUT_LIST	EQU		$00FEC300
                                        
                                        ; Timeout list commands
    180 = 0000000000000000                            TOL_NOP			EQU		0
    181 = 0000000000000001                            TOL_DEC			EQU		1
    182 = 0000000000000002                            TOL_INS			EQU		2
    183 = 0000000000000003                            TOL_RMV			EQU		3
                                        
    185 = 00000000000EB000                            SID			EQU		$EB000		; FEB000
    186 = 0000000000000000                            SID_FREQ0		EQU		$00
    187 = 0000000000000004                            SID_PW0			EQU		$04
    188 = 0000000000000008                            SID_CTRL0		EQU		$08
    189 = 000000000000000C                            SID_ATTACK0		EQU		$0C
    190 = 0000000000000010                            SID_DECAY0		EQU		$10
    191 = 0000000000000014                            SID_SUSTAIN0	EQU		$14
    192 = 0000000000000018                            SID_RELEASE0	EQU		$18
    193 = 000000000000001C                            SID_WADR0		EQU		$1C
    194 = 00000000000000B0                            SID_VOLUME		EQU		$B0
                                        
    196 = 0000000000007868                            do_invaders			EQU		$7868
                                        
    198 = 0000000000000040                            NR_JCB			EQU		64
    199 = 0000000000000200                            NR_TCB			EQU		512
    200 = 0000000000000400                            NR_MBX			EQU		1024
    201 = 0000000000001000                            NR_MSG			EQU		4096
    202 = 0000000000000001                            TS_READY		EQU		1
    203 = 0000000000000002                            TS_WAITMSG		EQU		2
    204 = 0000000000000000                            MQS_NEWEST		EQU		0		; message queue strategy
    205 = 0000000000000000                            MT_NONE			EQU		0
    206 = 0000000000000001                            MT_FREE			EQU		1
                                        
    208 = 0000000000000040                            TCB_SIZE		EQU		64
    209 = 0000000000020000                            tcbs			EQU		$20000
    210 = 0000000000000000                            TCB_Next		EQU		$00	; 2 byte handles
    211 = 0000000000000002                            TCB_Prev		EQU		$02	; 2 byte handles
    212 = 0000000000000004                            TCB_Timeout		EQU		$04	; 4 byte value
    213 = 0000000000000008                            TCB_mbq_next	EQU		$08	; 2 byte handles
    214 = 000000000000000A                            TCB_mbq_prev	EQU		$0A	; 2 byte handles
    215 = 000000000000000C                            TCB_msg_d1		EQU		$0C	; 4 byte value
    216 = 0000000000000010                            TCB_msg_d2		EQU		$10	; 4 byte value
    217 = 0000000000000014                            TCB_msg_d3		EQU		$14	; 4 byte value
    218 = 0000000000000018                            TCB_msg_tgtadr	EQU		$18	; 2 byte handle
    219 = 000000000000001A                            TCB_msg_retadr	EQU		$1A	; 2 byte handle
    220 = 000000000000001C                            TCB_msg_link	EQU		$1C	; 2 byte handle
    221 = 000000000000001E                            TCB_msg_type	EQU		$1E	; 2 byte value
    222 = 0000000000000020                            TCB_hMbx1		EQU		$20	; 2 byte handle
    223 = 0000000000000022                            TCB_hMbx2		EQU		$22	; 2 byte handle
    224 = 0000000000000024                            TCB_hMbx3		EQU		$24	; 2 byte handle
    225 = 0000000000000026                            TCB_hMbx4		EQU		$26	; 2 byte handle
    226 = 0000000000000028                            TCB_hWaitMbx	EQU		$28	; 2 byte handle
    227 = 000000000000002A                            TCB_number		EQU		$2A	; 2 byte value
    228 = 000000000000002C                            TCB_priority	EQU		$2C	; 1 byte value
    229 = 000000000000002D                            TCB_status		EQU		$2D	; 1 byte value
    230 = 000000000000002E                            TCB_affinity	EQU		$2E	; 1 byte value
    231 = 000000000000002F                            TCB_hJob		EQU		$2F	; 1 byte handle
    232 = 0000000000000030                            TCB_start_tick	EQU		$30	; 4 byte value
    233 = 0000000000000034                            TCB_end_tick	EQU		$34	; 4 byte value
    234 = 0000000000000038                            TCB_ticks		EQU		$38	; 4 byte value
    235 = 000000000000003C                            TCB_exception	EQU		$3C	; 4 byte value
                                        
    237 = 0000000000000400                            JCB_SIZE		EQU		1024
    238 = 00028000                      jcbs			EQU		tcbs + TCB_SIZE * NR_TCB
    239 = 0000000000000000                            JCB_iof_next	EQU		$000	; 1 byte value
    240 = 0000000000000001                            JCB_iof_prev	EQU		$001	; 1 byte value
    241 = 0000000000000002                            JCB_user_name	EQU		$002	; 32 byte value
    242 = 0000000000000022                            JCB_path		EQU		$022	; 256 byte value
    243 = 0000000000000122                            JCB_exit_runfile	EQU	$122	; 256 byte value
    244 = 0000000000000222                            JCB_command_line	EQU	$222	; 256 byte value
    245 = 0000000000000322                            JCB_pVidMem		EQU		$322	; 6 byte value
    246 = 0000000000000328                            JCB_pVirtVidMem	EQU		$328	; 6 byte value
    247 = 000000000000032E                            JCB_VideoCols	EQU		$32E	; 1 byte value
    248 = 000000000000032F                            JCB_VideoRows	EQU		$32F	; 1 byte value
    249 = 0000000000000330                            JCB_CursorRow	EQU		$330	; 1 byte value
    250 = 0000000000000331                            JCB_CursorCol	EQU		$331	; 1 byte value
    251 = 0000000000000332                            JCB_NormAttr	EQU		$332	; 2 byte value
    252 = 0000000000000334                            JCB_KeyState1	EQU		$334	; 2 byte value
    253 = 0000000000000336                            JCB_KeyState2	EQU		$336	; 2 byte value
    254 = 0000000000000338                            JCB_KeybdWaitFlag	EQU	$338	; 1 byte value
    255 = 0000000000000339                            JCB_KeybdHead	EQU		$339
    256 = 000000000000033A                            JCB_KeybdTail	EQU		$33A
    257 = 000000000000033B                            JCB_KeybdBuffer	EQU		$33B	; 32 byte value
    258 = 000000000000035B                            JCB_number		EQU		$35B	; 1 byte value
    259 = 000000000000035C                            JCB_tasks		EQU		$35C	; 2 byte value * 8
    260 = 000000000000035E                            JCB_next		EQU		$35E	; 1 byte value
                                        
                                        ; 1024 mailboxes
    263 = 00038000                      mailboxes		EQU		jcbs + JCB_SIZE * NR_JCB
    264 = 0000000000000018                            MBX_SIZE		EQU		24
    265 = 0000000000000000                            MBX_link		EQU		$00	; 1 byte value
    266 = 0000000000000001                            MBX_owner		EQU		$01	; 1 byte value
    267 = 0000000000000002                            MBX_tq_head		EQU		$02	; 2 byte value
    268 = 0000000000000004                            MBX_tq_tail		EQU		$04	; 2 byte value
    269 = 0000000000000006                            MBX_mq_head		EQU		$06	; 2 byte value
    270 = 0000000000000008                            MBX_mq_tail		EQU		$08	; 2 byte value
    271 = 000000000000000C                            MBX_tq_count	EQU		$0C	; 2 byte value
    272 = 000000000000000E                            MBX_mq_count	EQU		$0E	; 2 byte value
    273 = 0000000000000010                            MBX_mq_size		EQU		$10	; 2 byte value
    274 = 0000000000000012                            MBX_mq_missed	EQU		$12	; 2 byte value
    275 = 0000000000000014                            MBX_mq_strategy	EQU		$14	; 1 byte value
                                        
    277 = 0003E000                      messages	EQU		mailboxes + MBX_SIZE * NR_MBX
    278 = 0000000000000000                            MSG_d1		EQU		$00	; 4 byte value	( 4096 messages )
    279 = 0000000000000004                            MSG_d2		EQU		$04	; 4 byte value
    280 = 0000000000000008                            MSG_d3		EQU		$08	; 4 byte value
    281 = 000000000000000C                            MSG_tgtadr	EQU		$0C	; 2 byte handle
    282 = 000000000000000E                            MSG_retadr	EQU		$0E	; 2 byte handle
    283 = 0000000000000010                            MSG_link	EQU		$10	; 2 byte handle
    284 = 0000000000000012                            MSG_type	EQU		$12	; 2 byte value
    285 = 00000014                      MSG_SIZE	EQU		MSG_type + 2
                                        
    287 = 00052000                      running_task	EQU		messages + MSG_SIZE * NR_MSG
    288 = 00052002                      hTcbTmp		EQU		running_task + 2
    289 = 00052004                      hMbxTmp		EQU		hTcbTmp + 2
    290 = 00052006                      hMsgTmp		EQU		hMbxTmp + 2
                                        
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
supermon832.asm

                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;	.opt proc65c02,caseinsensitive
                                        	cpu	W65C02
                                        ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;*                                                                                 *
                                        ;*      SUPERMON 816 MACHINE LANGUAGE MONITOR FOR THE W65C816S MICROPROCESSOR      *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;*      Copyright ©1991-2014 by BCS Technology Limited.  All rights reserved.      *
                                        ;*                                                                                 *
                                        ;* Permission is hereby granted to use, copy, modify and distribute this software, *
                                        ;* provided this copyright notice remains in the source code and  proper  attribu- *
                                        ;* tion is given.  Redistribution, regardless of form, must be at no charge to the *
                                        ;* end  user.  This code or any part thereof, including any derivation, MAY NOT be *
                                        ;* incorporated into any package intended for sale,  unless written permission has * 
                                        ;* been given by the copyright holder.                                             *
                                        ;*                                                                                 *
                                        ;* THERE IS NO WARRANTY OF ANY KIND WITH THIS SOFTWARE.  The user assumes all risk *
                                        ;* in connection with the incorporation of this software into any system.          *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* Supermon 816 is a salute to Jim Butterfield, who passed away on June 29, 2007.  *
                                        ;*                                                                                 *
                                        ;* Jim, who was the unofficial  spokesman for  Commodore  International during the *  
                                        ;* heyday of the company's 8 bit supremacy, scratch-developed the Supermon machine *
                                        ;* language monitor for the PET & CBM computers.   When the best-selling Commodore *
                                        ;* 64 was introduced, Jim adapted his software to the new machine & gave the adap- *
                                        ;* tation the name Supermon 64.   Commodore  subsequently  integrated a customized *
                                        ;* version of Supermon 64 into the C-128 to act as the resident M/L monitor.       *
                                        ;*                                                                                 *
                                        ;* Although Supermon 816 is not an adaptation of Supermon 64,  it was  decided  to *
                                        ;* keep the Supermon name alive, since Supermon 816's general operation & user in- *
                                        ;* terface is similar to that of Supermon 64.   Supermon 816 is 100 percent native *
                                        ;* mode 65C816 code & was developed from a blank canvas.                           *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* This version customized for the RTF65002 test system                            *
                                        ;* Finitron.ca                                                                     *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* Supermon 816 is a full featured monitor and supports the following operations:  *
                                        ;*                                                                                 *
                                        ;*     A — Assemble code                                                           *
                                        ;*     C — Compare memory regions                                                  *
                                        ;*     D — Disassemble code                                                        *
                                        ;*     F — Fill memory region (cannot span banks)                                  *
                                        ;*     G — Execute code (stops at BRK)                                             *
                                        ;*     H — Search (hunt) memory region                                             *
                                        ;*     J — Execute code as a subroutine (stops at BRK or RTS)                      *
                                        ;*     M — Dump & display memory range                                             *
                                        ;*     R — Dump & display 65C816 registers                                         *
                                        ;*     T — Copy (transfer) memory region                                           *
                                        ;*     X — Exit Supermon 816 & return to operating environment                     *
                                        ;*     > — Modify up to 32 bytes of memory                                         *
                                        ;*     ; — Modify 65C816 registers                                                 *
                                        ;*                                                                                 *
                                        ;* Supermon 816 accepts binary (%), octal (@), decimal (+) and hexadecimal ($) as  *
                                        ;* input for numeric parameters.  Additionally, the H and > operations accept an   *
                                        ;* ASCII string in place of numeric values by preceding the string with ', e.g.:   *
                                        ;*                                                                                 *
                                        ;*     h 042000 042FFF 'BCS Technology Limited                                     *
                                        ;*                                                                                 *
                                        ;* If no radix symbol is entered hex is assumed.                                   *
                                        ;*                                                                                 *
                                        ;* Numeric conversion is also available.  For example, typing:                     *
                                        ;*                                                                                 *
                                        ;*     +1234567 <CR>                                                               *
                                        ;*                                                                                 *
                                        ;* will display:                                                                   *
                                        ;*                                                                                 *
                                        ;*         $12D687                                                                 *
                                        ;*         +1234567                                                                *
                                        ;*         @04553207                                                               *
                                        ;*         %100101101011010000111                                                  *
                                        ;*                                                                                 *
                                        ;* In the above example, <CR> means the console keyboard's return or enter key.    *
                                        ;*                                                                                 *
                                        ;* All numeric values are internally processed as 32 bit unsigned integers.  Addr- *
                                        ;* esses may be entered as 8, 16 or 24 bit values.  During instruction assembly,   *
                                        ;* immediate mode operands may be forced to 16 bits by preceding the operand with  *
                                        ;* an exclamation point if the instruction can accept a 16 bit operand, e.g.:      *
                                        ;*                                                                                 *
                                        ;*     a 1f2000 lda !#4                                                            *
                                        ;*                                                                                 *
                                        ;* The above will assemble as:                                                     *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A9 04 00     LDA #$0004                                           *
                                        ;*                                                                                 *
                                        ;* Entering:                                                                       *
                                        ;*                                                                                 *
                                        ;*     a 1f2000 ldx !#+157                                                         *
                                        ;*                                                                                 *
                                        ;* will assemble as:                                                               *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A2 9D 00     LDX #$009D                                           *
                                        ;*                                                                                 *
                                        ;* Absent the ! in the operand field, the above would have been assembled as:      *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A2 9D        LDX #$9D                                             *
                                        ;*                                                                                 *
                                        ;* If an immediate mode operand is greater than $FF assembly of a 16 bit operand   *
                                        ;* is implied.                                                                     *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* A Note on the PEA & PEI Instructions                                            *
                                        ;* ————————————————————————————————————                                            *
                                        ;*                                                                                 *
                                        ;* The Eyes and Lichty programming manual uses the following syntax for the PEA    *
                                        ;* and PEI instructions:                                                           *
                                        ;*                                                                                 *
                                        ;*     PEA <operand>                                                               *
                                        ;*     PEI (<operand>)                                                             *
                                        ;*                                                                                 *
                                        ;* The WDC data sheet that was published at the time of the 65C816's release in    *
                                        ;* 1984 does not indicate a recommended or preferred syntax for any of the above   *
                                        ;* instructions.  PEA pushes its operand to the stack and hence operates like any  *
                                        ;* other immediate mode instruction, in that the operand is the data (however, PEA *
                                        ;* doesn't affect the status register).  Similarly, PEI pushes the 16 bit value    *
                                        ;* stored at <operand> and <operand>+1, and hence operates like any other direct   *
                                        ;* (zero) page instruction, again without affecting the status register.           *
                                        ;*                                                                                 *
                                        ;* BCS Technology Limited is of the opinion that the developer of the ORCA/M as-   *
                                        ;* sembler, which is the assembler referred to in the Eyes and Lichty manual, mis- *
                                        ;* understood how PEA and PEI behave during runtime, and hence chose an incorrect  *
                                        ;* syntax for these two instructions.  This error was subsequently carried forward *
                                        ;* by Eyes and Lichty.                                                             *
                                        ;*                                                                                 *
                                        ;* Supermon 816's assembler uses the following syntax for PEA and PEI:             *
                                        ;*                                                                                 *
                                        ;*     PEA #<operand>                                                              *
                                        ;*     PEI <operand>                                                               *
                                        ;*                                                                                 *
                                        ;* The operand for PEA is treated as a 16 bit value, even if entered as an 8 bit   *
                                        ;* value.  The operand for PEI must be 8 bits.                                     *
                                        ;*                                                                                 *
                                        ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;
                                        ;	* * * * * * * * * * * *
                                        ;	* VERSION INFORMATION *
                                        ;	* * * * * * * * * * * *
                                        ;
                                        softvers .macro                ;software version — change with each revision...
                                                 .byte "1"             ;major
                                                 .byte "."
                                                 .byte "0"             ;minor
                                                 .byte "."
                                                 .byte "0"             ;revision
                                                 .endm
                                        ;
                                        ;REVISION TABLE
                                        ;
                                        ;Ver  Rev Date    Description
                                        ;———————————————————————————————————————————————————————————————————————————————
                                        ;1.0  2013/11/01  A) Original derived from the POC V1.1 single-board computer
                                        ;                    firmware.
                                        ;     2013/11/04  A) Fixed a problem where the B-accumulator wasn't always being
                                        ;                    be copied to shadow storage after return from execution of
                                        ;                    a J command.
                                        ;———————————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	        COMMENT ABBREVIATIONS
                                        ;	————————————————————————————————————————————————————
                                        ;	  BCD   binary-coded decimal
                                        ;	   DP   direct page or page zero
                                        ;	  EOF   end-of-field
                                        ;	  EOI   end-of-input
                                        ;	  LSB   least significant byte/bit
                                        ;	  LSD   least significant digit
                                        ;	  LSN   least significant nybble
                                        ;	  LSW   least significant word
                                        ;	  MPU   microprocessor
                                        ;	  MSB   most significant byte/bit
                                        ;	  MSD   most significant digit
                                        ;	  MSN   most significant nybble
                                        ;	  MSW   most-significant word
                                        ;	  RAM   random access memory
                                        ;	   WS   whitespace, i.e., blanks & horizontal tabs
                                        ;	————————————————————————————————————————————————————
                                        ;	A word is defined as 16 bits.
                                        ;
                                        ;	   MPU REGISTER SYMBOLS
                                        ;	——————————————————————————
                                        ;	   .A   accumulator LSB
                                        ;	   .B   accumulator MSB
                                        ;	   .C   16 bit accumulator
                                        ;	   .X   X-index
                                        ;	   .Y   Y-index
                                        ;      DS   data segment
                                        ;	   DB   data bank
                                        ;	   DP   direct page
                                        ;      CS   code segment
                                        ;	   PB   program bank
                                        ;	   PC   program counter
                                        ;	   SP   stack pointer
                                        ;	   SR   MPU status
                                        ;      SRX  status extension
                                        ;	————————————————————————————
                                        ;
                                        ;	  MPU STATUS REGISTER SYMBOLS
                                        ;	———————————————————————————————
                                        ;	    C   carry
                                        ;	    D   decimal mode
                                        ;	    I   maskable interrupts
                                        ;	    m   accumulator/memory size
                                        ;	    N   result negative
                                        ;	    V   sign overflow
                                        ;	    x   index registers size
                                        ;	    Z   result zero
                                        ;
                                        ;      16   16 bit emulation flag
                                        ;      32   32 bit emulation flag
                                        ;	———————————————————————————————
                                        ;
                                        ;================================================================================
                                        ;
                                        ;SYSTEM INTERFACE DEFINITIONS
                                        ;
                                        ;	——————————————————————————————————————————————————————————————————
                                        ;	This section defines the interface between Supermon 816 & the host
                                        ;	system.   Change these definitions to suit your system, but do not
                                        ;	change any label names.  All definitions must have valid values in
                                        ;	order to assemble Supermon 816.
                                        ;	——————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————
    513 = 0000000000008000                            _origin_ =$008000              ;assembly address...
                                        ;
                                        ;	Set _ORIGIN_ to Supermon 816's desired assembly address.
                                        ;	————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    519 = 000000000000FE03                            vecexit  =$00FE03              ;exit to environment address...
                                        ;
                                        ;	Set VECEXIT to where Supermon 816 should go when it exits.  Supermon 816
                                        ;	will do a JML (long jump) to this address, which means VECEXIT must be a
                                        ;	24 bit address.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    527 = 0000000000000102                            vecbrki  =$0102                ;BRK handler indirect vector...
    528 = 0000000000000105                            vecbrkia =$0105                ;system indirect BRK vector
                                        ;
                                        ;	Supermon 816 will modify this vector so that execution of a BRK instruc-
                                        ;	tion is intercepted & the registers  are  captured.   Your BRK front end
                                        ;	should jump through this vector after pushing the registers as follows:
                                        ;
                                        ;	         phb                   ;save DB
                                        ;	         phd                   ;save DP
                                        ;	         rep #%00110000        ;16 bit registers
                                        ;	         pha
                                        ;	         phx
                                        ;	         phy
                                        ;	         jmp (vecbrki)         ;indirect vector
                                        ;
                                        ;	When a G or J command is issued, the above sequence will be reversed be-
                                        ;	fore a jump is made to the code to be executed.  Upon exit from Supermon
                                        ;	816, the original address at VECBRKI will be restored.
                                        ;
                                        ;	If your BRK front end doesn't conform to the above you will have to mod-
                                        ;	ify Supermon 816 to accommodate the differences.  The most likely needed
                                        ;	changes will be in the order in which registers are pushed to the stack.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    552 = 0000000000003FFF                            hwstack  =$3fff                ;top of hardware stack...
                                        ;
                                        ;	Supermon 816 initializes the stack pointer to this address when the cold
                                        ;	start at MONCOLD is called to enter the monitor.  The stack pointer will
                                        ;	be undisturbed when entry into Supermon 816 is through JMONBRK (see jump
                                        ;	table definitions).
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    561 = 0000000000000080                            zeropage =$80                  ;Supermon 816's direct page...
                                        ;
                                        ;	Supermon 816 uses direct page starting at this address.  Be sure that no
                                        ;	conflict occurs with other software.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
    567 = 00000000000000FC                            biosctx	 =$FC
                                        ;	————————————————————————————————————————————————————————————————————————
    569 = 000000000000FE00                            getcha   =$FE00                ;get keystroke from console...
                                        ;
                                        ;	GETCHA refers to an operating system API call that returns a keystroke
                                        ;	in the 8 bit accumulator.  Supermon 816  assumes that GETCHA is a non-
                                        ;	blocking subroutine & returns with carry clear to indicate that a key-
                                        ;	stroke is in .A, or with carry set to indicate that no keystroke was
                                        ;	available.  GETCHA will be called with a JSR instruction.
                                        ;
                                        ;	Supermon 816 expects .X & .Y to be preserved upon return from GETCHA.
                                        ;	You may have to modify Supermon 816 at all calls to GETCHA if your "get
                                        ;	keystroke" routine works differently than described.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    583 = 000000000000FE06                            putcha   =$FE06                ;print character on console...
                                        ;
                                        ;	PUTCHA refers to an operating system API call that prints a character to
                                        ;	the console screen.  The character to be printed will be in .A, which
                                        ;	will be set to 8-bit width.  Supermon 816 assumes that PUTCHA will block
                                        ;	until the character can be processed.  PUTCHA will be called with a JSR
                                        ;	instructions.
                                        ;
                                        ;	Supermon 816 expects .X & .Y to be preserved upon return from PUTCHA.
                                        ;	You may have to modify Supermon 816 at all calls to PUTCHA if your "put
                                        ;	character" routine works differently than described.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    597 = 0000000000000003                            stopkey  =$03                  ;display abort key...
                                        ;
                                        ;	Supermon 816 will poll for a "stop key" during display operations, such
                                        ;	as code disassembly & memory dumps, so as to abort further processing &
                                        ;	return to the command prompt.  STOPKEY must be defined with the ASCII
                                        ;	value that the "stop key" will emit when typed.  The polling is via a
                                        ;	call to GETCHA (described above).  The default STOPKEY definition of $03
                                        ;	is for ASCII <ETX> or [Ctrl-C].
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
    607 = 0000000000000200                            ibuffer  =$000200               ;input buffer &...
    608 = 00000251                      auxbuf   =ibuffer+s_ibuf+1 ;auxiliary buffer...
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	Supermon 816 will use the above definitions for input buffers.  These
                                        ;	buffers may be located anywhere in RAM that is convenient.  The buffers
                                        ;	are stateless, which means that unless Supermon 816 has control of your
                                        ;	system, they may be overwritten without consequence.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;================================================================================
                                        ;
                                        ;W65C816S INSTRUCTION SYNTHESIS MACROS —— !!!!! DO NOT EDIT !!!!!
                                        ;
                                        _asm24_  .macro .ad
                                                 .byte <.ad,>.ad,.ad >> 16
                                                 .endm
                                        ;
                                        brl      .macro .ad
                                        .ba      =*+3
                                                 .byte $82
                                                 .word .ad-.ba
                                                 .endm
                                        ;
                                        ; jml is supported for the RTF65002 in 65c02 mode. And the opcode is supported
                                        ; by the assembler.
                                        ;jml      .macro .ad
                                        ; ;        .byte $5c
                                        ;         _asm24_ .ad
                                        ;         .endm
                                        ;
                                        mvn      .macro .s,.d
                                                 .byte $54,.d,.s
                                                 .endm
                                        ;
                                        mvp      .macro .s,.d
                                                 .byte $44,.d,.s
                                                 .endm
                                        ;
                                        pea      .macro .op
                                                 .byte $f4
                                                 .word .op
                                                 .endm
                                        ;
                                        phb      .macro
                                                 .byte $8b
                                                 .endm
                                        ;
                                        phk      .macro
                                                 .byte $4b
                                                 .endm
                                        ;
                                        plb      .macro
                                                 .byte $ab
                                                 .endm
                                        ;
                                        rep      .macro .op
                                                 .byte $c2,.op
                                                 .endm
                                        ;
                                        sep      .macro .op
                                                 .byte $e2,.op
                                                 .endm
                                        ;
                                        tcd      .macro
                                                 .byte $5b
                                                 .endm
                                        ;
                                        tcs      .macro
                                                 .byte $1b
                                                 .endm
                                        ;
                                        tdc      .macro
                                                 .byte $7b
                                                 .endm
                                        ;
                                        tsc      .macro
                                                 .byte $3b
                                                 .endm
                                        ;
                                        txy      .macro
                                                 .byte $9b
                                                 .endm
                                        ;
                                        tyx      .macro
                                                 .byte $bb
                                                 .endm
                                        ;
                                        wai      .macro
                                                 .byte $cb
                                                 .endm
                                        ;
                                        xba      .macro
                                                 .byte $eb
                                                 .endm
                                        ;
                                        adcw     .macro .op
                                                 adc #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        andw     .macro .op
                                                 and #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        bitw     .macro .op
                                                 bit #<.op
                                                 .byte >.op
                                                 .endm
                                        ;         
                                        cmpw     .macro .op
                                                 cmp #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        cpxw     .macro .op
                                                 cpx #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        cpyw     .macro .op
                                                 cpy #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        eorw     .macro .op
                                                 eor #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldaw     .macro .op
                                                 lda #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldxw     .macro .op
                                                 ldx #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldyw     .macro .op
                                                 ldy #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        oraw     .macro .op
                                                 ora #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        sbcw     .macro .op
                                                 sbc #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldalx    .macro .ad
                                                 .byte $+         .byte a_esc,"("
                                     +            .byte a_esc,"G4"
                                        
                                     +            .byte <.ad,>.ad,.ad >> 16
                                        
                                                 .endm
                                        ;
                                        adcil    .macro .ad
                                                 .byte $67,.ad
                                                 .endm
                                        ;
                                        adcily   .macro .ad
                                                 .byte $77,.ad
                                                 .endm
                                        ;
                                        andil    .macro .ad
                                                 .byte $27,.ad
                                                 .endm
                                        ;
                                        andily   .macro .ad
                                                 .byte $37,.ad
                                                 .endm
                                        ;
                                        cmpil    .macro .ad
                                                 .byte $c7,.ad
                                                 .endm
                                        ;
                                        cmpily   .macro .ad
                                                 .byte $d7,.ad
                                                 .endm
                                        ;
                                        eoril    .macro .ad
                                                 .byte $47,.ad
                                                 .endm
                                        ;
                                        eorily   .macro .ad
                                                 .byte $57,.ad
                                                 .endm
                                        ;
                                        ldail    .macro .ad
                                                 .byte $a7,.ad
                                                 .endm
                                        ;
                                        ldaily   .macro .ad
                                                 .byte $b7,.ad
                                                 .endm
                                        ;
                                        orail    .macro .ad
                                                 .byte $07,.ad
                                                 .endm
                                        ;
                                        oraily   .macro .ad
                                                 .byte $17,.ad
                                                 .endm
                                        ;
                                        sbcil    .macro .ad
                                                 .byte $e7,.ad
                                                 .endm
                                        ;
                                        sbcily   .macro .ad
                                                 .byte $f7,.ad
                                                 .endm
                                        ;
                                        stail    .macro .ad
                                                 .byte $87,.ad
                                                 .endm
                                        ;
                                        staily   .macro .ad
                                                 .byte $97,.ad
                                                 .endm
                                        ;
                                        adcs     .macro .of
                                                 .byte $63,.of
                                                 .endm
                                        ;
                                        adcsi    .macro .of
                                                 .byte $73,.of
                                                 .endm
                                        ;
                                        ands     .macro .of
                                                 .byte $23,.of
                                                 .endm
                                        ;
                                        andsi    .macro .of
                                                 .byte $33,.of
                                                 .endm
                                        ;
                                        cmps     .macro .of
                                                 .byte $c3,.of
                                                 .endm
                                        ;
                                        cmpsi    .macro .of
                                                 .byte $d3,.of
                                                 .endm
                                        ;
                                        eors     .macro .of
                                                 .byte $43,.of
                                                 .endm
                                        ;
                                        eorsi    .macro .of
                                                 .byte $53,.of
                                                 .endm
                                        ;
                                        ldas     .macro .of
                                                 .byte $a3,.of
                                                 .endm
                                        ;
                                        ldasi    .macro .of
                                                 .byte $b3,.of
                                                 .endm
                                        ;
                                        oras     .macro .of
                                                 .byte $03,.of
                                                 .endm
                                        ;
                                        orasi    .macro .of
                                                 .byte $13,.of
                                                 .endm
                                        ;
                                        sbcs     .macro .of
                                                 .byte $e3,.of
                                                 .endm
                                        ;
                                        sbcsi    .macro .of
                                                 .byte $f3,.of
                                                 .endm
                                        ;
                                        stas     .macro .of
                                                 .byte $83,.of
                                                 .endm
                                        ;
                                        stasi    .macro .of
                                                 .byte $93,.of
                                                 .endm
                                        ;
                                        longa    .macro
                                                 .byte $c2,$20
                                                 .endm
                                        ;
                                        longr    .macro
                                                 .byte $c2,$30
                                                 .endm
                                        ;
                                        longx    .macro
                                                 .byte $c2,$10
                                                 .endm
                                        ;
                                        shorta   .macro
                                                 .byte $e2,$20
                                                 .endm
                                        ;
                                        shorti   .macro
                                                 .byte $e2,$10
                                                 .endm
                                        ;
                                        shortr   .macro
                                                 .byte $e2,$30
                                                 .endm
                                        ;
                                        shortx   .macro
                                                 .byte $e2,$10
                                                 .endm
                                        ;
                                        ;================================================================================
                                        ;
                                        ;CONSOLE DISPLAY CONTROL MACROS
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	The following macros execute terminal  control procedures  that  perform
                                        ;	such tasks as clearing the screen,  switching  between  normal & reverse
                                        ;	video, etc.  These macros are for WYSE 60 & compatible displays, such as
                                        ;	the WYSE 150, WYSE 160, WYSE 325 & WYSE GPT.   Only the functions needed
                                        ;	by Supermon 816 are included.
                                        ;
                                        ;	If your console is not WYSE 60 compatible, you will need to  edit  these
                                        ;	macros as required to control your particular console or terminal.  Note
                                        ;	that in some cases one macro may call another.  Exercise caution in your
                                        ;	edits to avoid introducing display bugs.
                                        ;
                                        ;	If your console display cannot execute one of these procedures,  such as
                                        ;	'CL' (clear to end of line), you will have to develop an alternative.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	clearing data...
                                        ;
                                        bs       .macro                ;destructive backspace
                                                 .byte a_bs
                                     +            .byte a_esc,"W"
                                        
                                                 .endm
                                        ;
                                        cl       .macro                ;clear to end of line 
                                                 .byte a_esc,"T"
                                                 .endm
                                        ;
                                        ;
                                        ;	cursor control...
                                        ;
                                        cn       .macro                ;cursor on
                                                 .byte a_esc,"`1"
                                                 .endm
                                        ;
                                        co       .macro                ;cursor off
                                                 .byte a_esc,"`0"
                                                 .endm
                                        ;
                                        cr       .macro                ;carriage return
                                                 .byte a_cr
                                                 .endm
                                        ;
                                        lf       .macro                ;carriage return/line feed
                                     +            .byte a_cr
                                        
                                                 .byte a_lf
                                                 .endm
                                        ;
                                        ;
                                        ;	display attributes...
                                        ;
                                        bf       .macro                ;reverse foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G4"
                                                 .endm
                                        ;
                                        er       .macro                ;enable normal foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G0"
                                                 .endm
                                        ;
                                        sf       .macro                ;set foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G0"
                                                 .endm
                                        ;
                                        ;
                                        ;	display editing...
                                        ;
                                        dcuc     .macro                ;delete char under cursor
                                                 .byte a_esc,"W"
                                                 .endm
                                        ;
                                        ;
                                        ;	miscellaneous control...
                                        ;
                                        rb       .macro                ;ring "bell"
                                                 .byte a_bel
                                                 .endm
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASCII CONTROL DEFINITIONS (menmonic order)
                                        ;
   1017 = 0000000000000007                            a_bel    =$07                  ;<BEL> alert/ring bell
   1018 = 0000000000000008                            a_bs     =$08                  ;<BS>  backspace
   1019 = 000000000000000D                            a_cr     =$0d                  ;<CR>  carriage return
   1020 = 000000000000007F                            a_del    =$7f                  ;<DEL> delete
   1021 = 000000000000001B                            a_esc    =$1b                  ;<ESC> escape
   1022 = 0000000000000009                            a_ht     =$09                  ;<HT>  horizontal tabulation
   1023 = 000000000000000A                            a_lf     =$0a                  ;<LF>  linefeed
                                        ;
                                        ;
                                        ;	miscellaneous (description order)...
                                        ;
   1028 = 20                            a_blank  =' '                  ;blank (whitespace)
   1029 = 7A                            a_asclch ='z'                  ;end of lowercase ASCII
   1030 = 000000000000005F                            a_lctouc =$5f                  ;LC to UC conversion mask
   1031 = 61                            a_asclcl ='a'                  ;start of lowercase ASCII
   1032 = 3A                            a_colon  =':'
                                        ;
                                        ;================================================================================
                                        ;
                                        ;GLOBAL ATOMIC CONSTANTS
                                        ;
                                        ;
                                        ;	data type sizes...
                                        ;
   1041 = 0000000000000001                            s_byte   =1                    ;byte
   1042 = 0000000000000002                            s_word   =2                    ;word (16 bits)
   1043 = 0000000000000003                            s_xword  =3                    ;extended word (24 bits)
   1044 = 0000000000000004                            s_dword  =4                    ;double word (32 bits)
   1045 = 0000000000000100                            s_rampag =$0100                ;65xx RAM page
                                        ;
                                        ;
                                        ;	data type sizes in bits...
                                        ;
   1050 = 0000000000000008                            s_bibyte =8                    ;byte
   1051 = 0000000000000004                            s_bnybbl =4                    ;nybble
                                        ;
                                        ;
                                        ;	miscellaneous...
                                        ;
   1056 = 000000000000002C                            bitabs   =$2c                  ;absolute BIT opcode
   1057 = 0000000000000024                            bitzp    =$24                  ;zero page BIT opcode
                                        ;
                                        ;================================================================================
                                        ;
                                        ;W65C816S NATIVE MODE STATUS REGISTER DEFINITIONS
                                        ;
   1063 = 00000001                      s_mpudbx =s_byte               ;data bank size
   1064 = 00000002                      s_mpudpx =s_word               ;direct page size
   1065 = 00000001                      s_mpupbx =s_byte               ;program bank size
   1066 = 00000002                      s_mpupcx =s_word               ;program counter size
   1067 = 00000002                      s_mpuspx =s_word               ;stack pointer size
   1068 = 00000001                      s_mpusrx =s_byte               ;status size
                                        ;
                                        ;
                                        ;	status register flags...
                                        ;
   1073 = 0000000000000001                            sr_car   =%00000001            ;C
   1074 = 00000002                      sr_zer   =sr_car << 1          ;Z
   1075 = 00000004                      sr_irq   =sr_zer << 1          ;I
   1076 = 00000008                      sr_bdm   =sr_irq << 1          ;D
   1077 = 00000010                      sr_ixw   =sr_bdm << 1          ;x
   1078 = 00000020                      sr_amw   =sr_ixw << 1          ;m
   1079 = 00000040                      sr_ovl   =sr_amw << 1          ;V
   1080 = 00000080                      sr_neg   =sr_ovl << 1          ;N
   1081 = 00000100                      sr_16	 =sr_neg << 1
   1082 = 00000200                      sr_32    =sr_16 << 1
                                        ;
                                        ;	NVmxDIZC
                                        ;	xxxxxxxx
                                        ;	||||||||
                                        ;	|||||||+———> 1 = carry set/generated
                                        ;	||||||+————> 1 = result = zero
                                        ;	|||||+—————> 1 = IRQs ignored
                                        ;	||||+——————> 0 = binary arithmetic mode
                                        ;	||||         1 = decimal arithmetic mode
                                        ;	|||+———————> 0 = 16 bit index
                                        ;	|||          1 = 8 bit index
                                        ;	||+————————> 0 = 16 bit .A & memory
                                        ;	||           1 = 8 bit .A & memory
                                        ;	|+—————————> 1 = sign overflow
                                        ;	+——————————> 1 = result = negative
                                        ;
                                        ;================================================================================
                                        ;
                                        ;"SIZE-OF" CONSTANTS
                                        ;
   1103 = 00000003                      s_addr   =s_xword              ;24 bit address
   1104 = 0000000000000020                            s_auxbuf =32                   ;auxiliary buffer
   1105 = 0000000000000050                            s_ibuf   =80                   ;input buffer
   1106 = 0000000000000003                            s_mnemon =3                    ;MPU ASCII mnemonic
   1107 = 0000000000000002                            s_mnepck =2                    ;MPU encoded mnemonic
   1108 = 0000000000000003                            s_mvinst =3                    ;MVN/MVP instruction
   1109 = 00000001                      s_opcode =s_byte               ;MPU opcode
   1110 = 00000003                      s_oper   =s_xword              ;operand
   1111 = 00000004                      s_pfac   =s_dword              ;primary math accumulator
   1112 = 00000006                      s_sfac   =s_dword+s_word       ;secondary math accumulators
                                        ;
                                        ;================================================================================
                                        ;
                                        ;"NUMBER-OF" CONSTANTS
                                        ;
   1118 = 0000000000000015                            n_dbytes =21                   ;default disassembly bytes
   1119 = 0000000000000008                            n_dump   =8                    ;bytes per memory dump line
   1120 = 000000FF                      n_mbytes =s_rampag-1           ;default memory dump bytes
   1121 = 0000000000000008                            n_hccols =8                    ;compare/hunt display columns
   1122 = 00000009                      n_opcols =3*s_oper             ;disassembly operand columns
   1123 = 0000000000000004                            n_opslsr =4                    ;LSRs to extract instruction size
   1124 = 0000000000000005                            n_shfenc =5                    ;shifts to encode/decode mnemonic
                                        ;
                                        ;================================================================================
                                        ;
                                        ;NUMERIC CONVERSION CONSTANTS
                                        ;
   1130 = 0000000000000006                            a_hexdec ='A'-'9'-2            ;hex to decimal difference
   1131 = 25                            c_bin    ='%'                  ;binary prefix
   1132 = 2B                            c_dec    ='+'                  ;decimal prefix
   1133 = 24                            c_hex    ='$'                  ;hexadecimal prefix
   1134 = 40                            c_oct    ='@'                  ;octal prefix
   1135 = 66                            k_hex    ='f'                  ;hex ASCII conversion
   1136 = 00000020                      m_bits   =s_pfac*s_bibyte      ;operand bit size
   1137 = 00000030                      m_cbits  =s_sfac*s_bibyte      ;workspace bit size
   1138 = 000000000000000F                            bcdumask =%00001111            ;isolate BCD units mask
   1139 = 0000000000000030                            btoamask =%00110000            ;binary to ASCII mask
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASSEMBLER/DISASSEMBLER CONSTANTS
                                        ;
   1145 = 3F                            a_mnecvt ='?'                  ;encoded mnemonic conversion base
   1146 = 000000000000001F                            aimmaska =%00011111            ;.A immediate opcode test #1
   1147 = 0000000000000009                            aimmaskb =%00001001            ;.A immediate opcode test #2
   1148 = 41                            asmprfx  ='A'                  ;assemble code prefix
   1149 = 0000000000000009                            ascprmct =9                    ;assembler prompt "size-of"
   1150 = 2E                            disprfx  ='.'                  ;disassemble code prefix
   1151 = 00000000000000C0                            flimmask =%11000000            ;force long immediate flag
   1152 = 0000000000000054                            opc_mvn  =$54                  ;MVN opcode
   1153 = 0000000000000044                            opc_mvp  =$44                  ;MVP opcode
   1154 = 00000000000000C2                            opc_rep  =$c2                  ;REP opcode
   1155 = 00000000000000E2                            opc_sep  =$e2                  ;SEP opcode
   1156 = 00000030                      pfmxmask =sr_amw | sr_ixw      ;MPU m & x flag bits mask
                                        ;
                                        ;
                                        ;	assembler prompt buffer offsets...
                                        ;
   1161 = 00000002                      apadrbkh =s_word               ;instruction address bank MSN
   1162 = 00000003                      apadrbkl =apadrbkh+s_byte      ;instruction address bank LSN
   1163 = 00000004                      apadrmbh =apadrbkl+s_byte      ;instruction address MSB MSN
   1164 = 00000005                      apadrmbl =apadrmbh+s_byte      ;instruction address MSB LSN
   1165 = 00000006                      apadrlbh =apadrmbl+s_byte      ;instruction address LSB MSN
   1166 = 00000007                      apadrlbl =apadrlbh+s_byte      ;instruction address LSB LSN
                                        ;
                                        ;
                                        ;	addressing mode preamble symbols...
                                        ;
   1171 = 21                            amp_flim ='!'                  ;force long immediate
   1172 = 23                            amp_imm  ='#'                  ;immediate
   1173 = 28                            amp_ind  ='('                  ;indirect
   1174 = 5B                            amp_indl ='['                  ;indirect long
   1175 = 7B                            amp_indxl = '{'				   ;indirect extra long
                                        ;
                                        ;
                                        ;	addressing mode symbolic translation indices...
                                        ;
   1180 = 0000000000000000                            am_nam   =%0000                ;(0)  no symbol
   1181 = 0000000000000001                            am_imm   =%0001                ;(1)  #
   1182 = 0000000000000002                            am_adrx  =%0010                ;(2)  dp,X or addr,X
   1183 = 0000000000000003                            am_adry  =%0011                ;(3)  dp,Y or addr,Y
   1184 = 0000000000000004                            am_ind   =%0100                ;(4)  (dp) or (addr)
   1185 = 0000000000000005                            am_indl  =%0101                ;(5)  [dp] or [addr]
   1186 = 0000000000000006                            am_indly =%0110                ;(6)  [dp],Y
   1187 = 0000000000000007                            am_indx  =%0111                ;(7)  (dp,X) or (addr,X)
   1188 = 0000000000000008                            am_indy  =%1000                ;(8)  (dp),Y
   1189 = 0000000000000009                            am_stk   =%1001                ;(9)  offset,S
   1190 = 000000000000000A                            am_stky  =%1010                ;(10) (offset,S),Y
   1191 = 000000000000000B                            am_move  =%1011                ;(11) MVN/MVP sbnk,dbnk
   1192 = 000000000000000C                            am_indxly=%1100				   ;(12) {dp},Y
                                        ;
                                        ;
                                        ;	operand size translation indices...
                                        ;
   1197 = 0000000000000000                            ops0     =%0000 << 4           ;no operand
   1198 = 0000000000000010                            ops1     =%0001 << 4           ;8 bit operand
   1199 = 0000000000000020                            ops2     =%0010 << 4           ;16 bit operand
   1200 = 0000000000000030                            ops3     =%0011 << 4           ;24 bit operand
   1201 = 0000000000000050                            bop1     =%0101 << 4           ;8 bit relative branch
   1202 = 0000000000000060                            bop2     =%0110 << 4           ;16 bit relative branch
   1203 = 0000000000000090                            vops     =%1001 << 4           ;8, 16, or 32 bit operand
   1204 = 0000000000010100                            ops5	 =$1010 << 4		   ;32 bit operand
                                        ;
                                        ;
                                        ;	operand size & addressing mode extraction masks...
                                        ;
   1209 = 000000000000000F                            amodmask =%00001111            ;addressing mode index
   1210 = 0000000000000030                            opsmask  =%00110000            ;operand size
   1211 = 00000000000000C0                            vopsmask =%11000000            ;BOPx & VOPS flag bits
                                        ;
                                        ;
                                        ;	instruction mnemonic encoding...
                                        ;
   1216 = 0000000000002144                            mne_adc  =$2144                ;ADC
   1217 = 0000000000002BC4                            mne_and  =$2bc4                ;AND
   1218 = 0000000000006D04                            mne_asl  =$6d04                ;ASL
   1219 = 0000000000002106                            mne_bcc  =$2106                ;BCC
   1220 = 000000000000A106                            mne_bcs  =$a106                ;BCS
   1221 = 0000000000009186                            mne_beq  =$9186                ;BEQ
   1222 = 000000000000AA86                            mne_bit  =$aa86                ;BIT
   1223 = 0000000000005386                            mne_bmi  =$5386                ;BMI
   1224 = 00000000000033C6                            mne_bne  =$33c6                ;BNE
   1225 = 0000000000006C46                            mne_bpl  =$6c46                ;BPL
   1226 = 00000000000014C6                            mne_bra  =$14c6                ;BRA
   1227 = 00000000000064C6                            mne_brk  =$64c6                ;BRK
   1228 = 0000000000006CC6                            mne_brl  =$6cc6                ;BRL
   1229 = 00000000000025C6                            mne_bvc  =$25c6                ;BVC
   1230 = 000000000000A5C6                            mne_bvs  =$a5c6                ;BVS
   1231 = 0000000000002348                            mne_clc  =$2348                ;CLC
   1232 = 0000000000002B48                            mne_cld  =$2b48                ;CLD
   1233 = 0000000000005348                            mne_cli  =$5348                ;CLI
   1234 = 000000000000BB48                            mne_clv  =$bb48                ;CLV
   1235 = 0000000000008B88                            mne_cmp  =$8b88                ;CMP
   1236 = 0000000000008C08                            mne_cop  =$8c08                ;COP
   1237 = 000000000000CC48                            mne_cpx  =$cc48                ;CPX
   1238 = 000000000000D448                            mne_cpy  =$d448                ;CPY
   1239 = 000000000000218A                            mne_dec  =$218a                ;DEC
   1240 = 000000000000C98A                            mne_dex  =$c98a                ;DEX
   1241 = 000000000000D18A                            mne_dey  =$d18a                ;DEY
   1242 = 0000000000009C0C                            mne_eor  =$9c0c                ;EOR
   1243 = 00000000000023D4                            mne_inc  =$23d4                ;INC
   1244 = 000000000000CBD4                            mne_inx  =$cbd4                ;INX
   1245 = 000000000000D3D4                            mne_iny  =$d3d4                ;INY
   1246 = 0000000000006B96                            mne_jml  =$6b96                ;JML
   1247 = 0000000000008B96                            mne_jmp  =$8b96                ;JMP
   1248 = 0000000000006D16                            mne_jsl  =$6d16                ;JSL
   1249 = 0000000000009D16                            mne_jsr  =$9d16                ;JSR
   1250 = 000000000000115A                            mne_lda  =$115a                ;LDA
   1251 = 000000000000C95A                            mne_ldx  =$c95a                ;LDX
   1252 = 000000000000D15A                            mne_ldy  =$d15a                ;LDY
   1253 = 0000000000009D1A                            mne_lsr  =$9d1a                ;LSR
   1254 = 0000000000007DDC                            mne_mvn  =$7ddc                ;MVN
   1255 = 0000000000008DDC                            mne_mvp  =$8ddc                ;MVP
   1256 = 0000000000008C1E                            mne_nop  =$8c1e                ;NOP
   1257 = 00000000000014E0                            mne_ora  =$14e0                ;ORA
   1258 = 00000000000011A2                            mne_pea  =$11a2                ;PEA
   1259 = 00000000000051A2                            mne_pei  =$51a2                ;PEI
   1260 = 00000000000099A2                            mne_per  =$99a2                ;PER
   1261 = 0000000000001262                            mne_pha  =$1262                ;PHA
   1262 = 0000000000001A62                            mne_phb  =$1a62                ;PHB
   1263 = 0000000000002A62                            mne_phd  =$2a62                ;PHD
   1264 = 0000000000006262                            mne_phk  =$6262                ;PHK
   1265 = 0000000000008A62                            mne_php  =$8a62                ;PHP
   1266 = 000000000000CA62                            mne_phx  =$ca62                ;PHX
   1267 = 000000000000D262                            mne_phy  =$d262                ;PHY
   1268 = 0000000000001362                            mne_pla  =$1362                ;PLA
   1269 = 0000000000001B62                            mne_plb  =$1b62                ;PLB
   1270 = 0000000000002B62                            mne_pld  =$2b62                ;PLD
   1271 = 0000000000008B62                            mne_plp  =$8b62                ;PLP
   1272 = 000000000000CB62                            mne_plx  =$cb62                ;PLX
   1273 = 000000000000D362                            mne_ply  =$d362                ;PLY
   1274 = 00000000000089A6                            mne_rep  =$89a6                ;REP
   1275 = 0000000000006C26                            mne_rol  =$6c26                ;ROL
   1276 = 0000000000009C26                            mne_ror  =$9c26                ;ROR
   1277 = 0000000000005566                            mne_rti  =$5566                ;RTI
   1278 = 0000000000006D66                            mne_rtl  =$6d66                ;RTL
   1279 = 000000000000A566                            mne_rts  =$a566                ;RTS
   1280 = 00000000000020E8                            mne_sbc  =$20e8                ;SBC
   1281 = 00000000000021A8                            mne_sec  =$21a8                ;SEC
   1282 = 00000000000029A8                            mne_sed  =$29a8                ;SED
   1283 = 00000000000051A8                            mne_sei  =$51a8                ;SEI
   1284 = 00000000000089A8                            mne_sep  =$89a8                ;SEP
   1285 = 0000000000001568                            mne_sta  =$1568                ;STA
   1286 = 0000000000008D68                            mne_stp  =$8d68                ;STP
   1287 = 000000000000CD68                            mne_stx  =$cd68                ;STX
   1288 = 000000000000D568                            mne_sty  =$d568                ;STY
   1289 = 000000000000DD68                            mne_stz  =$dd68                ;STZ
   1290 = 000000000000C8AA                            mne_tax  =$c8aa                ;TAX
   1291 = 000000000000D0AA                            mne_tay  =$d0aa                ;TAY
   1292 = 000000000000292A                            mne_tcd  =$292a                ;TCD
   1293 = 000000000000A12A                            mne_tcs  =$a12a                ;TCS
   1294 = 000000000000216A                            mne_tdc  =$216a                ;TDC
   1295 = 0000000000001CEA                            mne_trb  =$1cea                ;TRB
   1296 = 0000000000001D2A                            mne_tsb  =$1d2a                ;TSB
   1297 = 000000000000252A                            mne_tsc  =$252a                ;TSC
   1298 = 000000000000CD2A                            mne_tsx  =$cd2a                ;TSX
   1299 = 000000000000166A                            mne_txa  =$166a                ;TXA
   1300 = 000000000000A66A                            mne_txs  =$a66a                ;TXS
   1301 = 000000000000D66A                            mne_txy  =$d66a                ;TXY
   1302 = 00000000000016AA                            mne_tya  =$16aa                ;TYA
   1303 = 000000000000CEAA                            mne_tyx  =$ceaa                ;TYX
   1304 = 00000000000050B0                            mne_wai  =$50b0                ;WAI
   1305 = 0000000000007170                            mne_wdm  =$7170                ;WDM
   1306 = 00000000000010F2                            mne_xba  =$10f2                ;XBA
   1307 = 0000000000003132                            mne_xce  =$3132                ;XCE
                                        ;
                                        ;
                                        ;	encoded instruction mnemonic indices...
                                        ;
   1312 = 0000000000000010                            mne_adcx =16                   ;ADC
   1313 = 000000000000001D                            mne_andx =29                   ;AND
   1314 = 000000000000002C                            mne_aslx =44                   ;ASL
   1315 = 000000000000000F                            mne_bccx =15                   ;BCC
   1316 = 0000000000000041                            mne_bcsx =65                   ;BCS
   1317 = 000000000000003B                            mne_beqx =59                   ;BEQ
   1318 = 0000000000000046                            mne_bitx =70                   ;BIT
   1319 = 0000000000000024                            mne_bmix =36                   ;BMI
   1320 = 000000000000001F                            mne_bnex =31                   ;BNE
   1321 = 000000000000002A                            mne_bplx =42                   ;BPL
   1322 = 0000000000000005                            mne_brax =5                    ;BRA
   1323 = 0000000000000027                            mne_brkx =39                   ;BRK
   1324 = 000000000000002B                            mne_brlx =43                   ;BRL
   1325 = 0000000000000017                            mne_bvcx =23                   ;BVC
   1326 = 0000000000000044                            mne_bvsx =68                   ;BVS
   1327 = 0000000000000014                            mne_clcx =20                   ;CLC
   1328 = 000000000000001B                            mne_cldx =27                   ;CLD
   1329 = 0000000000000023                            mne_clix =35                   ;CLI
   1330 = 0000000000000047                            mne_clvx =71                   ;CLV
   1331 = 0000000000000035                            mne_cmpx =53                   ;CMP
   1332 = 0000000000000037                            mne_copx =55                   ;COP
   1333 = 000000000000004E                            mne_cpxx =78                   ;CPX
   1334 = 0000000000000058                            mne_cpyx =88                   ;CPY
   1335 = 0000000000000012                            mne_decx =18                   ;DEC
   1336 = 000000000000004A                            mne_dexx =74                   ;DEX
   1337 = 0000000000000054                            mne_deyx =84                   ;DEY
   1338 = 000000000000003D                            mne_eorx =61                   ;EOR
   1339 = 0000000000000015                            mne_incx =21                   ;INC
   1340 = 000000000000004D                            mne_inxx =77                   ;INX
   1341 = 0000000000000057                            mne_inyx =87                   ;INY
   1342 = 0000000000000028                            mne_jmlx =40                   ;JML
   1343 = 0000000000000036                            mne_jmpx =54                   ;JMP
   1344 = 000000000000002D                            mne_jslx =45                   ;JSL
   1345 = 000000000000003F                            mne_jsrx =63                   ;JSR
   1346 = 0000000000000001                            mne_ldax =1                    ;LDA
   1347 = 0000000000000049                            mne_ldxx =73                   ;LDX
   1348 = 0000000000000053                            mne_ldyx =83                   ;LDY
   1349 = 0000000000000040                            mne_lsrx =64                   ;LSR
   1350 = 0000000000000030                            mne_mvnx =48                   ;MVN
   1351 = 000000000000003A                            mne_mvpx =58                   ;MVP
   1352 = 0000000000000038                            mne_nopx =56                   ;NOP
   1353 = 0000000000000006                            mne_orax =6                    ;ORA
   1354 = 0000000000000002                            mne_peax =2                    ;PEA
   1355 = 0000000000000021                            mne_peix =33                   ;PEI
   1356 = 000000000000003C                            mne_perx =60                   ;PER
   1357 = 0000000000000003                            mne_phax =3                    ;PHA
   1358 = 000000000000000A                            mne_phbx =10                   ;PHB
   1359 = 000000000000001A                            mne_phdx =26                   ;PHD
   1360 = 0000000000000026                            mne_phkx =38                   ;PHK
   1361 = 0000000000000033                            mne_phpx =51                   ;PHP
   1362 = 000000000000004B                            mne_phxx =75                   ;PHX
   1363 = 0000000000000055                            mne_phyx =85                   ;PHY
   1364 = 0000000000000004                            mne_plax =4                    ;PLA
   1365 = 000000000000000B                            mne_plbx =11                   ;PLB
   1366 = 000000000000001C                            mne_pldx =28                   ;PLD
   1367 = 0000000000000034                            mne_plpx =52                   ;PLP
   1368 = 000000000000004C                            mne_plxx =76                   ;PLX
   1369 = 0000000000000056                            mne_plyx =86                   ;PLY
   1370 = 0000000000000031                            mne_repx =49                   ;REP
   1371 = 0000000000000029                            mne_rolx =41                   ;ROL
   1372 = 000000000000003E                            mne_rorx =62                   ;ROR
   1373 = 0000000000000025                            mne_rtix =37                   ;RTI
   1374 = 000000000000002E                            mne_rtlx =46                   ;RTL
   1375 = 0000000000000043                            mne_rtsx =67                   ;RTS
   1376 = 000000000000000E                            mne_sbcx =14                   ;SBC
   1377 = 0000000000000013                            mne_secx =19                   ;SEC
   1378 = 0000000000000019                            mne_sedx =25                   ;SED
   1379 = 0000000000000022                            mne_seix =34                   ;SEI
   1380 = 0000000000000032                            mne_sepx =50                   ;SEP
   1381 = 0000000000000007                            mne_stax =7                    ;STA
   1382 = 0000000000000039                            mne_stpx =57                   ;STP
   1383 = 0000000000000050                            mne_stxx =80                   ;STX
   1384 = 0000000000000059                            mne_styx =89                   ;STY
   1385 = 000000000000005B                            mne_stzx =91                   ;STZ
   1386 = 0000000000000048                            mne_taxx =72                   ;TAX
   1387 = 0000000000000052                            mne_tayx =82                   ;TAY
   1388 = 0000000000000018                            mne_tcdx =24                   ;TCD
   1389 = 0000000000000042                            mne_tcsx =66                   ;TCS
   1390 = 0000000000000011                            mne_tdcx =17                   ;TDC
   1391 = 000000000000000C                            mne_trbx =12                   ;TRB
   1392 = 000000000000000D                            mne_tsbx =13                   ;TSB
   1393 = 0000000000000016                            mne_tscx =22                   ;TSC
   1394 = 000000000000004F                            mne_tsxx =79                   ;TSX
   1395 = 0000000000000008                            mne_txax =8                    ;TXA
   1396 = 0000000000000045                            mne_txsx =69                   ;TXS
   1397 = 000000000000005A                            mne_txyx =90                   ;TXY
   1398 = 0000000000000009                            mne_tyax =9                    ;TYA
   1399 = 0000000000000051                            mne_tyxx =81                   ;TYX
   1400 = 0000000000000020                            mne_waix =32                   ;WAI
   1401 = 000000000000002F                            mne_wdmx =47                   ;WDM
   1402 = 0000000000000000                            mne_xbax =0                    ;XBA
   1403 = 000000000000001E                            mne_xcex =30                   ;XCE
                                        ;
                                        ;================================================================================
                                        ;
                                        ;MISCELLANEOUS CONSTANTS
                                        ;
   1409 = 0000000000000004                            halftab  =4                    ;1/2 tabulation spacing
   1410 = 3E                            memprfx  ='>'                  ;memory dump prefix
   1411 = 3A                            memsepch =':'                  ;memory dump separator
   1412 = 2E                            memsubch ='.'                  ;memory dump non-print char
   1413 = 0000000000000030                            srinit   =%00110000            ;SR initialization value
                                        ;
                                        ;================================================================================
                                        ;
                                        ;DIRECT PAGE STORAGE
                                        ;
   1419 = 00000080                      reg_csx  =zeropage			;CS
   1420 = 00000082                      reg_dsx  =reg_csx + 2		;DS
   1421 = 00000084                      reg_ssx  =reg_dsx + 2		;SS
   1422 = 00000086                      reg_pcx  =reg_ssx + 2	    ;PC
   1423 = 00000088                      reg_pbx  =reg_pcx + 2       ;PB
   1424 = 00000089                      reg_ax   =reg_pbx + 1       ;.C
   1425 = 0000008D                      reg_xx   =reg_ax + 4        ;.X
   1426 = 00000091                      reg_yx   =reg_xx + 4        ;.Y
   1427 = 00000095                      reg_spx  =reg_yx + 4        ;SP
   1428 = 00000099                      reg_srx  =reg_spx + 4       ;SR
   1429 = 0000009A                      reg_srxx =reg_srx + 1       ;SRX
   1430 = 0000009B                      reg_dbx  =reg_srxx + 1      ;DB
   1431 = 0000009C                      reg_dpx  =reg_dbx + 1       ;DP
                                        ;
                                        ;
                                        ;	general workspace...
                                        ;
   1436 = 000000A0                      addra    =reg_dpx+4            ;address #1
   1437 = 000000A4                      addrb    =addra+4              ;address #2
   1438 = 000000A7                      faca     =addrb+s_addr         ;primary accumulator
   1439 = 000000AB                      facax    =faca+s_pfac          ;extended primary accumulator
   1440 = 000000AF                      facb     =facax+s_pfac         ;secondary accumulator
   1441 = 000000B5                      facc     =facb+s_sfac          ;tertiary accumulator
   1442 = 000000BB                      operand  =facc+s_sfac          ;instruction operand
   1443 = 000000BE                      auxbufix =operand+s_oper       ;auxiliary buffer index
   1444 = 000000BF                      ibufidx  =auxbufix+s_byte      ;input buffer index
   1445 = 000000C0                      bitsdig  =ibufidx+s_byte       ;bits per numeral
   1446 = 000000C1                      numeral  =bitsdig+s_byte       ;numeral buffer
   1447 = 000000C2                      radix    =numeral+s_byte       ;radix index
   1448 = 000000C3                      admodidx =radix+s_byte         ;addressing mode index
   1449 = 000000C4                      charcnt  =admodidx+s_byte      ;character counter
   1450 = 000000C6                      instsize =charcnt+s_word       ;instruction size
   1451 = 000000C8                      mnepck   =instsize+s_word      ;encoded mnemonic
   1452 = 000000CA                      opcode   =mnepck+s_mnepck      ;current opcode
   1453 = 000000CB                      status   =opcode+s_byte        ;I/O status flag
   1454 = 000000CC                      xrtemp   =status+s_byte        ;temp .X storage
   1455 = 000000CD                      eopsize  =xrtemp+s_byte        ;entered operand size
   1456 = 000000CE                      flimflag =eopsize+s_byte       ;forced long immediate...
                                        ;
                                        ;	xx000000
                                        ;	||
                                        ;	|+—————————> 0: .X/.Y = 8 bits
                                        ;	|            1: .X/.Y = 16 bits
                                        ;	+——————————> 0: .A = 8 bits
                                        ;	             1: .A = 16 bits
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	During assembly, FLIMFLAG indicates the operand size used with an immed-
                                        ;	iate mode instruction, thus causing the following disassembly to display
                                        ;	the assembled  operand size.   During disassembly,  FLIMFLAG will mirror
                                        ;	the effect of the most recent REP or SEP instruction.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1472 = 000000CF                      iopsize  =flimflag+s_byte      ;operand size
   1473 = 000000D0                      range    =iopsize+s_byte       ;allowable radix range
   1474 = 000000D1                      vopsflag =range+s_byte         ;VOPS & ROPS mode bits
                                        ;
                                        ;
                                        ;	copy/fill workspace (overlaps some of the above)...
                                        ;
   1479 = 000000D2                      mcftwork =vopsflag+s_byte	;faca                 ;start of copy/fill code
   1480 = 000000D3                      mcftopc  =mcftwork+s_byte      ;instruction opcode
   1481 = 000000D4                      mcftbnk  =mcftopc+s_byte       ;banks
                                        ;
                                        ;================================================================================
                                        ;
                                        ;SUPERMON 816 JUMP TABLE
                                        ;
                                                 org	_origin_
                                        ;
   1490 8000                            		 MEM	8
   1491 8000                            		 NDX	8
                                        		 CPU	W65C02
   1493 8000 80 02                      JMON     bra mon               ;cold start entry
   1494 8002 80 3E                      JMONBRK  bra monbrk            ;software interrupt intercept
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mon: SUPERMON 816 COLD START
                                        ;
   1500 8004 C2 20                      mon +         .byte $c2,$20
                                        
   1501 8006 AD 02 01                             lda vecbrki           ;BRK vector
   1502 8009 C9 42                    +            cmp #<monbrk
   1502 800B 80                       +            .byte >monbrk
                                        ;pointing at monitor?
   1503 800C D0 03                                bne .2            ;yes, ignore cold start
   1504 800E 4C 7F 80                             jmp	monreg			; got a branch out of range here when debugging code
                                        								; was included
   1506 8011                            .2
                                        ;
   1508 8011 8D 05 01                             sta vecbrkia          ;save vector for exit
   1509 8014 A9 42                    +            lda #<monbrk
   1509 8016 80                       +            .byte >monbrk
                                        ;Supermon 816 intercepts...
   1510 8017 8D 02 01                             sta vecbrki           ;BRK handler
   1511 801A E2 30                    +            .byte $e2,$30
                                                        ;8 bit registers
   1512 801C A2 49                                ldx #vopsflag-reg_pbx
                                        ;
   1514 801E 74 88                      .0000010 stz reg_pbx,x         ;clear DP storage
   1515 8020 CA                                   dex
   1516 8021 10 FB                                bpl .0000010
                                        ;
   1518 8023 A9 30                                lda #srinit
   1519 8025 85 99                                sta reg_srx           ;status register
   1520 8027 C2 20                    +            .byte $c2,$20
                                                         ;16 bit .A
   1521 8029 A9 FF                    +            lda #<hwstack
   1521 802B 3F                       +            .byte >hwstack
                                        ;top of hardware stack
   1522 802C 1B                       +            .byte $1b
                                                           ;set SP
   1523 802D 7B                       +            .byte $7b
                                                           ;get & save...
   1524 802E 85 9C                                sta reg_dpx           ;DP register
   1525 8030 A9 00                    +            lda #<0
   1525 8032 00                       +            .byte >0
                                        
   1526 8033 E2 20                    +            .byte $e2,$20
                                        
   1527 8035 4B                       +            .byte $4b
                                        
   1528 8036 68                                   pla                   ;capture PB &...
   1529 8037 85 88                                sta reg_pbx           ;set
   1530 8039 8B                       +            .byte $8b
                                        
   1531 803A 68                                   pla                   ;capture DB &...
   1532 803B 85 9B                                sta reg_dbx           ;set
   1533 803D F4                       +            .byte $f4
   1533 803E 34 90                    +            .word mm_entry
                                        ;"...ready..."
   1534 8040 80 30                                bra moncom
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monbrk: SOFTWARE INTERRUPT INTERCEPT
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	This is the entry point taken when a BRK instruction is executed.  It is
                                        ;	assumed that the BRK  handler has pushed the registers to the stack that
                                        ;	are not automatically pushed by the MPU in response to BRK.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1546 8042 58                         monbrk   cli                   ;reenable IRQs
   1547 8043                            		 phds
   1548 8043 68                          		 pla
   1549 8044 85 82                       		 sta reg_dsx
                                           		 CPU	FT832
   1551 008046 42 7A                        		 tssa
   1552 008048 85 84                        		 sta	reg_ssx
                                        		 CPU	W65C02
   1554 804A 7A                                   ply                   ;recover registers
   1555 804B FA                                   plx
   1556 804C 68                                   pla
   1557 804D C2 30                    +            .byte $c2,$30
                                                         ;store 16 bit registers
   1558 804F 85 89                                sta reg_ax            ;.A
   1559 8051 86 8D                                stx reg_xx            ;.X
   1560 8053 84 91                                sty reg_yx            ;.Y
   1561 8055 E2 10                    +            .byte $e2,$10
                                                        ;8 bit index registers
   1562 8057 68                                   pla                   ;get DP &...
   1563 8058 85 9C                                sta reg_dpx           ;store
   1564 805A FA                                   plx                   ;get DB &...
   1565 805B 86 9B                                stx reg_dbx           ;store
   1566 805D FA                                   plx                   ;get SR &...
   1567 805E 86 99                                stx reg_srx           ;store
   1568 8060 68                                   pla                   ;get PC &...
   1569 8061 85 86                                sta reg_pcx           ;store
   1570 8063 E2 20                    +            .byte $e2,$20
                                        
   1571 8065 68                                   pla                   ;get PB &...
   1572 8066 85 88                                sta reg_pbx           ;store
   1573 8068 C2 20                    +            .byte $c2,$20
                                        
   1574 806A 68                          		 pla				   ; get CS &...
   1575 806B 85 80                       		 sta	reg_csx		   ; store
   1576 806D E2 20                    +            .byte $e2,$20
                                        
   1577 806F F4                       +            .byte $f4
   1577 8070 29 90                    +            .word mm_brk
                                        ;"*BRK"
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncom: COMMON ENTRY POINT
                                        ;
                                        ;	——————————————————————————————————————
                                        ;	DO NOT directly call this entry point!
                                        ;	——————————————————————————————————————
                                        ;
   1587 8072                            moncom   
   1588 8072 20 1D 88                    		 jsr sprint            ;print heading
   1589 8075 C2 20                    +            .byte $c2,$20
                                        
   1590 8077 3B                       +            .byte $3b
                                                           ;get SP &...
   1591 8078 85 95                                sta reg_spx           ;store
   1592 807A C2 FF                    +            .byte $c2,%11111111
                                        ;clear SR &...
   1593 807C E2 30                    +            .byte $e2,srinit
                                        ;set default state
   1594 807E 38                                   sec                   ;see next
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monreg: DISPLAY MPU REGISTERS
                                        ;
                                        ;	—————————
                                        ;	syntax: R
                                        ;	—————————
                                        ;
   1604 807F B0 03                      monreg   bcs .0000010          ;okay to proceed
                                        ;
   1606 8081 4C 65 81                             jmp monerr            ;error if called with a parm
                                        ;
   1608 8084 F4                         .0000010 +         .byte $f4
   1608 8085 5F 90                    +            .word mm_regs
                                        
   1609 8087 20 1D 88                             jsr sprint            ;display heading
                                        ;
                                        ;
                                        ;	display code selector & program bank & counter...
                                        ;
   1614 808A C2 20                    +            .byte $c2,$20
                                        
   1615 808C A5 80                       		 lda	reg_csx
   1616 808E E2 20                    +            .byte $e2,$20
                                        
   1617 8090 20 D7 87                    		 jsr    dpyhexw
   1618 8093 E2 20                    +            .byte $e2,$20
                                        
   1619 8095 A9 3A                       		 lda #a_colon
   1620 8097 20 17 88                             jsr printcmn          ;':'
   1621 809A A5 88                                lda reg_pbx           ;PB
   1622 809C 20 E7 87                             jsr dpyhex            ;display as hex ASCII
   1623 809F 20 15 88                             jsr printspc          ;inter-field space
   1624 80A2 C2 20                    +            .byte $c2,$20
                                        
   1625 80A4 A5 86                                lda reg_pcx
   1626 80A6 E2 20                    +            .byte $e2,$20
                                        
   1627 80A8 20 D7 87                             jsr dpyhexw           ;display PC
   1628 80AB A2 02                                ldx #2
   1629 80AD 20 F6 87                             jsr multspc           ;inter-field spacing
                                        ;
                                        ;
                                        ;	display SR in bitwise fashion...
                                        ;
   1634 80B0 A5 9A                       		 lda reg_srxx
   1635 80B2 4A                          		 lsr
   1636 80B3 4A                          		 lsr
   1637 80B4 69 30                       		 adc #'0'
                                           		 cpu FT832
   1639 0080B6 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   1641 80BB A5 9A                       		 lda reg_srxx
   1642 80BD 4A                          		 lsr
   1643 80BE 69 30                       		 adc #'0'
                                           		 cpu FT832
   1645 0080C0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        
   1648 80C5 A6 99                                ldx reg_srx           ;SR
   1649 80C7 A0 08                                ldy #s_bibyte         ;bits in a byte
                                        ;
   1651 80C9 8A                         .0000020 txa                   ;remaining SR bits
   1652 80CA 0A                                   asl                   ;grab one of them
   1653 80CB AA                                   tax                   ;save remainder
   1654 80CC A9 30                                lda #'0'              ;a clear bit but...
   1655 80CE 69 00                                adc #0                ;adjust if set &...
                                           		 cpu FT832
   1657 0080D0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   1659 80D5 88                                   dey                   ;bit processed
   1660 80D6 D0 F1                                bne .0000020          ;do another
                                        ;
                                        ;
                                        ;	display .C, .X, .Y, SP & DP...
                                        ;
   1665 80D8 20 15 88                   .0000030 jsr printspc          ;spacing
   1666 80DB C2 20                    +            .byte $c2,$20
                                        
   1667 80DD B9 8B 00                             lda reg_ax+2,y        ;get register value
   1668 80E0 E2 20                    +            .byte $e2,$20
                                        
   1669 80E2 20 D7 87                             jsr dpyhexw           ;convert & display
   1670 80E5 C2 20                    +            .byte $c2,$20
                                        
   1671 80E7 B9 89 00                             lda reg_ax,y          ;get register value
   1672 80EA E2 20                    +            .byte $e2,$20
                                        
   1673 80EC 20 D7 87                             jsr dpyhexw           ;convert & display
                                        ;         .rept s_word
   1675 80EF C8                                     iny
   1676 80F0 C8                                     iny
                                        ;         .endr
                                        ;         .rept s_word
   1679 80F1 C8                                     iny
   1680 80F2 C8                                     iny
                                        ;         .endr
   1682 80F3 C0 0F                                cpy #reg_spx-reg_ax+3
   1683 80F5 90 E1                                bcc .0000030          ;next
                                        ;
                                        ;
                                        ;	display DS SS DB...
                                        ;
   1688 80F7 F4                       +            .byte $f4
   1688 80F8 BB 90                    +            .word mm_regs2
                                        
   1689 80FA 20 1D 88                    		 jsr sprint
   1690 80FD C2 20                    +            .byte $c2,$20
                                        
   1691 80FF A5 82                                lda reg_dsx          ;get DS &...
   1692 8101 E2 20                    +            .byte $e2,$20
                                        
   1693 8103 20 D7 87                             jsr dpyhexw           ;convert & display
   1694 8106 20 15 88                             jsr printspc          ;more spacing
   1695 8109 C2 20                    +            .byte $c2,$20
                                        
   1696 810B A5 84                                lda reg_ssx           ;get SS &...
   1697 810D E2 20                    +            .byte $e2,$20
                                        
   1698 810F 20 D7 87                             jsr dpyhexw           ;convert & display
   1699 8112 20 15 88                             jsr printspc          ;more spacing
   1700 8115 A5 9B                                lda reg_dbx           ;get DB &...
   1701 8117 20 E7 87                             jsr dpyhex            ;display it
   1702 811A 20 15 88                             jsr printspc          ;more spacing
   1703 811D C2 20                    +            .byte $c2,$20
                                        
   1704 811F A5 9C                                lda reg_dpx           ;get DPR &...
   1705 8121 E2 20                    +            .byte $e2,$20
                                        
   1706 8123 20 D7 87                             jsr dpyhexw           ;convert & display
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monce: COMMAND EXECUTIVE
                                        ;	
   1712 8126 E2 20                      monce +         .byte $e2,$20
                                        
   1713 8128 A9 00                                lda #0                ;default buffer index
                                        ;
   1715 812A E2 30                      moncea +         .byte $e2,$30
                                                        ;alternate entry point
   1716 812C 85 BF                                sta ibufidx           ;(re)set buffer index
   1717 812E F4                       +            .byte $f4
   1717 812F 56 90                    +            .word mm_prmpt
                                        
   1718 8131 20 1D 88                             jsr sprint            ;display input prompt
   1719 8134 20 3F 8C                             jsr input             ;await some input
                                        ;
   1721 8137                            .0000010:
   1722 8137 20 A1 8C                    		jsr getcharc          ;read from buffer
   1723 813A F0 EA                                beq monce             ;terminator, just loop
                                        ;
   1725 813C C9 20                                cmp #a_blank
   1726 813E F0 F7                                beq .0000010          ;strip leading blanks
                                        ;
   1728 8140 A2 0C                                ldx #n_mpctab-1       ;number of primary commands
                                        ;
   1730 8142 DD BB 8C                   .0000020 cmp mpctab,x          ;search primary command list
   1731 8145 D0 0E                                bne .0000030
                                        ;
   1733 8147 8A                                   txa                   ;get index
   1734 8148 0A                                   asl                   ;double for offset
   1735 8149 AA                                   tax
   1736 814A C2 20                    +            .byte $c2,$20
                                        
   1737 814C BD C8 8C                             lda mpcextab,x        ;command address -1
   1738 814F 48                                   pha                   ;prime the stack
   1739 8150 E2 20                    +            .byte $e2,$20
                                        
   1740 8152 4C E3 8A                             jmp getparm           ;evaluate parm & execute command
                                        ;
   1742 8155 CA                         .0000030 dex
   1743 8156 10 EA                                bpl .0000020          ;continue searching primary commands
                                        ;
   1745 8158 A2 03                                ldx #n_radix-1        ;number of radices
                                        ;
   1747 815A DD F6 8C                   .0000040 cmp radxtab,x         ;search conversion command list
   1748 815D D0 03                                bne .0000050
                                        ;
   1750 815F 4C AF 85                             jmp monenv            ;convert & display parameter
                                        ;
   1752 8162 CA                         .0000050 dex
   1753 8163 10 F5                                bpl .0000040
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monerr: COMMON ERROR HANDLER
                                        ;
   1759 8165 E2 30                      monerr +         .byte $e2,$30
                                                        ;8 bit registers
                                        ;
   1761 8167 20 BE 87                   monerraa jsr dpyerr            ;indicate an error &...
   1762 816A 80 BA                                bra monce             ;return to input loop
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monasc: ASSEMBLE CODE
                                        ;
                                        ;	———————————————————————————————————————————————————————————————————————
                                        ;	syntax: A <addr> <mnemonic> [<argument>]
                                        ;
                                        ;	After a line of code has been successfully assembled it will be disass-
                                        ;	embled & displayed,  & the monitor will prompt with the next address to
                                        ;	which code may be assembled.
                                        ;	———————————————————————————————————————————————————————————————————————
                                        ;
   1776 816C 90 03                      monasc   bcc .0000020          ;assembly address entered
                                        ;
   1778 816E 4C 65 81                   .0000010 jmp monerr            ;terminate w/error
                                        ;
                                        ;
                                        ;	evaluate assembly address...
                                        ;
   1783 8171 20 CF 8A                   .0000020 jsr facasize          ;check address...
   1784 8174 C9 04                                cmp #s_dword          ;range
   1785 8176 B0 F6                                bcs .0000010          ;out of range — error
                                        ;
   1787 8178 20 B1 8A                             jsr facaddra          ;store assembly address
                                        ;
                                        ;
                                        ;	initialize workspace...
                                        ;
   1792 817B A2 1F                                ldx #s_auxbuf-s_byte
                                        ;
   1794 817D 9E 51 02                   .0000030 stz auxbuf,x          ;clear addressing mode buffer
   1795 8180 CA                                   dex
   1796 8181 D0 FA                                bne .0000030
                                        ;
   1798 8183 A9 20                                lda #a_blank
   1799 8185 8D 51 02                             sta auxbuf            ;preamble placeholder
   1800 8188 20 1E 8A                             jsr clroper           ;clear operand
   1801 818B 64 BE                                stz auxbufix          ;reset addressing mode index
   1802 818D 64 CE                                stz flimflag          ;clear forced long immediate
   1803 818F 64 C8                                stz mnepck            ;clear encoded...
   1804 8191 64 C9                                stz mnepck+s_byte     ;mnemonic workspace
   1805 8193 64 D1                                stz vopsflag          ;clear 8/16 or relative flag
                                        ;
                                        ;
                                        ;	encode mnemonic...
                                        ;
   1810 8195 A0 03                                ldy #s_mnemon         ;expected mnemonic size
                                        ;
   1812 8197 20 30 8C                   .0000040 jsr getcharw          ;get from buffer wo/whitespace
   1813 819A D0 0A                                bne .0000060          ;gotten
                                        ;
   1815 819C C0 03                                cpy #s_mnemon         ;any input at all?
   1816 819E 90 03                                bcc .0000050          ;yes
                                        ;
   1818 81A0 4C 26 81                             jmp monce             ;no, abort further assembly
                                        ;
   1820 81A3 4C 45 83                   .0000050 jmp monasc10          ;incomplete mnemonic — error
                                        ;
   1822 81A6 38                         .0000060 sec
   1823 81A7 E9 3F                                sbc #a_mnecvt         ;ASCII to binary factor
   1824 81A9 A2 05                                ldx #n_shfenc         ;shifts required to encode
                                        ;
   1826 81AB 4A                         .0000070 lsr                   ;shift out a bit...
   1827 81AC 66 C9                                ror mnepck+s_byte     ;into...
   1828 81AE 66 C8                                ror mnepck            ;encoded mnemonic
   1829 81B0 CA                                   dex
   1830 81B1 D0 F8                                bne .0000070          ;next bit
                                        ;
   1832 81B3 88                                   dey
   1833 81B4 D0 E1                                bne .0000040          ;get next char
                                        ;
                                        ;
                                        ;	test for copy instruction...
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	The MVN & MVP instructions accept two operands & hence have an irregular
                                        ;	syntax.  Therefore, special handling is necessary to assemble either of
                                        ;	these instructions.
                                        ;
                                        ;	The official WDC syntax has the programmer entering a pair of 24 bit ad-
                                        ;	dresses as operands, with the assembler isolating bits 16-23 to	use as
                                        ;	operands.  This formality has been dispensed with in this monitor & the
                                        ;	operands are expected to be 8 bit bank values.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1848 81B6 C2 20                    +            .byte $c2,$20
                                                         ;16 bit load
   1849 81B8 A5 C8                                lda mnepck            ;packed menmonic
   1850 81BA A2 54                                ldx #opc_mvn          ;MVN opcode
   1851 81BC C9 DC                    +            cmp #<mne_mvn
   1851 81BE 7D                       +            .byte >mne_mvn
                                        ;is it MVN?
   1852 81BF F0 07                                beq monasc01          ;yes
                                        ;
   1854 81C1 A2 44                                ldx #opc_mvp          ;MVP opcode
   1855 81C3 C9 DC                    +            cmp #<mne_mvp
   1855 81C5 8D                       +            .byte >mne_mvp
                                        ;is it MVP?
   1856 81C6 D0 30                                bne monasc02          ;no
                                        ;
                                        ;
                                        ;	assemble copy instruction...
                                        ;
   1861 81C8 86 CA                      monasc01 stx opcode            ;store relevant opcode
   1862 81CA E2 20                    +            .byte $e2,$20
                                        
   1863 81CC 20 3F 8B                             jsr instdata          ;get instruction data
   1864 81CF 86 CD                                stx eopsize           ;effective operand size
   1865 81D1 E8                                   inx
   1866 81D2 86 C6                                stx instsize          ;instruction size
   1867 81D4 A2 01                                ldx #s_oper-s_word    ;operand index
   1868 81D6 86 CC                                stx xrtemp            ;set it
                                        ;
   1870 81D8 20 38 88                   .0000010 jsr ascbin            ;evaluate bank number
   1871 81DB B0 50                                bcs monasc04          ;conversion error
                                        ;
   1873 81DD F0 4E                                beq monasc04          ;nothing returned — error
                                        ;
   1875 81DF 20 CF 8A                             jsr facasize          ;bank must be...
   1876 81E2 C9 02                                cmp #s_word           ;8 bits
   1877 81E4 B0 47                                bcs monasc04          ;it isn't — error
                                        ;
   1879 81E6 A5 A7                                lda faca              ;bank
   1880 81E8 A6 CC                                ldx xrtemp            ;operand index
   1881 81EA 95 BB                                sta operand,x         ;store
   1882 81EC C6 CC                                dec xrtemp            ;index=index-1
   1883 81EE 10 E8                                bpl .0000010          ;get destination bank
                                        ;
   1885 81F0 20 D0 8B                             jsr getcharr          ;should be no more input
   1886 81F3 D0 38                                bne monasc04          ;there is — error
                                        ;
   1888 81F5 4C F3 82                             jmp monasc08          ;finish MVN/MVP assembly 
                                        ;
                                        ;
                                        ;	continue with normal assembly...
                                        ;
   1893 81F8 E2 20                      monasc02 +         .byte $e2,$20
                                                        ;back to 8 bits
                                        ;
   1895 81FA 20 30 8C                   monasc03 jsr getcharw          ;get next char
   1896 81FD F0 3D                                beq monasc06          ;EOI, no argument
                                        ;
   1898 81FF C9 21                                cmp #amp_flim
   1899 8201 D0 0A                                bne .0000010          ;no forced long immediate
                                        ;
   1901 8203 A5 CE                                lda flimflag          ;FLIM already set?
   1902 8205 D0 26                                bne monasc04          ;yes — error
                                        ;
   1904 8207 A9 C0                                lda #flimmask
   1905 8209 85 CE                                sta flimflag          ;set flag &...
   1906 820B 80 ED                                bra monasc03          ;get next char
                                        ;
   1908 820D C9 23                      .0000010 cmp #amp_imm          ;immediate mode?
   1909 820F F0 08                                beq .0000020          ;yes
                                        ;
   1911 8211 C9 28                                cmp #amp_ind          ;indirect mode?
   1912 8213 F0 04                                beq .0000020          ;yes
                                        ;
   1914 8215 C9 5B                                cmp #amp_indl         ;indirect long mode?
   1915 8217 D0 07                                bne .0000030          ;no
                                        ;
   1917 8219 8D 51 02                   .0000020 sta auxbuf            ;set addressing mode preamble
   1918 821C E6 BE                                inc auxbufix          ;bump aux buffer index &...
   1919 821E 80 02                                bra .0000040          ;evaluate operand
                                        ;
   1921 8220 C6 BF                      .0000030 dec ibufidx           ;position back to char
                                        ;
   1923 8222 20 38 88                   .0000040 jsr ascbin            ;evaluate operand
   1924 8225 D0 09                                bne monasc05          ;evaluated
                                        ;
   1926 8227 B0 04                                bcs monasc04          ;conversion error
                                        ;
   1928 8229 A5 BE                                lda auxbufix          ;no operand...any preamble?
   1929 822B F0 0F                                beq monasc06          ;no, syntax is okay so far
                                        ;
   1931 822D 4C 45 83                   monasc04 jmp monasc10          ;abort w/error
                                        ;
   1933 8230 20 CF 8A                   monasc05 jsr facasize          ;size operand
   1934 8233 C9 04                                cmp #s_dword          ;max is 24 bits
   1935 8235 B0 F6                                bcs monasc04          ;too big
                                        ;
   1937 8237 85 CD                                sta eopsize           ;save operand size
   1938 8239 20 C5 8A                             jsr facaoper          ;store operand
                                        ;
   1940 823C C6 BF                      monasc06 dec ibufidx           ;back to last char
   1941 823E A6 BE                                ldx auxbufix          ;mode buffer index
   1942 8240 D0 01                                bne .0000010          ;preamble in buffer
                                        ;
   1944 8242 E8                                   inx                   ;step past preamble position
                                        ;
   1946 8243 20 A1 8C                   .0000010 jsr getcharc          ;get a char w/forced UC
   1947 8246 F0 0A                                beq .0000030          ;EOI
                                        ;
   1949 8248 E0 20                                cpx #s_auxbuf         ;mode buffer full?
   1950 824A B0 E1                                bcs monasc04          ;yes, too much input
                                        ;
   1952 824C 9D 51 02                   .0000020 sta auxbuf,x          ;store for comparison
   1953 824F E8                                   inx
   1954 8250 D0 F1                                bne .0000010
                                        ;
                                        ;
                                        ;	evaluate mnemonic...
                                        ;
   1959 8252 A2 5B                      .0000030 ldx #n_mnemon-1       ;starting mnemonic index
                                        ;
   1961 8254 8A                         monasc07 txa                   ;convert index...
   1962 8255 0A                                   asl                   ;to offset
   1963 8256 A8                                   tay                   ;now mnemonic table index
   1964 8257 C2 20                    +            .byte $c2,$20
                                                         ;16 bit compare
   1965 8259 B9 03 8D                             lda mnetab,y          ;get mnemonic from table
   1966 825C C5 C8                                cmp mnepck            ;compare to entered mnemonic
   1967 825E E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   1968 8260 F0 05                                beq .0000020          ;match
                                        ;
   1970 8262 CA                         .0000010 dex                   ;try next mnemonic
   1971 8263 30 C8                                bmi monasc04          ;unknown mnemonic — error
                                        ;
   1973 8265 80 ED                                bra monasc07          ;keep going
                                        ;
   1975 8267 86 C8                      .0000020 stx mnepck            ;save mnemonic index
   1976 8269 8A                                   txa
   1977 826A A2 00                                ldx #0                ;trial opcode
                                        ;
   1979 826C DD BB 8D                   .0000030 cmp mnetabix,x        ;search index table...
   1980 826F F0 05                                beq .0000050          ;for a match
                                        ;
   1982 8271 E8                         .0000040 inx                   ;keep going until we...
   1983 8272 D0 F8                                bne .0000030          ;search entire table
                                        ;
   1985 8274 80 B7                                bra monasc04          ;this shouldn't happen!
                                        ;
                                        ;	—————————————————————————————————————————————————————————————————————
                                        ;	If the mnemonic index table search fails then there is a coding error
                                        ;	somewhere, as every entry in the mnemonic table is supposed to have a
                                        ;	matching cardinal index.
                                        ;	—————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	evaluate addressing mode...
                                        ;
   1996 8276 86 CA                      .0000050 stx opcode            ;save trial opcode
   1997 8278 20 3F 8B                             jsr instdata          ;get related instruction data
   1998 827B 85 D1                                sta vopsflag          ;save 8/16 or relative flag
   1999 827D 86 CF                                stx iopsize           ;operand size
   2000 827F E8                                   inx
   2001 8280 86 C6                                stx instsize          ;instruction size
   2002 8282 A6 CA                                ldx opcode            ;recover trial opcode
   2003 8284 98                                   tya                   ;addressing mode
   2004 8285 0A                                   asl                   ;create table index
   2005 8286 A8                                   tay
   2006 8287 C2 20                    +            .byte $c2,$20
                                        
   2007 8289 B9 BF 8F                             lda ms_lutab,y        ;mode lookup table
   2008 828C 85 A4                                sta addrb             ;set pointer
   2009 828E E2 20                    +            .byte $e2,$20
                                        
   2010 8290 A0 00                                ldy #0
                                        ;
   2012 8292 B1 A4                      .0000060 lda (addrb),y         ;table addressing mode
   2013 8294 D9 51 02                             cmp auxbuf,y          ;entered addressing mode
   2014 8297 F0 04                                beq .0000080          ;okay so far
                                        ;
   2016 8299 A5 C8                      .0000070 lda mnepck            ;reload mnemonic index        
   2017 829B 80 D4                                bra .0000040          ;wrong opcode for addresing mode
                                        ;
   2019 829D 09 00                      .0000080 ora #0                ;last char the terminator?
   2020 829F F0 03                                beq .0000090          ;yes, evaluate operand
                                        ;
   2022 82A1 C8                                   iny
   2023 82A2 80 EE                                bra .0000060          ;keep testing
                                        ;
                                        ;
                                        ;	evaluate operand...
                                        ;
   2028 82A4 A5 CD                      .0000090 lda eopsize           ;entered operand size
   2029 82A6 D0 06                                bne .0000100          ;non-zero
                                        ;
   2031 82A8 05 CF                                ora iopsize           ;instruction operand size
   2032 82AA D0 ED                                bne .0000070          ;wrong opcode — keep trying
                                        ;
   2034 82AC 80 45                                bra monasc08          ;assemble instruction
                                        ;
   2036 82AE 24 D1                      .0000100 bit vopsflag          ;is this a branch?
   2037 82B0 70 3A                                bvs .0000160          ;yes, evaluate
                                        ;
   2039 82B2 A5 CF                                lda iopsize           ;instruction operand size
   2040 82B4 24 D1                                bit vopsflag          ;variable size operand allowed?
   2041 82B6 30 15                                bmi .0000130          ;yes
                                        ;
   2043 82B8 24 CE                                bit flimflag          ;was forced immediate set?
   2044 82BA 10 03                                bpl .0000110          ;no
                                        ;         
   2046 82BC 4C 45 83                             jmp monasc10          ;yes — error
                                        ;
   2048 82BF C5 CD                      .0000110 cmp eopsize           ;entered operand size
   2049 82C1 90 D6                                bcc .0000070          ;operand too big
                                        ;
   2051 82C3 85 CD                                sta eopsize           ;new operand size
   2052 82C5 80 2C                                bra monasc08          ;assemble, otherwise...
                                        ;
   2054 82C7 C5 CD                      .0000120 cmp eopsize           ;exact size match required
   2055 82C9 D0 CE                                bne .0000070          ;mismatch — wrong opcode
                                        ;
   2057 82CB 80 26                                bra monasc08          ;assemble
                                        ;
                                        ;
                                        ;	process variable size immediate mode operand...
                                        ;
   2062 82CD A6 CD                      .0000130 ldx eopsize           ;entered operand size
   2063 82CF E0 03                                cpx #s_xword          ;check size
   2064 82D1 B0 72                                bcs monasc10          ;too big — error
                                        ;
   2066 82D3 24 CE                                bit flimflag          ;forced long immediate?
   2067 82D5 10 06                                bpl .0000140          ;no
                                        ;
   2069 82D7 A2 02                                ldx #s_word           ;promote operand size to...
   2070 82D9 86 CD                                stx eopsize           ;16 bits
   2071 82DB 80 08                                bra .0000150
                                        ;
   2073 82DD E0 02                      .0000140 cpx #s_word           ;16 bits?
   2074 82DF D0 04                                bne .0000150          ;no
                                        ;
   2076 82E1 A0 C0                                ldy #flimmask         ;yes so force long...
   2077 82E3 84 CE                                sty flimflag          ;immediate disassembly
                                        ;
   2079 82E5 1A                         .0000150 ina                   ;new instruction operand size
   2080 82E6 C5 CD                                cmp eopsize           ;compare against operand size
   2081 82E8 90 AF                                bcc .0000070          ;mismatch — can't assemble
                                        ;
   2083 82EA 80 07                                bra monasc08          ;okay, assemble
                                        ;
                                        ;
                                        ;	process relative branch...
                                        ;
   2088 82EC 20 8B 8B                   .0000160 jsr targoff           ;compute branch offset
   2089 82EF B0 54                                bcs monasc10          ;branch out of range
                                        ;
   2091 82F1 85 CD                                sta eopsize           ;effective operand size
                                        ;
                                        ;
                                        ;	assemble instruction...
                                        ;
   2096 82F3 A5 CA                      monasc08 lda opcode            ;opcode
   2097 82F5 87 A0                    +            .byte $87,addra
                                        ;store at assembly address
   2098 82F7 A6 CD                                ldx eopsize           ;any operand to process?
   2099 82F9 F0 09                                beq .0000020          ;no
                                        ;
   2101 82FB 9B                       +            .byte $9b
                                                           ;also storage offset
                                        ;
   2103 82FC CA                         .0000010 dex
   2104 82FD B5 BB                                lda operand,x         ;get operand byte &...
   2105 82FF 97 A0                    +            .byte $97,addra
                                        ;poke into memory
   2106 8301 88                                   dey
   2107 8302 D0 F8                                bne .0000010          ;next
                                        ;
   2109 8304 A9 0D                      .0000020 lda #a_cr
                                           		 cpu FT832
   2111 008306 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2113 830B A9 41                                lda #asmprfx          ;assembly prefix
   2114 830D 20 5B 86                             jsr dpycodaa          ;disassemble & display
                                        ;
                                        ;
                                        ;	prompt for next instruction...
                                        ;
   2119 8310 A9 20                      monasc09 lda #a_blank
   2120 8312 A2 08                                ldx #ascprmct-1
                                        ;
   2122 8314 9D 00 02                   .0000010 sta ibuffer,x         ;prepare buffer for...
   2123 8317 CA                                   dex                   ;next instruction
   2124 8318 10 FA                                bpl .0000010
                                        ;
   2126 831A A9 41                                lda #asmprfx          ;assemble code...
   2127 831C 8D 00 02                             sta ibuffer           ;prompt prefix
   2128 831F A5 A2                                lda addra+s_word      ;next instruction address bank
   2129 8321 20 8A 89                             jsr binhex            ;convert to ASCII
   2130 8324 8D 02 02                             sta ibuffer+apadrbkh  ;store MSN in buffer
   2131 8327 8E 03 02                             stx ibuffer+apadrbkl  ;store LSN in buffer
   2132 832A A5 A1                                lda addra+s_byte      ;next instruction address MSB
   2133 832C 20 8A 89                             jsr binhex
   2134 832F 8D 04 02                             sta ibuffer+apadrmbh
   2135 8332 8E 05 02                             stx ibuffer+apadrmbl
   2136 8335 A5 A0                                lda addra             ;next instruction address LSB
   2137 8337 20 8A 89                             jsr binhex
   2138 833A 8D 06 02                             sta ibuffer+apadrlbh
   2139 833D 8E 07 02                             stx ibuffer+apadrlbl
   2140 8340 A9 09                                lda #ascprmct         ;effective input count
   2141 8342 4C 2A 81                             jmp moncea            ;reenter input loop
                                        ;
                                        ;
                                        ;	process assembly error...
                                        ;
   2146 8345 20 BE 87                   monasc10 jsr dpyerr            ;indicate error &...
   2147 8348 80 C6                                bra monasc09          ;prompt w/same assembly address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mondsc: DISASSEMBLE CODE
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: D [<addr1> [<addr2>]]
                                        ;	—————————————————————————————
                                        ;
   2157 834A B0 11                      mondsc   bcs .0000010          ;no parameters
                                        ;
   2159 834C 64 CE                                stz flimflag          ;reset to 8 bit mode
   2160 834E 20 CF 8A                             jsr facasize          ;check starting...
   2161 8351 C9 04                                cmp #s_dword          ;address
   2162 8353 B0 46                                bcs .0000050          ;out of range — error
                                        ;
   2164 8355 20 B1 8A                             jsr facaddra          ;copy starting address
   2165 8358 20 E3 8A                             jsr getparm           ;get ending address
   2166 835B 90 17                                bcc .0000020          ;gotten
                                        ;
   2168 835D 20 9D 89                   .0000010 jsr clrfaca           ;clear accumulator
   2169 8360 C2 20                    +            .byte $c2,$20
                                        
   2170 8362 18                                   clc
   2171 8363 A5 A0                                lda addra             ;starting address
   2172 8365 69 15                    +            adc #<n_dbytes
   2172 8367 00                       +            .byte >n_dbytes
                                        ;default bytes
   2173 8368 85 A7                                sta faca              ;effective ending address
   2174 836A E2 20                    +            .byte $e2,$20
                                        
   2175 836C A5 A2                                lda addra+s_word      ;starting bank
   2176 836E 69 00                                adc #0
   2177 8370 85 A9                                sta faca+s_word       ;effective ending bank
   2178 8372 B0 27                                bcs .0000050          ;end address > $FFFFFF
                                        ;
   2180 8374 20 CF 8A                   .0000020 jsr facasize          ;check ending...
   2181 8377 C9 04                                cmp #s_dword          ;address
   2182 8379 B0 20                                bcs .0000050          ;out of range — error
                                        ;
   2184 837B 20 BB 8A                             jsr facaddrb          ;set ending address
   2185 837E 20 E3 8A                             jsr getparm           ;check for excess input
   2186 8381 90 18                                bcc .0000050          ;present — error
                                        ;
   2188 8383 20 09 8A                             jsr calccnt           ;calculate bytes
   2189 8386 90 13                                bcc .0000050          ;end < start
                                        ;
   2191 8388 20 B3 8C                   .0000030 jsr teststop          ;test for display stop
   2192 838B B0 0B                                bcs .0000040          ;stopped
                                        ;
   2194 838D 20 05 88                             jsr newline           ;next line
   2195 8390 20 59 86                             jsr dpycod            ;disassemble & display
   2196 8393 20 67 8A                             jsr decdcnt           ;decrement byte count
   2197 8396 90 F0                                bcc .0000030          ;not done
                                        ;
   2199 8398 4C 26 81                   .0000040 jmp monce             ;back to main loop
                                        ;
   2201 839B 4C 65 81                   .0000050 jmp monerr            ;address range error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monjmp: EXECUTE CODE
                                        ;
                                        ;	—————————————————————————————————————————————————————————————
                                        ;	syntax: G [<addr>]
                                        ;
                                        ;	If no address is specified, the current values in the PB & PC
                                        ;	shadow registers are used.
                                        ;	—————————————————————————————————————————————————————————————
                                        ;
   2214 839E 20 74 8B                   monjmp   jsr setxaddr          ;set execution address
   2215 83A1 B0 29                                bcs monjmpab          ;out of range — error
                                        ;
   2217 83A3 20 E3 8A                             jsr getparm           ;check for excess input
   2218 83A6 90 24                                bcc monjmpab          ;too much input — error
                                        ;
   2220 83A8 C2 20                    +            .byte $c2,$20
                                                         ;16 bit .A
   2221 83AA A5 95                                lda reg_spx
   2222 83AC 1B                       +            .byte $1b
                                                           ;restore SP
                                        ;
   2224 83AD E2 20                      monjmpaa +         .byte $e2,$20
                                        
   2225 83AF A5 88                                lda reg_pbx
   2226 83B1 48                                   pha                   ;restore PB
   2227 83B2 C2 20                    +            .byte $c2,$20
                                        
   2228 83B4 A5 86                                lda reg_pcx
   2229 83B6 48                                   pha                   ;restore PC
   2230 83B7 E2 20                    +            .byte $e2,$20
                                        
   2231 83B9 A5 99                                lda reg_srx
   2232 83BB 48                                   pha                   ;restore SR
   2233 83BC A5 9B                                lda reg_dbx
   2234 83BE 48                                   pha
   2235 83BF AB                       +            .byte $ab
                                                           ;restore DB
   2236 83C0 C2 30                    +            .byte $c2,$30
                                        
   2237 83C2 A5 9C                                lda reg_dpx
   2238 83C4 5B                       +            .byte $5b
                                                           ;restore DP
   2239 83C5 A5 89                                lda reg_ax            ;restore .C
   2240 83C7 A6 8D                                ldx reg_xx            ;restore .X
   2241 83C9 A4 91                                ldy reg_yx            ;restore .Y
   2242 83CB 40                                   rti                   ;execute code
                                        ;
   2244 83CC 4C 65 81                   monjmpab jmp monerr            ;error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monjsr: EXECUTE CODE AS SUBROUTINE
                                        ;
                                        ;	————————————————————————————————————————————————————————————
                                        ;	syntax: J [<addr>]
                                        ;
                                        ;	If no address is specified the current values in the PB & PC
                                        ;	shadow registers are used.   An RTS at the end of the called
                                        ;	subroutine will return control to the monitor  provided  the
                                        ;	stack remains in balance.
                                        ;	————————————————————————————————————————————————————————————
                                        ;
   2259 83CF 20 74 8B                   monjsr   jsr setxaddr          ;set execution address
   2260 83D2 B0 F8                                bcs monjmpab          ;out of range — error
                                        ;
   2262 83D4 20 E3 8A                             jsr getparm           ;check for excess input
   2263 83D7 90 F3                                bcc monjmpab          ;too much input — error
                                        ;
   2265 83D9 C2 20                    +            .byte $c2,$20
                                        
   2266 83DB A5 95                                lda reg_spx
   2267 83DD 1B                       +            .byte $1b
                                                           ;restore SP &...
   2268 83DE 20 AD 83                             jsr monjmpaa          ;call subroutine
   2269 83E1 08                                   php                   ;push SR
   2270 83E2 C2 30                    +            .byte $c2,$30
                                        
   2271 83E4 85 89                                sta reg_ax            ;save...
   2272 83E6 86 8D                                stx reg_xx            ;register...
   2273 83E8 84 91                                sty reg_yx            ;returns
   2274 83EA E2 10                    +            .byte $e2,$10
                                                        ;8 bit .X & .Y
   2275 83EC FA                                   plx                   ;get & save...
   2276 83ED 86 99                                stx reg_srx           ;return SR
   2277 83EF 3B                       +            .byte $3b
                                                           ;get & save...
   2278 83F0 85 95                                sta reg_spx           ;return SP
   2279 83F2 7B                       +            .byte $7b
                                                           ;get & save...
   2280 83F3 85 9C                                sta reg_dpx           ;DP pointer
   2281 83F5 E2 20                    +            .byte $e2,$20
                                                        ;8 bit .A
   2282 83F7 4B                       +            .byte $4b
                                                           ;get &...
   2283 83F8 68                                   pla                   ;save...
   2284 83F9 85 88                                sta reg_pbx           ;return PB
   2285 83FB 8B                       +            .byte $8b
                                                           ;get &...
   2286 83FC 68                                   pla                   ;save...
   2287 83FD 85 9B                                sta reg_dbx           ;return DB
   2288 83FF F4                       +            .byte $f4
   2288 8400 D4 90                    +            .word mm_rts
                                        ;"*RET"
   2289 8402 4C 72 80                             jmp moncom            ;return to monitor
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monchm: CHANGE and/or DUMP MEMORY
                                        ;
                                        ;	————————————————————————————————————————————
                                        ;	syntax: > [<addr> <operand> [<operand>]...]
                                        ;
                                        ;	> <addr> without operands will dump 16 bytes
                                        ;	of memory, starting at <addr>.
                                        ;	————————————————————————————————————————————
                                        ;
   2302 8405 B0 23                      monchm   bcs .0000030          ;no address given — quit
                                        ;
   2304 8407 20 CF 8A                             jsr facasize          ;size address
   2305 840A C9 04                                cmp #s_dword
   2306 840C B0 1F                                bcs .0000040          ;address out of range — error
                                        ;
   2308 840E 20 B1 8A                             jsr facaddra          ;set starting address
   2309 8411 20 E4 8B                             jsr getpat            ;evaluate change pattern
   2310 8414 90 04                                bcc .0000010          ;entered
                                        ;
   2312 8416 10 0C                                bpl .0000020          ;not entered
                                        ;
   2314 8418 80 13                                bra .0000040          ;evaluation error
                                        ;
   2316 841A 88                         .0000010 dey                   ;next byte
   2317 841B 30 07                                bmi .0000020          ;done
                                        ;
   2319 841D B9 51 02                             lda auxbuf,y          ;write pattern...
   2320 8420 97 A0                    +            .byte $97,addra
                                        ;to memory
   2321 8422 80 F6                                bra .0000010          ;next
                                        ;
   2323 8424 20 05 88                   .0000020 jsr newline           ;next line
   2324 8427 20 77 87                             jsr dpymem            ;regurgitate changes
                                        ;
   2326 842A 4C 26 81                   .0000030 jmp monce             ;back to command loop
                                        ;
   2328 842D 4C 65 81                   .0000040 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncmp: COMPARE MEMORY
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: C <start> <end> <ref>
                                        ;	—————————————————————————————
                                        ;
   2338 8430 B0 26                      moncmp   bcs .0000030          ;start not given — quit
                                        ;
   2340 8432 20 8B 8A                             jsr enddest           ;get end & reference addresses
   2341 8435 B0 24                                bcs .0000040          ;range or other error
                                        ;
   2343 8437 64 CC                                stz xrtemp            ;column counter
                                        ;
   2345 8439 20 B3 8C                   .0000010 jsr teststop          ;check for stop
   2346 843C B0 1A                                bcs .0000030          ;abort
                                        ;
   2348 843E A7 A0                    +            .byte $a7,addra
                                        ;get from reference location
   2349 8440 C7 BB                    +            .byte $c7,operand
                                        ;test against compare location
   2350 8442 F0 03                                beq .0000020          ;match, don't display address
                                        ;
   2352 8444 20 3F 86                             jsr dpycaddr          ;display current location
                                        ;
   2354 8447 20 0B 8B                   .0000020 jsr nxtaddra          ;next reference location
   2355 844A B0 0C                                bcs .0000030          ;done
                                        ;
   2357 844C C2 20                    +            .byte $c2,$20
                                        
   2358 844E E6 BB                                inc operand           ;bump bits 0-15
   2359 8450 E2 20                    +            .byte $e2,$20
                                        
   2360 8452 D0 E5                                bne .0000010
                                        ;
   2362 8454 E6 BD                                inc operand+s_word    ;bump bits 16-23
   2363 8456 80 E1                                bra .0000010
                                        ;
   2365 8458 4C 26 81                   .0000030 jmp monce             ;return to command exec
                                        ;
   2367 845B 4C 65 81                   .0000040 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncpy: COPY (transfer) MEMORY
                                        ;
                                        ;	————————————————————————————————
                                        ;	syntax: T <start> <end> <target>
                                        ;	————————————————————————————————
                                        ;
   2377 845E B0 49                      moncpy   bcs .0000040          ;start not given — quit
                                        ;
   2379 8460 20 8B 8A                             jsr enddest           ;get end & target addresses
   2380 8463 B0 47                                bcs .0000050          ;range or other error
                                        ;
   2382 8465 C2 20                    +            .byte $c2,$20
                                        
   2383 8467 38                                   sec
   2384 8468 A5 A4                                lda addrb             ;ending address
   2385 846A E5 A0                                sbc addra             ;starting address
   2386 846C 90 3E                                bcc .0000050          ;start > end — error
                                        ;
   2388 846E 85 AF                                sta facb              ;bytes to copy
   2389 8470 E2 20                    +            .byte $e2,$20
                                        
   2390 8472 C2 10                    +            .byte $c2,$10
                                        
   2391 8474 A5 BD                                lda operand+s_word    ;target bank
   2392 8476 A4 BB                                ldy operand           ;target address
   2393 8478 C5 A2                                cmp addra+s_word      ;source bank
   2394 847A C2 20                    +            .byte $c2,$20
                                        
   2395 847C D0 1C                                bne .0000020          ;can use forward copy
                                        ;
   2397 847E C4 A0                                cpy addra             ;source address
   2398 8480 90 18                                bcc .0000020          ;can use forward copy
                                        ;
   2400 8482 D0 02                                bne .0000010          ;must use reverse copy
                                        ;
   2402 8484 80 26                                bra .0000050          ;copy in place — error
                                        ;
   2404 8486 A5 AF                      .0000010 lda facb              ;get bytes to copy
   2405 8488 48                                   pha                   ;protect
   2406 8489 20 99 8C                             jsr lodbnk            ;load banks
   2407 848C 20 31 8A                             jsr cprvsup           ;do reverse copy setup
   2408 848F 68                                   pla                   ;get bytes to copy
   2409 8490 AA                                   tax                   ;save a copy
   2410 8491 18                                   clc
   2411 8492 65 BB                                adc operand           ;change target to...
   2412 8494 A8                                   tay                   ;target end
   2413 8495 8A                                   txa                   ;recover bytes to copy
   2414 8496 A6 A4                                ldx addrb             ;source end
   2415 8498 80 0C                                bra .0000030
                                        ;
   2417 849A A5 AF                      .0000020 lda facb              ;get bytes to copy
   2418 849C 48                                   pha                   ;protect
   2419 849D 20 99 8C                             jsr lodbnk            ;load banks
   2420 84A0 20 2A 8A                             jsr cpfwsup           ;do forward copy setup
   2421 84A3 68                                   pla                   ;get bytes to copy
   2422 84A4 A6 A0                                ldx addra             ;source start
                                        ;
   2424 84A6 4C D2 00                   .0000030 jmp mcftwork          ;copy memory
                                        ;
   2426 84A9 4C 26 81                   .0000040 jmp monce             ;back to executive
                                        ;
   2428 84AC 4C 65 81                   .0000050 jmp monerr            ;error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mondmp: DISPLAY MEMORY RANGE
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: M [<addr1> [<addr2>]]
                                        ;	—————————————————————————————
                                        ;
   2438 84AF B0 0F                      mondmp   bcs .0000010          ;no parameters
                                        ;
   2440 84B1 20 CF 8A                             jsr facasize          ;check address...
   2441 84B4 C9 04                                cmp #s_dword          ;range
   2442 84B6 B0 46                                bcs .0000050          ;address out of range
                                        ;
   2444 84B8 20 B1 8A                             jsr facaddra          ;copy starting address
   2445 84BB 20 E3 8A                             jsr getparm           ;get ending address
   2446 84BE 90 17                                bcc .0000020          ;gotten
                                        ;
   2448 84C0 20 9D 89                   .0000010 jsr clrfaca           ;clear accumulator
   2449 84C3 C2 20                    +            .byte $c2,$20
                                        
   2450 84C5 18                                   clc
   2451 84C6 A5 A0                                lda addra             ;starting address
   2452 84C8 69 FF                    +            adc #<n_mbytes
   2452 84CA 00                       +            .byte >n_mbytes
                                        ;default bytes
   2453 84CB 85 A7                                sta faca              ;effective ending address
   2454 84CD E2 20                    +            .byte $e2,$20
                                        
   2455 84CF A5 A2                                lda addra+s_word      ;starting bank
   2456 84D1 69 00                                adc #0
   2457 84D3 85 A9                                sta faca+s_word       ;effective ending bank
   2458 84D5 B0 27                                bcs .0000050          ;end address > $FFFFFF
                                        ;
   2460 84D7 20 CF 8A                   .0000020 jsr facasize          ;check ending address...
   2461 84DA C9 04                                cmp #s_dword          ;range
   2462 84DC B0 20                                bcs .0000050          ;out of range — error
                                        ;
   2464 84DE 20 BB 8A                             jsr facaddrb          ;copy ending address
   2465 84E1 20 E3 8A                             jsr getparm           ;check for excess input
   2466 84E4 90 18                                bcc .0000050          ;error
                                        ;
   2468 84E6 20 09 8A                             jsr calccnt           ;calculate bytes to dump
   2469 84E9 90 13                                bcc .0000050          ;end < start
                                        ;
   2471 84EB 20 B3 8C                   .0000030 jsr teststop          ;test for display stop
   2472 84EE B0 0B                                bcs .0000040          ;stopped
                                        ;
   2474 84F0 20 05 88                             jsr newline           ;next line
   2475 84F3 20 77 87                             jsr dpymem            ;display
   2476 84F6 20 67 8A                             jsr decdcnt           ;decrement byte count
   2477 84F9 90 F0                                bcc .0000030          ;not done
                                        ;
   2479 84FB 4C 26 81                   .0000040 jmp monce             ;back to main loop
                                        ;
   2481 84FE 4C 65 81                   .0000050 jmp monerr            ;address range error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monfil: FILL MEMORY
                                        ;
                                        ;	—————————————————————————————————————————
                                        ;	syntax: F <start> <end> <fill>
                                        ;
                                        ;	<start> & <end> must be in the same bank.
                                        ;	—————————————————————————————————————————
                                        ;
   2493 8501 B0 5E                      monfil   bcs .0000010          ;start not given — quit
                                        ;
   2495 8503 20 CF 8A                             jsr facasize          ;check size
   2496 8506 C9 04                                cmp #s_dword
   2497 8508 B0 5A                                bcs .0000020          ;out of range — error...
                                        ;
   2499 850A 20 B1 8A                             jsr facaddra          ;store start
   2500 850D 20 E3 8A                             jsr getparm           ;evaluate end
   2501 8510 B0 52                                bcs .0000020          ;not entered — error
                                        ;
   2503 8512 20 CF 8A                             jsr facasize          ;check size
   2504 8515 C9 04                                cmp #s_dword
   2505 8517 B0 4B                                bcs .0000020          ;out of range — error
                                        ;
   2507 8519 A5 A9                                lda faca+s_word       ;end bank
   2508 851B C5 A2                                cmp addra+s_word      ;start bank
   2509 851D D0 45                                bne .0000020          ;not same — error
                                        ;
   2511 851F 20 BB 8A                             jsr facaddrb          ;store <end>
   2512 8522 C2 20                    +            .byte $c2,$20
                                        
   2513 8524 38                                   sec
   2514 8525 A5 A4                                lda addrb             ;ending address
   2515 8527 E5 A0                                sbc addra             ;starting address
   2516 8529 90 39                                bcc .0000020          ;start > end — error
                                        ;
   2518 852B 85 AF                                sta facb              ;bytes to copy
   2519 852D E2 20                    +            .byte $e2,$20
                                        
   2520 852F 20 E3 8A                             jsr getparm           ;evaluate <fill>
   2521 8532 B0 30                                bcs .0000020          ;not entered — error
                                        ;
   2523 8534 20 CF 8A                             jsr facasize          ;<fill> should be...
   2524 8537 C9 02                                cmp #s_word           ;8 bits
   2525 8539 B0 29                                bcs .0000020          ;it isn't — error
                                        ;
   2527 853B 20 C5 8A                             jsr facaoper          ;store <fill>
   2528 853E 20 E3 8A                             jsr getparm           ;should be no more parameters
   2529 8541 90 21                                bcc .0000020          ;there are — error
                                        ;
   2531 8543 A5 BB                                lda operand           ;<fill>
   2532 8545 87 A0                    +            .byte $87,addra
                                        ;fill 1st location
   2533 8547 C2 30                    +            .byte $c2,$30
                                                         ;16 bit operations
   2534 8549 A5 AF                                lda facb              ;
   2535 854B F0 14                                beq .0000010          ;only 1 location — finished
                                        ;
   2537 854D 3A                                   dea                   ;zero align &...
   2538 854E 48                                   pha                   ;protect
   2539 854F E2 20                    +            .byte $e2,$20
                                        
   2540 8551 A5 A2                                lda addra+s_word      ;start bank
   2541 8553 EB                       +            .byte $eb
                                        
   2542 8554 A5 A6                                lda addrb+s_word      ;end bank
   2543 8556 20 2A 8A                             jsr cpfwsup           ;do forward copy setup
   2544 8559 68                                   pla                   ;recover fill count
   2545 855A A6 A0                                ldx addra             ;fill-from starting location
   2546 855C 9B                       +            .byte $9b
                                        
   2547 855D C8                                   iny                   ;fill-to starting location
   2548 855E 4C D2 00                             jmp mcftwork          ;fill memory
                                        ;
   2550 8561 4C 26 81                   .0000010 jmp monce             ;goto command executive
                                        ;
   2552 8564 4C 65 81                   .0000020 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monhnt: SEARCH (hunt) MEMORY
                                        ;
                                        ;	———————————————————————————————————
                                        ;	syntax: H <addr1> <addr2> <pattern>
                                        ;	———————————————————————————————————
                                        ;
   2562 8567 B0 40                      monhnt   bcs .0000050          ;no start address
                                        ;
   2564 8569 20 CF 8A                             jsr facasize          ;size starting address
   2565 856C C9 04                                cmp #s_dword
   2566 856E B0 3C                                bcs .0000060          ;address out of range — error
                                        ;
   2568 8570 20 B1 8A                             jsr facaddra          ;store starting address
   2569 8573 20 E3 8A                             jsr getparm           ;evaluate ending address
   2570 8576 B0 34                                bcs .0000060          ;no address — error
                                        ;
   2572 8578 20 CF 8A                             jsr facasize          ;size ending address
   2573 857B C9 04                                cmp #s_dword
   2574 857D B0 2D                                bcs .0000060          ;address out of range — error
                                        ;
   2576 857F 20 BB 8A                             jsr facaddrb          ;store ending address
   2577 8582 20 09 8A                             jsr calccnt           ;calculate byte range
   2578 8585 90 25                                bcc .0000060          ;end < start
                                        ;
   2580 8587 20 E4 8B                             jsr getpat            ;evaluate search pattern
   2581 858A B0 20                                bcs .0000060          ;error
                                        ;
   2583 858C 64 CC                                stz xrtemp            ;clear column counter
                                        ;
   2585 858E 20 B3 8C                   .0000010 jsr teststop          ;check for stop
   2586 8591 B0 16                                bcs .0000050          ;abort
                                        ;
   2588 8593 A4 BE                                ldy auxbufix          ;pattern index
                                        ;
   2590 8595 88                         .0000020 dey
   2591 8596 30 09                                bmi .0000030          ;pattern match
                                        ;
   2593 8598 B7 A0                    +            .byte $b7,addra
                                        ;get from memory
   2594 859A D9 51 02                             cmp auxbuf,y          ;test against pattern
   2595 859D D0 05                                bne .0000040          ;mismatch, next location
                                        ;
   2597 859F F0 F4                                beq .0000020          ;match, keep testing
                                        ;
   2599 85A1 20 3F 86                   .0000030 jsr dpycaddr          ;display current location
                                        ;
   2601 85A4 20 0B 8B                   .0000040 jsr nxtaddra          ;next location
   2602 85A7 90 E5                                bcc .0000010          ;not done
                                        ;
   2604 85A9 4C 26 81                   .0000050 jmp monce             ;back to executive
                                        ;
   2606 85AC 4C 65 81                   .0000060 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monenv: CONVERT NUMERIC VALUE
                                        ;
                                        ;	——————————————————————
                                        ;	syntax: <radix><value>
                                        ;	——————————————————————
                                        ;
   2616 85AF 20 E1 8A                   monenv   jsr getparmr          ;reread & evaluate parameter
   2617 85B2 B0 26                                bcs .0000020          ;none entered
                                        ;
   2619 85B4 A2 00                                ldx #0                ;radix index
   2620 85B6 A0 04                                ldy #n_radix          ;number of radices
                                        ;
   2622 85B8 5A                         .0000010 phy                   ;save counter
   2623 85B9 DA                                   phx                   ;save radix index
   2624 85BA 20 05 88                             jsr newline           ;next line &...
   2625 85BD 20 6D 87                             jsr clearlin          ;clear it
   2626 85C0 A9 20                                lda #a_blank
   2627 85C2 A2 04                                ldx #halftab
   2628 85C4 20 F6 87                             jsr multspc           ;indent 1/2 tab
   2629 85C7 FA                                   plx                   ;get radix index but...
   2630 85C8 DA                                   phx                   ;put it back
   2631 85C9 BD F6 8C                             lda radxtab,x         ;get radix
   2632 85CC 20 F6 88                             jsr binasc            ;convert to ASCII
   2633 85CF 5A                                   phy                   ;string address MSB
   2634 85D0 DA                                   phx                   ;string address LSB
   2635 85D1 20 1D 88                             jsr sprint            ;print
   2636 85D4 FA                                   plx                   ;get index again
   2637 85D5 7A                                   ply                   ;get counter
   2638 85D6 E8                                   inx
   2639 85D7 88                                   dey
   2640 85D8 D0 DE                                bne .0000010          ;no
                                        
   2642 85DA 4C 26 81                   .0000020 jmp monce             ;back to command exec
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monchr: CHANGE REGISTERS
                                        ;
                                        ;	——————————————————————————————————————————————————————
                                        ;	syntax: ; [PB [PC [.S [.C [.X [.Y [SP [DP [DB]]]]]]]]]
                                        ;
                                        ;	; with no parameters is the same as the R command.
                                        ;	——————————————————————————————————————————————————————
                                        ;
   2654 85DD B0 33                      monchr   bcs .0000040          ;dump registers & quit
                                        ;
   2656 85DF A0 00                                ldy #0                ;register counter
   2657 85E1 84 B5                                sty facc              ;initialize register index
                                        ;
   2659 85E3 20 CF 8A                   .0000010 jsr facasize          ;get parameter size
   2660 85E6 D9 FA 8C                             cmp rcvltab,y         ;check against size table
   2661 85E9 B0 2A                                bcs .0000050          ;out of range
                                        ;
   2663 85EB B9 FA 8C                             lda rcvltab,y         ;determine number of bytes...
   2664 85EE C9 03                                cmp #s_word+1         ;to store
   2665 85F0 66 B6                                ror facc+s_byte       ;condition flag
   2666 85F2 10 02                                bpl .0000020          ;8 bit register size
                                        ;
   2668 85F4 C2 20                    +            .byte $c2,$20
                                                         ;16 bit register size
                                        ;
   2670 85F6 A6 B5                      .0000020 ldx facc              ;get register index
   2671 85F8 A5 A7                                lda faca              ;get parm
   2672 85FA 95 88                                sta reg_pbx,x         ;put in shadow storage
   2673 85FC E2 20                    +            .byte $e2,$20
                                        
   2674 85FE 06 B6                                asl facc+s_byte       ;mode flag to carry
   2675 8600 8A                                   txa                   ;register index
   2676 8601 69 01                                adc #s_byte           ;at least 1 byte stored
   2677 8603 85 B5                                sta facc              ;save new index
   2678 8605 20 E3 8A                             jsr getparm           ;get a parameter
   2679 8608 B0 08                                bcs .0000040          ;EOI
                                        ;
   2681 860A C8                                   iny                   ;bump register count
   2682 860B C0 09                                cpy #n_regchv         ;all registers processed?
   2683 860D D0 D4                                bne .0000010          ;no, keep going
                                        ;
   2685 860F 20 11 88                   .0000030 jsr alert             ;excessive input
                                        ;
   2687 8612 4C 7F 80                   .0000040 jmp monreg            ;display changes
                                        ;
   2689 8615 4C 65 81                   .0000050 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monxit: EXIT TO OPERATING ENVIRONMENT
                                        ;
                                        ;	—————————
                                        ;	syntax: X
                                        ;	—————————
                                        ;
   2699 8618 90 22                      monxit   bcc .0000020          ;no parameters allowed
                                        ;
   2701 861A C2 20                    +            .byte $c2,$20
                                        
   2702 861C AD 02 01                             lda vecbrki           ;BRK indirect vector
   2703 861F C9 42                    +            cmp #<monbrk
   2703 8621 80                       +            .byte >monbrk
                                        ;we intercept it?
   2704 8622 D0 09                                bne .0000010          ;no, don't change it
                                        ;
   2706 8624 AD 05 01                             lda vecbrkia          ;old vector
   2707 8627 8D 02 01                             sta vecbrki           ;restore it
   2708 862A 9C 05 01                             stz vecbrkia          ;invalidate old vector
                                        ;         
   2710 862D E2 30                      .0000010 +         .byte $e2,$30
                                        
                                           		 CPU FT832
   2712 00862F 64 CE                        		 STZ	$CE
   2713 008631 64 CF                        		 STZ	$CF
   2714 008633 42 CB 42 A2 00 00            		 TSK	JMP:#0
   2715 008639 4C 00 C0                     		 JMP	$C000
                                        		 CPU	W65C02
                                        ;         jml vecexit           ;long jump to exit
                                        ;
   2719 863C 4C 65 81                   .0000020 jmp monerr            ;goto error handler
                                        ;
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * *                                         * *
                                        ; * * S T A R T   o f   S U B R O U T I N E S * *
                                        ; * *                                         * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;
                                        ;dpycaddr: DISPLAY CURRENT ADDRESS IN COLUMNS
                                        ;
   2731 863F A6 CC                      dpycaddr ldx xrtemp            ;column count
   2732 8641 D0 05                                bne .0000010          ;not at right side
                                        ;
   2734 8643 20 05 88                             jsr newline           ;next row
   2735 8646 A2 08                                ldx #n_hccols         ;max columns
                                        ;
   2737 8648 E0 08                      .0000010 cpx #n_hccols         ;max columns
   2738 864A F0 07                                beq .0000020          ;at left margin
                                        ;
   2740 864C A9 09                                lda #a_ht
                                           		 cpu FT832
   2742 00864E 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        ;
   2745 8653 CA                         .0000020 dex                   ;one less column
   2746 8654 86 CC                                stx xrtemp            ;save column counter
   2747 8656 4C CA 87                             jmp prntladr          ;print reference address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpycod: DISASSEMBLE & DISPLAY CODE
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	This function disassembles & displays the machine code at  the  location
                                        ;	pointed to by ADDRA.  Upon return, ADDRA will point to the opcode of the
                                        ;	next instruction.   The entry point at DPYCODAA  should be called with a
                                        ;	disassembly prefix character loaded in .A.   If entered  at  DPYCOD, the
                                        ;	default character will be display at the beginning of each  disassembled
                                        ;	instruction.
                                        ;
                                        ;	The disassembly of immediate mode instructions that can take an 8 or  16
                                        ;	bit operand is affected by the bit pattern that is  stored  in  FLIMFLAG
                                        ;	upon entry to this function:
                                        ;
                                        ;	    FLIMFLAG: xx000000
                                        ;	              ||
                                        ;	              |+—————————> 0:  8 bit .X or .Y operand
                                        ;	              |            1: 16 bit .X or .Y operand
                                        ;	              +——————————> 0:  8 bit .A or BIT # operand
                                        ;	                           1: 16 bit .A or BIT # operand
                                        ;
                                        ;	FLIMFLAG is conditioned according to the operand of  the  most  recently
                                        ;	disassembled REP or SEP instruction.   Hence repetitive  calls  to  this
                                        ;	subroutine will usually result in the correct disassembly of 16 bit imm-
                                        ;	ediate mode instructions.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   2778 8659 A9 2E                       public dpycod   lda #disprfx          ;default prefix
                                        ;
                                        ;
                                        ;	alternate prefix display entry point...
                                        ;
   2783 865B                            dpycodaa 
                                           		 cpu FT832
   2785 00865B 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2787 8660 20 15 88                             jsr printspc          ;space
   2788 8663 20 CA 87                             jsr prntladr          ;print long address
   2789 8666 20 15 88                             jsr printspc          ;space to opcode field
   2790 8669 20 DD 8A                             jsr getbyte           ;get opcode
   2791 866C 85 CA                                sta opcode            ;save &...
   2792 866E 20 0A 88                             jsr printbyt          ;display as hex
                                        ;
                                        ;
                                        ;	decode menmonic & addressing info...
                                        ;
   2797 8671 A6 CA                                ldx opcode            ;current mnemonic
   2798 8673 BD BB 8D                             lda mnetabix,x        ;get mnemonic index
   2799 8676 0A                                   asl                   ;double for...
   2800 8677 A8                                   tay                   ;mnemonic table offset
   2801 8678 C2 20                    +            .byte $c2,$20
                                                         ;16 bit load
   2802 867A B9 03 8D                             lda mnetab,y          ;copy encoded mnemonic to...
   2803 867D 85 C8                                sta mnepck            ;working storage
   2804 867F E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   2805 8681 20 3F 8B                             jsr instdata          ;extract mode & size data
   2806 8684 85 D1                                sta vopsflag          ;save mode flags
   2807 8686 84 C3                                sty admodidx          ;save mode index
   2808 8688 0A                                   asl                   ;variable immediate instruction?
   2809 8689 90 1F                                bcc dpycod01          ;no, effective operand size in .X
                                        ;
                                        ;
                                        ;	determine immediate mode operand size...
                                        ;
   2814 868B A5 CA                                lda opcode            ;current opcode
   2815 868D 24 CE                                bit flimflag          ;operand display mode
   2816 868F 10 08                                bpl .0000010          ;8 bit .A & BIT immediate mode
                                        ;
   2818 8691 29 1F                                and #aimmaska         ;determine if...
   2819 8693 C9 09                                cmp #aimmaskb         ;.A or BIT immediate
   2820 8695 F0 10                                beq .0000030          ;display 16 bit operand
                                        ;
   2822 8697 A5 CA                                lda opcode            ;not .A or BIT immediate
                                        ;
   2824 8699 50 0F                      .0000010 bvc dpycod01          ;8 bit .X/.Y immediate mode
                                        ;
   2826 869B A0 03                                ldy #n_vopidx-1       ;opcodes to test
                                        ;
   2828 869D D9 BB 8F                   .0000020 cmp vopidx,y          ;looking for LDX #, CPY #, etc.
   2829 86A0 F0 07                                beq .0000040          ;disassemble a 16 bit operand
                                        ;
   2831 86A2 88                                   dey
   2832 86A3 10 F8                                bpl .0000020          ;keep trying
                                        ;
   2834 86A5 80 03                                bra dpycod01          ;not .X or .Y immediate
                                        ;
   2836 86A7 A5 CA                      .0000030 lda opcode            ;reload
                                        ;
   2838 86A9 E8                         .0000040 inx                   ;16 bit operand
                                        ;
                                        ;
                                        ;	get & display operand bytes...
                                        ;
   2843 86AA 86 CF                      dpycod01 stx iopsize           ;operand size...
   2844 86AC E8                                   inx                   ;plus opcode becomes...
   2845 86AD 86 C6                                stx instsize          ;instruction size
   2846 86AF 86 C4                                stx charcnt           ;total bytes to process
   2847 86B1 A9 0B                                lda #n_opcols+2       ;total operand columns plus WS
   2848 86B3 85 CC                                sta xrtemp            ;initialize counter
   2849 86B5 20 1E 8A                             jsr clroper           ;clear operand
   2850 86B8 A4 CF                                ldy iopsize           ;operand size
   2851 86BA F0 16                                beq .0000020          ;no operand
                                        ;
   2853 86BC A2 00                                ldx #0                ;operand index
                                        ;
   2855 86BE 20 DD 8A                   .0000010 jsr getbyte           ;get operand byte
   2856 86C1 95 BB                                sta operand,x         ;save
   2857 86C3 DA                                   phx                   ;protect operand index
   2858 86C4 20 0A 88                             jsr printbyt          ;print operand byte
   2859 86C7 C6 CC                                dec xrtemp            ;3 columns used, 2 for...
   2860 86C9 C6 CC                                dec xrtemp            ;operand nybbles &...
   2861 86CB C6 CC                                dec xrtemp            ;1 for whitespace
   2862 86CD FA                                   plx                   ;get operand index
   2863 86CE E8                                   inx                   ;bump it
   2864 86CF 88                                   dey
   2865 86D0 D0 EC                                bne .0000010          ;next
                                        ;
   2867 86D2 A6 CC                      .0000020 ldx xrtemp            ;operand columns remaining
   2868 86D4 20 F6 87                             jsr multspc           ;space to mnemonic field
                                        ;
                                        ;
                                        ;	display mnemonic...
                                        ;
   2873 86D7 A0 03                                ldy #s_mnemon         ;size of ASCII mnemonic
                                        ;
   2875 86D9 A9 00                      .0000030 lda #0                ;initialize char
   2876 86DB A2 05                                ldx #n_shfenc         ;shifts to execute
                                        ;
   2878 86DD 06 C8                      .0000040 asl mnepck            ;shift encoded mnemonic
   2879 86DF 26 C9                                rol mnepck+s_byte
   2880 86E1 2A                                   rol
   2881 86E2 CA                                   dex
   2882 86E3 D0 F8                                bne .0000040
                                        ;
   2884 86E5 69 3F                                adc #a_mnecvt         ;convert to ASCII &...
   2885 86E7 48                                   pha                   ;stash
   2886 86E8 88                                   dey
   2887 86E9 D0 EE                                bne .0000030          ;continue with mnemonic
                                        ;
   2889 86EB A0 03                                ldy #s_mnemon
                                        ;
   2891 86ED 68                         .0000050 pla                   ;get mnenmonic byte
                                           		 cpu FT832
   2893 0086EE 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2895 86F3 88                                   dey
   2896 86F4 D0 F7                                bne .0000050
                                        ;
                                        ;
                                        ;	display operand...
                                        ;
   2901 86F6 A5 CF                                lda iopsize           ;operand size
   2902 86F8 F0 73                                beq clearlin          ;zero, disassembly finished
                                        ;
   2904 86FA 20 15 88                             jsr printspc          ;space to operand field
   2905 86FD 24 D1                                bit vopsflag          ;check mode flags
   2906 86FF 50 08                                bvc dpycod02          ;not a branch
                                        ;
   2908 8701 20 55 8B                             jsr offtarg           ;compute branch target
   2909 8704 A6 C6                                ldx instsize          ;effective instruction size
   2910 8706 CA                                   dex
   2911 8707 86 CF                                stx iopsize           ;effective operand size
                                        ;
   2913 8709 64 D1                      dpycod02 stz vopsflag          ;clear
   2914 870B A5 C3                                lda admodidx          ;instruction addressing mode
   2915 870D C9 0B                                cmp #am_move          ;block move instruction?
   2916 870F D0 02                                bne .0000010          ;no
                                        ;
   2918 8711 66 D1                                ror vopsflag          ;yes
                                        ;
   2920 8713 0A                         .0000010 asl                   ;convert addressing mode to...
   2921 8714 AA                                   tax                   ;symbology table index
   2922 8715 C2 20                    +            .byte $c2,$20
                                                         ;do a 16 bit load
   2923 8717 BD BF 8F                             lda ms_lutab,x        ;addressing symbol pointer
   2924 871A 48                                   pha
   2925 871B E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bit loads
   2926 871D A0 00                                ldy #0
   2927 871F B3 01                    +            .byte $b3,1
                                        ;get 1st char
   2928 8721 C9 20                                cmp #a_blank
   2929 8723 F0 05                                beq .0000020          ;no addresing mode preamble
                                        ;
                                           		 cpu FT832
   2932 008725 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        ;
   2935 872A A9 24                      .0000020 lda #c_hex
                                           		 cpu FT832
   2937 00872C 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2939 8731 A4 CF                                ldy iopsize           ;operand size = index
                                        ;
   2941 8733 88                         .0000030 dey
   2942 8734 30 16                                bmi .0000040          ;done with operand
                                        ;
   2944 8736 B9 BB 00                             lda operand,y         ;get operand byte
   2945 8739 20 E7 87                             jsr dpyhex            ;print operand byte
   2946 873C 24 D1                                bit vopsflag          ;block move?
   2947 873E 10 F3                                bpl .0000030          ;no
                                        ;
   2949 8740 64 D1                                stz vopsflag          ;reset
   2950 8742 5A                                   phy                   ;protect operand index
   2951 8743 F4                       +            .byte $f4
   2951 8744 F8 8F                    +            .word ms_move
                                        
   2952 8746 20 1D 88                             jsr sprint            ;display MVN/MVP operand separator
   2953 8749 7A                                   ply                   ;recover operand index again
   2954 874A 80 E7                                bra .0000030          ;continue
                                        ;
   2956 874C FA                         .0000040 plx                   ;symbology LSB
   2957 874D 7A                                   ply                   ;symbology MSB
   2958 874E E8                                   inx                   ;move past preamble
   2959 874F D0 01                                bne .0000050
                                        ;
   2961 8751 C8                                   iny
                                        ;
   2963 8752 5A                         .0000050 phy
   2964 8753 DA                                   phx
   2965 8754 20 1D 88                             jsr sprint            ;print postamble, if any
                                        ;
                                        ;
                                        ;	condition immediate mode display format...
                                        ;
   2970 8757 A5 BB                      dpycod03 lda operand           ;operand LSB
   2971 8759 29 30                                and #pfmxmask         ;isolate M & X bits
   2972 875B 0A                                   asl                   ;shift to match...
   2973 875C 0A                                   asl                   ;FLIMFLAG alignment
   2974 875D A6 CA                                ldx opcode            ;current instruction
   2975 875F E0 C2                                cpx #opc_rep          ;was it REP?
   2976 8761 D0 04                                bne .0000010          ;no
                                        ;
   2978 8763 04 CE                                tsb flimflag          ;set flag bits as required
   2979 8765 80 06                                bra clearlin
                                        ;
   2981 8767 E0 E2                      .0000010 cpx #opc_sep          ;was it SEP?
   2982 8769 D0 02                                bne clearlin          ;no, just exit
                                        ;
   2984 876B 14 CE                                trb flimflag          ;clear flag bits as required
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clearlin: CLEAR DISPLAY LINE
                                        ;
   2990 876D F4                         clearlin +         .byte $f4
   2990 876E 15 90                    +            .word dc_cl
                                        
   2991 8770 80 4F                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyibuf: DISPLAY MONITOR INPUT BUFFER CONTENTS
                                        ;
   2997 8772 F4                         dpyibuf +         .byte $f4
   2997 8773 00 02                    +            .word ibuffer
                                        
   2998 8775 80 4A                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpymem: DISPLAY MEMORY
                                        ;
                                        ;	————————————————————————————————————————————————————————————
                                        ;	This function displays 16 bytes of memory as hex values & as
                                        ;	ASCII equivalents.  The starting address for the display is
                                        ;	in ADDRA & is expected to be a 24 bit address.  Upon return,
                                        ;	ADDRA will point to the start of the next 16 bytes.
                                        ;	————————————————————————————————————————————————————————————
                                        ;
   3011 8777 E2 30                      dpymem +         .byte $e2,$30
                                        
   3012 8779 64 C4                                stz charcnt           ;reset
   3013 877B A9 3E                                lda #memprfx
                                           		 cpu FT832
   3015 00877D 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3017 8782 20 CA 87                             jsr prntladr          ;print 24 bit address
   3018 8785 A2 00                                ldx #0                ;string buffer index
   3019 8787 A0 08                                ldy #n_dump           ;bytes per line
                                        ;
   3021 8789 20 DD 8A                   .0000010 jsr getbyte           ;get from RAM, also...
   3022 878C 48                                   pha                   ;save for decoding
   3023 878D DA                                   phx                   ;save string index
   3024 878E 20 0A 88                             jsr printbyt          ;display as hex ASCII
   3025 8791 E6 C4                                inc charcnt           ;bytes displayed +1
   3026 8793 FA                                   plx                   ;recover string index &...
   3027 8794 68                                   pla                   ;byte
   3028 8795 C9 20                                cmp #a_blank          ;printable?
   3029 8797 90 04                                bcc .0000020          ;no
                                        ;
   3031 8799 C9 7F                                cmp #a_del
   3032 879B 90 02                                bcc .0000030          ;is printable
                                        ;
   3034 879D A9 2E                      .0000020 lda #memsubch         ;substitute character
                                        ;
   3036 879F 9D 00 02                   .0000030 sta ibuffer,x         ;save char
   3037 87A2 E8                                   inx                   ;bump index
   3038 87A3 88                                   dey                   ;byte count -= 1
   3039 87A4 D0 E3                                bne .0000010          ;not done
                                        ;
   3041 87A6 9E 00 02                             stz ibuffer,x         ;terminate ASCII string
   3042 87A9 A9 3A                                lda #memsepch
                                           		 cpu FT832
   3044 0087AB 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3046 87B0 F4                       +            .byte $f4
   3046 87B1 0B 90                    +            .word dc_bf
                                        
   3047 87B3 20 1D 88                             jsr sprint            ;select reverse video
   3048 87B6 20 72 87                             jsr dpyibuf           ;display ASCII equivalents
   3049 87B9 F4                       +            .byte $f4
   3049 87BA 20 90                    +            .word dc_er
                                        ;normal video
   3050 87BC 80 03                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyerr: DISPLAY ERROR SIGNAL
                                        ;
   3056 87BE F4                         dpyerr +         .byte $f4
   3056 87BF 4D 90                    +            .word mm_err
                                        ;"*ERR"
                                        ;
   3058 87C1 20 1D 88                   dpyerraa jsr sprint
   3059 87C4 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;gendbs: GENERATE DESTRUCTIVE BACKSPACE
                                        ;
   3065 87C5 F4                         gendbs +         .byte $f4
   3065 87C6 11 90                    +            .word dc_bs
                                        ;destructive backspace
   3066 87C8 80 F7                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;prntladr: PRINT 24 BIT CURRENT ADDRESS
                                        ;
   3072 87CA 08                         prntladr php                   ;protect register sizes
   3073 87CB E2 20                    +            .byte $e2,$20
                                        
   3074 87CD A5 A2                                lda addra+s_word      ;get bank byte &...
   3075 87CF 20 E7 87                             jsr dpyhex            ;display it
   3076 87D2 C2 20                    +            .byte $c2,$20
                                        
   3077 87D4 A5 A0                                lda addra             ;get 16 bit address
   3078 87D6 28                                   plp                   ;restore register sizes
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyhexw: DISPLAY BINARY WORD AS HEX ASCII
                                        ;
                                        ;	————————————————————————————————————
                                        ;	Preparatory Ops: .C: word to display
                                        ;
                                        ;	Returned Values: .C: used
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————
                                        ;
   3092 87D7 08                         dpyhexw  php                   ;save register sizes
   3093 87D8 C2 20                    +            .byte $c2,$20
                                        
   3094 87DA 48                                   pha                   ;protect value
   3095 87DB E2 20                    +            .byte $e2,$20
                                        
   3096 87DD EB                       +            .byte $eb
                                                           ;get MSB &...
   3097 87DE 20 E7 87                             jsr dpyhex            ;display
   3098 87E1 C2 20                    +            .byte $c2,$20
                                        
   3099 87E3 68                                   pla                   ;recover value
   3100 87E4 E2 20                    +            .byte $e2,$20
                                                        ;only LSB visible
   3101 87E6 28                                   plp                   ;reset register sizes
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyhex: DISPLAY BINARY BYTE AS HEX ASCII
                                        ;
                                        ;	————————————————————————————————————
                                        ;	Preparatory Ops: .A: byte to display
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————
                                        ;
   3115 87E7 20 8A 89                   dpyhex   jsr binhex            ;convert to hex ASCII
                                           		 cpu FT832
   3117 0087EA 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3119 87EF 8A                                   txa
                                           		 cpu FT832
   3121 0087F0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3123 87F5 60                          		 rts
                                                 ;jmp putcha            ;print LSN
                                        ;
                                        ;================================================================================
                                        ;
                                        ;multspc: PRINT MULTIPLE BLANKS
                                        ;
                                        ;	————————————————————————————————————————————————
                                        ;	Preparatory Ops : .X: number of blanks to print
                                        ;
                                        ;	Register Returns: none
                                        ;
                                        ;	Calling Example : ldx #3
                                        ;	                  jsr multspc    ;print 3 spaces
                                        ;
                                        ;	Notes: This sub will print 1 blank if .X=0.
                                        ;	————————————————————————————————————————————————
                                        ;
   3141 87F6 8A                         multspc  txa
   3142 87F7 D0 01                                bne .0000010          ;blank count specified
                                        ;
   3144 87F9 E8                                   inx                   ;default to 1 blank
                                        ;
   3146 87FA A9 20                      .0000010 lda #a_blank
                                        ;
   3148 87FC                            .0000020 
                                           		 cpu FT832
   3150 0087FC 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3152 8801 CA                                   dex
   3153 8802 D0 F8                                bne .0000020
                                        ;
   3155 8804 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;newline: PRINT NEWLINE (CRLF)
                                        ;
   3161 8805 F4                         newline +         .byte $f4
   3161 8806 26 90                    +            .word dc_lf
                                        
   3162 8808 80 B7                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;printbyt: PRINT A BYTE WITH LEADING SPACE
                                        ;
   3168 880A 48                         printbyt pha                   ;protect byte
   3169 880B 20 15 88                             jsr printspc          ;print leading space
   3170 880E 68                                   pla                   ;restore &...
   3171 880F 80 D6                                bra dpyhex            ;print byte
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;alert: ALERT USER w/TERMINAL BELL
                                        ;
   3177 8811 A9 07                      alert    lda #a_bel
   3178 8813 80 02                                bra printcmn
                                        ;
                                        ;================================================================================
                                        ;
                                        ;printspc: PRINT A SPACE
                                        ;
   3184 8815 A9 20                      printspc lda #a_blank
                                        ;
   3186 8817                            printcmn 
                                           		 cpu FT832
   3188 008817 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3190 881C 60                          		 rts
                                        ;jmp putcha
                                        ;
                                        ;================================================================================
                                        ;
                                        ;sprint: PRINT NULL-TERMINATED CHARACTER STRING
                                        ;
                                        ;	—————————————————————————————————————————————————————————
                                        ;	Preparatory Ops : SP+1: string address LSB
                                        ;	                  SP+2: string address MSB
                                        ;
                                        ;	Register Returns: .A: used
                                        ;	                  .B: entry value
                                        ;	                  .X: used
                                        ;	                  .Y: used
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> 0: okay
                                        ;	           |||||||      1: string too long (1)
                                        ;	           ||||+++————> not defined
                                        ;	           |||+———————> 1
                                        ;	           ||+————————> 1
                                        ;	           ++—————————> not defined
                                        ;
                                        ;	Example: PER STRING
                                        ;	         JSR SPRINT
                                        ;	         BCS TOOLONG
                                        ;
                                        ;	Notes: 1) Maximum permissible string length including the
                                        ;	          terminator is 32,767 bytes.
                                        ;	       2) All registers are forced to 8 bits.
                                        ;	       3) DO NOT JUMP OR BRANCH INTO THIS FUNCTION!
                                        ;	—————————————————————————————————————————————————————————
                                        ;
   3225 881D E2 20                      sprint +         .byte $e2,$20
                                                        ;8 bit accumulator
   3226 881F C2 10                    +            .byte $c2,$10
                                                         ;16 bit index
                                        ;
                                        ;—————————————————————————————————————————————————————————
   3378 = 0000000000000001                            .reetaddr =1                    ;return address
                                        
   3380 = 00000003                      .src     =.reetaddr+s_word      ;string address stack offset
                                        
                                        ;—————————————————————————————————————————————————————————
                                        ;
   3235 8821 A0 00                    +            ldy #<0
   3235 8823 00                       +            .byte >0
                                        
   3236 8824 18                                   clc                   ;no initial error
                                        ;
   3238 8825 B3 03                      .0000010 +         .byte $b3,.src
                                        ;get a byte
   3239 8827 F0 09                                beq .0000020          ;done
                                        ;
                                           		 cpu FT832
   3242 008829 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3244 882E C8                                   iny
   3245 882F 10 F4                                bpl .0000010          ;next
                                        ;
   3247 8831 38                                   sec                   ;string too long
                                        ;
   3249 8832 FA                         .0000020 plx                   ;pull RTS address
   3250 8833 7A                                   ply                   ;clear string pointer
   3251 8834 DA                                   phx                   ;replace RTS
   3252 8835 E2 10                    +            .byte $e2,$10
                                        
   3253 8837 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ascbin: CONVERT NULL-TERMINATED ASCII NUMBER STRING TO BINARY
                                        ;
                                        ;	———————————————————————————————————————————————————
                                        ;	Preparatory Ops: ASCII number string in IBUFFER
                                        ;
                                        ;	Returned Values: FACA: converted parameter
                                        ;	                   .A: used
                                        ;	                   .X: used
                                        ;	                   .Y: used
                                        ;	                   .C: 1 = conversion error
                                        ;	                   .Z: 1 = nothing to convert
                                        ;
                                        ;	Notes: 1) Conversion stops when a non-numeric char-
                                        ;	          acter is encountered.
                                        ;	       2) Radix symbols are as follows:
                                        ;
                                        ;	          % binary
                                        ;	          @ octal
                                        ;	          + decimal
                                        ;	          $ hexadecimal
                                        ;
                                        ;	          Hex is the default if no radix is speci-
                                        ;	          fied in the 1st character of the string.
                                        ;	———————————————————————————————————————————————————
                                        ;
   3282 8838 E2 30                      ascbin +         .byte $e2,$30
                                        
   3283 883A 20 9D 89                             jsr clrfaca           ;clear accumulator
   3284 883D 64 C4                                stz charcnt           ;zero char count
   3285 883F 64 C2                                stz radix             ;initialize
                                        ;
                                        ;
                                        ;	process radix if present...
                                        ;
   3290 8841 20 30 8C                             jsr getcharw          ;get next non-WS char
   3291 8844 D0 02                                bne .0000010          ;got something
                                        ;
   3293 8846 18                                   clc                   ;no more input
   3294 8847 60                                   rts
                                        ;
   3296 8848 A2 03                      .0000010 ldx #n_radix-1        ;number of radices
                                        ;
   3298 884A DD F6 8C                   .0000020 cmp radxtab,x         ;recognized radix?
   3299 884D F0 06                                beq .0000030          ;yes
                                        ;
   3301 884F CA                                   dex
   3302 8850 10 F8                                bpl .0000020          ;try next
                                        ;
   3304 8852 C6 BF                                dec ibufidx           ;reposition to previous char
   3305 8854 E8                                   inx                   ;not recognized, assume hex
                                        ;
   3307 8855 C9 2B                      .0000030 cmp #c_dec            ;decimal radix?
   3308 8857 D0 02                                bne .0000040          ;not decimal
                                        ;
   3310 8859 66 C2                                ror radix             ;flag decimal conversion
                                        ;
   3312 885B BD E2 8C                   .0000040 lda basetab,x         ;number bases table
   3313 885E 85 D0                                sta range             ;set valid numeral range
   3314 8860 BD E6 8C                             lda bitsdtab,x        ;get bits per digit
   3315 8863 85 C0                                sta bitsdig           ;store
                                        ;
                                        ;
                                        ;	process numerals...
                                        ;
   3320 8865 20 D2 8B                   ascbin01 jsr getchar           ;get next char
   3321 8868 F0 70                                beq ascbin03          ;EOI
                                        ;
   3323 886A C9 20                                cmp #' '
   3324 886C F0 6C                                beq ascbin03          ;blank — EOF
                                        ;
   3326 886E C9 2C                                cmp #','
   3327 8870 F0 68                                beq ascbin03          ;comma — EOF
                                        ;
   3329 8872 C9 09                                cmp #a_ht
   3330 8874 F0 64                                beq ascbin03          ;tab — EOF
                                        ;
   3332 8876 20 F7 89                             jsr nybtobin          ;change to binary
   3333 8879 B0 60                                bcs ascbin04          ;not a recognized numeral
                                        ;
   3335 887B C5 D0                                cmp range             ;check range
   3336 887D B0 5C                                bcs ascbin04          ;not valid for base
                                        ;
   3338 887F 85 C1                                sta numeral           ;save processed numeral
   3339 8881 E6 C4                                inc charcnt           ;bump numeral count
   3340 8883 24 C2                                bit radix             ;working in base 10?
   3341 8885 10 15                                bpl .0000030          ;no
                                        ;
                                        ;
                                        ;	compute N*2 for decimal conversion...
                                        ;
   3346 8887 A2 00                                ldx #0                ;accumulator index
   3347 8889 A0 02                                ldy #s_pfac/2         ;iterations
   3348 888B C2 20                    +            .byte $c2,$20
                                        
   3349 888D 18                                   clc
                                        ;
   3351 888E B5 A7                      .0000020 lda faca,x            ;N
   3352 8890 2A                                   rol                   ;N=N*2
   3353 8891 95 AF                                sta facb,x
   3354 8893 E8                                   inx
   3355 8894 E8                                   inx
   3356 8895 88                                   dey
   3357 8896 D0 F6                                bne .0000020
                                        ;
   3359 8898 B0 41                                bcs ascbin04          ;overflow — error
                                        ;
   3361 889A E2 20                    +            .byte $e2,$20
                                        
                                        ;
                                        ;
                                        ;	compute N*base for binary, octal or hex...
                                        ;	or N*8 for decimal...
                                        ;
   3367 889C A6 C0                      .0000030 ldx bitsdig           ;bits per digit
   3368 889E C2 20                    +            .byte $c2,$20
                                                         ;16 bit shifts
                                        ;
   3370 88A0 06 A7                      .0000040 asl faca
   3371 88A2 26 A9                                rol faca+s_word
   3372 88A4 B0 35                                bcs ascbin04          ;overflow — error
                                        ;
   3374 88A6 CA                                   dex
   3375 88A7 D0 F7                                bne .0000040          ;next shift
                                        ;
   3377 88A9 E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   3378 88AB 24 C2                                bit radix             ;check base
   3379 88AD 10 13                                bpl ascbin02          ;not decimal
                                        ;
                                        ;
                                        ;	compute N*10 for decimal (N*8 + N*2)...
                                        ;
   3384 88AF A0 04                                ldy #s_pfac
   3385 88B1 C2 20                    +            .byte $c2,$20
                                        
                                        ;
   3387 88B3 B5 A7                      .0000050 lda faca,x            ;N*8
   3388 88B5 75 AF                                adc facb,x            ;N*2
   3389 88B7 95 A7                                sta faca,x            ;now N*10
   3390 88B9 E8                                   inx
   3391 88BA E8                                   inx
   3392 88BB 88                                   dey
   3393 88BC D0 F5                                bne .0000050
                                        ;
   3395 88BE B0 1B                                bcs ascbin04          ;overflow — error
                                        ;
   3397 88C0 E2 20                    +            .byte $e2,$20
                                        
                                        ;
                                        ;
                                        ;	add current numeral to partial result...
                                        ;
   3402 88C2 A5 A7                      ascbin02 lda faca              ;N
   3403 88C4 65 C1                                adc numeral           ;N=N+D
   3404 88C6 85 A7                                sta faca
   3405 88C8 A2 01                                ldx #1
   3406 88CA A0 03                                ldy #s_pfac-1
                                        ;
   3408 88CC B5 A7                      .0000010 lda faca,x
   3409 88CE 69 00                                adc #0                ;account for carry
   3410 88D0 95 A7                                sta faca,x
   3411 88D2 E8                                   inx
   3412 88D3 88                                   dey
   3413 88D4 D0 F6                                bne .0000010
                                        ;
   3415 88D6 90 8D                                bcc ascbin01          ;next if no overflow
                                        ;
   3417 88D8 B0 01                                bcs ascbin04          ;overflow — error
                                        ;
                                        ;
                                        ;	finish up...
                                        ;
   3422 88DA 18                         ascbin03 clc                   ;no error
                                        ;
   3424 88DB E2 20                      ascbin04 +         .byte $e2,$20
                                                        ;reset if necessary
   3425 88DD A5 C4                                lda charcnt           ;load char count
   3426 88DF 60                                   rts                   ;done
                                        ;
                                        ;================================================================================
                                        ;
                                        ;bcdasc: CONVERT BCD DIGIT TO ASCII
                                        ;
                                        ;	———————————————————————————————————————
                                        ;	Preparatory Ops: .A: BCD digit, $00-$99
                                        ;
                                        ;	Returned Values: .A: ASCII MSD
                                        ;	                 .X: ASCII LSD
                                        ;	                 .Y: entry value
                                        ;	———————————————————————————————————————
                                        ;
   3440 88E0 20 EC 88                   bcdasc   jsr bintonyb          ;extract nybbles
   3441 88E3 48                                   pha                   ;save tens
   3442 88E4 8A                                   txa                 
   3443 88E5 09 30                                ora #btoamask         ;change units to ASCII
   3444 88E7 AA                                   tax                   ;store
   3445 88E8 68                                   pla                   ;get tens
   3446 88E9 09 30                                ora #btoamask         ;change to ASCII
   3447 88EB 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;bintonyb: EXTRACT BINARY NYBBLES
                                        ;
                                        ;	—————————————————————————————————
                                        ;	Preparatory Ops: .A: binary value
                                        ;
                                        ;	Returned Values: .A: MSN
                                        ;	                 .X: LSN
                                        ;	                 .Y: entry value
                                        ;	—————————————————————————————————
                                        ;
   3461 88EC 48                         bintonyb pha                   ;save
   3462 88ED 29 0F                                and #bcdumask         ;extract LSN
   3463 88EF AA                                   tax                   ;save it
   3464 88F0 68                                   pla
                                        ;         .rept s_bnybbl        ;extract MSN
   3466 88F1 4A                                     lsr
   3467 88F2 4A                                     lsr
   3468 88F3 4A                                     lsr
   3469 88F4 4A                                     lsr
                                        ;         .endr
   3471 88F5 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;binasc: CONVERT 32-BIT BINARY TO NULL-TERMINATED ASCII NUMBER STRING
                                        ;
                                        ;	——————————————————————————————————————————————————————
                                        ;	Preparatory Ops: FACA: 32-bit operand
                                        ;	                   .A: radix character, w/bit 7 set to
                                        ;	                       suppress radix symbol in the
                                        ;	                       conversion string
                                        ;
                                        ;	Returned Values: ibuffer: conversion string
                                        ;	                      .A: string length
                                        ;	                      .X: string address LSB
                                        ;	                      .Y: string address MSB
                                        ;
                                        ;	Execution Notes: ibufidx & instsize are overwritten.
                                        ;	——————————————————————————————————————————————————————
                                        ;
   3491 88F6 64 BF                      binasc   stz ibufidx           ;initialize string index
   3492 88F8 64 C6                                stz instsize          ;clear format flag
                                        ;
                                        ;
                                        ;	evaluate radix...
                                        ;
   3497 88FA 0A                                   asl                   ;extract format flag &...
   3498 88FB 66 C6                                ror instsize          ;save it
   3499 88FD 4A                                   lsr                   ;extract radix character
   3500 88FE A2 03                                ldx #n_radix-1        ;total radices
                                        ;
   3502 8900 DD F6 8C                   .0000010 cmp radxtab,x         ;recognized radix?
   3503 8903 F0 04                                beq .0000020          ;yes
                                        ;
   3505 8905 CA                                   dex
   3506 8906 10 F8                                bpl .0000010          ;try next
                                        ;
   3508 8908 E8                                   inx                   ;assume hex
                                        ;
   3510 8909 86 C2                      .0000020 stx radix             ;save radix index for later
   3511 890B 24 C6                                bit instsize
   3512 890D 30 08                                bmi .0000030          ;no radix symbol wanted
                                        ;
   3514 890F BD F6 8C                             lda radxtab,x         ;radix table
   3515 8912 8D 00 02                             sta ibuffer           ;prepend to string
   3516 8915 E6 BF                                inc ibufidx           ;bump string index
                                        ;
   3518 8917 C9 2B                      .0000030 cmp #c_dec            ;converting to decimal?
   3519 8919 D0 07                                bne .0000040          ;no
                                        ;
   3521 891B 20 AF 89                             jsr facabcd           ;convert operand to BCD
   3522 891E A9 00                                lda #0
   3523 8920 80 17                                bra .0000070          ;skip binary stuff
                                        ;
                                        ;
                                        ;	prepare for binary, octal or hex conversion...
                                        ;
   3528 8922 A2 00                      .0000040 ldx #0                ;operand index
   3529 8924 A0 05                                ldy #s_sfac-1         ;workspace index
                                        ;
   3531 8926 B5 A7                      .0000050 lda faca,x            ;copy operand to...
   3532 8928 99 AF 00                             sta facb,y            ;workspace in...
   3533 892B 88                                   dey                   ;big-endian order
   3534 892C E8                                   inx
   3535 892D E0 04                                cpx #s_pfac
   3536 892F D0 F5                                bne .0000050
                                        ;
   3538 8931 A9 00                                lda #0
   3539 8933 BB                       +            .byte $bb
                                        
                                        ;
   3541 8934 95 AF                      .0000060 sta facb,x            ;pad workspace
   3542 8936 CA                                   dex
   3543 8937 10 FB                                bpl .0000060
                                        ;
                                        ;
                                        ;	set up conversion parameters...
                                        ;
   3548 8939 85 B5                      .0000070 sta facc              ;initialize byte counter
   3549 893B A4 C2                                ldy radix             ;radix index
   3550 893D B9 F2 8C                             lda numstab,y         ;numerals in string
   3551 8940 85 B6                                sta facc+s_byte       ;set remaining numeral count
   3552 8942 B9 EA 8C                             lda bitsntab,y        ;bits per numeral
   3553 8945 85 B7                                sta facc+s_word       ;set
   3554 8947 B9 EE 8C                             lda lzsttab,y         ;leading zero threshold
   3555 894A 85 B8                                sta facc+s_xword      ;set
                                        ;
                                        ;
                                        ;	generate conversion string...
                                        ;
   3560 894C A9 00                      .0000080 lda #0
   3561 894E A4 B7                                ldy facc+s_word       ;bits per numeral
                                        ;
   3563 8950 A2 05                      .0000090 ldx #s_sfac-1         ;workspace size
   3564 8952 18                                   clc                   ;avoid starting carry
                                        ;
   3566 8953 36 AF                      .0000100 rol facb,x            ;shift out a bit...
   3567 8955 CA                                   dex                   ;from the operand or...
   3568 8956 10 FB                                bpl .0000100          ;BCD conversion result
                                        ;
   3570 8958 2A                                   rol                   ;bit to .A
   3571 8959 88                                   dey
   3572 895A D0 F4                                bne .0000090          ;more bits to grab
                                        ;
   3574 895C A8                                   tay                   ;if numeral isn't zero...
   3575 895D D0 0A                                bne .0000110          ;skip leading zero tests
                                        ;
   3577 895F A6 B6                                ldx facc+s_byte       ;remaining numerals
   3578 8961 E4 B8                                cpx facc+s_xword      ;leading zero threshold
   3579 8963 90 04                                bcc .0000110          ;below it, must convert
                                        ;
   3581 8965 A6 B5                                ldx facc              ;processed byte count
   3582 8967 F0 11                                beq .0000130          ;discard leading zero
                                        ;
   3584 8969 C9 0A                      .0000110 cmp #10               ;check range
   3585 896B 90 02                                bcc .0000120          ;is 0-9
                                        ;
   3587 896D 69 06                                adc #a_hexdec         ;apply hex adjust
                                        ;
   3589 896F 69 30                      .0000120 adc #'0'              ;change to ASCII
   3590 8971 A4 BF                                ldy ibufidx           ;string index
   3591 8973 99 00 02                             sta ibuffer,y         ;save numeral in buffer
   3592 8976 E6 BF                                inc ibufidx           ;next buffer position
   3593 8978 E6 B5                                inc facc              ;bytes=bytes+1
                                        ;
   3595 897A C6 B6                      .0000130 dec facc+s_byte       ;numerals=numerals-1
   3596 897C D0 CE                                bne .0000080          ;not done
                                        ;
                                        ;
                                        ;	terminate string & exit...
                                        ;
   3601 897E A6 BF                                ldx ibufidx           ;printable string length
   3602 8980 9E 00 02                             stz ibuffer,x         ;terminate string
   3603 8983 8A                                   txa
   3604 8984 A2 00                                ldx #<ibuffer         ;converted string
   3605 8986 A0 02                                ldy #>ibuffer
   3606 8988 18                                   clc                   ;all okay
   3607 8989 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;binhex: CONVERT BINARY BYTE TO HEX ASCII CHARS
                                        ;
                                        ;	————————————————————————————————————————————
                                        ;	Preparatory Ops: .A: byte to convert
                                        ;
                                        ;	Returned Values: .A: MSN ASCII char
                                        ;	                 .X: LSN ASCII char
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————————————
                                        ;
   3621 898A 20 EC 88                   binhex   jsr bintonyb          ;generate binary values
   3622 898D 48                                   pha                   ;save MSN
   3623 898E 8A                                   txa
   3624 898F 20 94 89                             jsr .0000010          ;generate ASCII LSN
   3625 8992 AA                                   tax                   ;save
   3626 8993 68                                   pla                   ;get input
                                        ;
                                        ;
                                        ;	convert nybble to hex ASCII equivalent...
                                        ;
   3631 8994 C9 0A                      .0000010 cmp #10
   3632 8996 90 02                                bcc .0000020          ;in decimal range
                                        ;
   3634 8998 69 66                                adc #k_hex            ;hex compensate
                                        ;         
   3636 899A 49 30                      .0000020 eor #'0'              ;finalize nybble
   3637 899C 60                                   rts                   ;done
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clrfaca: CLEAR FLOATING ACCUMULATOR A
                                        ;
   3643 899D 08                         clrfaca  php
   3644 899E C2 20                    +            .byte $c2,$20
                                        
   3645 89A0 64 A7                                stz faca
   3646 89A2 64 A9                                stz faca+s_word
   3647 89A4 28                                   plp
   3648 89A5 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clrfacb: CLEAR FLOATING ACCUMULATOR B
                                        ;
   3654 89A6 08                         clrfacb  php
   3655 89A7 C2 20                    +            .byte $c2,$20
                                        
   3656 89A9 64 AF                                stz facb
   3657 89AB 64 B1                                stz facb+s_word
   3658 89AD 28                                   plp
   3659 89AE 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facabcd: CONVERT FACA INTO BCD
                                        ;
   3665 89AF A2 03                      facabcd  ldx #s_pfac-1         ;primary accumulator size -1
                                        ;
   3667 89B1 B5 A7                      .0000010 lda faca,x            ;value to be converted
   3668 89B3 48                                   pha                   ;preserve
   3669 89B4 CA                                   dex
   3670 89B5 10 FA                                bpl .0000010          ;next
                                        ;
   3672 89B7 A2 05                                ldx #s_sfac-1         ;workspace size
                                        ;
   3674 89B9 74 AF                      .0000020 stz facb,x            ;clear final result
   3675 89BB 74 B5                                stz facc,x            ;clear scratchpad
   3676 89BD CA                                   dex
   3677 89BE 10 F9                                bpl .0000020
                                        ;
   3679 89C0 E6 BA                                inc facc+s_sfac-s_byte
   3680 89C2 F8                                   sed                   ;select decimal mode
   3681 89C3 A0 1F                                ldy #m_bits-1         ;bits to convert -1
                                        ;
   3683 89C5 A2 03                      .0000030 ldx #s_pfac-1         ;operand size
   3684 89C7 18                                   clc                   ;no carry at start
                                        ;
   3686 89C8 76 A7                      .0000040 ror faca,x            ;grab LS bit in operand
   3687 89CA CA                                   dex
   3688 89CB 10 FB                                bpl .0000040
                                        ;
   3690 89CD 90 0D                                bcc .0000060          ;LS bit clear
                                        ;
   3692 89CF 18                                   clc
   3693 89D0 A2 05                                ldx #s_sfac-1
                                        ;
   3695 89D2 B5 AF                      .0000050 lda facb,x            ;partial result
   3696 89D4 75 B5                                adc facc,x            ;scratchpad
   3697 89D6 95 AF                                sta facb,x            ;new partial result
   3698 89D8 CA                                   dex
   3699 89D9 10 F7                                bpl .0000050
                                        ;
   3701 89DB 18                                   clc
                                        ;
   3703 89DC A2 05                      .0000060 ldx #s_sfac-1
                                        ;
   3705 89DE B5 B5                      .0000070 lda facc,x            ;scratchpad
   3706 89E0 75 B5                                adc facc,x            ;double &...
   3707 89E2 95 B5                                sta facc,x            ;save
   3708 89E4 CA                                   dex
   3709 89E5 10 F7                                bpl .0000070
                                        ;
   3711 89E7 88                                   dey
   3712 89E8 10 DB                                bpl .0000030          ;next operand bit
                                        ;
   3714 89EA D8                                   cld
   3715 89EB A2 00                                ldx #0
   3716 89ED A0 04                                ldy #s_pfac
                                        ;
   3718 89EF 68                         .0000080 pla                   ;operand
   3719 89F0 95 A7                                sta faca,x            ;restore
   3720 89F2 E8                                   inx
   3721 89F3 88                                   dey
   3722 89F4 D0 F9                                bne .0000080          ;next
                                        ;
   3724 89F6 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;nybtobin: CONVERT ASCII NYBBLE TO BINARY
                                        ;
   3730 89F7 20 A6 8C                   nybtobin jsr toupper           ;convert case if necessary
   3731 89FA 38                                   sec
   3732 89FB E9 30                                sbc #'0'              ;change to binary
   3733 89FD 90 08                                bcc .0000020          ;not a numeral — error
                                        ;
   3735 89FF C9 0A                                cmp #10
   3736 8A01 90 03                                bcc .0000010          ;numeral is 0-9
                                        ;
   3738 8A03 E9 07                                sbc #a_hexdec+1       ;10-15 ——> A-F
   3739 8A05 18                                   clc                   ;no conversion error
                                        ;
   3741 8A06 60                         .0000010 rts
                                        ;
   3743 8A07 38                         .0000020 sec                   ;conversion error
   3744 8A08 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;calccnt: COMPUTE BYTE COUNT FROM ADDRESS RANGE
                                        ;
   3750 8A09 20 A6 89                   calccnt  jsr clrfacb           ;clear accumulator
   3751 8A0C C2 20                    +            .byte $c2,$20
                                        
   3752 8A0E 38                                   sec
   3753 8A0F A5 A4                                lda addrb             ;ending address
   3754 8A11 E5 A0                                sbc addra             ;starting address
   3755 8A13 85 AF                                sta facb              ;byte count
   3756 8A15 E2 20                    +            .byte $e2,$20
                                        
   3757 8A17 A5 A6                                lda addrb+s_word      ;handle banks
   3758 8A19 E5 A2                                sbc addra+s_word
   3759 8A1B 85 B1                                sta facb+s_word
   3760 8A1D 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clroper: CLEAR OPERAND
                                        ;
   3766 8A1E DA                         clroper  phx
   3767 8A1F A2 02                                ldx #s_oper-1
                                        ;
   3769 8A21 74 BB                      .0000010 stz operand,x
   3770 8A23 CA                                   dex
   3771 8A24 10 FB                                bpl .0000010
                                        ;
   3773 8A26 64 CD                                stz eopsize
   3774 8A28 FA                                   plx
   3775 8A29 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;cpfwsup: FOWARD COPY MEMORY SETUP
                                        ;
   3781 8A2A C2 30                      cpfwsup +         .byte $c2,$30
                                        
   3782 8A2C A2 54                    +            ldx #<opc_mvn
   3782 8A2E 00                       +            .byte >opc_mvn
                                        ;"move next" opcode
   3783 8A2F 80 05                                bra cpsup
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;cprvsup: REVERSE COPY MEMORY SETUP
                                        ;
   3789 8A31 C2 30                      cprvsup +         .byte $c2,$30
                                        
   3790 8A33 A2 44                    +            ldx #<opc_mvp
   3790 8A35 00                       +            .byte >opc_mvp
                                        ;"move previous" opcode
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;cpsup: COPY MEMORY SETUP
                                        ;
   3796 8A36 48                         cpsup    pha                   ;save banks
   3797 8A37 8A                                   txa                   ;protect...
   3798 8A38 EB                       +            .byte $eb
                                                           ;opcode
   3799 8A39 E2 20                    +            .byte $e2,$20
                                        
   3800 8A3B A2 08                    +            ldx #<(cpcodeee-cpcode-1)
   3800 8A3D 00                       +            .byte >(cpcodeee-cpcode-1)
                                        
                                        ;
   3802 8A3E BF                         .0000010 +         .byte $bf
   3802 8A3F 5E 8A 00                 +   +         .byte <cpcode,>cpcode,cpcode >> 16
                                     +   
                                        ;transfer copy code to...
   3803 8A42 95 D2                                sta mcftwork,x        ;to workspace
   3804 8A44 CA                                   dex
   3805 8A45 10 F7                                bpl .0000010
                                        ;
   3807 8A47 EB                       +            .byte $eb
                                                           ;recover opcode &...
   3808 8A48 85 D3                                sta mcftopc           ;set it
   3809 8A4A C2 20                    +            .byte $c2,$20
                                        
   3810 8A4C 68                                   pla                   ;get banks &...
   3811 8A4D 85 D4                                sta mcftbnk           ;set them
                                         
                                        ; We just dynamically created a routine, so the cache (if one is present) has
                                        ; to be invalidated. Otherwise the processor could execute dead code from the
                                        ; cache. Two lines are invalidated in case the code crosses a line boundary.
                                        ;
                                        ;	acc = 16 bit address to invalidate
                                        ;
                                        ; If there is no cache in the processor then these lines can be deleted.
                                        ;-------------------------------------------------------------------------------
                                           		 CPU	FT832
                                           		 MEM	16
   3823 008A4F 48                                    pha
   3824 008A50 A9 D2 00                              lda	#mcftwork
   3825 008A53 42 E0 01                     		 cache	#1				; 1= invalidate line identified by address in acc
   3826 008A56 A9 E2 00                              lda	#mcftwork+16
   3827 008A59 42 E0 01                     		 cache	#1
   3828 008A5C 68                                    pla
                                        		 CPU	W65C02
   3830 8A5D                            		 MEM	8
                                        ;---------------------------------------------
   3832 8A5D 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;cpcode: COPY MEMORY CODE
                                        ;
                                        ;	———————————————————————————————————————————
                                        ;	This code is transfered to workspace when a
                                        ;	copy or fill operation is to be performed.
                                        ;	———————————————————————————————————————————
                                        ;
   3843 8A5E 8B                         cpcode +         .byte $8b
                                                           ;must preserve data bank
                                        ;         .rept s_mvinst
   3845 8A5F EA                                     nop                 ;placeholder
   3846 8A60 EA                                     nop
   3847 8A61 EA                                     nop
                                        ;         .endr
   3849 8A62 AB                       +            .byte $ab
                                                           ;restore data bank
   3850 8A63 5C 26 81 00                          jml monce             ;return to command executive
   4034 = 00008A67                      cpcodeee =*                    ;placeholder — do not delete
                                        ;
                                        ;================================================================================
                                        ;
                                        ;decdcnt: DECREMENT DUMP COUNT
                                        ;
                                        ;	———————————————————————————————————————————
                                        ;	Preparatory Ops: bytes to process in FACB
                                        ;	                 bytes processed in CHARCNT
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .C: 1 = count = zero
                                        ;	———————————————————————————————————————————
                                        ;
   3867 8A67 E2 20                      decdcnt +         .byte $e2,$20
                                        
   3868 8A69 A9 00                                lda #0
   3869 8A6B EB                       +            .byte $eb
                                                           ;clear .B
   3870 8A6C A5 B1                                lda facb+s_word       ;count MSW
   3871 8A6E C2 20                    +            .byte $c2,$20
                                        
   3872 8A70 38                                   sec
   3873 8A71 05 AF                                ora facb              ;count LSW
   3874 8A73 F0 13                                beq .0000020          ;zero, just exit
                                        ;
   3876 8A75 A5 AF                                lda facb
   3877 8A77 E5 C4                                sbc charcnt           ;bytes processed
   3878 8A79 85 AF                                sta facb
   3879 8A7B E2 20                    +            .byte $e2,$20
                                        
   3880 8A7D A5 B1                                lda facb+s_word
   3881 8A7F E9 00                                sbc #0                ;handle borrow
   3882 8A81 90 04                                bcc .0000010          ;underflow
                                        ;
   3884 8A83 85 B1                                sta facb+s_word
   3885 8A85 18                                   clc                   ;count > 0
   3886 8A86 60                                   rts
                                        ;
   3888 8A87 38                         .0000010 sec
                                        ;
   3890 8A88 E2 20                      .0000020 +         .byte $e2,$20
                                        
   3891 8A8A 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;enddest: GET 2ND & 3RD ADDRESSES FOR COMPARE & TRANSFER
                                        ;
   3897 8A8B 20 CF 8A                   enddest  jsr facasize          ;check start...
   3898 8A8E C9 04                                cmp #s_dword          ;for range
   3899 8A90 B0 1E                                bcs .0000010          ;out of range — error
                                        ;
   3901 8A92 20 B1 8A                             jsr facaddra          ;store start
   3902 8A95 20 E3 8A                             jsr getparm           ;get end
   3903 8A98 B0 16                                bcs .0000010          ;not entered — error
                                        ;
   3905 8A9A 20 CF 8A                             jsr facasize          ;check end...
   3906 8A9D C9 04                                cmp #s_dword          ;for range
   3907 8A9F B0 0F                                bcs .0000010          ;out of range — error
                                        ;
   3909 8AA1 20 BB 8A                             jsr facaddrb          ;store end
   3910 8AA4 20 E3 8A                             jsr getparm           ;get destination
   3911 8AA7 B0 07                                bcs .0000010          ;not entered — error
                                        ;
   3913 8AA9 20 CF 8A                             jsr facasize          ;check destination...
   3914 8AAC C9 04                                cmp #s_dword          ;for range
   3915 8AAE 90 15                                bcc facaoper          ;store dest address
                                        ;
   3917 8AB0 60                         .0000010 rts                   ;exit w/error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaddra: COPY FACA TO ADDRA
                                        ;
   3923 8AB1 A2 02                      facaddra ldx #s_xword-1
                                        ;
   3925 8AB3 B5 A7                      .0000010 lda faca,x
   3926 8AB5 95 A0                                sta addra,x
   3927 8AB7 CA                                   dex
   3928 8AB8 10 F9                                bpl .0000010
                                        ;
   3930 8ABA 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaddrb: COPY FACA TO ADDRB
                                        ;
   3936 8ABB A2 02                      facaddrb ldx #s_xword-1
                                        ;
   3938 8ABD B5 A7                      .0000010 lda faca,x
   3939 8ABF 95 A4                                sta addrb,x
   3940 8AC1 CA                                   dex
   3941 8AC2 10 F9                                bpl .0000010
                                        ;
   3943 8AC4 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaoper: COPY FACA TO OPERAND
                                        ;
   3949 8AC5 A2 02                      facaoper ldx #s_oper-1
                                        ;
   3951 8AC7 B5 A7                      .0000010 lda faca,x
   3952 8AC9 95 BB                                sta operand,x
   3953 8ACB CA                                   dex
   3954 8ACC 10 F9                                bpl .0000010
                                        ;
   3956 8ACE 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facasize: REPORT OPERAND SIZE IN FACA
                                        ;
                                        ;	——————————————————————————————————————————
                                        ;	Preparatory Ops: operand in FACA
                                        ;
                                        ;	Returned Values: .A: s_byte  (1)
                                        ;	                     s_word  (2)
                                        ;	                     s_xword (3)
                                        ;	                     s_dword (4)
                                        ;
                                        ;	Notes: 1) This function will always report
                                        ;	          a non-zero result.
                                        ;	——————————————————————————————————————————
                                        ;
   3974 8ACF E2 30                      facasize +         .byte $e2,$30
                                        
   3975 8AD1 A2 03                                ldx #s_dword-1
                                        ;
   3977 8AD3 B5 A7                      .0000010 lda faca,x            ;get byte
   3978 8AD5 D0 03                                bne .0000020          ;done
                                        ;
   3980 8AD7 CA                                   dex
   3981 8AD8 D0 F9                                bne .0000010          ;next byte
                                        ;
   3983 8ADA E8                         .0000020 inx                   ;count=index+1
   3984 8ADB 8A                                   txa
   3985 8ADC 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getbyte: GET A BYTE FROM MEMORY
                                        ;
   3991 8ADD A7 A0                      getbyte +         .byte $a7,addra
                                        ;get a byte
   3992 8ADF 80 3F                                bra incaddra          ;bump address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getparm: GET A PARAMETER
                                        ;
                                        ;	—————————————————————————————————————————————————
                                        ;	Preparatory Ops: null-terminated input in IBUFFER
                                        ;
                                        ;	Returned Values: .A: chars in converted parameter
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	                 .C: 1 = no parameter entered
                                        ;	—————————————————————————————————————————————————
                                        ;
   4007 8AE1 C6 BF                      getparmr dec ibufidx           ;reread previous char
                                        ;
   4009 8AE3 5A                         getparm  phy                   ;preserve
   4010 8AE4 20 38 88                             jsr ascbin            ;convert parameter to binary
   4011 8AE7 B0 1C                                bcs .0000040          ;conversion error
                                        ;
   4013 8AE9 20 D0 8B                             jsr getcharr          ;reread last char
   4014 8AEC D0 08                                bne .0000010          ;not end-of-input
                                        ;
   4016 8AEE C6 BF                                dec ibufidx           ;reindex to terminator
   4017 8AF0 A5 C4                                lda charcnt           ;get chars processed so far
   4018 8AF2 F0 0C                                beq .0000030          ;none
                                        ;
   4020 8AF4 D0 08                                bne .0000020          ;some
                                        ;
   4022 8AF6 C9 20                      .0000010 cmp #a_blank          ;recognized delimiter
   4023 8AF8 F0 04                                beq .0000020          ;end of parameter
                                        ;
   4025 8AFA C9 2C                                cmp #','              ;recognized delimiter
   4026 8AFC D0 07                                bne .0000040          ;unknown delimter
                                        ;
   4028 8AFE 18                         .0000020 clc
   4029 8AFF 24                                   .byte bitzp           ;skip SEC below
                                        ;
   4031 8B00 38                         .0000030 sec
   4032 8B01 7A                                   ply                   ;restore
   4033 8B02 A5 C4                                lda charcnt           ;get count
   4034 8B04 60                                   rts                   ;done
                                        ;
   4036 8B05                            .0000040 
                                        ;.rept 3               ;clean up stack
   4038 8B05 68                          			pla
   4039 8B06 68                          			pla
   4040 8B07 68                                     pla
                                        ;        .endr
   4042 8B08 4C 65 81                             jmp monerr            ;abort w/error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;nxtaddra: TEST & INCREMENT WORKING ADDRESS 'A'
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Calling syntax: JSR NXTADDRA
                                        ;
                                        ;	Exit registers: .A: used
                                        ;	                .B: used
                                        ;	                .X: entry value
                                        ;	                .Y: entry value
                                        ;	                DB: entry value
                                        ;	                DP: entry value
                                        ;	                PB: entry value
                                        ;	                SR: NVmxDIZC
                                        ;	                    ||||||||
                                        ;	                    |||||||+———> 0: ADDRA < ADDRB
                                        ;	                    |||||||      1: ADDRA >= ADDRB
                                        ;	                    ||||||+————> undefined
                                        ;	                    |||+++—————> entry value
                                        ;	                    ||+————————> 1
                                        ;	                    ++—————————> undefined
                                        ;	——————————————————————————————————————————————————
                                        ;
   4068 8B0B E2 20                      nxtaddra +         .byte $e2,$20
                                        
   4069 8B0D A5 A2                                lda addra+s_word      ;bits 16-23
   4070 8B0F C5 A6                                cmp addrb+s_word
   4071 8B11 90 0D                                bcc incaddra          ;increment
                                        ;
   4073 8B13 D0 0A                                bne .0000010          ;don't increment
                                        ;
   4075 8B15 C2 20                    +            .byte $c2,$20
                                        
   4076 8B17 A5 A0                                lda addra             ;bits 0-15
   4077 8B19 C5 A4                                cmp addrb             ;condition flags
   4078 8B1B E2 20                    +            .byte $e2,$20
                                        
   4079 8B1D 90 01                                bcc incaddra          ;increment
                                        ;
   4081 8B1F 60                         .0000010 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;incaddra: INCREMENT WORKING ADDRESS 'A'
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Calling syntax: JSR INCADDRA
                                        ;
                                        ;	Exit registers: .A: entry value
                                        ;	                .B: entry value
                                        ;	                .X: entry value
                                        ;	                .Y: entry value
                                        ;	                DB: entry value
                                        ;	                DP: entry value
                                        ;	                PB: entry value
                                        ;	                SR: NVmxDIZC
                                        ;	                    ||||||||
                                        ;	                    ++++++++———> entry value
                                        ;	——————————————————————————————————————————————————
                                        ;
   4102 8B20 08                         incaddra php
   4103 8B21 C2 20                    +            .byte $c2,$20
                                        
   4104 8B23 E6 A0                                inc addra             ;bump bits 0-15
   4105 8B25 D0 04                                bne .0000010
                                        ;
   4107 8B27 E2 20                    +            .byte $e2,$20
                                        
   4108 8B29 E6 A2                                inc addra+s_word      ;bump bits 16-23
                                        ;
   4110 8B2B 28                         .0000010 plp
   4111 8B2C 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;incoper: INCREMENT OPERAND ADDRESS
                                        ;
   4117 8B2D 18                         incoper  clc
   4118 8B2E 08                                   php
   4119 8B2F C2 30                    +            .byte $c2,$30
                                        
   4120 8B31 48                                   pha
   4121 8B32 E6 BB                                inc operand           ;handle base address
   4122 8B34 D0 06                                bne .0000010
                                        ;              
   4124 8B36 E2 20                    +            .byte $e2,$20
                                        
   4125 8B38 E6 BD                                inc operand+s_word    ;handle bank
   4126 8B3A C2 20                    +            .byte $c2,$20
                                        
                                        ;
   4128 8B3C 68                         .0000010 pla
   4129 8B3D 28                                   plp
   4130 8B3E 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;instdata: GET INSTRUCTION SIZE & ADDRESSING MODE DATA
                                        ;
                                        ;	——————————————————————————————————
                                        ;	Preparatory Ops: .X: 65C816 opcode
                                        ;
                                        ;	Returned Values: .A: mode flags
                                        ;	                 .X: operand size
                                        ;	                 .Y: mode index
                                        ;	——————————————————————————————————
                                        ;
   4144 8B3F E2 30                      instdata +         .byte $e2,$30
                                        
   4145 8B41 BD BB 8E                             lda mnetabam,x        ;addressing mode data
   4146 8B44 48                                   pha                   ;save mode flag bits
   4147 8B45 48                                   pha                   ;save size data
   4148 8B46 29 0F                                and #amodmask         ;extract mode index &...
   4149 8B48 A8                                   tay                   ;save
   4150 8B49 68                                   pla                   ;recover data
   4151 8B4A 29 30                                and #opsmask          ;mask mode fields &...
                                        ;         .rept n_opslsr        ;extract operand size
   4153 8B4C 4A                                     lsr
   4154 8B4D 4A                                     lsr
   4155 8B4E 4A                                     lsr
   4156 8B4F 4A                                     lsr
                                        ;         .endr
   4158 8B50 AA                                   tax                   ;operand size
   4159 8B51 68                                   pla                   ;recover mode flags
   4160 8B52 29 C0                                and #vopsmask         ;discard mode & size fields
   4161 8B54 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;offtarg: CONVERT BRANCH OFFSET TO TARGET ADDRESS
                                        ;
                                        ;	———————————————————————————————————————————————
                                        ;	Preparatory Ops:    ADDRA: base address
                                        ;	                 INSTSIZE: instruction size
                                        ;	                  OPERAND: offset
                                        ;
                                        ;	Returned Values:  OPERAND: target address (L/H)
                                        ;	                       .A: used
                                        ;	                       .X: entry value
                                        ;                              .Y: entry value
                                        ;	———————————————————————————————————————————————
                                        ;
   4178 8B55 C2 20                      offtarg +         .byte $c2,$20
                                        
   4179 8B57 A5 A0                                lda addra             ;base address
   4180 8B59 E2 20                    +            .byte $e2,$20
                                        
   4181 8B5B 46 C6                                lsr instsize          ;bit 0 will be set if...
   4182 8B5D B0 07                                bcs .0000010          ;a long branch
                                        ;
   4184 8B5F 24 BB                                bit operand           ;short forward or backward?
   4185 8B61 10 03                                bpl .0000010          ;forward
                                        ;
   4187 8B63 EB                       +            .byte $eb
                                                           ;expose address MSB
   4188 8B64 3A                                   dea                   ;back a page
   4189 8B65 EB                       +            .byte $eb
                                                           ;expose address LSB
                                        ;
   4191 8B66 C2 20                      .0000010 +         .byte $c2,$20
                                        
   4192 8B68 18                                   clc
   4193 8B69 65 BB                                adc operand           ;calculate target address
   4194 8B6B 85 BB                                sta operand           ;new operand
   4195 8B6D E2 20                    +            .byte $e2,$20
                                        
   4196 8B6F A9 03                                lda #s_xword
   4197 8B71 85 C6                                sta instsize          ;effective instruction size
   4198 8B73 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;setxaddr: SET EXECUTION ADDRESS
                                        ;
   4204 8B74 B0 13                      setxaddr bcs .0000010          ;no address given
                                        ;
   4206 8B76 20 CF 8A                             jsr facasize          ;check address...
   4207 8B79 C9 04                                cmp #s_dword          ;range
   4208 8B7B B0 0D                                bcs .0000020          ;out of range
                                        ;
   4210 8B7D C2 20                    +            .byte $c2,$20
                                        
   4211 8B7F A5 A7                                lda faca              ;execution address
   4212 8B81 85 86                                sta reg_pcx           ;set new PC value
   4213 8B83 E2 20                    +            .byte $e2,$20
                                        
   4214 8B85 A5 A9                                lda faca+s_word
   4215 8B87 85 88                                sta reg_pbx           ;set new PB value
                                        ;
   4217 8B89 18                         .0000010 clc                   ;no error
                                        ;
   4219 8B8A 60                         .0000020 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;targoff: CONVERT BRANCH TARGET ADDRESS TO BRANCH OFFSET                   
                                        ;
                                        ;	—————————————————————————————————————————————————
                                        ;	Preparatory Ops:   ADDRA: instruction address
                                        ;	                 OPERAND: target address
                                        ;
                                        ;	Returned Values: OPERAND: computed offset
                                        ;	                      .A: effective operand size
                                        ;	                      .X: entry value
                                        ;                             .Y: entry value
                                        ;	                      .C: 1 = branch out of range
                                        ;
                                        ;	Execution notes: ADDRB is set to the branch base
                                        ;	                 address.
                                        ;	—————————————————————————————————————————————————
                                        ;
   4239 8B8B 64 C7                      targoff  stz instsize+s_byte   ;always zero
   4240 8B8D A5 C6                                lda instsize          ;instruction size will tell...
   4241 8B8F 4A                                   lsr                   ;if long or short branch
                                        ;
                                        ;—————————————————————————————————————————————————
   4451 = 000000BA                      .btype   =facc+5               ;branch type flag
                                        ;—————————————————————————————————————————————————
                                        ;
   4247 8B90 66 BA                                ror .btype            ;set branch type...
                                        ;
                                        ;	x0000000
                                        ;	|
                                        ;	+——————————> 0: short
                                        ;	             1: long
                                        ;
   4254 8B92 C2 20                    +            .byte $c2,$20
                                        
   4255 8B94 18                                   clc
   4256 8B95 A5 A0                                lda addra             ;instruction address
   4257 8B97 65 C6                                adc instsize          ;instruction size
   4258 8B99 85 A4                                sta addrb             ;base address
   4259 8B9B 38                                   sec
   4260 8B9C A5 BB                                lda operand           ;target address
   4261 8B9E E5 A4                                sbc addrb             ;base address
   4262 8BA0 85 BB                                sta operand           ;offset
   4263 8BA2 E2 20                    +            .byte $e2,$20
                                        
   4264 8BA4 90 15                                bcc .0000040          ;backward branch
                                        ;
   4266 8BA6 24 BA                                bit .btype            ;check branch range
   4267 8BA8 30 0A                                bmi .0000020          ;long
                                        ;
                                        ;
                                        ;	process short forward branch...
                                        ;
   4272 8BAA EB                       +            .byte $eb
                                                           ;offset MSB should be zero
   4273 8BAB D0 21                                bne .0000060          ;it isn't — out of range
                                        ;
   4275 8BAD EB                       +            .byte $eb
                                                           ;offset LSB should be $00-$7F
   4276 8BAE 30 1E                                bmi .0000060          ;it isn't — out of range
                                        ;
   4278 8BB0 A9 01                      .0000010 lda #s_byte           ;final instruction size
   4279 8BB2 18                                   clc                   ;branch in range
   4280 8BB3 60                                   rts
                                        ;
                                        ;
                                        ;	process long forward branch...
                                        ;
   4285 8BB4 EB                         .0000020 +         .byte $eb
                                                           ;offset MSB should be positive
   4286 8BB5 30 17                                bmi .0000060          ;it isn't — branch out of range
                                        ;
   4288 8BB7 A9 02                      .0000030 lda #s_word
   4289 8BB9 18                                   clc
   4290 8BBA 60                                   rts
                                        ;
                                        ;
                                        ;	process backward branch...
                                        ;
   4295 8BBB 24 BA                      .0000040 bit .btype            ;long or short?
   4296 8BBD 30 0C                                bmi .0000050          ;long
                                        ;
                                        ;
                                        ;	process short backward branch...
                                        ;
   4301 8BBF EB                       +            .byte $eb
                                                           ;offset MSB should be negative
   4302 8BC0 10 0C                                bpl .0000060          ;it isn't — out of range
                                        ;
   4304 8BC2 49 FF                                eor #%11111111        ;complement offset MSB 2s 
   4305 8BC4 D0 08                                bne .0000060          ;out of range
                                        ;
   4307 8BC6 EB                       +            .byte $eb
                                                           ;offset LSB should be $80-$FF
   4308 8BC7 30 E7                                bmi .0000010          ;it is — branch in range
                                        ;
   4310 8BC9 80 03                                bra .0000060          ;branch out of range
                                        ;
                                        ;
                                        ;	process long backward branch...
                                        ;
   4315 8BCB EB                         .0000050 +         .byte $eb
                                                           ;offset MSB should be negative
   4316 8BCC 30 E9                                bmi .0000030          ;it is — branch in range
                                        ;
   4318 8BCE 38                         .0000060 sec                   ;range error
   4319 8BCF 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getcharr: GET PREVIOUS INPUT BUFFER CHARACTER
                                        ;
   4325 8BD0 C6 BF                      getcharr dec ibufidx           ;move back a char
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getchar: GET A CHARACTER FROM INPUT BUFFER
                                        ;
                                        ;	——————————————————————————————————————————————
                                        ;	Preparatory Ops : none
                                        ;
                                        ;	Register Returns: .A: character or <NUL>
                                        ;	                  .B: entry value
                                        ;	                  .X: entry value
                                        ;	                  .Y: entry value
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> entry value
                                        ;	           ||||||+————> 1: <NUL> gotten
                                        ;	           |||||+—————> entry value
                                        ;	           ||||+——————> entry value
                                        ;	           |||+———————> entry value
                                        ;	           ||+————————> entry value
                                        ;	           |+—————————> not defined
                                        ;	           +——————————> not defined
                                        ;	——————————————————————————————————————————————
                                        ;
   4351 8BD2 DA                         getchar  phx
   4352 8BD3 5A                                   phy
   4353 8BD4 08                                   php                   ;save register sizes
   4354 8BD5 E2 30                    +            .byte $e2,$30
                                                        ;force 8 bits
   4355 8BD7 A6 BF                                ldx ibufidx           ;buffer index
   4356 8BD9 BD 00 02                             lda ibuffer,x         ;get char
   4357 8BDC E6 BF                                inc ibufidx           ;bump index
   4358 8BDE 28                                   plp                   ;restore register widths
   4359 8BDF 7A                                   ply
   4360 8BE0 FA                                   plx
                                        ; Changed the following to XBA instruction which seems to work as well.
                                        ; XBA doesn't access the stack memory saving a data memory access,
                                        ; and hence is faster.
   4364 8BE1 EB                       +            .byte $eb
                                        		;	pha                   ;condition...
   4365 8BE2 EB                       +            .byte $eb
                                        		;   pla                   ;.Z
   4366 8BE3 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getpat: GET PATTERN FOR MEMORY CHANGE or SEARCH
                                        ;
                                        ;	—————————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated pattern in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: used
                                        ;	                 .Y: pattern length if entered
                                        ;	                 .C: 0 = pattern valid
                                        ;	                     1 = exception:
                                        ;	                 .N  0 = no pattern entered
                                        ;	                     1 = evaluation error
                                        ;
                                        ;	Notes: 1) If pattern is preceded by "'" the following
                                        ;	          characters are interpreted as ASCII.
                                        ;	       2) A maximum of 32 bytes or characters is
                                        ;	          accepted.  Excess input will be discarded.
                                        ;	—————————————————————————————————————————————————————
                                        ;
   4389 8BE4 64 CB                      getpat   stz status            ;clear pattern type indicator
   4390 8BE6 A0 00                                ldy #0                ;pattern index
   4391 8BE8 20 D0 8B                             jsr getcharr          ;get last char
   4392 8BEB F0 3C                                beq .0000070          ;EOS
                                        ;
   4394 8BED A6 BF                                ldx ibufidx           ;current buffer index
   4395 8BEF 20 30 8C                             jsr getcharw          ;get next
   4396 8BF2 F0 35                                beq .0000070          ;EOS
                                        ;
   4398 8BF4 C9 27                                cmp #''''			; *** watch syntax here, the following line of code was omitted when only ''' was present
   4399 8BF6 D0 04                                bne .0000010          ;not ASCII input
                                        ;
   4401 8BF8 66 CB                                ror status            ;condition flag
   4402 8BFA 80 12                                bra .0000030          ;balance of input is ASCII
                                        ;
   4404 8BFC 86 BF                      .0000010 stx ibufidx           ;restore buffer index
                                        ;
   4406 8BFE 20 E3 8A                   .0000020 jsr getparm           ;evaluate numeric pattern
   4407 8C01 B0 21                                bcs .0000060          ;done w/pattern
                                        ;
   4409 8C03 20 CF 8A                             jsr facasize          ;size
   4410 8C06 C9 02                                cmp #s_word
   4411 8C08 B0 1F                                bcs .0000070          ;not a byte — error
                                        ;
   4413 8C0A A5 A7                                lda faca              ;get byte &...
   4414 8C0C 80 05                                bra .0000040          ;store
                                        ;
   4416 8C0E 20 D2 8B                   .0000030 jsr getchar           ;get ASCII char
   4417 8C11 F0 11                                beq .0000060          ;done w/pattern
                                        ;
   4419 8C13 C0 20                      .0000040 cpy #s_auxbuf         ;pattern buffer full?
   4420 8C15 F0 0A                                beq .0000050          ;yes
                                        ;
   4422 8C17 99 51 02                             sta auxbuf,y          ;store pattern
   4423 8C1A C8                                   iny
   4424 8C1B 24 CB                                bit status
   4425 8C1D 10 DF                                bpl .0000020          ;get next numeric value
                                        ;
   4427 8C1F 80 ED                                bra .0000030          ;get next ASCII char
                                        ;
   4429 8C21 20 11 88                   .0000050 jsr alert             ;excess input
                                        ;
   4431 8C24 84 BE                      .0000060 sty auxbufix          ;save pattern size
   4432 8C26 98                                   tya                   ;condition .Z
   4433 8C27 18                                   clc                   ;pattern valid
   4434 8C28 60                                   rts
                                        ;
                                        ;
                                        ;	no pattern entered...
                                        ;
   4439 8C29 C2 80                      .0000070 +         .byte $c2,%10000000
                                        
   4440 8C2B 38                                   sec
   4441 8C2C 60                                   rts
                                        ;
                                        ;
                                        ;	evaluation error...
                                        ;
   4446 8C2D E2 81                      .0000080 +         .byte $e2,%10000001
                                        
   4447 8C2F 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getcharw: GET FROM INPUT BUFFER, DISCARDING WHITESPACE
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated input in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: char or null
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .Z: 1 = null terminator detected
                                        ;
                                        ;	Notes: Whitespace is defined as a blank ($20) or a
                                        ;	       horizontal tab ($09).
                                        ;	——————————————————————————————————————————————————
                                        ;
   4465 8C30 20 D2 8B                   getcharw jsr getchar           ;get from buffer
   4466 8C33 F0 08                                beq .0000010          ;EOI
                                        ;
   4468 8C35 C9 20                                cmp #' '
   4469 8C37 F0 F7                                beq getcharw          ;discard whitespace
                                        ;
   4471 8C39 C9 09                                cmp #a_ht             ;also whitespace
   4472 8C3B F0 F3                                beq getcharw
                                        ;
   4474 8C3D 18                         .0000010 clc
   4475 8C3E 60                                   rts  
                                        ;
                                        ;================================================================================
                                        ;
                                        ;input: INTERACTIVE INPUT FROM CONSOLE CHANNEL
                                        ;
                                        ;	———————————————————————————————————————————————————————————
                                        ;	Preparatory Ops: Zero IBUFIDX or load IBUFFER with default
                                        ;	                 input & set IBUFIDX to the number of chars
                                        ;	                 loaded into the buffer.
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: characters entered
                                        ;	                 .Y: used
                                        ;
                                        ;	Example: STZ IBUFIDX
                                        ;	         JSR INPUT
                                        ;
                                        ;	Notes: Input is collected in IBUFFER & is null-terminated.
                                        ;	       IBUFIDX is reset to zero upon exit.
                                        ;	———————————————————————————————————————————————————————————
                                        ;
   4497 8C3F                            input:
   4498 8C3F A6 BF                       	    ldx ibufidx
   4499 8C41 9E 00 02                             stz ibuffer,x         ;be sure buffer is terminated
   4500 8C44 20 72 87                             jsr dpyibuf           ;print default input if any
   4501 8C47 F4                       +            .byte $f4
   4501 8C48 18 90                    +            .word dc_cn
                                        
   4502 8C4A 20 1D 88                             jsr sprint            ;enable cursor
   4503 8C4D A6 BF                                ldx ibufidx           ;starting buffer index
                                        ;
                                        ;
                                        ;	main input loop...
                                        ;
   4508 8C4F                               .0000010 CPU FT832
   4509 008C4F 42 20 00 FE FC               		 jcr getcha,biosctx            ;poll for input
                                        		 CPU	W65C02
   4511 8C54 90 02                                bcc .0000020          ;got something
                                        ;
                                        ;         jsr	$F409          ;wait 'til any IRQ &... (Reschedule tasks)
   4514 8C56 80 F7                                bra .0000010          ;try again
                                        ;
   4516 8C58                            .0000020
   4517 8C58 C9 7F                       		cmp #a_del            ;above ASCII range?
   4518 8C5A B0 F3                                bcs .0000010          ;yes, ignore
                                        ;
   4520 8C5C C9 09                                cmp #a_ht             ;horizontal tab?
   4521 8C5E D0 02                                bne .0000030          ;no
                                        ;
   4523 8C60 A9 20                                lda #a_blank          ;replace <HT> w/blank
                                        ;
   4525 8C62 C9 20                      .0000030 cmp #a_blank          ;control char?
   4526 8C64 90 12                                bcc .0000050          ;yes
                                        ;
                                        ;
                                        ;	process QWERTY character...
                                        ;
   4531 8C66 E0 50                                cpx #s_ibuf           ;room in buffer?
   4532 8C68 B0 05                                bcs .0000040          ;no
                                        ;
   4534 8C6A 9D 00 02                             sta ibuffer,x         ;store char
   4535 8C6D E8                                   inx                   ;bump index
   4536 8C6E 2C                                   .byte bitabs          ;echo char
                                        ;
   4538 8C6F A9 07                      .0000040 lda #a_bel            ;alert user
                                           		 cpu FT832
   4540 008C71 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   4542 8C76 80 D7                                bra .0000010          ;get some more
                                        ;
                                        ;
                                        ;	process carriage return...
                                        ;
   4547 8C78 C9 0D                      .0000050 cmp #a_cr             ;carriage return?
   4548 8C7A D0 0E                                bne .0000060          ;no
                                        ;
   4550 8C7C DA                                   phx                   ;protect input count
   4551 8C7D F4                       +            .byte $f4
   4551 8C7E 1C 90                    +            .word dc_co
                                        
   4552 8C80 20 1D 88                             jsr sprint            ;cursor off
   4553 8C83 FA                                   plx                   ;recover input count
   4554 8C84 9E 00 02                             stz ibuffer,x         ;terminate input &...
   4555 8C87 64 BF                                stz ibufidx           ;reset buffer index
   4556 8C89 60                                   rts                   ;done
                                        ;
                                        ;
                                        ;	process backspace...
                                        ;
   4561 8C8A C9 08                      .0000060 cmp #a_bs             ;backspace?
   4562 8C8C D0 C1                                bne .0000010          ;no
                                        ;
   4564 8C8E 8A                                   txa
   4565 8C8F F0 BE                                beq .0000010          ;no input, ignore <BS>
                                        ;
   4567 8C91 CA                                   dex                   ;1 less char
   4568 8C92 DA                                   phx                   ;preserve count
   4569 8C93 20 C5 87                             jsr gendbs            ;destructive backspace
   4570 8C96 FA                                   plx                   ;restore count
   4571 8C97 80 B6                                bra .0000010          ;get more input
                                        ;
                                        ;================================================================================
                                        ;
                                        ;lodbnk: LOAD SOURCE & DESTINATION BANKS
                                        ;
   4577 8C99 E2 20                      lodbnk +         .byte $e2,$20
                                        
   4578 8C9B A5 BD                                lda operand+s_word    ;destination bank
   4579 8C9D EB                       +            .byte $eb
                                                           ;make it MSB
   4580 8C9E A5 A2                                lda addra+s_word      ;source bank is LSB
   4581 8CA0 60                                   rts
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;getcharc: GET A CHARACTER FROM INPUT BUFFER & CONVERT CASE
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated input in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: char or null
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .Z: 1 = null terminator detected
                                        ;	——————————————————————————————————————————————————
                                        ;
   4596 8CA1 20 D2 8B                   getcharc jsr getchar           ;get from buffer
   4597 8CA4 F0 0C                                beq touppera          ;just return
                                        ;
                                        ;================================================================================
                                        ;
                                        ;toupper: FORCE CHARACTER TO UPPER CASE
                                        ;
                                        ;	————————————————————————————————————————————————
                                        ;	Preparatory Ops : .A: character to convert
                                        ;
                                        ;	Register Returns: .A: converted character
                                        ;	                  .B: entry value
                                        ;	                  .X: entry value
                                        ;	                  .Y: entry value
                                        ;
                                        ;	MPU Flags: no change
                                        ;
                                        ;	Notes: 1) This subroutine has no effect on char-
                                        ;	          acters that are not alpha.
                                        ;	————————————————————————————————————————————————
                                        ;
   4617 8CA6 08                         toupper  php                   ;protect flags
   4618 8CA7 C9 61                                cmp #a_asclcl         ;check char range
   4619 8CA9 90 06                                bcc .0000010          ;not LC alpha
                                        ;
   4621 8CAB C9 7B                                cmp #a_asclch+s_byte
   4622 8CAD B0 02                                bcs .0000010          ;not LC alpha
                                        ;
   4624 8CAF 29 5F                                and #a_lctouc         ;force to UC
                                        ;
   4626 8CB1 28                         .0000010 plp                   ;restore flags
                                        ;
   4628 8CB2 60                         touppera rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;teststop: TEST FOR STOP KEY
                                        ;
                                        ;	——————————————————————————————————————————————
                                        ;	Preparatory Ops: none
                                        ;
                                        ;	Returned Values: .A: detected keypress, if any
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> 0: normal key detected
                                        ;	           |||||||      1: <STOP> detected
                                        ;	           +++++++————> not defined
                                        ;
                                        ;	Example: jsr teststop
                                        ;	         bcs stopped
                                        ;
                                        ;	Notes: The symbol STOPKEY defines the ASCII
                                        ;	       value of the "stop key."
                                        ;	——————————————————————————————————————————————
                                        ;
   4654 8CB3                            teststop 
                                            		CPU	TF832
   4656 000008CB3                           		jcr getcha,biosctx            ;poll console
                                        		CPU	W65C02
   4658 8CB3 B0 04                                bcs .0000010          ;no input
                                        ;
   4660 8CB5 C9 03                                cmp #stopkey          ;stop key pressed?
   4661 8CB7 F0 01                                beq .0000020          ;yes
                                        ;
   4663 8CB9 18                         .0000010 clc
                                        ;
   4665 8CBA 60                         .0000020 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;COMMAND PROCESSING DATA TABLES
                                        ;
                                        ;
                                        ;	monitor commands...
                                        ;
   4674 8CBB 41                         mpctab   .byte "A"             ;assemble code
   4675 8CBC 43                                   .byte "C"             ;compare memory ranges
   4676 8CBD 44                                   .byte "D"             ;disassemble code
   4677 8CBE 46                                   .byte "F"             ;fill memory
   4678 8CBF 47                                   .byte "G"             ;execute code
   4679 8CC0 48                                   .byte "H"             ;search memory
   4680 8CC1 4A                                   .byte "J"             ;execute code as subroutine
   4681 8CC2 4D                                   .byte "M"             ;dump memory range
   4682 8CC3 52                                   .byte "R"             ;dump registers
   4683 8CC4 54                                   .byte "T"             ;copy memory range
   4684 8CC5 58                                   .byte "X"             ;exit from monitor
   4685 8CC6 3E                                   .byte ">"             ;change memory
   4686 8CC7 3B                                   .byte ";"             ;change registers
   4913 = 0000000D                      n_mpctab =*-mpctab             ;entries in above table
                                        ;
                                        ;
                                        ;	monitor command jump table...
                                        ;
   4692 8CC8 6B 81                      mpcextab .word monasc-s_byte   ; A  assemble code
   4693 8CCA 2F 84                                .word moncmp-s_byte   ; C  compare memory ranges
   4694 8CCC 49 83                                .word mondsc-s_byte   ; D  disassemble code
   4695 8CCE 00 85                                .word monfil-s_byte   ; F  fill memory
   4696 8CD0 9D 83                                .word monjmp-s_byte   ; G  execute code
   4697 8CD2 66 85                                .word monhnt-s_byte   ; H  search memory
   4698 8CD4 CE 83                                .word monjsr-s_byte   ; J  execute code as subroutine
   4699 8CD6 AE 84                                .word mondmp-s_byte   ; M  dump memory range
   4700 8CD8 7E 80                                .word monreg-s_byte   ; R  dump registers
   4701 8CDA 5D 84                                .word moncpy-s_byte   ; T  copy memory range
   4702 8CDC 17 86                                .word monxit-s_byte   ; X  exit from monitor
   4703 8CDE 04 84                                .word monchm-s_byte   ; >  change memory
   4704 8CE0 DC 85                                .word monchr-s_byte   ; ;  change registers
                                        ;
                                        ;
                                        ;	number conversion...
                                        ;        
   4709 8CE2 10 0A 08 02                basetab  .byte 16,10,8,2       ;supported number bases
   4710 8CE6 04 03 03 01                bitsdtab .byte 4,3,3,1         ;bits per binary digit
   4711 8CEA 04 04 03 01                bitsntab .byte 4,4,3,1         ;bits per ASCII character
   4712 8CEE 03 02 09 02                lzsttab  .byte 3,2,9,2         ;leading zero suppression thresholds
   4713 8CF2 0C 0C 10 30                numstab  .byte 12,12,16,48     ;bin to ASCII conversion numerals
   4714 8CF6 24                         radxtab  .byte c_hex           ;hexadecimal radix
   4715 8CF7 2B                                   .byte c_dec           ;decimal radix
   4716 8CF8 40                                   .byte c_oct           ;octal radix
   4717 8CF9 25                                   .byte c_bin           ;binary radix
   4944 = 00000004                      n_radix  =*-radxtab            ;number of recognized radices
                                        ;
                                        ;
                                        ;	shadow MPU register sizes...
                                        ;
   4723 8CFA 02                         rcvltab  .byte s_mpupbx+s_byte ; PB
   4724 8CFB 03                                   .byte s_mpupcx+s_byte ; PC
   4725 8CFC 02                                   .byte s_mpusrx+s_byte ; SR
   4726 8CFD 03                                   .byte s_word+s_byte   ; .C
   4727 8CFE 03                                   .byte s_word+s_byte   ; .X
   4728 8CFF 03                                   .byte s_word+s_byte   ; .Y
   4729 8D00 03                                   .byte s_mpuspx+s_byte ; SP
   4730 8D01 03                                   .byte s_mpudpx+s_byte ; DP
   4731 8D02 02                                   .byte s_mpudbx+s_byte ; DB
   4958 = 00000009                      n_regchv =*-rcvltab            ;total shadow registers
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASSEMBLER/DISASSEMBLER DATA TABLES
                                        ;
                                        ;
                                        ;	numerically sorted & encoded W65C816S mnemonics...
                                        ;
   4741 8D03 F2 10                      mnetab   .word mne_xba         ;  0 — XBA
   4742 8D05 5A 11                                .word mne_lda         ;  1 — LDA
   4743 8D07 A2 11                                .word mne_pea         ;  2 — PEA
   4744 8D09 62 12                                .word mne_pha         ;  3 — PHA
   4745 8D0B 62 13                                .word mne_pla         ;  4 — PLA
   4746 8D0D C6 14                                .word mne_bra         ;  5 — BRA
   4747 8D0F E0 14                                .word mne_ora         ;  6 — ORA
   4748 8D11 68 15                                .word mne_sta         ;  7 — STA
   4749 8D13 6A 16                                .word mne_txa         ;  8 — TXA
   4750 8D15 AA 16                                .word mne_tya         ;  9 — TYA
   4751 8D17 62 1A                                .word mne_phb         ; 10 — PHB
   4752 8D19 62 1B                                .word mne_plb         ; 11 — PLB
   4753 8D1B EA 1C                                .word mne_trb         ; 12 — TRB
   4754 8D1D 2A 1D                                .word mne_tsb         ; 13 — TSB
   4755 8D1F E8 20                                .word mne_sbc         ; 14 — SBC
   4756 8D21 06 21                                .word mne_bcc         ; 15 — BCC
   4757 8D23 44 21                                .word mne_adc         ; 16 — ADC
   4758 8D25 6A 21                                .word mne_tdc         ; 17 — TDC
   4759 8D27 8A 21                                .word mne_dec         ; 18 — DEC
   4760 8D29 A8 21                                .word mne_sec         ; 19 — SEC
   4761 8D2B 48 23                                .word mne_clc         ; 20 — CLC
   4762 8D2D D4 23                                .word mne_inc         ; 21 — INC
   4763 8D2F 2A 25                                .word mne_tsc         ; 22 — TSC
   4764 8D31 C6 25                                .word mne_bvc         ; 23 — BVC
   4765 8D33 2A 29                                .word mne_tcd         ; 24 — TCD
   4766 8D35 A8 29                                .word mne_sed         ; 25 — SED
   4767 8D37 62 2A                                .word mne_phd         ; 26 — PHD
   4768 8D39 48 2B                                .word mne_cld         ; 27 — CLD
   4769 8D3B 62 2B                                .word mne_pld         ; 28 — PLD
   4770 8D3D C4 2B                                .word mne_and         ; 29 — AND
   4771 8D3F 32 31                                .word mne_xce         ; 30 — XCE
   4772 8D41 C6 33                                .word mne_bne         ; 31 — BNE
   4773 8D43 B0 50                                .word mne_wai         ; 32 — WAI
   4774 8D45 A2 51                                .word mne_pei         ; 33 — PEI
   4775 8D47 A8 51                                .word mne_sei         ; 34 — SEI
   4776 8D49 48 53                                .word mne_cli         ; 35 — CLI
   4777 8D4B 86 53                                .word mne_bmi         ; 36 — BMI
   4778 8D4D 66 55                                .word mne_rti         ; 37 — RTI
   4779 8D4F 62 62                                .word mne_phk         ; 38 — PHK
   4780 8D51 C6 64                                .word mne_brk         ; 39 — BRK
   4781 8D53 96 6B                                .word mne_jml         ; 40 — JML
   4782 8D55 26 6C                                .word mne_rol         ; 41 — ROL
   4783 8D57 46 6C                                .word mne_bpl         ; 42 — BPL
   4784 8D59 C6 6C                                .word mne_brl         ; 43 — BRL
   4785 8D5B 04 6D                                .word mne_asl         ; 44 — ASL
   4786 8D5D 16 6D                                .word mne_jsl         ; 45 — JSL
   4787 8D5F 66 6D                                .word mne_rtl         ; 46 — RTL
   4788 8D61 70 71                                .word mne_wdm         ; 47 — WDM
   4789 8D63 DC 7D                                .word mne_mvn         ; 48 — MVN
   4790 8D65 A6 89                                .word mne_rep         ; 49 — REP
   4791 8D67 A8 89                                .word mne_sep         ; 50 — SEP
   4792 8D69 62 8A                                .word mne_php         ; 51 — PHP
   4793 8D6B 62 8B                                .word mne_plp         ; 52 — PLP
   4794 8D6D 88 8B                                .word mne_cmp         ; 53 — CMP
   4795 8D6F 96 8B                                .word mne_jmp         ; 54 — JMP
   4796 8D71 08 8C                                .word mne_cop         ; 55 — COP
   4797 8D73 1E 8C                                .word mne_nop         ; 56 — NOP
   4798 8D75 68 8D                                .word mne_stp         ; 57 — STP
   4799 8D77 DC 8D                                .word mne_mvp         ; 58 — MVP
   4800 8D79 86 91                                .word mne_beq         ; 59 — BEQ
   4801 8D7B A2 99                                .word mne_per         ; 60 — PER
   4802 8D7D 0C 9C                                .word mne_eor         ; 61 — EOR
   4803 8D7F 26 9C                                .word mne_ror         ; 62 — ROR
   4804 8D81 16 9D                                .word mne_jsr         ; 63 — JSR
   4805 8D83 1A 9D                                .word mne_lsr         ; 64 — LSR
   4806 8D85 06 A1                                .word mne_bcs         ; 65 — BCS
   4807 8D87 2A A1                                .word mne_tcs         ; 66 — TCS
   4808 8D89 66 A5                                .word mne_rts         ; 67 — RTS
   4809 8D8B C6 A5                                .word mne_bvs         ; 68 — BVS
   4810 8D8D 6A A6                                .word mne_txs         ; 69 — TXS
   4811 8D8F 86 AA                                .word mne_bit         ; 70 — BIT
   4812 8D91 48 BB                                .word mne_clv         ; 71 — CLV
   4813 8D93 AA C8                                .word mne_tax         ; 72 — TAX
   4814 8D95 5A C9                                .word mne_ldx         ; 73 — LDX
   4815 8D97 8A C9                                .word mne_dex         ; 74 — DEX
   4816 8D99 62 CA                                .word mne_phx         ; 75 — PHX
   4817 8D9B 62 CB                                .word mne_plx         ; 76 — PLX
   4818 8D9D D4 CB                                .word mne_inx         ; 77 — INX
   4819 8D9F 48 CC                                .word mne_cpx         ; 78 — CPX
   4820 8DA1 2A CD                                .word mne_tsx         ; 79 — TSX
   4821 8DA3 68 CD                                .word mne_stx         ; 80 — STX
   4822 8DA5 AA CE                                .word mne_tyx         ; 81 — TYX
   4823 8DA7 AA D0                                .word mne_tay         ; 82 — TAY
   4824 8DA9 5A D1                                .word mne_ldy         ; 83 — LDY
   4825 8DAB 8A D1                                .word mne_dey         ; 84 — DEY
   4826 8DAD 62 D2                                .word mne_phy         ; 85 — PHY
   4827 8DAF 62 D3                                .word mne_ply         ; 86 — PLY
   4828 8DB1 D4 D3                                .word mne_iny         ; 87 — INY
   4829 8DB3 48 D4                                .word mne_cpy         ; 88 — CPY
   4830 8DB5 68 D5                                .word mne_sty         ; 89 — STY
   4831 8DB7 6A D6                                .word mne_txy         ; 90 — TXY
   4832 8DB9 68 DD                                .word mne_stz         ; 91 — STZ
                                        ;
   5060 = 000000B8                      s_mnetab =*-mnetab             ;mnemonic table size
   5061 = 0000005C                      n_mnemon =s_mnetab/s_word      ;total mnemonics
                                        ;
                                        ;
                                        ;	mnemonic lookup indices in opcode order...
                                        ;
   4840 8DBB 27                         mnetabix .byte mne_brkx        ; $00  BRK
   4841 8DBC 06                                   .byte mne_orax        ; $01  ORA (dp,X)
   4842 8DBD 37                                   .byte mne_copx        ; $02  COP
   4843 8DBE 06                                   .byte mne_orax        ; $03  ORA offset,S
   4844 8DBF 0D                                   .byte mne_tsbx        ; $04  TSB dp
   4845 8DC0 06                                   .byte mne_orax        ; $05  ORA dp
   4846 8DC1 2C                                   .byte mne_aslx        ; $06  ASL dp
   4847 8DC2 06                                   .byte mne_orax        ; $07  ORA [dp]
   4848 8DC3 33                                   .byte mne_phpx        ; $08  PHP
   4849 8DC4 06                                   .byte mne_orax        ; $09  ORA #
   4850 8DC5 2C                                   .byte mne_aslx        ; $0A  ASL A
   4851 8DC6 1A                                   .byte mne_phdx        ; $0B  PHD
   4852 8DC7 0D                                   .byte mne_tsbx        ; $0C  TSB abs
   4853 8DC8 06                                   .byte mne_orax        ; $0D  ORA abs
   4854 8DC9 2C                                   .byte mne_aslx        ; $0E  ASL abs
   4855 8DCA 06                                   .byte mne_orax        ; $0F  ORA absl
                                        ;
   4857 8DCB 2A                                   .byte mne_bplx        ; $10  BPL abs
   4858 8DCC 06                                   .byte mne_orax        ; $11  ORA (dp),Y
   4859 8DCD 06                                   .byte mne_orax        ; $12  ORA (dp)
   4860 8DCE 06                                   .byte mne_orax        ; $13  ORA (offset,S),Y
   4861 8DCF 0C                                   .byte mne_trbx        ; $14  TRB dp
   4862 8DD0 06                                   .byte mne_orax        ; $15  ORA dp,X
   4863 8DD1 2C                                   .byte mne_aslx        ; $16  ASL dp,X
   4864 8DD2 06                                   .byte mne_orax        ; $17  ORA [dp],Y
   4865 8DD3 14                                   .byte mne_clcx        ; $18  CLC
   4866 8DD4 06                                   .byte mne_orax        ; $19  ORA abs
   4867 8DD5 15                                   .byte mne_incx        ; $1A  INC A
   4868 8DD6 42                                   .byte mne_tcsx        ; $1B  TCS
   4869 8DD7 0C                                   .byte mne_trbx        ; $1C  TRB abs
   4870 8DD8 06                                   .byte mne_orax        ; $1D  ORA abs,X
   4871 8DD9 2C                                   .byte mne_aslx        ; $1E  ASL abs,X
   4872 8DDA 06                                   .byte mne_orax        ; $1F  ORA absl,X
                                        ;
   4874 8DDB 3F                                   .byte mne_jsrx        ; $20  JSR abs
   4875 8DDC 1D                                   .byte mne_andx        ; $21  AND (dp,X)
   4876 8DDD 2D                                   .byte mne_jslx        ; $22  JSL absl
   4877 8DDE 1D                                   .byte mne_andx        ; $23  AND offset,S
   4878 8DDF 46                                   .byte mne_bitx        ; $24  BIT dp
   4879 8DE0 1D                                   .byte mne_andx        ; $25  AND dp
   4880 8DE1 29                                   .byte mne_rolx        ; $26  ROL dp
   4881 8DE2 1D                                   .byte mne_andx        ; $27  AND [dp]
   4882 8DE3 34                                   .byte mne_plpx        ; $28  PLP
   4883 8DE4 1D                                   .byte mne_andx        ; $29  AND #
   4884 8DE5 29                                   .byte mne_rolx        ; $2A  ROL A
   4885 8DE6 1C                                   .byte mne_pldx        ; $2B  PLD
   4886 8DE7 46                                   .byte mne_bitx        ; $2C  BIT abs
   4887 8DE8 1D                                   .byte mne_andx        ; $2D  AND abs
   4888 8DE9 29                                   .byte mne_rolx        ; $2E  ROL abs
   4889 8DEA 1D                                   .byte mne_andx        ; $2F  AND absl
                                        ;
   4891 8DEB 24                                   .byte mne_bmix        ; $30  BMI abs
   4892 8DEC 1D                                   .byte mne_andx        ; $31  AND (dp),Y
   4893 8DED 1D                                   .byte mne_andx        ; $32  AND (dp)
   4894 8DEE 1D                                   .byte mne_andx        ; $33  AND (offset,S),Y
   4895 8DEF 46                                   .byte mne_bitx        ; $34  BIT dp,X
   4896 8DF0 1D                                   .byte mne_andx        ; $35  AND dp,X
   4897 8DF1 29                                   .byte mne_rolx        ; $36  ROL dp,X
   4898 8DF2 1D                                   .byte mne_andx        ; $37  AND [dp],Y
   4899 8DF3 13                                   .byte mne_secx        ; $38  SEC
   4900 8DF4 1D                                   .byte mne_andx        ; $39  AND abs,Y
   4901 8DF5 12                                   .byte mne_decx        ; $3A  DEC A
   4902 8DF6 16                                   .byte mne_tscx        ; $3B  TSC
   4903 8DF7 46                                   .byte mne_bitx        ; $3C  BIT abs,X
   4904 8DF8 1D                                   .byte mne_andx        ; $3D  AND abs,X
   4905 8DF9 29                                   .byte mne_rolx        ; $3E  ROL abs,X
   4906 8DFA 1D                                   .byte mne_andx        ; $3F  AND absl,X
                                        ;
   4908 8DFB 25                                   .byte mne_rtix        ; $40  RTI
   4909 8DFC 3D                                   .byte mne_eorx        ; $41  EOR (dp,X)
   4910 8DFD 2F                                   .byte mne_wdmx        ; $42  WDM
   4911 8DFE 3D                                   .byte mne_eorx        ; $43  EOR offset,S
   4912 8DFF 3A                                   .byte mne_mvpx        ; $44  MVP sb,db
   4913 8E00 3D                                   .byte mne_eorx        ; $45  EOR dp
   4914 8E01 40                                   .byte mne_lsrx        ; $46  LSR dp
   4915 8E02 3D                                   .byte mne_eorx        ; $47  EOR [dp]
   4916 8E03 03                                   .byte mne_phax        ; $48  PHA
   4917 8E04 3D                                   .byte mne_eorx        ; $49  EOR #
   4918 8E05 40                                   .byte mne_lsrx        ; $4A  LSR A
   4919 8E06 26                                   .byte mne_phkx        ; $4B  PHK
   4920 8E07 36                                   .byte mne_jmpx        ; $4C  JMP abs
   4921 8E08 3D                                   .byte mne_eorx        ; $4D  EOR abs
   4922 8E09 40                                   .byte mne_lsrx        ; $4E  LSR abs
   4923 8E0A 3D                                   .byte mne_eorx        ; $4F  EOR absl
                                        ;
   4925 8E0B 17                                   .byte mne_bvcx        ; $50  BVC abs
   4926 8E0C 3D                                   .byte mne_eorx        ; $51  EOR (dp),Y
   4927 8E0D 3D                                   .byte mne_eorx        ; $52  EOR (dp)
   4928 8E0E 3D                                   .byte mne_eorx        ; $53  EOR (offset,S),Y
   4929 8E0F 30                                   .byte mne_mvnx        ; $54  MVN sb,db
   4930 8E10 3D                                   .byte mne_eorx        ; $55  EOR dp,X
   4931 8E11 40                                   .byte mne_lsrx        ; $56  LSR dp,X
   4932 8E12 3D                                   .byte mne_eorx        ; $57  EOR [dp],Y
   4933 8E13 23                                   .byte mne_clix        ; $58  CLI
   4934 8E14 3D                                   .byte mne_eorx        ; $59  EOR abs,Y
   4935 8E15 55                                   .byte mne_phyx        ; $5A  PHY
   4936 8E16 18                                   .byte mne_tcdx        ; $5B  TCD
   4937 8E17 28                                   .byte mne_jmlx        ; $5C  JML absl
   4938 8E18 3D                                   .byte mne_eorx        ; $5D  EOR abs,X
   4939 8E19 40                                   .byte mne_lsrx        ; $5E  LSR abs,X
   4940 8E1A 3D                                   .byte mne_eorx        ; $5F  EOR absl,X
                                        ;
   4942 8E1B 43                                   .byte mne_rtsx        ; $60  RTS
   4943 8E1C 10                                   .byte mne_adcx        ; $61  ADC (dp,X)
   4944 8E1D 3C                                   .byte mne_perx        ; $62  PER
   4945 8E1E 10                                   .byte mne_adcx        ; $63  ADC offset,S
   4946 8E1F 5B                                   .byte mne_stzx        ; $64  STZ dp
   4947 8E20 10                                   .byte mne_adcx        ; $65  ADC dp
   4948 8E21 3E                                   .byte mne_rorx        ; $66  ROR dp
   4949 8E22 10                                   .byte mne_adcx        ; $67  ADC [dp]
   4950 8E23 04                                   .byte mne_plax        ; $68  PLA
   4951 8E24 10                                   .byte mne_adcx        ; $69  ADC #
   4952 8E25 3E                                   .byte mne_rorx        ; $6A  ROR A
   4953 8E26 2E                                   .byte mne_rtlx        ; $6B  RTL
   4954 8E27 36                                   .byte mne_jmpx        ; $6C  JMP (abs)
   4955 8E28 10                                   .byte mne_adcx        ; $6D  ADC abs
   4956 8E29 3E                                   .byte mne_rorx        ; $6E  ROR abs
   4957 8E2A 10                                   .byte mne_adcx        ; $6F  ADC absl
                                        ;
   4959 8E2B 44                                   .byte mne_bvsx        ; $70  BVS abs
   4960 8E2C 10                                   .byte mne_adcx        ; $71  ADC (dp),Y
   4961 8E2D 10                                   .byte mne_adcx        ; $72  ADC (dp)
   4962 8E2E 10                                   .byte mne_adcx        ; $73  ADC (offset,S),Y
   4963 8E2F 5B                                   .byte mne_stzx        ; $74  STZ dp,X
   4964 8E30 10                                   .byte mne_adcx        ; $75  ADC dp,X
   4965 8E31 3E                                   .byte mne_rorx        ; $76  ROR dp,X
   4966 8E32 10                                   .byte mne_adcx        ; $77  ADC [dp],Y
   4967 8E33 22                                   .byte mne_seix        ; $78  SEI
   4968 8E34 10                                   .byte mne_adcx        ; $79  ADC abs,Y
   4969 8E35 56                                   .byte mne_plyx        ; $7A  PLY
   4970 8E36 11                                   .byte mne_tdcx        ; $7B  TDC
   4971 8E37 36                                   .byte mne_jmpx        ; $7C  JMP (abs,X)
   4972 8E38 10                                   .byte mne_adcx        ; $7D  ADC abs,X
   4973 8E39 3E                                   .byte mne_rorx        ; $7E  ROR abs,X
   4974 8E3A 10                                   .byte mne_adcx        ; $7F  ADC absl,X
                                        ;
   4976 8E3B 05                                   .byte mne_brax        ; $80  BRA abs
   4977 8E3C 07                                   .byte mne_stax        ; $81  STA (dp,X)
   4978 8E3D 2B                                   .byte mne_brlx        ; $82  BRL abs
   4979 8E3E 07                                   .byte mne_stax        ; $83  STA offset,S
   4980 8E3F 59                                   .byte mne_styx        ; $84  STY dp
   4981 8E40 07                                   .byte mne_stax        ; $85  STA dp
   4982 8E41 50                                   .byte mne_stxx        ; $86  STX dp
   4983 8E42 07                                   .byte mne_stax        ; $87  STA [dp]
   4984 8E43 54                                   .byte mne_deyx        ; $88  DEY
   4985 8E44 46                                   .byte mne_bitx        ; $89  BIT #
   4986 8E45 08                                   .byte mne_txax        ; $8A  TXA
   4987 8E46 0A                                   .byte mne_phbx        ; $8B  PHB
   4988 8E47 59                                   .byte mne_styx        ; $8C  STY abs
   4989 8E48 07                                   .byte mne_stax        ; $8D  STA abs
   4990 8E49 50                                   .byte mne_stxx        ; $8E  STX abs
   4991 8E4A 07                                   .byte mne_stax        ; $8F  STA absl
                                        ;
   4993 8E4B 0F                                   .byte mne_bccx        ; $90  BCC abs
   4994 8E4C 07                                   .byte mne_stax        ; $91  STA (dp),Y
   4995 8E4D 07                                   .byte mne_stax        ; $92  STA (dp)
   4996 8E4E 07                                   .byte mne_stax        ; $93  STA (offset,S),Y
   4997 8E4F 59                                   .byte mne_styx        ; $94  STY dp,X
   4998 8E50 07                                   .byte mne_stax        ; $95  STA dp,X
   4999 8E51 50                                   .byte mne_stxx        ; $96  STX dp,Y
   5000 8E52 07                                   .byte mne_stax        ; $97  STA [dp],Y
   5001 8E53 09                                   .byte mne_tyax        ; $98  TYA
   5002 8E54 07                                   .byte mne_stax        ; $99  STA abs,Y
   5003 8E55 45                                   .byte mne_txsx        ; $9A  TXS
   5004 8E56 5A                                   .byte mne_txyx        ; $9B  TXY
   5005 8E57 5B                                   .byte mne_stzx        ; $9C  STZ abs
   5006 8E58 07                                   .byte mne_stax        ; $9D  STA abs,X
   5007 8E59 5B                                   .byte mne_stzx        ; $9E  STZ abs,X
   5008 8E5A 07                                   .byte mne_stax        ; $9F  STA absl,X
                                        ;
   5010 8E5B 53                                   .byte mne_ldyx        ; $A0  LDY #
   5011 8E5C 01                                   .byte mne_ldax        ; $A1  LDA (dp,X)
   5012 8E5D 49                                   .byte mne_ldxx        ; $A2  LDX #
   5013 8E5E 01                                   .byte mne_ldax        ; $A3  LDA offset,S
   5014 8E5F 53                                   .byte mne_ldyx        ; $A4  LDY dp
   5015 8E60 01                                   .byte mne_ldax        ; $A5  LDA dp
   5016 8E61 49                                   .byte mne_ldxx        ; $A6  LDX dp
   5017 8E62 01                                   .byte mne_ldax        ; $A7  LDA [dp]
   5018 8E63 52                                   .byte mne_tayx        ; $A8  TAY
   5019 8E64 01                                   .byte mne_ldax        ; $A9  LDA #
   5020 8E65 48                                   .byte mne_taxx        ; $AA  TAX
   5021 8E66 0B                                   .byte mne_plbx        ; $AB  PLB
   5022 8E67 53                                   .byte mne_ldyx        ; $AC  LDY abs
   5023 8E68 01                                   .byte mne_ldax        ; $AD  LDA abs
   5024 8E69 49                                   .byte mne_ldxx        ; $AE  LDX abs
   5025 8E6A 01                                   .byte mne_ldax        ; $AF  LDA absl
                                        ;
   5027 8E6B 41                                   .byte mne_bcsx        ; $B0  BCS abs
   5028 8E6C 01                                   .byte mne_ldax        ; $B1  LDA (dp),Y
   5029 8E6D 01                                   .byte mne_ldax        ; $B2  LDA (dp)
   5030 8E6E 01                                   .byte mne_ldax        ; $B3  LDA (offset,S),Y
   5031 8E6F 53                                   .byte mne_ldyx        ; $B4  LDY dp,X
   5032 8E70 01                                   .byte mne_ldax        ; $B5  LDA dp,X
   5033 8E71 49                                   .byte mne_ldxx        ; $B6  LDX dp,Y
   5034 8E72 01                                   .byte mne_ldax        ; $B7  LDA [dp],Y
   5035 8E73 47                                   .byte mne_clvx        ; $B8  CLV
   5036 8E74 01                                   .byte mne_ldax        ; $B9  LDA abs,Y
   5037 8E75 4F                                   .byte mne_tsxx        ; $BA  TSX
   5038 8E76 51                                   .byte mne_tyxx        ; $BB  TYX
   5039 8E77 53                                   .byte mne_ldyx        ; $BC  LDY abs,X
   5040 8E78 01                                   .byte mne_ldax        ; $BD  LDA abs,X
   5041 8E79 49                                   .byte mne_ldxx        ; $BE  LDX abs,Y
   5042 8E7A 01                                   .byte mne_ldax        ; $BF  LDA absl,X
                                        ;
   5044 8E7B 58                                   .byte mne_cpyx        ; $C0  CPY #
   5045 8E7C 35                                   .byte mne_cmpx        ; $C1  CMP (dp,X)
   5046 8E7D 31                                   .byte mne_repx        ; $C2  REP #
   5047 8E7E 35                                   .byte mne_cmpx        ; $C3  CMP offset,S
   5048 8E7F 58                                   .byte mne_cpyx        ; $C4  CPY dp
   5049 8E80 35                                   .byte mne_cmpx        ; $C5  CMP dp
   5050 8E81 12                                   .byte mne_decx        ; $C6  DEC dp
   5051 8E82 35                                   .byte mne_cmpx        ; $C7  CMP [dp]
   5052 8E83 57                                   .byte mne_inyx        ; $C8  INY
   5053 8E84 35                                   .byte mne_cmpx        ; $C9  CMP #
   5054 8E85 4A                                   .byte mne_dexx        ; $CA  DEX
   5055 8E86 20                                   .byte mne_waix        ; $CB  WAI
   5056 8E87 58                                   .byte mne_cpyx        ; $CC  CPY abs
   5057 8E88 35                                   .byte mne_cmpx        ; $CD  CMP abs
   5058 8E89 12                                   .byte mne_decx        ; $CE  DEC abs
   5059 8E8A 35                                   .byte mne_cmpx        ; $CF  CMP absl
                                        ;
   5061 8E8B 1F                                   .byte mne_bnex        ; $D0  BNE abs
   5062 8E8C 35                                   .byte mne_cmpx        ; $D1  CMP (dp),Y
   5063 8E8D 35                                   .byte mne_cmpx        ; $D2  CMP (dp)
   5064 8E8E 35                                   .byte mne_cmpx        ; $D3  CMP (offset,S),Y
   5065 8E8F 21                                   .byte mne_peix        ; $D4  PEI dp
   5066 8E90 35                                   .byte mne_cmpx        ; $D5  CMP dp,X
   5067 8E91 12                                   .byte mne_decx        ; $D6  DEC dp,X
   5068 8E92 35                                   .byte mne_cmpx        ; $D7  CMP [dp],Y
   5069 8E93 1B                                   .byte mne_cldx        ; $D8  CLD
   5070 8E94 35                                   .byte mne_cmpx        ; $D9  CMP abs,Y
   5071 8E95 4B                                   .byte mne_phxx        ; $DA  PHX
   5072 8E96 39                                   .byte mne_stpx        ; $DB  STP
   5073 8E97 36                                   .byte mne_jmpx        ; $DC  JMP [abs]
   5074 8E98 35                                   .byte mne_cmpx        ; $DD  CMP abs,X
   5075 8E99 12                                   .byte mne_decx        ; $DE  DEC abs,X
   5076 8E9A 35                                   .byte mne_cmpx        ; $DF  CMP absl,X
                                        ;
   5078 8E9B 4E                                   .byte mne_cpxx        ; $E0  CPX #
   5079 8E9C 0E                                   .byte mne_sbcx        ; $E1  SBC (dp,X)
   5080 8E9D 32                                   .byte mne_sepx        ; $E2  SEP #
   5081 8E9E 0E                                   .byte mne_sbcx        ; $E3  SBC offset,S
   5082 8E9F 4E                                   .byte mne_cpxx        ; $E4  CPX dp
   5083 8EA0 0E                                   .byte mne_sbcx        ; $E5  SBC dp
   5084 8EA1 15                                   .byte mne_incx        ; $E6  INC dp
   5085 8EA2 0E                                   .byte mne_sbcx        ; $E7  SBC [dp]
   5086 8EA3 4D                                   .byte mne_inxx        ; $E8  INX
   5087 8EA4 0E                                   .byte mne_sbcx        ; $E9  SBC #
   5088 8EA5 38                                   .byte mne_nopx        ; $EA  NOP
   5089 8EA6 00                                   .byte mne_xbax        ; $EB  XBA
   5090 8EA7 4E                                   .byte mne_cpxx        ; $EC  CPX abs
   5091 8EA8 0E                                   .byte mne_sbcx        ; $ED  SBC abs
   5092 8EA9 15                                   .byte mne_incx        ; $EE  INC abs
   5093 8EAA 0E                                   .byte mne_sbcx        ; $EF  SBC absl
                                        ;
   5095 8EAB 3B                                   .byte mne_beqx        ; $F0  BEQ abs
   5096 8EAC 0E                                   .byte mne_sbcx        ; $F1  SBC (dp),Y
   5097 8EAD 0E                                   .byte mne_sbcx        ; $F2  SBC (dp)
   5098 8EAE 0E                                   .byte mne_sbcx        ; $F3  SBC (offset,S),Y
   5099 8EAF 02                                   .byte mne_peax        ; $F4  PEA #
   5100 8EB0 0E                                   .byte mne_sbcx        ; $F5  SBC dp,X
   5101 8EB1 15                                   .byte mne_incx        ; $F6  INC dp,X
   5102 8EB2 0E                                   .byte mne_sbcx        ; $F7  SBC [dp],Y
   5103 8EB3 19                                   .byte mne_sedx        ; $F8  SED
   5104 8EB4 0E                                   .byte mne_sbcx        ; $F9  SBC abs,Y
   5105 8EB5 4C                                   .byte mne_plxx        ; $FA  PLX
   5106 8EB6 1E                                   .byte mne_xcex        ; $FB  XCE
   5107 8EB7 3F                                   .byte mne_jsrx        ; $FC  JSR (abs,X)
   5108 8EB8 0E                                   .byte mne_sbcx        ; $FD  SBC abs,X
   5109 8EB9 15                                   .byte mne_incx        ; $FE  INC abs,X
   5110 8EBA 0E                                   .byte mne_sbcx        ; $FF  SBC absl,X
                                        ;
                                        ;
                                        ;	instruction addressing modes & sizes in opcode order...
                                        ;
                                        ;	    xxxxxxxx
                                        ;	    ||||||||
                                        ;	    ||||++++———> Addressing Mode
                                        ;	    ||||         ——————————————————————————————————
                                        ;	    ||||          0000  dp, abs, absl, implied or A
                                        ;	    ||||          0001  #
                                        ;	    ||||          0010  dp,X, abs,X or absl,X
                                        ;	    ||||          0011  dp,Y or abs,Y
                                        ;	    ||||          0100  (dp) or (abs)
                                        ;	    ||||          0101  [dp] or [abs]
                                        ;	    ||||          0110  [dp],Y
                                        ;	    ||||          0111  (dp,X) or (abs,X)
                                        ;	    ||||          1000  (dp),Y
                                        ;	    ||||          1001  offset,S
                                        ;	    ||||          1010  (offset,S),Y
                                        ;	    ||||          1011  sbnk,dbnk (MVN or MVP)
                                        ;	    ||||          —-—-—-—-—-—-—-—-—-—-—-—-—-—-—-—-—
                                        ;	    ||||           #    = immediate
                                        ;	    ||||           A    = accumulator
                                        ;	    ||||           abs  = absolute
                                        ;	    ||||           absl = absolute long
                                        ;	    ||||           dbnk = destination bank
                                        ;	    ||||           dp   = direct (zero) page
                                        ;	    ||||           S    = stack relative
                                        ;	    ||||           sbnk = source bank
                                        ;	    ||||         ——————————————————————————————————
                                        ;	    ||||
                                        ;	    ||++———————> binary-encoded operand size
                                        ;	    |+—————————> 1: relative branch instruction
                                        ;	    +——————————> 1: variable operand size...
                                        ;
                                        ;	    —————————————————————————————————————————————————————————————
                                        ;	    Variable operand size refers to an immediate mode instruction
                                        ;	    that can accept either an 8 or 16 bit operand.  During instr-
                                        ;	    uction assembly, an 8 bit operand can be forced to 16 bits by
                                        ;	    preceding the operand field with !,  e.g.,  LDA !#$01,  which
                                        ;	    will assemble as $A9 $01 $00.
                                        ;	    —————————————————————————————————————————————————————————————
                                        ;
   5154 8EBB 00                         mnetabam .byte ops0 | am_nam   ; $00  BRK
   5155 8EBC 17                                   .byte ops1 | am_indx  ; $01  ORA (dp,X)
   5156 8EBD 10                                   .byte ops1 | am_nam   ; $02  COP
   5157 8EBE 19                                   .byte ops1 | am_stk   ; $03  ORA offset,S
   5158 8EBF 10                                   .byte ops1 | am_nam   ; $04  TSB dp
   5159 8EC0 10                                   .byte ops1 | am_nam   ; $05  ORA dp
   5160 8EC1 10                                   .byte ops1 | am_nam   ; $06  ASL dp
   5161 8EC2 15                                   .byte ops1 | am_indl  ; $07  ORA [dp]
   5162 8EC3 00                                   .byte ops0 | am_nam   ; $08  PHP
   5163 8EC4 91                                   .byte vops | am_imm   ; $09  ORA #
   5164 8EC5 00                                   .byte ops0 | am_nam   ; $0A  ASL A
   5165 8EC6 00                                   .byte ops0 | am_nam   ; $0B  PHD
   5166 8EC7 20                                   .byte ops2 | am_nam   ; $0C  TSB abs
   5167 8EC8 20                                   .byte ops2 | am_nam   ; $0D  ORA abs
   5168 8EC9 20                                   .byte ops2 | am_nam   ; $0E  ASL abs
   5169 8ECA 30                                   .byte ops3 | am_nam   ; $0F  ORA absl
                                        ;
   5171 8ECB 50                                   .byte bop1 | am_nam   ; $10  BPL abs
   5172 8ECC 18                                   .byte ops1 | am_indy  ; $11  ORA (dp),Y
   5173 8ECD 14                                   .byte ops1 | am_ind   ; $12  ORA (dp)
   5174 8ECE 1A                                   .byte ops1 | am_stky  ; $13  ORA (offset,S),Y
   5175 8ECF 10                                   .byte ops1 | am_nam   ; $14  TRB dp
   5176 8ED0 12                                   .byte ops1 | am_adrx  ; $15  ORA dp,X
   5177 8ED1 12                                   .byte ops1 | am_adrx  ; $16  ASL dp,X
   5178 8ED2 16                                   .byte ops1 | am_indly ; $17  ORA [dp],Y
   5179 8ED3 00                                   .byte ops0 | am_nam   ; $18  CLC
   5180 8ED4 20                                   .byte ops2 | am_nam   ; $19  ORA abs
   5181 8ED5 00                                   .byte ops0 | am_nam   ; $1A  INC A
   5182 8ED6 00                                   .byte ops0 | am_nam   ; $1B  TCS
   5183 8ED7 20                                   .byte ops2 | am_nam   ; $1C  TRB abs
   5184 8ED8 22                                   .byte ops2 | am_adrx  ; $1D  ORA abs,X
   5185 8ED9 22                                   .byte ops2 | am_adrx  ; $1E  ASL abs,X
   5186 8EDA 32                                   .byte ops3 | am_adrx  ; $1F  ORA absl,X
                                        ;
   5188 8EDB 20                                   .byte ops2 | am_nam   ; $20  JSR abs
   5189 8EDC 17                                   .byte ops1 | am_indx  ; $21  AND (dp,X)
   5190 8EDD 30                                   .byte ops3 | am_nam   ; $22  JSL absl
   5191 8EDE 19                                   .byte ops1 | am_stk   ; $23  AND offset,S
   5192 8EDF 10                                   .byte ops1 | am_nam   ; $24  BIT dp
   5193 8EE0 10                                   .byte ops1 | am_nam   ; $25  AND dp
   5194 8EE1 10                                   .byte ops1 | am_nam   ; $26  ROL dp
   5195 8EE2 15                                   .byte ops1 | am_indl  ; $27  AND [dp]
   5196 8EE3 00                                   .byte ops0 | am_nam   ; $28  PLP
   5197 8EE4 91                                   .byte vops | am_imm   ; $29  AND #
   5198 8EE5 00                                   .byte ops0 | am_nam   ; $2A  ROL A
   5199 8EE6 00                                   .byte ops0 | am_nam   ; $2B  PLD
   5200 8EE7 20                                   .byte ops2 | am_nam   ; $2C  BIT abs
   5201 8EE8 20                                   .byte ops2 | am_nam   ; $2D  AND abs
   5202 8EE9 20                                   .byte ops2 | am_nam   ; $2E  ROL abs
   5203 8EEA 30                                   .byte ops3 | am_nam   ; $2F  AND absl
                                        ;
   5205 8EEB 50                                   .byte bop1 | am_nam   ; $30  BMI abs
   5206 8EEC 18                                   .byte ops1 | am_indy  ; $31  AND (dp),Y
   5207 8EED 14                                   .byte ops1 | am_ind   ; $32  AND (dp)
   5208 8EEE 1A                                   .byte ops1 | am_stky  ; $33  AND (offset,S),Y
   5209 8EEF 12                                   .byte ops1 | am_adrx  ; $34  BIT dp,X
   5210 8EF0 12                                   .byte ops1 | am_adrx  ; $35  AND dp,X
   5211 8EF1 12                                   .byte ops1 | am_adrx  ; $36  ROL dp,X
   5212 8EF2 16                                   .byte ops1 | am_indly ; $37  AND [dp],Y
   5213 8EF3 00                                   .byte ops0 | am_nam   ; $38  SEC
   5214 8EF4 23                                   .byte ops2 | am_adry  ; $39  AND abs,Y
   5215 8EF5 00                                   .byte ops0 | am_nam   ; $3A  DEC A
   5216 8EF6 00                                   .byte ops0 | am_nam   ; $3B  TSC
   5217 8EF7 22                                   .byte ops2 | am_adrx  ; $3C  BIT abs,X
   5218 8EF8 22                                   .byte ops2 | am_adrx  ; $3D  AND abs,X
   5219 8EF9 22                                   .byte ops2 | am_adrx  ; $3E  ROL abs,X
   5220 8EFA 32                                   .byte ops3 | am_adrx  ; $3F  AND absl,X
                                        ;
   5222 8EFB 00                                   .byte ops0 | am_nam   ; $40  RTI
   5223 8EFC 17                                   .byte ops1 | am_indx  ; $41  EOR (dp,X)
   5224 8EFD 00                                   .byte ops0 | am_nam   ; $42  WDM
   5225 8EFE 19                                   .byte ops1 | am_stk   ; $43  EOR offset,S
   5226 8EFF 2B                                   .byte ops2 | am_move  ; $44  MVP sb,db
   5227 8F00 10                                   .byte ops1 | am_nam   ; $45  EOR dp
   5228 8F01 10                                   .byte ops1 | am_nam   ; $46  LSR dp
   5229 8F02 15                                   .byte ops1 | am_indl  ; $47  EOR [dp]
   5230 8F03 00                                   .byte ops0 | am_nam   ; $48  PHA
   5231 8F04 91                                   .byte vops | am_imm   ; $49  EOR #
   5232 8F05 00                                   .byte ops0 | am_nam   ; $4A  LSR A
   5233 8F06 00                                   .byte ops0 | am_nam   ; $4B  PHK
   5234 8F07 20                                   .byte ops2 | am_nam   ; $4C  JMP abs
   5235 8F08 20                                   .byte ops2 | am_nam   ; $4D  EOR abs
   5236 8F09 20                                   .byte ops2 | am_nam   ; $4E  LSR abs
   5237 8F0A 30                                   .byte ops3 | am_nam   ; $4F  EOR absl
                                        ;
   5239 8F0B 50                                   .byte bop1 | am_nam   ; $50  BVC abs
   5240 8F0C 18                                   .byte ops1 | am_indy  ; $51  EOR (dp),Y
   5241 8F0D 14                                   .byte ops1 | am_ind   ; $52  EOR (dp)
   5242 8F0E 1A                                   .byte ops1 | am_stky  ; $53  EOR (offset,S),Y
   5243 8F0F 2B                                   .byte ops2 | am_move  ; $54  MVN sb,db
   5244 8F10 12                                   .byte ops1 | am_adrx  ; $55  EOR dp,X
   5245 8F11 12                                   .byte ops1 | am_adrx  ; $56  LSR dp,X
   5246 8F12 16                                   .byte ops1 | am_indly ; $57  EOR [dp],Y
   5247 8F13 00                                   .byte ops0 | am_nam   ; $58  CLI
   5248 8F14 23                                   .byte ops2 | am_adry  ; $59  EOR abs,Y
   5249 8F15 00                                   .byte ops0 | am_nam   ; $5A  PHY
   5250 8F16 00                                   .byte ops0 | am_nam   ; $5B  TCD
   5251 8F17 30                                   .byte ops3 | am_nam   ; $5C  JML absl
   5252 8F18 22                                   .byte ops2 | am_adrx  ; $5D  EOR abs,X
   5253 8F19 22                                   .byte ops2 | am_adrx  ; $5E  LSR abs,X
   5254 8F1A 32                                   .byte ops3 | am_adrx  ; $5F  EOR absl,X
                                        ;
   5256 8F1B 00                                   .byte ops0 | am_nam   ; $60  RTS
   5257 8F1C 17                                   .byte ops1 | am_indx  ; $61  ADC (dp,X)
   5258 8F1D 60                                   .byte bop2 | am_nam   ; $62  PER
   5259 8F1E 19                                   .byte ops1 | am_stk   ; $63  ADC offset,S
   5260 8F1F 10                                   .byte ops1 | am_nam   ; $64  STZ dp
   5261 8F20 10                                   .byte ops1 | am_nam   ; $65  ADC dp
   5262 8F21 10                                   .byte ops1 | am_nam   ; $66  ROR dp
   5263 8F22 15                                   .byte ops1 | am_indl  ; $67  ADC [dp]
   5264 8F23 00                                   .byte ops0 | am_nam   ; $68  PLA
   5265 8F24 91                                   .byte vops | am_imm   ; $69  ADC #
   5266 8F25 00                                   .byte ops0 | am_nam   ; $6A  ROR A
   5267 8F26 00                                   .byte ops0 | am_nam   ; $6B  RTL
   5268 8F27 24                                   .byte ops2 | am_ind   ; $6C  JMP (abs)
   5269 8F28 20                                   .byte ops2 | am_nam   ; $6D  ADC abs
   5270 8F29 20                                   .byte ops2 | am_nam   ; $6E  ROR abs
   5271 8F2A 30                                   .byte ops3 | am_nam   ; $6F  ADC absl
                                        ;
   5273 8F2B 50                                   .byte bop1 | am_nam   ; $70  BVS abs
   5274 8F2C 18                                   .byte ops1 | am_indy  ; $71  ADC (dp),Y
   5275 8F2D 14                                   .byte ops1 | am_ind   ; $72  ADC (dp)
   5276 8F2E 1A                                   .byte ops1 | am_stky  ; $73  ADC (offset,S),Y
   5277 8F2F 12                                   .byte ops1 | am_adrx  ; $74  STZ dp,X
   5278 8F30 12                                   .byte ops1 | am_adrx  ; $75  ADC dp,X
   5279 8F31 12                                   .byte ops1 | am_adrx  ; $76  ROR dp,X
   5280 8F32 16                                   .byte ops1 | am_indly ; $77  ADC [dp],Y
   5281 8F33 00                                   .byte ops0 | am_nam   ; $78  SEI
   5282 8F34 23                                   .byte ops2 | am_adry  ; $79  ADC abs,Y
   5283 8F35 00                                   .byte ops0 | am_nam   ; $7A  PLY
   5284 8F36 00                                   .byte ops0 | am_nam   ; $7B  TDC
   5285 8F37 27                                   .byte ops2 | am_indx  ; $7C  JMP (abs,X)
   5286 8F38 22                                   .byte ops2 | am_adrx  ; $7D  ADC abs,X
   5287 8F39 22                                   .byte ops2 | am_adrx  ; $7E  ROR abs,X
   5288 8F3A 32                                   .byte ops3 | am_adrx  ; $7F  ADC absl,X
                                        ;
   5290 8F3B 50                                   .byte bop1 | am_nam   ; $80  BRA abs
   5291 8F3C 17                                   .byte ops1 | am_indx  ; $81  STA (dp,X)
   5292 8F3D 60                                   .byte bop2 | am_nam   ; $82  BRL abs
   5293 8F3E 19                                   .byte ops1 | am_stk   ; $83  STA offset,S
   5294 8F3F 10                                   .byte ops1 | am_nam   ; $84  STY dp
   5295 8F40 10                                   .byte ops1 | am_nam   ; $85  STA dp
   5296 8F41 10                                   .byte ops1 | am_nam   ; $86  STX dp
   5297 8F42 15                                   .byte ops1 | am_indl  ; $87  STA [dp]
   5298 8F43 00                                   .byte ops0 | am_nam   ; $88  DEY
   5299 8F44 91                                   .byte vops | am_imm   ; $89  BIT #
   5300 8F45 00                                   .byte ops0 | am_nam   ; $8A  TXA
   5301 8F46 00                                   .byte ops0 | am_nam   ; $8B  PHB
   5302 8F47 20                                   .byte ops2 | am_nam   ; $8C  STY abs
   5303 8F48 20                                   .byte ops2 | am_nam   ; $8D  STA abs
   5304 8F49 20                                   .byte ops2 | am_nam   ; $8E  STX abs
   5305 8F4A 30                                   .byte ops3 | am_nam   ; $8F  STA absl
                                        ;
   5307 8F4B 50                                   .byte bop1 | am_nam   ; $90  BCC abs
   5308 8F4C 18                                   .byte ops1 | am_indy  ; $91  STA (dp),Y
   5309 8F4D 14                                   .byte ops1 | am_ind   ; $92  STA (dp)
   5310 8F4E 1A                                   .byte ops1 | am_stky  ; $93  STA (offset,S),Y
   5311 8F4F 12                                   .byte ops1 | am_adrx  ; $94  STY dp,X
   5312 8F50 12                                   .byte ops1 | am_adrx  ; $95  STA dp,X
   5313 8F51 13                                   .byte ops1 | am_adry  ; $96  STX dp,Y
   5314 8F52 16                                   .byte ops1 | am_indly ; $97  STA [dp],Y
   5315 8F53 00                                   .byte ops0 | am_nam   ; $98  TYA
   5316 8F54 23                                   .byte ops2 | am_adry  ; $99  STA abs,Y
   5317 8F55 00                                   .byte ops0 | am_nam   ; $9A  TXS
   5318 8F56 00                                   .byte ops0 | am_nam   ; $9B  TXY
   5319 8F57 20                                   .byte ops2 | am_nam   ; $9C  STZ abs
   5320 8F58 22                                   .byte ops2 | am_adrx  ; $9D  STA abs,X
   5321 8F59 22                                   .byte ops2 | am_adrx  ; $9E  STZ abs,X
   5322 8F5A 32                                   .byte ops3 | am_adrx  ; $9F  STA absl,X
                                        ;
   5324 8F5B 91                                   .byte vops | am_imm   ; $A0  LDY #
   5325 8F5C 17                                   .byte ops1 | am_indx  ; $A1  LDA (dp,X)
   5326 8F5D 91                                   .byte vops | am_imm   ; $A2  LDX #
   5327 8F5E 19                                   .byte ops1 | am_stk   ; $A3  LDA offset,S
   5328 8F5F 10                                   .byte ops1 | am_nam   ; $A4  LDY dp
   5329 8F60 10                                   .byte ops1 | am_nam   ; $A5  LDA dp
   5330 8F61 10                                   .byte ops1 | am_nam   ; $A6  LDX dp
   5331 8F62 15                                   .byte ops1 | am_indl  ; $A7  LDA [dp]
   5332 8F63 00                                   .byte ops0 | am_nam   ; $A8  TAY
   5333 8F64 91                                   .byte vops | am_imm   ; $A9  LDA #
   5334 8F65 00                                   .byte ops0 | am_nam   ; $AA  TAX
   5335 8F66 00                                   .byte ops0 | am_nam   ; $AB  PLB
   5336 8F67 20                                   .byte ops2 | am_nam   ; $AC  LDY abs
   5337 8F68 20                                   .byte ops2 | am_nam   ; $AD  LDA abs
   5338 8F69 20                                   .byte ops2 | am_nam   ; $AE  LDX abs
   5339 8F6A 30                                   .byte ops3 | am_nam   ; $AF  LDA absl
                                        ;
   5341 8F6B 50                                   .byte bop1 | am_nam   ; $B0  BCS abs
   5342 8F6C 18                                   .byte ops1 | am_indy  ; $B1  LDA (dp),Y
   5343 8F6D 14                                   .byte ops1 | am_ind   ; $B2  LDA (dp)
   5344 8F6E 1A                                   .byte ops1 | am_stky  ; $B3  LDA (offset,S),Y
   5345 8F6F 12                                   .byte ops1 | am_adrx  ; $B4  LDY dp,X
   5346 8F70 12                                   .byte ops1 | am_adrx  ; $B5  LDA dp,X
   5347 8F71 13                                   .byte ops1 | am_adry  ; $B6  LDX dp,Y
   5348 8F72 16                                   .byte ops1 | am_indly ; $B7  LDA [dp],Y
   5349 8F73 00                                   .byte ops0 | am_nam   ; $B8  CLV
   5350 8F74 23                                   .byte ops2 | am_adry  ; $B9  LDA abs,Y
   5351 8F75 00                                   .byte ops0 | am_nam   ; $BA  TSX
   5352 8F76 00                                   .byte ops0 | am_nam   ; $BB  TYX
   5353 8F77 22                                   .byte ops2 | am_adrx  ; $BC  LDY abs,X
   5354 8F78 22                                   .byte ops2 | am_adrx  ; $BD  LDA abs,X
   5355 8F79 23                                   .byte ops2 | am_adry  ; $BE  LDX abs,Y
   5356 8F7A 32                                   .byte ops3 | am_adrx  ; $BF  LDA absl,X
                                        ;
   5358 8F7B 91                                   .byte vops | am_imm   ; $C0  CPY #
   5359 8F7C 17                                   .byte ops1 | am_indx  ; $C1  CMP (dp,X)
   5360 8F7D 11                                   .byte ops1 | am_imm   ; $C2  REP #
   5361 8F7E 19                                   .byte ops1 | am_stk   ; $C3  CMP offset,S
   5362 8F7F 10                                   .byte ops1 | am_nam   ; $C4  CPY dp
   5363 8F80 10                                   .byte ops1 | am_nam   ; $C5  CMP dp
   5364 8F81 10                                   .byte ops1 | am_nam   ; $C6  DEC dp
   5365 8F82 15                                   .byte ops1 | am_indl  ; $C7  CMP [dp]
   5366 8F83 00                                   .byte ops0 | am_nam   ; $C8  INY
   5367 8F84 91                                   .byte vops | am_imm   ; $C9  CMP #
   5368 8F85 00                                   .byte ops0 | am_nam   ; $CA  DEX
   5369 8F86 00                                   .byte ops0 | am_nam   ; $CB  WAI
   5370 8F87 20                                   .byte ops2 | am_nam   ; $CC  CPY abs
   5371 8F88 20                                   .byte ops2 | am_nam   ; $CD  CMP abs
   5372 8F89 20                                   .byte ops2 | am_nam   ; $CE  DEC abs
   5373 8F8A 30                                   .byte ops3 | am_nam   ; $CF  CMP absl
                                        ;
   5375 8F8B 50                                   .byte bop1 | am_nam   ; $D0  BNE abs
   5376 8F8C 18                                   .byte ops1 | am_indy  ; $D1  CMP (dp),Y
   5377 8F8D 14                                   .byte ops1 | am_ind   ; $D2  CMP (dp)
   5378 8F8E 1A                                   .byte ops1 | am_stky  ; $D3  CMP (offset,S),Y
   5379 8F8F 10                                   .byte ops1 | am_nam   ; $D4  PEI dp
   5380 8F90 12                                   .byte ops1 | am_adrx  ; $D5  CMP dp,X
   5381 8F91 12                                   .byte ops1 | am_adrx  ; $D6  DEC dp,X
   5382 8F92 16                                   .byte ops1 | am_indly ; $D7  CMP [dp],Y
   5383 8F93 00                                   .byte ops0 | am_nam   ; $D8  CLD
   5384 8F94 23                                   .byte ops2 | am_adry  ; $D9  CMP abs,Y
   5385 8F95 00                                   .byte ops0 | am_nam   ; $DA  PHX
   5386 8F96 00                                   .byte ops0 | am_nam   ; $DB  STP
   5387 8F97 25                                   .byte ops2 | am_indl  ; $DC  JMP [abs]
   5388 8F98 22                                   .byte ops2 | am_adrx  ; $DD  CMP abs,X
   5389 8F99 22                                   .byte ops2 | am_adrx  ; $DE  DEC abs,X
   5390 8F9A 32                                   .byte ops3 | am_adrx  ; $DF  CMP absl,X
                                        ;
   5392 8F9B 91                                   .byte vops | am_imm   ; $E0  CPX #
   5393 8F9C 17                                   .byte ops1 | am_indx  ; $E1  SBC (dp,X)
   5394 8F9D 11                                   .byte ops1 | am_imm   ; $E2  SEP #
   5395 8F9E 19                                   .byte ops1 | am_stk   ; $E3  SBC offset,S
   5396 8F9F 10                                   .byte ops1 | am_nam   ; $E4  CPX dp
   5397 8FA0 10                                   .byte ops1 | am_nam   ; $E5  SBC dp
   5398 8FA1 10                                   .byte ops1 | am_nam   ; $E6  INC dp
   5399 8FA2 15                                   .byte ops1 | am_indl  ; $E7  SBC [dp]
   5400 8FA3 00                                   .byte ops0 | am_nam   ; $E8  INX
   5401 8FA4 91                                   .byte vops | am_imm   ; $E9  SBC #
   5402 8FA5 00                                   .byte ops0 | am_nam   ; $EA  NOP
   5403 8FA6 00                                   .byte ops0 | am_nam   ; $EB  XBA
   5404 8FA7 20                                   .byte ops2 | am_nam   ; $EC  CPX abs
   5405 8FA8 20                                   .byte ops2 | am_nam   ; $ED  SBC abs
   5406 8FA9 20                                   .byte ops2 | am_nam   ; $EE  INC abs
   5407 8FAA 30                                   .byte ops3 | am_nam   ; $EF  SBC absl
                                        ;
   5409 8FAB 50                                   .byte bop1 | am_nam   ; $F0  BEQ abs
   5410 8FAC 18                                   .byte ops1 | am_indy  ; $F1  SBC (dp),Y
   5411 8FAD 14                                   .byte ops1 | am_ind   ; $F2  SBC (dp)
   5412 8FAE 1A                                   .byte ops1 | am_stky  ; $F3  SBC (offset,S),Y
   5413 8FAF 21                                   .byte ops2 | am_imm   ; $F4  PEA #
   5414 8FB0 12                                   .byte ops1 | am_adrx  ; $F5  SBC dp,X
   5415 8FB1 12                                   .byte ops1 | am_adrx  ; $F6  INC dp,X
   5416 8FB2 16                                   .byte ops1 | am_indly ; $F7  SBC [dp],Y
   5417 8FB3 00                                   .byte ops0 | am_nam   ; $F8  SED
   5418 8FB4 23                                   .byte ops2 | am_adry  ; $F9  SBC abs,Y
   5419 8FB5 00                                   .byte ops0 | am_nam   ; $FA  PLX
   5420 8FB6 00                                   .byte ops0 | am_nam   ; $FB  XCE
   5421 8FB7 27                                   .byte ops2 | am_indx  ; $FC  JSR (abs,X)
   5422 8FB8 22                                   .byte ops2 | am_adrx  ; $FD  SBC abs,X
   5423 8FB9 22                                   .byte ops2 | am_adrx  ; $FE  INC abs,X
   5424 8FBA 32                                   .byte ops3 | am_adrx  ; $FF  SBC absl,X
                                        ;
                                        ;
                                        ;	.X & .Y immediate mode opcodes...
                                        ;
   5429 8FBB A0                         vopidx   .byte $a0             ;LDY #
   5430 8FBC A2                                   .byte $a2             ;LDX #
   5431 8FBD C0                                   .byte $c0             ;CPY #
   5432 8FBE E0                                   .byte $e0             ;CPX #
   5659 = 00000004                      n_vopidx =*-vopidx             ;number of opcodes
                                        ;
                                        ;
                                        ;	addressing mode symbology lookup...
                                        ;
   5438 8FBF D7 8F                      ms_lutab .word ms_nam          ;(0000)  no symbol
   5439 8FC1 E1 8F                                .word ms_imm          ;(0001)  #
   5440 8FC3 D9 8F                                .word ms_addrx        ;(0010)  dp,X or abs,X
   5441 8FC5 DD 8F                                .word ms_addry        ;(0011)  dp,Y or abs,Y
   5442 8FC7 E3 8F                                .word ms_ind          ;(0100)  (dp) or (abs)
   5443 8FC9 E6 8F                                .word ms_indl         ;(0101)  [dp] or [abs]
   5444 8FCB E9 8F                                .word ms_indly        ;(0110)  [dp],Y
   5445 8FCD EE 8F                                .word ms_indx         ;(0111)  (dp,X) or (abs,X)
   5446 8FCF F3 8F                                .word ms_indy         ;(1000)  (dp),Y
   5447 8FD1 FB 8F                                .word ms_stk          ;(1001)  offset,S
   5448 8FD3 FF 8F                                .word ms_stky         ;(1010) (offset,S),Y
   5449 8FD5 D7 8F                                .word ms_nam          ;(1011) sbnk,dbnk
                                        ;
                                        ;
                                        ;	addressing mode symbology strings...
                                        ;
   5454 8FD7 20 00                      ms_nam   .byte " ",0           ;no symbol
   5455 8FD9 20 2C 58 00                ms_addrx .byte " ,X",0         ;dp,X or addr,X
   5456 8FDD 20 2C 59 00                ms_addry .byte " ,Y",0         ;dp,Y or addr,Y
   5457 8FE1 23 00                      ms_imm   .byte "#",0           ;immediate
   5458 8FE3 28 29 00                   ms_ind   .byte "()",0          ;(dp) or (abs)
   5459 8FE6 5B 5D 00                   ms_indl  .byte "[]",0          ;[dp] or [abs]
   5460 8FE9 5B 5D 2C 59 00             ms_indly .byte "[],Y",0        ;[dp],Y
   5461 8FEE 28 2C 58 29 00             ms_indx  .byte "(,X)",0        ;(dp,X) or (abs,X)
   5462 8FF3 28 29 2C 59 00             ms_indy  .byte "(),Y",0        ;(dp),Y
   5463 8FF8 2C 24 00                   ms_move  .byte ",$",0          ;MVN/MVP sbnk,dbnk
   5464 8FFB 20 2C 53 00                ms_stk   .byte " ,S",0         ;offset,S
   5465 8FFF 28 2C 53 29 2C 59 00       ms_stky  .byte "(,S),Y",0      ;(offset,S),Y
   5466 9006 7B 7D 2C 59 00             ms_indxly	.byte "{},Y",0     ;{dp},Y
                                        ;
                                        ;================================================================================
                                        ;
                                        ;CONSOLE DISPLAY CONTROL STRINGS
                                        ;
   5472 900B 1B 28                      dc_bf +         .byte a_esc,"("
   5472 900D 1B 47 34                 +            .byte a_esc,"G4"
                                                            ;enable reverse foreground
   5473 9010 00                                   .byte 0
                                        ;
   5475 9011 08                         dc_bs +         .byte a_bs
   5475 9012 1B 57                    +   +         .byte a_esc,"W"
                                        
                                                            ;destructive backspace
   5477 9014 00                                   .byte 0
                                        ;
   5479 9015 1B 54                      dc_cl +         .byte a_esc,"T"
                                                            ;clear to end of line 
   5480 9017 00                                   .byte 0
                                        ;
   5482 9018 1B 60 31                   dc_cn +         .byte a_esc,"`1"
                                                            ;cursor on
   5483 901B 00                                   .byte 0
                                        ;
   5485 901C 1B 60 30                   dc_co +         .byte a_esc,"`0"
                                                            ;cursor off
   5486 901F 00                                   .byte 0
                                        ;
   5488 9020 1B 28                      dc_er +         .byte a_esc,"("
   5488 9022 1B 47 30                 +            .byte a_esc,"G0"
                                                            ;enable normal foreground
   5489 9025 00                                   .byte 0
                                        ;
   5491 9026 0D                         dc_lf ++         .byte a_cr
                                     +   
   5491 9027 0A                       +            .byte a_lf
                                                            ;newline
   5492 9028 00                                   .byte 0
                                        ;
                                        ;================================================================================
                                        ;
                                        ;TEXT STRINGS
                                        ;
   5498 9029 07                         mm_brk +         .byte a_bel
                                        
   5499 902A 0D                       +   +         .byte a_cr
                                     +   
   5499 902B 0A                       +            .byte a_lf
                                        
   5500 902C 2A 2A 42 52 4B                       .byte "**BRK"
   5501 9031 0D                       +   +         .byte a_cr
                                     +   
   5501 9032 0A                       +            .byte a_lf
                                        
   5502 9033 00                                   .byte 0
                                        ;
   5504 9034 0D                         mm_entry ++         .byte a_cr
                                     +   
   5504 9035 0A                       +            .byte a_lf
                                        
   5505 9036 0A 53 75 70 65 72 6D 6F              .byte a_lf,"Supermon 832 "
   5505 903E 6E 20 38 33 32 20         
   5506 9044 31                       +            .byte "1"
   5506 9045 2E                       +            .byte "."
   5506 9046 30                       +            .byte "0"
   5506 9047 2E                       +            .byte "."
   5506 9048 30                       +            .byte "0"
                                        
   5507 9049 20                                   .byte " "
   5508 904A 0D                       +   +         .byte a_cr
                                     +   
   5508 904B 0A                       +            .byte a_lf
                                        
   5509 904C 00                                   .byte 0
                                        ;
   5511 904D 20 2A 2A 45 52 52 20 20    mm_err   .byte " **ERR  ",0
   5511 9055 00                        
                                        ;
   5513 9056 0D                         mm_prmpt ++         .byte a_cr
                                     +   
   5513 9057 0A                       +            .byte a_lf
                                        
   5514 9058 1B 28                    +            .byte a_esc,"("
   5514 905A 1B 47 30                 +            .byte a_esc,"G0"
                                        
   5515 905D 2E 00                                .byte ".",0
                                        ;
   5517 905F 0D                         mm_regs ++         .byte a_cr
                                     +   
   5517 9060 0A                       +            .byte a_lf
                                        
   5518 9061 20 20 20 20 20 20 20 20              .byte "                    31"
   5518 9069 20 20 20 20 20 20 20 20   
   5518 9071 20 20 20 20 33 31         
   5519 9077 0D                       +   +         .byte a_cr
                                     +   
   5519 9078 0A                       +            .byte a_lf
                                        
   5520 9079 20 20 20 43 53 20 20 50              .byte "   CS  PB  PC   26NVmxDIZC    .A       .X       .Y       SP  "
   5520 9081 42 20 20 50 43 20 20 20   
   5520 9089 32 36 4E 56 6D 78 44 49   
   5520 9091 5A 43 20 20 20 20 2E 41   
   5520 9099 20 20 20 20 20 20 20 2E   
   5520 90A1 58 20 20 20 20 20 20 20   
   5520 90A9 2E 59 20 20 20 20 20 20   
   5520 90B1 20 53 50 20 20            
   5521 90B6 0D                       +   +         .byte a_cr
                                     +   
   5521 90B7 0A                       +            .byte a_lf
                                        
   5522 90B8 3B 20 00                             .byte "; ",0
   5523 90BB 0D                         mm_regs2 ++         .byte a_cr
                                     +   
   5523 90BC 0A                       +            .byte a_lf
                                        
   5524 90BD 20 20 20 44 53 20 20 20              .byte "   DS   SS  DP  DB"
   5524 90C5 53 53 20 20 44 50 20 20   
   5524 90CD 44 42                     
   5525 90CF 0D                       +   +         .byte a_cr
                                     +   
   5525 90D0 0A                       +            .byte a_lf
                                        
   5526 90D1 3B 20 00                             .byte "; ",0
                                        ;
   5528 90D4 07                         mm_rts +         .byte a_bel
                                        
   5529 90D5 0D                       +   +         .byte a_cr
                                     +   
   5529 90D6 0A                       +            .byte a_lf
                                        
   5530 90D7 2A 2A 52 54 53                       .byte "**RTS"
   5531 90DC 0D                       +   +         .byte a_cr
                                     +   
   5531 90DD 0A                       +            .byte a_lf
                                        
   5532 90DE 00                                   .byte 0
                                        ;
                                        ;================================================================================
                                        ;
                                        ;VECTOR STORAGE
                                        ;
                                        ;
   5835 = 000090DF                      _txtend_ =*                     ;end of program text
                                        ;
                                        ;================================================================================
                                        	;.end
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
FTBios816.asm


                                        .include "supermon832.asm"
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
FAC1ToString.asm

                                        ; ============================================================================
                                        ; FAC1ToString.asm
                                        ;        __
                                        ;   \\__/ o\    (C) 2014  Robert Finch, Stratford
                                        ;    \  __ /    All rights reserved.
                                        ;     \/_//     robfinch<remove>@finitron.ca
                                        ;       ||
                                        ;  
                                        ;
                                        ; This source file is free software: you can redistribute it and/or modify 
                                        ; it under the terms of the GNU Lesser General Public License as published 
                                        ; by the Free Software Foundation, either version 3 of the License, or     
                                        ; (at your option) any later version.                                      
                                        ;                                                                          
                                        ; This source file is distributed in the hope that it will be useful,      
                                        ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                        ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                        ; GNU General Public License for more details.                             
                                        ;                                                                          
                                        ; You should have received a copy of the GNU General Public License        
                                        ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                        ;                                                                          
                                        ; ============================================================================
                                        ;
                                        ; This code is a heavily modified version of the floating point to string
                                        ; conversion routine which is a part of Lee Davison's EhBASIC.
                                        ;
   5867 = 00000000000000C6                            Cvaral		= $C6		; current var address low byte
   5868 = 000000C7                      Cvarah		= Cvaral+1	; current var address high byte
   5869 = 00000000000000C0                            numexp		= $C0		; string to float number exponent count
   5870 = 00000000000000C2                            expcnt		= $C2		; string to float exponent count
   5871 = 00000000000000C4                            Sendl			= $C4	; BASIC pointer temp low byte
   5872 = 00000000000000C5                            Sendh			= $C5	; BASIC pointer temp low byte
                                        
   5874 = 00000000000003A0                            Decss		= $3A0		; number to decimal string start
   5875 = 000003A1                      Decssp1		= Decss+1	; number to decimal string start
   5876 = 0000000000000001                            FP_ADD		EQU		1
   5877 = 0000000000000002                            FP_SUB		EQU		2
   5878 = 0000000000000003                            FP_MUL		EQU		3
   5879 = 0000000000000004                            FP_DIV		EQU		4
   5880 = 0000000000000005                            FP_FIX2FLT	EQU		5
   5881 = 0000000000000006                            FP_FLT2FIX	EQU		6
   5882 = 0000000000000007                            FP_ABS		EQU		7
   5883 = 0000000000000010                            FP_NEG		EQU		16
   5884 = 0000000000000011                            FP_SWAP		EQU		17
   5885 = 0000000000000083                            FIXED_MUL	EQU		$83
   5886 = 0000000000000081                            FIXED_ADD	EQU		$81
   5887 = 0000000000000082                            FIXED_SUB	EQU		$82
                                        ;parameter FIXED_DIV = 8'h84;
                                        ;parameter FIXED_ABS = 8'h87;
                                        ;parameter FIXED_NEG = 8'h90;
   5891 = 0000000000FEA20E                            FP_CMDREG	EQU		$FEA20E
   5892 = 0000000000FEA20E                            FP_STATREG	EQU		$FEA20E
   5893 = 0000000000FEA200                            FAC1		EQU		$FEA200
   5894 = 0000000000FEA200                            FAC1_5		EQU		$FEA200
   5895 = 0000000000FEA202                            FAC1_4		EQU		$FEA202
   5896 = 0000000000FEA204                            FAC1_3		EQU		$FEA204
   5897 = 0000000000FEA206                            FAC1_2		EQU		$FEA206
   5898 = 0000000000FEA208                            FAC1_1		EQU		$FEA208
   5899 = 0000000000FEA208                            FAC1_msw	EQU		$FEA208
   5900 = 0000000000FEA20A                            FAC1_e		EQU		$FEA20A
   5901 = 0000000000FEA210                            FAC2		EQU		$FEA210
                                        
                                           	CPU		W65C816S
                                           	NDX		16
                                           	MEM		16
                                           	
                                           public FAC1ToString:
                                           
                                           ; The first chunk of code determines if the number is positive or negative
                                           ; and spits out the appropriate sign. Next it takes the absolute value of
                                           ; the accumulator so following code only has to deal with positive numbers.
                                           
   5617 0090DF A0 00 00                     	LDY	#$00			; set index = 1
   5618 0090E2 AF 08 A2 FE                  	LDA	FAC1_msw		; test FAC1 sign (b15) (Can't use BIT)
   5619 0090E6 10 0E                        	BPL	.0002		; branch if +ve
   5620 0090E8 A9 2D 00                     	LDA	#'-'			; else character = "-"
   5621 0090EB 99 A0 03                     	STA	Decss,Y		; save leading character (" " or "-")
   5622 0090EE A9 10 00                     	LDA	#FP_NEG		; make the FAC positive
   5623 0090F1 20 18 93                     	JSR	FPCommandWait
   5624 0090F4 80 06                        	BRA	.0001
   5625 0090F6                             .0002:
   5626 0090F6 A9 20 00                     	LDA	#$20			; character = " " (assume +ve)
   5627 0090F9 99 A0 03                     	STA	Decss,Y
   5628 0090FC                             .0001:
   5629 0090FC 84 C4                        	STY	Sendl			; save index
                                           
                                           ; This little bit of code check for a zero exponent which indicates a
                                           ; value of zero.
                                           
   5634 0090FE AF 0A A2 FE                  	LDA	FAC1_e		; get FAC1 exponent
   5635 009102 AA                           	TAX
   5636 009103 D0 06                        	BNE	LAB_2989		; branch if FAC1<>0
                                           					; exponent was $00 so FAC1 is 0
   5638 009105 A9 30 00                     	LDA	#'0'			; set character = "0"
   5639 009108 82 93 01                     	BRL	LAB_2A89		; save last character, [EOT] and exit
                                           
                                           ; This loop attempts to make small values more significant, so that there are
                                           ; fewer leading zeros in the value. (The exponent is decremented so that it
                                           ; corresponds). Because of the potential for extremely small values looping is
                                           ; limited. The problem is the 16 bit exponent can allow for much smaller
                                           ; values than an 8 bit exponent would and we don't want to loop for thousands
                                           ; of iterations in order to display a value that's almost zero.
                                           
                                           					; FAC1 is some non zero value
   5649 00910B                             LAB_2989
   5650 00910B 84 C4                        	STY	Sendl			; save off .Y
   5651 00910D A0 67 06                     	LDY #1639			; max number of retries
   5652 009110 A9 00 00                     	LDA	#$00			; clear (number exponent count)
   5653 009113 85 C0                        	STA numexp
   5654 009115                             LOOP_MBMILLION:
   5655 009115 E0 00 80                     	CPX	#$8000			; compare FAC1 exponent with $8000 (>1.00000)
   5656 009118 B0 1A                        	BCS	LAB_299A		; branch if FAC1=>1
                                           					; FAC1<1
   5658 00911A F4 67 93                     	PEA	A_MILLION		; multiply FAC * 1,000,000
   5659 00911D 20 CD 92                     	JSR	LOAD_FAC2		; 
   5660 009120 68                           	PLA					; get rid of parameter
   5661 009121 20 C7 92                     	JSR	FMUL
   5662 009124 A5 C0                        	LDA numexp
   5663 009126 38                           	SEC
   5664 009127 E9 06 00                     	SBC	#6				; set number exponent count (-6)
   5665 00912A 85 C0                        	STA numexp
   5666 00912C AF 0A A2 FE                  	LDA FAC1_e
   5667 009130 AA                           	TAX
   5668 009131 88                           	DEY
   5669 009132 10 E1                        	BPL	LOOP_MBMILLION
                                           
   5671 009134                             LAB_299A
   5672 009134 A4 C4                        	LDY	Sendl		; get back .Y
                                           
                                           ; These two loops coerce the value of the FAC to be between 100,000 and
                                           ; 1,000,000. This gives a maximum of six digits before the decimal point
                                           ; in scientific notation.
                                           
                                           ; This loop divides by 10 until the value in the FAC is less than 1,000,000
                                           ;
   5680 009136                             LOOP_DB10:
   5681 009136 F4 7F 93                     	PEA	MAX_BEFORE_SCI	; set pointer low byte to 999999.4375 (max before sci note)
   5682 009139 20 CD 92                     	JSR	LOAD_FAC2		; compare FAC1 with (AY)
   5683 00913C 68                           	PLA					; get rid of parameter
   5684 00913D AF 0E A2 FE                  	LDA FP_CMDREG
   5685 009141 89 08 00                     	BIT	#$08			; test equals bit
   5686 009144 D0 28                        	BNE	LAB_29C3		; exit if FAC1 = (AY)
   5687 009146 89 04 00                     	BIT	#$04			; test greater than bit
   5688 009149 F0 07                        	BEQ	LOOP_MB10		; go do *10 if FAC1 < (AY)
                                           
   5690 00914B                             LAB_29B9
   5691 00914B 20 05 93                     	JSR	DivideByTen		; divide by 10
   5692 00914E E6 C0                        	INC	numexp			; increment number exponent count
   5693 009150 80 E4                        	BRA	LOOP_DB10		; go test again (branch always)
                                           
                                           ; This loop multiplies the value by 10 until it's greater than
                                           ; 100,000.
                                           					; FAC1 < (AY)
   5698 009152                             LOOP_MB10
   5699 009152 F4 97 93                     	PEA CONST_9375		; set pointer to 99999.9375
   5700 009155 20 CD 92                     	JSR	LOAD_FAC2		; compare FAC1 with (AY)
   5701 009158 68                           	PLA					; get rid of parameter
   5702 009159 AF 0E A2 FE                  	LDA FP_CMDREG
   5703 00915D 89 08 00                     	BIT #$08
   5704 009160 D0 05                        	BNE	LAB_29B2		; branch if FAC1 = (AY) (allow decimal places)
   5705 009162 89 04 00                     	BIT #$04
   5706 009165 D0 07                        	BNE	LAB_29C0		; branch if FAC1 > (AY) (no decimal places)
                                           					; FAC1 <= (AY)
   5708 009167                             LAB_29B2
   5709 009167 20 F8 92                     	JSR	MultiplyByTen	; multiply by 10
   5710 00916A C6 C0                        	DEC	numexp		; decrement number exponent count
   5711 00916C 80 E4                        	BRA	LOOP_MB10		; go test again (branch always)
                                           
                                           ; now we have just the digits to do
                                           
   5715 00916E                             LAB_29C0
                                           ;	JSR	AddPoint5		; add 0.5 to FAC1 (round FAC1)
   5717 00916E                             LAB_29C3
                                           ;	JSR	FloatToFixed	; convert FAC1 floating-to-fixed
   5719 00916E A2 01 00                     	LDX	#$01			; set default digits before dp = 1
   5720 009171 A5 C0                        	LDA	numexp		; get number exponent count
   5721 009173 18                           	CLC				; clear carry for add
   5722 009174 69 07 00                     	ADC	#$07			; up to 6 digits before point
   5723 009177 30 0A                        	BMI	LAB_29D8		; if -ve then 1 digit before dp
                                           
   5725 009179 C9 08 00                     	CMP	#$08			; A>=8 if n>=1E6
   5726 00917C B0 06                        	BCS	LAB_29D9		; branch if >= $08
                                           
                                           					; carry is clear
   5729 00917E AA                           	TAX				; copy to A
   5730 00917F CA                           	DEX				; take 1 from digit count
   5731 009180 A9 02 00                     	LDA	#$02			;.set exponent adjust
                                           
   5733 009183                             LAB_29D8
   5734 009183 38                           	SEC				; set carry for subtract
   5735 009184                             LAB_29D9
   5736 009184 E9 02 00                     	SBC	#$02			; -2
   5737 009187 85 C2                        	STA	expcnt		;.save exponent adjust
   5738 009189 86 C0                        	STX	numexp		; save digits before dp count
   5739 00918B 8A                           	TXA				; copy to A
   5740 00918C F0 02                        	BEQ	LAB_29E4		; branch if no digits before dp
                                           
   5742 00918E 10 15                        	BPL	LAB_29F7		; branch if digits before dp
                                           
   5744 009190                             LAB_29E4
   5745 009190 A4 C4                        	LDY	Sendl			; get output string index
   5746 009192 A9 2E 00                     	LDA	#'.'			; character "."
   5747 009195 C8                           	INY				; increment index
   5748 009196 99 A0 03                     	STA	Decss,Y		; save to output string
   5749 009199 8A                           	TXA				;.
   5750 00919A F0 07                        	BEQ	LAB_29F5		;.
                                           
   5752 00919C A9 30 00                     	LDA	#'0'			; character "0"
   5753 00919F C8                           	INY				; increment index
   5754 0091A0 99 A0 03                     	STA	Decss,Y		; save to output string
   5755 0091A3                             LAB_29F5
   5756 0091A3 84 C4                        	STY	Sendl			; save output string index
                                           
   5758 0091A5                             LAB_29F7
   5759 0091A5 A2 30 00                     	LDX	#'0'			; holds onto the digit value
                                           
                                           ; Now loop subtracting 100,000 as many times as we can. The value was coerced
                                           ; to be between 100,000 and 1,000,000. Count the number of times subtraction
                                           ; can be done successfully.
                                           ;
   5765 0091A8                             LAB_29FB
   5766 0091A8 F4 73 93                     	PEA CONST_100000
   5767 0091AB 20 CD 92                     	JSR LOAD_FAC2	; load FAC2 with 100,000
   5768 0091AE 68                           	PLA				; get rid of parameter
   5769 0091AF AF 0E A2 FE                  	LDA FP_STATREG
   5770 0091B3 89 04 00                     	BIT #$04		; Is FAC1 > 100,000 ?
   5771 0091B6 F0 0F                        	BEQ	.0005		; branch if not
   5772 0091B8 A9 11 00                     	LDA #FP_SWAP	; subtract is FAC2-FAC1!
   5773 0091BB 20 18 93                     	JSR FPCommandWait;
   5774 0091BE A9 02 00                     	LDA #FP_SUB		; subtract 100,000 from the mantissa.
   5775 0091C1 20 18 93                     	JSR FPCommandWait
   5776 0091C4 E8                           	INX				; increment the value of the digit
   5777 0091C5 80 E1                        	BRA	LAB_29FB	; try again
   5778 0091C7                             .0005:
   5779 0091C7 8A                           	TXA
   5780 0091C8 A4 C4                        	LDY	Sendl			; get output string index
   5781 0091CA C8                           	INY				; increment output string index
   5782 0091CB 8A                           	TXA
   5783 0091CC 99 A0 03                     	STA	Decss,Y		; save to output string
   5784 0091CF C6 C0                        	DEC	numexp		; decrement # of characters before the dp
   5785 0091D1 D0 07                        	BNE	LAB_2A3B		; branch if still characters to do
                                           				; else output the point
   5787 0091D3 A9 2E 00                     	LDA	#'.'			; character "."
   5788 0091D6 C8                           	INY				; increment output string index
   5789 0091D7 99 A0 03                     	STA	Decss,Y		; save to output string
   5790 0091DA                             LAB_2A3B
   5791 0091DA 84 C4                        	STY	Sendl		; save output string index
                                           	; We subtracted until the value was < 100,000 so multiply the
                                           	; remainder upwards to get the next digit.
   5794 0091DC 20 F8 92                     	JSR	MultiplyByTen	; If not, multiply by 10
   5795 0091DF C0 1B 00                     	CPY #27			; converted (+/- . incl)
   5796 0091E2 90 C1                        	BCC	LAB_29F7
                                           					; now remove trailing zeroes
   5798 0091E4                             .RemoveTrailingZeros
   5799 0091E4 B9 A0 03                     	LDA	Decss,Y		; get character from output string
   5800 0091E7 29 FF 00                     	AND	#$FF		; mask to a byte
   5801 0091EA 88                           	DEY				; decrement output string index
   5802 0091EB C9 30 00                     	CMP	#'0'			; compare with "0"
   5803 0091EE F0 F4                        	BEQ	.RemoveTrailingZeros	; loop until non "0" character found
                                           
   5805 0091F0 C9 2E 00                     	CMP	#'.'			; compare with "."
   5806 0091F3 F0 01                        	BEQ	LAB_2A58		; branch if was dp
                                           
                                           					; restore last character
   5809 0091F5 C8                           	INY				; increment output string index
   5810 0091F6                             LAB_2A58
   5811 0091F6 A9 2B 00                     	LDA	#'+'			; character "+"
   5812 0091F9 A6 C2                        	LDX	expcnt		; get exponent count
   5813 0091FB F0 FF A2 00                  	LBEQ	LAB_2A8C		; if zero go set null terminator and exit
                                           
                                           					; exponent isn't zero so write exponent
   5816 0091FF 10 0A                        	BPL	LAB_2A68		; branch if exponent count +ve
                                           
   5818 009201 A9 00 00                     	LDA	#$00			; clear A
   5819 009204 38                           	SEC				; set carry for subtract
   5820 009205 E5 C2                        	SBC	expcnt		; subtract exponent count adjust (convert -ve to +ve)
   5821 009207 AA                           	TAX				; copy exponent count to X
   5822 009208 A9 2D 00                     	LDA	#'-'			; character "-"
                                           
                                           ; We must keep moving forwards through the string because the acc is storing
                                           ; two bytes.
                                           
   5827 00920B                             LAB_2A68
   5828 00920B 48                           	PHA
   5829 00920C A9 45 00                     	LDA	#'E'			; character "E"
   5830 00920F 99 A1 03                     	STA	Decss+1,Y		; save exponent sign to output string
   5831 009212 68                           	PLA
   5832 009213 99 A2 03                     	STA	Decss+2,Y		; save to output string
   5833 009216 8A                           	TXA				; get exponent count back
                                           
                                           ; do highest exponent digit
   5836 009217 64 C4                        	STZ Sendl
   5837 009219 A2 2F 00                     	LDX	#'0'-1		; one less than "0" character
   5838 00921C 38                           	SEC				; set carry for subtract
   5839 00921D E8                          .0001:				
   5840 00921E E9 10 27                     	SBC	#10000
   5841 009221 B0 FA                        	BCS .0001
   5842 009223 69 10 27                     	ADC #10000
   5843 009226 E0 30 00                     	CPX #'0'
   5844 009229 F0 09                        	BEQ .0005
   5845 00922B E6 C4                        	INC Sendl
   5846 00922D 48                           	PHA
   5847 00922E 8A                           	TXA
   5848 00922F 99 A3 03                     	STA Decss+3,Y
   5849 009232 68                           	PLA
   5850 009233 C8                           	INY
                                           ; do the next exponent digit
   5852 009234                             .0005:
   5853 009234 A2 2F 00                     	LDX #'0'-1
   5854 009237 38                           	SEC
   5855 009238                             .0002:
   5856 009238 E8                           	INX
   5857 009239 E9 E8 03                     	SBC #1000
   5858 00923C B0 FA                        	BCS .0002
   5859 00923E 69 E8 03                     	ADC #1000
   5860 009241 46 C4                        	LSR Sendl
   5861 009243 B0 05                        	BCS .00010
   5862 009245 E0 30 00                     	CPX #'0'
   5863 009248 F0 09                        	BEQ .0006
   5864 00924A                             .00010:
   5865 00924A E6 C4                        	INC Sendl
   5866 00924C 48                           	PHA
   5867 00924D 8A                           	TXA
   5868 00924E 99 A3 03                     	STA Decss+3,Y
   5869 009251 68                           	PLA
   5870 009252 C8                           	INY
                                           ; and the next
   5872 009253                             .0006:
   5873 009253 A2 2F 00                     	LDX	#'0'-1
   5874 009256 38                           	SEC
   5875 009257                             .0003:
   5876 009257 E8                           	INX
   5877 009258 E9 64 00                     	SBC #100
   5878 00925B B0 FA                        	BCS .0003
   5879 00925D 69 64 00                     	ADC #100
   5880 009260 46 C4                        	LSR Sendl
   5881 009262 B0 05                        	BCS .00011
   5882 009264 E0 30 00                     	CPX #'0'
   5883 009267 F0 09                        	BEQ .0007
   5884 009269                             .00011:
   5885 009269 E6 C4                        	INC Sendl
   5886 00926B 48                           	PHA
   5887 00926C 8A                           	TXA
   5888 00926D 99 A3 03                     	STA Decss+3,Y
   5889 009270 68                           	PLA
   5890 009271 C8                           	INY
                                           
   5892 009272                             .0007:
   5893 009272 A2 2F 00                     	LDX #'0'-1
   5894 009275 38                           	SEC
   5895 009276                             .0004:
   5896 009276 E8                           	INX
   5897 009277 E9 0A 00                     	SBC #10
   5898 00927A B0 FA                        	BCS .0004
   5899 00927C 69 0A 00                     	ADC #10
   5900 00927F 46 C4                        	LSR Sendl
   5901 009281 B0 05                        	BCS .00012
   5902 009283 E0 30 00                     	CPX #'0'
   5903 009286 F0 09                        	BEQ .0008
   5904 009288                             .00012:
   5905 009288 E6 C4                        	INC Sendl
   5906 00928A 48                           	PHA
   5907 00928B 8A                           	TXA
   5908 00928C 99 A3 03                     	STA Decss+3,Y
   5909 00928F 68                           	PLA
   5910 009290 C8                           	INY
                                           
   5912 009291                             .0008:
   5913 009291 69 30 00                     	ADC #'0'
   5914 009294 99 A3 03                     	STA Decss+3,Y
   5915 009297 A9 00 00                     	LDA	#$00			; set null terminator
   5916 00929A 99 A4 03                     	STA	Decss+4,Y		; save to output string
   5917 00929D 60                           	RTS					; go set string pointer (AY) and exit (branch always)
                                           
   5919 00929E                             LAB_2A89
   5920 00929E 99 A0 03                     	STA	Decss,Y		; save last character to output string
                                           					; set null terminator and exit
   5922 0092A1                             LAB_2A8C
   5923 0092A1 A9 00 00                     	LDA	#$00			; set null terminator
   5924 0092A4 99 A1 03                     	STA	Decss+1,Y		; save after last character
                                           
   5926 0092A7                             LAB_2A91
                                           ;	LDA	#<Decssp1		; set result string low pointer
                                           ;	LDY	#>Decssp1		; set result string high pointer
   5929 0092A7 60                           	RTS
                                           
   5931 0092A8                             LAB_25FB:
   5932 0092A8 A9 11 00                     	LDA		#FP_SWAP
   5933 0092AB 20 18 93                     	JSR		FPCommandWait
   5934 0092AE A0 00 00                     	LDY		#0
   5935 0092B1 BB                           	TYX
   5936 0092B2                             .0002:
   5937 0092B2 B3 03                        	LDA		(3,S),Y
   5938 0092B4 9F 00 A2 FE                  	STA		FAC1,X
   5939 0092B8 C8                           	INY
   5940 0092B9 C8                           	INY
   5941 0092BA E8                           	INX
   5942 0092BB E8                           	INX
   5943 0092BC E0 0C 00                     	CPX		#12
   5944 0092BF D0 F1                        	BNE		.0002
   5945 0092C1 A9 05 00                     	LDA		#FP_FIX2FLT
   5946 0092C4 20 18 93                     	JSR		FPCommandWait
   5947 0092C7                             FMUL:
   5948 0092C7 A9 03 00                     	LDA		#FP_MUL
   5949 0092CA 4C 18 93                     	JMP		FPCommandWait
   5950 0092CD                             	
   5951 0092CD DA                           	PHX
   5952 0092CE 5A                           	PHY
   5953 0092CF A0 00 00                     	LDY		#0
   5954 0092D2 BB                           	TYX
   5955 0092D3                             .0002:
   5956 0092D3 B3 07                        	LDA		(7,s),Y
   5957 0092D5 9F 10 A2 FE                  	STA		FAC2,X
   5958 0092D9 C8                           	INY
   5959 0092DA C8                           	INY
   5960 0092DB E8                           	INX
   5961 0092DC E8                           	INX
   5962 0092DD E0 0C 00                     	CPX		#12
   5963 0092E0 D0 F1                        	BNE		.0002
   5964 0092E2 7A                           	PLY
   5965 0092E3 FA                           	PLX
   5966 0092E4 60                           	RTS
   5967 0092E5                             	
   5968 0092E5 A9 06 00                     	LDA		#FP_FLT2FIX
   5969 0092E8 4C 18 93                     	JMP		FPCommandWait
   5970 0092EB                             	
   5971 0092EB F4 A3 93                     	PEA		CONST_POINT5
   5972 0092EE 20 CD 92                     	JSR		LOAD_FAC2
   5973 0092F1 68                           	PLA
   5974 0092F2 A9 01 00                     	LDA		#FP_ADD
   5975 0092F5 4C 18 93                     	JMP		FPCommandWait
   5976 0092F8                             	
   5977 0092F8 F4 8B 93                     	PEA		TEN_AS_FLOAT
   5978 0092FB 20 CD 92                     	JSR		LOAD_FAC2
   5979 0092FE 68                           	PLA
   5980 0092FF A9 03 00                     	LDA		#FP_MUL
   5981 009302 4C 18 93                     	JMP		FPCommandWait
                                           	
   5983 009305 F4 8B 93                     	PEA		TEN_AS_FLOAT
   5984 009308 20 CD 92                     	JSR		LOAD_FAC2
   5985 00930B 68                           	PLA
   5986 00930C 20 15 93                     	JSR		SwapFACs
   5987 00930F A9 04 00                     	LDA		#FP_DIV
   5988 009312 4C 18 93                     	JMP		FPCommandWait
   5989 009315                             	
   5990 009315 A9 11 00                     	LDA		#FP_SWAP
                                           
                                           ; Issue a command to the FP unit and wait for it to complete
                                           ;
                                           public FPCommandWait:
   5995 009318 48                           	PHA
   5996 009319 A9 06 00                     	LDA		#6
   5997 00931C 8D 00 70                     	STA		$7000
   5998 00931F                             .0001:
   5999 00931F AF 0E A2 FE                  	LDA		FP_STATREG	; get the status register
   6000 009323 89 80 00                     	BIT		#$80		; check for busy bit
   6001 009326 D0 F7                        	BNE		.0001		; if busy go back
   6002 009328 68                           	PLA					; to pop acc
   6003 009329 8F 0E A2 FE                  	STA		FP_CMDREG	; store the command
   6004 00932D 48                           	PHA
   6005 00932E A9 07 00                     	LDA		#7
   6006 009331 8D 00 70                     	STA		$7000
   6007 009334 68                           	PLA
   6008 009335 60                           	RTS
                                           
                                           ; Display the FAC1 as a hex number
                                           ;
                                           public DispFAC1:
   6013 009336 AF 0A A2 FE                  	LDA FAC1_e
   6014 00933A 20 A4 CC                     	JSR DispWord
   6015 00933D AF 08 A2 FE                  	LDA	FAC1_1
   6016 009341 20 A4 CC                     	JSR	DispWord
   6017 009344 AF 06 A2 FE                  	LDA FAC1_2
   6018 009348 20 A4 CC                     	JSR	DispWord
   6019 00934B AF 04 A2 FE                  	LDA FAC1_3
   6020 00934F 20 A4 CC                     	JSR DispWord
   6021 009352 AF 02 A2 FE                  	LDA FAC1_4
   6022 009356 20 A4 CC                     	JSR DispWord
   6023 009359 AF 00 A2 FE                  	LDA FAC1_5
   6024 00935D 20 A4 CC                     	JSR DispWord
   6025 009360 A9 20 00                     	LDA #' '
   6026 009363 20 C4 CB                     	JSR OutChar
   6027 009366 60                           	RTS
                                           ;
                                           ; 1,000,000 as a floating point number
                                           ;
   6031 009367                             A_MILLION:	; $F4240
   6032 009367 00 00                        	dw		$0000
   6033 009369 00 00                        	dw		$0000
   6034 00936B 00 00                        	dw		$0000
   6035 00936D 00 00                        	dW		$0000
   6036 00936F 12 7A                        	dw		$7A12
   6037 009371 13 80                        	dw		$8013
                                           
   6039 009373                             CONST_100000:
                                           	;186A0
   6041 009373 00 00                        	dw		$0000
   6042 009375 00 00                        	dw		$0000
   6043 009377 00 00                        	dw		$0000
   6044 009379 00 00                        	dw		$0000
   6045 00937B A8 61                        	dw		$61A8
   6046 00937D 10 80                        	dw		$8010
                                           ; The constant 999999.4375 as hex
                                           ; 01.11_1010_0001_0001_1111_1011_1000_00000000000000000000000000
   6049 00937F                             MAX_BEFORE_SCI:
   6050 00937F 00 00                        	dw  $0000
   6051 009381 00 00                        	dw  $0000
   6052 009383 00 00                        	dw	$0000
   6053 009385 80 FB                        	dw	$FB80
   6054 009387 11 7A                        	dw	$7A11
   6055 009389 13 80                        	dw	$8013
                                           
   6057 00938B                             TEN_AS_FLOAT:
   6058 00938B 00 00                        	dw	$0000
   6059 00938D 00 00                        	dw	$0000
   6060 00938F 00 00                        	dw	$0000
   6061 009391 00 00                        	dw	$0000
   6062 009393 00 50                        	dw	$5000
   6063 009395 03 80                        	dw	$8003
                                           
                                           ; 99999.9375
                                           ; 01.10_0001_1010_0111_1111_1100_000000000000000000000000000000
                                           ;
   6068 009397                             CONST_9375:
   6069 009397 00 00                        	dw	$0000
   6070 009399 00 00                        	dw	$0000
   6071 00939B 00 00                        	dw	$0000
   6072 00939D 00 FC                        	dw	$FC00
   6073 00939F A7 61                        	dw	$61A7
   6074 0093A1 10 80                        	dw	$8010
                                           
                                           ; 0.5
   6077 0093A3                             CONST_POINT5:
   6078 0093A3 00 00                        	dw	$0000
   6079 0093A5 00 00                        	dw	$0000
   6080 0093A7 00 00                        	dw	$0000
   6081 0093A9 00 00                        	dw	$0000
   6082 0093AB 00 40                        	dw	$4000
   6083 0093AD FF 7F                        	dw	$7FFF
                                           
                                           ; This table is used in converting numbers to ASCII.
                                           
   6087 0093AF                             LAB_2A9A
   6384 = 000093B0                         LAB_2A9B = LAB_2A9A+1
   6385 = 000093B1                         LAB_2A9C = LAB_2A9B+1
                                           ;	.word	$FFFF,$F21F,$494C,$589C,$0000
                                           ;	.word	$0000,$0163,$4578,$5D8A,$0000
                                           ;	.word	$FFFF,$FFDC,$790D,$903F,$0000
                                           ;	.word	$0000,$0003,$8D7E,$A4C6,$8000
                                           ;	.word	$FFFF,$FFFF,$A50C,$EF85,$C000
                                           ;	.word	$0000,$0000,$0918,$4E72,$A000
                                           ;	.word	$FFFF,$FFFF,$FF17,$2B5A,$F000
                                           ;	.word	$0000,$0000,$0017,$4876,$E800
                                           ;	.word	$FFFF,$FFFF,$FFFD,$ABF4,$1C00
                                           ;	.word	$0000,$0000,$0000,$3B9A,$CA00
                                           ;	.word	$FFFF,$FFFF,$FFFF,$FF67,$6980
                                           ;	.word	$0000,$0000,$0000,$05F5,$E100		; 100000000
                                           ;	.word	$0000,$0000,$0098,$9680		; 10000000
                                           ;	.word   $4240,$000F,$0000,$0000,$0000,$804E		; 1000000
   6104 0093AF A0 86 01 00 00 00 00 00      	.word	$86A0,$0001,$0000,$0000,$0000,$804E		; 100000
   6104 0093B7 00 00 4E 80                
   6105 0093BB 10 27 00 00 00 00 00 00      	.word	$2710,$0000,$0000,$0000,$0000,$804E		; 10000
   6105 0093C3 00 00 4E 80                
   6106 0093C7 E8 03 00 00 00 00 00 00      	.word	$03E8,$0000,$0000,$0000,$0000,$804E		; 1000
   6106 0093CF 00 00 4E 80                
   6107 0093D3 64 00 00 00 00 00 00 00      	.word	$0064,$0000,$0000,$0000,$0000,$804E		; 100
   6107 0093DB 00 00 4E 80                
   6108 0093DF                             FIXED10:
   6109 0093DF 0A 00 00 00 00 00 00 00      	.word	$000A,$0000,$0000,$0000,$0000,$804E		; 10
   6109 0093E7 00 00 4E 80                
   6110 0093EB 01 00 00 00 00 00 00 00      	.word	$0001,$0000,$0000,$0000,$0000,$804E		; 1
   6110 0093F3 00 00 4E 80                
                                           
                                           		 MEM	16
                                           		 NDX	16
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
FTBios816.asm


                                           .include "FAC1ToString.asm"
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
invaders.asm

                                           	CPU		FT832
                                           
   6419 = 0000000000FEA100                               PRNG		EQU		$FEA100
   6420 = 0000000000FEA108                               PRNG_NUM	EQU		$FEA108
   6421 = 0000000000FEA10E                               PRNG_ADV	EQU		$FEA10E
   6422 = 0000000000000001                               MAN_EXPLODING	EQU		1
                                           
                                           ; which invaders are still active (not destroyed)
                                           ; These var addresses are segment offsets into seg $7800
   6426 = 0000000000000000                               active				EQU		$00
   6427 = 000000000000005E                               left_right			EQU		$5E
   6428 = 0000000000000060                               rightmost_column	EQU		$60
   6429 = 0000000000000062                               leftmost_column		EQU		$62
   6430 = 0000000000000064                               bottom_row			EQU		$64
   6431 = 0000000000000066                               top_row				EQU		$66
   6432 = 000000000000006A                               inv_tick			EQU		$6A
   6433 = 000000000000006C                               inv_tick2			EQU		$6C
   6434 = 000000000000006E                               manX				EQU		$6E
   6435 = 0000000000000070                               manY				EQU		$70
   6436 = 0000000000000072                               manState			EQU		$72
   6437 = 0000000000000100                               InvadersX			EQU		$100
   6438 = 0000000000000200                               InvadersY			EQU		$200
   6439 = 0000000000000300                               min_right			EQU		$300
   6440 = 0000000000000310                               max_left			EQU		$310
   6441 = 0000000000000320                               bombX				EQU		$320
   6442 = 0000000000000330                               bombY				EQU		$330
   6443 = 0000000000000400                               inv_state			EQU		$400
                                           
                                           ; This var is shared, must be referenced ZS:
   6446 = 0000000000007868                               do_invaders			EQU		$7868
                                           
                                           	; minimum right +         .byte a_esc,"`0"
                                           -ordinate for each column of invaders
   6148 0093F7                             st_min_right:
   6149 0093F7 01 00                        	.word	1
   6150 0093F9 05 00                        	.word	5
   6151 0093FB 09 00                        	.word	9
   6152 0093FD 0D 00                        	.word	13
   6153 0093FF 11 00                        	.word	17
   6154 009401 15 00                        	.word	21
   6155 009403 19 00                        	.word	25
   6156 009405 1D 00                        	.word	29
                                           
                                           	; maximum left +         .byte a_esc,"`0"
                                           -ordinate for each column of invaders
   6160 009407 34 00                        	.word	52
   6161 009409 38 00                        	.word	56
   6162 00940B 3C 00                        	.word	60
   6163 00940D 40 00                        	.word	64
   6164 00940F 44 00                        	.word	68
   6165 009411 48 00                        	.word	72
   6166 009413 4C 00                        	.word	76
   6167 009415 50 00                        	.word	80
                                           
   6169 009417 00 00                        	.word	0		; rightmost column
   6170 009419 07 00                        	.word	7		; lefmost column
   6171 00941B 01 00                        	.word	1		; dx
                                           
                                           	MEM		16
                                           	NDX		16
                                           
                                           	code
                                           
   6178 00941D                             InvBomb:
   6179 00941D A2 00 00                     	LDX		#0
   6180 009420                             .0001:
   6181 009420 B5 00                        	LDA		active,X
   6182 009422 F0 27                        	BEQ		.0002
   6183 009424 20 FC 94                     	JSR		CanDropBomb
   6184 009427 F0 22                        	BEQ		.0002
   6185 009429 42 5B AF 08 A1 FE            	LDA		ZS:PRNG_NUM
   6186 00942F 42 5B 8F 0E A1 FE            	STA		ZS:PRNG_ADV
   6187 009435 29 63 00                     	AND		#$63
   6188 009438 D0 11                        	BNE		.0002
   6189 00943A 20 53 94                     	JSR		FindEmptyBomb
   6190 00943D 30 13                        	BMI		.0003
   6191 00943F BD 00 01                     	LDA		InvadersX,X
   6192 009442 99 20 03                     	STA		bombX,Y
   6193 009445 BD 00 02                     	LDA		InvadersY,X
   6194 009448 99 30 03                     	STA		bombY,Y
   6195 00944B                             .0002:
   6196 00944B E8                           	INX
   6197 00944C E8                           	INX
   6198 00944D E0 50 00                     	CPX		#80
   6199 009450 30 CE                        	BMI		.0001
   6200 009452                             .0003:
   6201 009452 60                           	RTS
                                           
   6203 009453                             FindEmptyBomb:
   6204 009453 A0 00 00                     	LDY		#0
   6205 009456                             .0001:
   6206 009456 B9 20 03                     	LDA		bombX,Y
   6207 009459 F0 0A                        	BEQ		.0002
   6208 00945B C8                           	INY
   6209 00945C C8                           	INY
   6210 00945D C0 10 00                     	CPY		#16
   6211 009460 30 F4                        	BMI		.0001
   6212 009462 A0 FF FF                     	LDY		#-1
   6213 009465                             .0002:
   6214 009465 60                           	RTS
                                           
   6216 009466                             MoveBombs:
   6217 009466 A2 00 00                     	LDX		#0
   6218 009469                             .0002:
   6219 009469 BD 20 03                     	LDA		bombX,X
   6220 00946C F0 14                        	BEQ		.0001
   6221 00946E BD 30 03                     	LDA		bombY,X
   6222 009471 C9 1E 00                     	CMP		#30			; has the bomb fallen all the way to the ground ?
   6223 009474 10 06                        	BPL		.0003		; if yes, reset bomb
   6224 009476 1A                           	INA
   6225 009477 9D 30 03                     	STA		bombY,X
   6226 00947A 80 06                        	BRA		.0001
   6227 00947C                             .0003:
   6228 00947C 9E 20 03                     	STZ		bombX,X
   6229 00947F 9E 30 03                     	STZ		bombY,X
   6230 009482                             .0001:
   6231 009482 E8                           	INX
   6232 009483 E8                           	INX
   6233 009484 E0 10 00                     	CPX		#16
   6234 009487 30 E0                        	BMI		.0002
   6235 009489 60                           	RTS
                                           
   6237 00948A                             GetBombOffset:
   6238 00948A B9 30 03                     	LDA		bombY,Y
   6239 00948D 0A                           	ASL
   6240 00948E AA                           	TAX
   6241 00948F 42 5B BD 3F DD               	LDA		ZS:LineTbl,X
   6242 009494 18                           	CLC
   6243 009495 79 20 03                     	ADC		bombX,Y
   6244 009498 79 20 03                     	ADC		bombX,Y
   6245 00949B AA                           	TAX
   6246 00949C 60                           	RTS
                                           
   6248 00949D                             RenderBombs:
   6249 00949D A0 00 00                     	LDY		#0
   6250 0094A0                             .0001:
   6251 0094A0 B9 30 03                     	LDA		bombY,Y
   6252 0094A3 F0 0C                        	BEQ		.0002
   6253 0094A5 20 8A 94                     	JSR		GetBombOffset
   6254 0094A8 A9 24 00                     	LDA		#'$'
   6255 0094AB 42 5B 9F 00 00 0D            	STA		ZS:VIDBUF,X
   6256 0094B1                             .0002:
   6257 0094B1 C8                           	INY
   6258 0094B2 C8                           	INY
   6259 0094B3 C0 10 00                     	CPY		#16
   6260 0094B6 30 E8                        	BMI		.0001
   6261 0094B8 60                           	RTS
                                           
   6263 0094B9                             TestBombsIntercept:
   6264 0094B9 A0 00 00                     	LDY		#0
   6265 0094BC                             .0001:
   6266 0094BC 20 C7 94                     	JSR		TestBombIntercept
   6267 0094BF C8                           	INY
   6268 0094C0 C8                           	INY
   6269 0094C1 C0 10 00                     	CPY		#16
   6270 0094C4 30 F6                        	BMI		.0001
   6271 0094C6 60                           	RTS
                                           
   6273 0094C7                             TestBombIntercept:
   6274 0094C7 20 8A 94                     	JSR		GetBombOffset
   6275 0094CA 42 5B BF 00 00 0D            	LDA		ZS:VIDBUF,X
   6276 0094D0 C9 20 00                     	CMP		#' '
   6277 0094D3 F0 1D                        	BEQ		.0001
   6278 0094D5 B9 30 03                     	LDA		bombY,Y
   6279 0094D8 C9 1D 00                     	CMP		#29
   6280 0094DB D0 16                        	BNE		.0002
   6281 0094DD B9 20 03                     	LDA		bombX,Y
   6282 0094E0 D9 6E 00                     	CMP		manX,Y
   6283 0094E3 D0 05                        	BNE		.0003
   6284 0094E5 A9 01 00                     	LDA		#MAN_EXPLODING
   6285 0094E8 85 72                        	STA		manState
   6286 0094EA                             .0003:
   6287 0094EA BB                           	TYX
   6288 0094EB 9E 30 03                     	STZ		bombY,X
   6289 0094EE 9E 20 03                     	STZ		bombX,X
   6290 0094F1 60                           	RTS
   6291 0094F2                             .0001:
   6292 0094F2 60                           	RTS
   6293 0094F3                             .0002:
   6294 0094F3 A9 20 00                     	LDA		#' '
   6295 0094F6 9F 00 00 0D                  	STA		VIDBUF,X
   6296 0094FA 80 EE                        	BRA		.0003
                                           
                                           ; An invader can drop a bomb only if there are no invaders underneath it.
                                           
   6300 0094FC                             CanDropBomb:
   6301 0094FC E0 0F 00                     	CPX		#15
   6302 0094FF 10 0C                        	BGE		.0001
   6303 009501 B5 10                        	LDA		active+16,X
   6304 009503 15 20                        	ORA		active+32,X
   6305 009505 15 30                        	ORA		active+48,X
   6306 009507 15 40                        	ORA		active+64,X
   6307 009509 49 01 00                     	EOR		#1
   6308 00950C 60                           	RTS
   6309 00950D                             .0001:
   6310 00950D E0 1F 00                     	CPX		#31
   6311 009510 10 0A                        	BGE		.0002
   6312 009512 B5 10                        	LDA		active+16,X
   6313 009514 15 20                        	ORA		active+32,X
   6314 009516 15 30                        	ORA		active+48,X
   6315 009518 49 01 00                     	EOR		#1
   6316 00951B 60                           	RTS
   6317 00951C                             .0002:
   6318 00951C E0 2F 00                     	CPX		#47
   6319 00951F 10 08                        	BGE		.0003
   6320 009521 B5 10                        	LDA		active+16,X
   6321 009523 15 20                        	ORA		active+32,X
   6322 009525 49 01 00                     	EOR		#1
   6323 009528 60                           	RTS
   6324 009529                             .0003:
   6325 009529 E0 3F 00                     	CPX		#63
   6326 00952C 10 06                        	BGE		.0004
   6327 00952E B5 10                        	LDA		active+16,X
   6328 009530 49 01 00                     	EOR		#1
   6329 009533 60                           	RTS
   6330 009534                             .0004:
   6331 009534 A9 01 00                     	LDA		#1
   6332 009537 60                           	RTS
                                           
                                           
                                           ; Test if it's possible to move to the left anymore.
                                           ;
   6337 009538                             CanMoveLeft:
   6338 009538 A5 62                        	LDA		leftmost_column
   6339 00953A 0A                           	ASL
   6340 00953B AA                           	TAX
   6341 00953C BD 10 03                     	LDA		max_left,X
   6342 00953F DD 00 01                     	CMP		InvadersX,X
   6343 009542 30 04                        	BMI		.0001
   6344 009544 A9 00 00                     	LDA		#0
   6345 009547 60                           	RTS
   6346 009548                             .0001:
   6347 009548 A9 01 00                     	LDA		#1
   6348 00954B 60                           	RTS
                                           
                                           ; Test if it's possible to move to the right anymore.
                                           ;
   6352 00954C                             CanMoveRight:
   6353 00954C A5 60                        	LDA		rightmost_column
   6354 00954E 0A                           	ASL
   6355 00954F AA                           	TAX
   6356 009550 BD 00 03                     	LDA		min_right,X
   6357 009553 DD 00 01                     	CMP		InvadersX,X
   6358 009556 10 04                        	BPL		.0001
   6359 009558 A9 00 00                     	LDA		#0
   6360 00955B 60                           	RTS
   6361 00955C                             .0001:
   6362 00955C A9 01 00                     	LDA		#1
   6363 00955F 60                           	RTS
                                           
                                           ; Test if it's possible to move down anymore
                                           ;
   6367 009560                             CanMoveDown:
   6368 009560 A5 64                        	LDA		bottom_row
   6369 009562 0A                           	ASL
   6370 009563 0A                           	ASL
   6371 009564 0A                           	ASL
   6372 009565 0A                           	ASL
   6373 009566 AA                           	TAX
   6374 009567 BD 00 02                     	LDA		InvadersY,X
   6375 00956A C9 1E 00                     	CMP		#30
   6376 00956D 30 04                        	BMI		.0001
   6377 00956F A9 00 00                     	LDA		#0
   6378 009572 60                           	RTS
   6379 009573                             .0001:
   6380 009573 A9 01 00                     	LDA		#1
   6381 009576 60                           	RTS
                                           
                                           ; Move all the invaders to the left
                                           ; Means incrementing the X co-ordinate
                                           ;
   6386 009577                             MoveLeft:
   6387 009577 A2 00 00                     	LDX		#00
   6388 00957A                             .0002:
   6389 00957A FE 00 01                     	INC		InvadersX,X
   6390 00957D E8                           	INX
   6391 00957E E8                           	INX
   6392 00957F E0 50 00                     	CPX		#80
   6393 009582 D0 F6                        	BNE		.0002
   6394 009584 60                           	RTS
                                           
                                           ; Move all the invaders to the right.
                                           ; means decrementing the X co-ordinate
                                           ;
   6399 009585                             MoveRight:
   6400 009585 A2 00 00                     	LDX		#0
   6401 009588                             .0002:
   6402 009588 DE 00 01                     	DEC		InvadersX,X
   6403 00958B E8                           	INX
   6404 00958C E8                           	INX
   6405 00958D E0 50 00                     	CPX		#80
   6406 009590 D0 F6                        	BNE		.0002
   6407 009592 60                           	RTS
                                           
                                           ; Move all the invaders down a row.
                                           ; Means incrementing the Y co-ordinate
                                           ;
   6412 009593                             MoveDown:
   6413 009593 A2 00 00                     	LDX		#00
   6414 009596                             .0002:
   6415 009596 FE 00 02                     	INC		InvadersY,X
   6416 009599 E8                           	INX
   6417 00959A E8                           	INX
   6418 00959B E0 50 00                     	CPX		#80
   6419 00959E D0 F6                        	BNE		.0002
   6420 0095A0 60                           	RTS
                                           
                                           ; Move the invaders
                                           ; Retuns
                                           ; .A = 1 if it was possible to do a move, 0 otherwise
                                           ;
   6426 0095A1                             Move:
   6427 0095A1 24 5E                        	BIT		left_right
   6428 0095A3 30 0A                        	BMI		.0002
   6429 0095A5 20 38 95                     	JSR		CanMoveLeft
   6430 0095A8 F0 0F                        	BEQ		.0001
   6431 0095AA 20 77 95                     	JSR		MoveLeft
   6432 0095AD 80 19                        	BRA		.0003
   6433 0095AF                             .0002:
   6434 0095AF 20 4C 95                     	JSR		CanMoveRight
   6435 0095B2 F0 05                        	BEQ		.0001
   6436 0095B4 20 85 95                     	JSR		MoveRight
   6437 0095B7 80 0F                        	BRA		.0003
   6438 0095B9                             .0001:
   6439 0095B9 20 60 95                     	JSR		CanMoveDown
   6440 0095BC F0 0E                        	BEQ		.0004
   6441 0095BE A5 5E                        	LDA		left_right
   6442 0095C0 49 FF FF                     	EOR		#$FFFF
   6443 0095C3 85 5E                        	STA		left_right
   6444 0095C5 20 93 95                     	JSR		MoveDown
   6445 0095C8                             .0003:
   6446 0095C8 A9 01 00                     	LDA		#1
   6447 0095CB 60                           	RTS
   6448 0095CC                             .0004:
   6449 0095CC A9 00 00                     	LDA		#0
   6450 0095CF 60                           	RTS
                                           
   6452 0095D0                             Initialize:
   6453 0095D0 64 60                        	STZ		rightmost_column
   6454 0095D2 A9 07 00                     	LDA		#7
   6455 0095D5 85 62                        	STA		leftmost_column
   6456 0095D7 64 66                        	STZ		top_row
   6457 0095D9 A9 04 00                     	LDA		#4
   6458 0095DC 85 64                        	STA		bottom_row
   6459 0095DE 64 5E                        	STZ		left_right
   6460 0095E0 20 28 96                     	JSR		ActivateAllInvaders
   6461 0095E3 A2 00 00                     	LDX		#0
   6462 0095E6                             .0001:
   6463 0095E6 42 1B BD 3B 9A               	LDA		CS:StartX,X
   6464 0095EB 9D 00 01                     	STA		InvadersX,X
   6465 0095EE 42 1B BD EB 99               	LDA		CS:StartY,X
   6466 0095F3 9D 00 02                     	STA		InvadersY,X
   6467 0095F6 E8                           	INX
   6468 0095F7 E8                           	INX
   6469 0095F8 E0 50 00                     	CPX		#80
   6470 0095FB 30 E9                        	BMI		.0001
   6471 0095FD A2 00 00                     	LDX		#0
   6472 009600                             .0002:
   6473 009600 42 1B BD F7 93               	LDA		CS:st_min_right,X
   6474 009605 9D 00 03                     	STA		min_right,X
   6475 009608 E8                           	INX
   6476 009609 E8                           	INX
   6477 00960A E0 20 00                     	CPX		#32
   6478 00960D 30 F1                        	BMI		.0002
                                           	; Initialize Bombs
   6480 00960F A2 00 00                     	LDX		#0
   6481 009612                             .0003:
   6482 009612 9E 20 03                     	STZ		bombX,X
   6483 009615 9E 30 03                     	STZ		bombY,X
   6484 009618 E8                           	INX
   6485 009619 E8                           	INX
   6486 00961A E0 10 00                     	CPX		#16
   6487 00961D 30 F3                        	BMI		.0003
   6488 00961F A9 FE FF                     	LDA		#$FFFE
   6489 009622 42 5B 8D 68 78               	STA		ZS:do_invaders
   6490 009627 60                           	RTS
                                           
   6492 009628                             ActivateAllInvaders:
   6493 009628 A2 00 00                     	LDX		#0
   6494 00962B A9 01 00                     	LDA		#1
   6495 00962E                             .0001:
   6496 00962E 95 00                        	STA		active,X
   6497 009630 E8                           	INX
   6498 009631 E8                           	INX
   6499 009632 E0 50 00                     	CPX		#80
   6500 009635 D0 F7                        	BNE		.0001
   6501 009637 60                           	RTS
                                           
   6503 009638                             IsAllDestroyed:
   6504 009638 20 C0 96                     	JSR		IsRightmostColumnDestroyed
   6505 00963B F0 2C                        	BEQ		.0001
   6506 00963D E6 60                        	INC		rightmost_column
   6507 00963F AD 0C 03                     	LDA		min_right+12
   6508 009642 8D 0E 03                     	STA		min_right+14
   6509 009645 AD 0A 03                     	LDA		min_right+10
   6510 009648 8D 0C 03                     	STA		min_right+12
   6511 00964B AD 08 03                     	LDA		min_right+8
   6512 00964E 8D 0A 03                     	STA		min_right+10
   6513 009651 AD 06 03                     	LDA		min_right+6
   6514 009654 8D 08 03                     	STA		min_right+8
   6515 009657 AD 04 03                     	LDA		min_right+4
   6516 00965A 8D 06 03                     	STA		min_right+6
   6517 00965D AD 02 03                     	LDA		min_right+2
   6518 009660 8D 04 03                     	STA		min_right+4
   6519 009663 AD 00 03                     	LDA		min_right
   6520 009666 8D 02 03                     	STA		min_right+2
   6521 009669                             .0001:
   6522 009669 20 BC 96                     	JSR		IsLeftmostColumnDestroyed
   6523 00966C F0 2C                        	BEQ		.0002
   6524 00966E C6 62                        	DEC		leftmost_column
   6525 009670 AD 12 03                     	LDA		max_left+2
   6526 009673 8D 10 03                     	STA		max_left
   6527 009676 AD 14 03                     	LDA		max_left+4
   6528 009679 8D 12 03                     	STA		max_left+2
   6529 00967C AD 16 03                     	LDA		max_left+6
   6530 00967F 8D 14 03                     	STA		max_left+4
   6531 009682 AD 18 03                     	LDA		max_left+8
   6532 009685 8D 16 03                     	STA		max_left+6
   6533 009688 AD 1A 03                     	LDA		max_left+10
   6534 00968B 8D 18 03                     	STA		max_left+8
   6535 00968E AD 1C 03                     	LDA		max_left+12
   6536 009691 8D 1A 03                     	STA		max_left+10
   6537 009694 AD 1E 03                     	LDA		max_left+14
   6538 009697 8D 1C 03                     	STA		max_left+12
   6539 00969A                             .0002:
   6540 00969A A5 62                        	LDA		leftmost_column
   6541 00969C C5 60                        	CMP		rightmost_column
   6542 00969E 30 18                        	BMI		.allDestroyed
   6543 0096A0 20 DC 96                     	JSR		IsBottomRowDestroyed
   6544 0096A3 F0 02                        	BEQ		.0003
   6545 0096A5 C6 64                        	DEC		bottom_row
   6546 0096A7                             .0003:
   6547 0096A7 20 D8 96                     	JSR		IsTopRowDestroyed
   6548 0096AA F0 02                        	BEQ		.0004
   6549 0096AC E6 66                        	INC		top_row
   6550 0096AE                             .0004:
   6551 0096AE A5 64                        	LDA		bottom_row
   6552 0096B0 C5 66                        	CMP		top_row
   6553 0096B2 30 04                        	BMI		.allDestroyed
   6554 0096B4 A9 00 00                     	LDA		#0
   6555 0096B7 60                           	RTS
   6556 0096B8                             .allDestroyed:
   6557 0096B8 A9 01 00                     	LDA		#1
   6558 0096BB 60                           	RTS
                                           
                                           
   6561 0096BC                             IsLeftmostColumnDestroyed:
   6562 0096BC A5 62                        	LDA		leftmost_column
   6563 0096BE 80 02                        	BRA		IsColumnDestroyed
   6564 0096C0                             IsRightmostColumnDestroyed:
   6565 0096C0 A5 60                        	LDA		rightmost_column
   6566 0096C2                             IsColumnDestroyed:
   6567 0096C2 0A                           	ASL
   6568 0096C3 AA                           	TAX
   6569 0096C4 B5 00                        	LDA		active,X
   6570 0096C6 15 10                        	ORA		active+16,X
   6571 0096C8 15 20                        	ORA		active+32,X
   6572 0096CA 15 30                        	ORA		active+48,X
   6573 0096CC 15 40                        	ORA		active+64,X
   6574 0096CE 15 50                        	ORA		active+80,X
   6575 0096D0 15 60                        	ORA		active+96,X
   6576 0096D2 15 70                        	ORA		active+112,X
   6577 0096D4 49 01 00                     	EOR		#1
   6578 0096D7 60                           	RTS
                                           
   6580 0096D8                             IsTopRowDestroyed:
   6581 0096D8 A5 66                        	LDA		top_row
   6582 0096DA 80 02                        	BRA		IsRowDestroyed
   6583 0096DC                             IsBottomRowDestroyed:
   6584 0096DC A5 64                        	LDA		bottom_row
   6585 0096DE                             IsRowDestroyed:
   6586 0096DE 0A                           	ASL
   6587 0096DF 0A                           	ASL
   6588 0096E0 0A                           	ASL
   6589 0096E1 0A                           	ASL
   6590 0096E2 B5 00                        	LDA		active,X
   6591 0096E4 15 02                        	ORA		active+2,X
   6592 0096E6 15 04                        	ORA		active+4,X
   6593 0096E8 15 06                        	ORA		active+6,X
   6594 0096EA 15 08                        	ORA		active+8,X
   6595 0096EC 15 0A                        	ORA		active+10,X
   6596 0096EE 15 0C                        	ORA		active+12,X
   6597 0096F0 15 0E                        	ORA		active+14,X
   6598 0096F2 49 01 00                     	EOR		#1
   6599 0096F5 60                           	RTS
                                           
                                           ; TickCount counts 1/100 of a second. We want to animate the graphics at a much
                                           ; slower rate, so we use bit 6 of the tick count to indicate when to animate.
                                           ;
   6604 0096F6                             ShiftTick:
   6605 0096F6 42 5B A5 04                  	LDA		ZS:TickCount
   6606 0096FA 4A                           	LSR
   6607 0096FB 4A                           	LSR
   6608 0096FC 4A                           	LSR
   6609 0096FD 4A                           	LSR
   6610 0096FE 4A                           	LSR
   6611 0096FF 4A                           	LSR
   6612 009700 60                           	RTS
                                           
   6614 009701                             RenderInvaders:
                                           	; First, clear the screen
   6616 009701 A2 00 00                     	LDX		#0
   6617 009704 A9 20 00                     	LDA		#' '
   6618 009707 09 00 BF                     	ORA		#$BF00
   6619 00970A                             .0003:
   6620 00970A 42 5B 9F 00 00 0D            	STA		ZS:VIDBUF,X
   6621 009710 E8                           	INX
   6622 009711 E8                           	INX
   6623 009712 E0 58 14                     	CPX		#84*31*2
   6624 009715 30 F3                        	BMI		.0003
   6625 009717 A2 00 00                     	LDX		#0
   6626 00971A                             .0002:
   6627 00971A C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   6630 00971C B5 00                        	LDA		active,X
   6631 00971E F0 FF BD 01                  	LBEQ	.0001
   6632 009722 BD 00 04                     	LDA		inv_state,X
   6633 009725 BD 00 02                     	LDA		InvadersY,X
   6634 009728 0A                           	ASL
   6635 009729 A8                           	TAY
   6636 00972A 42 5B B9 3F DD               	LDA		ZS:LineTbl,Y
   6637 00972F 18                           	CLC
   6638 009730 7D 00 01                     	ADC		InvadersX,X
   6639 009733 18                           	CLC
   6640 009734 7D 00 01                     	ADC		InvadersX,X
   6641 009737 A8                           	TAY
   6642 009738 E2 20                        	SEP		#$20			; eight bit acc
                                           	MEM		8
   6644 00973A 42 1B BD 8B 9A               	LDA		CS:InvaderType,X
   6645 00973F C9 01                        	CMP		#1
   6646 009741 D0 46                        	BNE		.0004
   6647 009743 A9 E9                        	LDA		#233
   6648 009745 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6649 00974D A9 F2                        	LDA		#242
   6650 00974F 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6651 009757 A9 DF                        	LDA		#223
   6652 009759 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6653 009761 20 F6 96                     	JSR		ShiftTick
   6654 009764 90 04                        	BCC		.0005
   6655 009766 A9 58                        	LDA		#'X'
   6656 009768 80 02                        	BRA		.0006
   6657 00976A                             .0005:
   6658 00976A A9 56                        	LDA		#'V'
   6659 00976C                             .0006:
   6660 00976C 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6661 009774 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6662 00977C A9 20                        	LDA		#' '
   6663 00977E 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6664 009786 82 E4 00                     	BRL		.0007
   6665 009789                             .0004:
   6666 009789 C9 02                        	CMP		#2
   6667 00978B D0 FF 83 00                  	LBNE	.0008
   6668 00978F 20 F6 96                     	JSR		ShiftTick
   6669 009792 90 3F                        	BCC		.0009
   6670 009794 A9 FC                        	LDA		#252
   6671 009796 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6672 00979E A9 99                        	LDA		#153
   6673 0097A0 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6674 0097A8 A9 FE                        	LDA		#254
   6675 0097AA 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6676 0097B2 A9 E2                        	LDA		#226
   6677 0097B4 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6678 0097BC A9 62                        	LDA		#98
   6679 0097BE 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6680 0097C6 A9 E2                        	LDA		#226
   6681 0097C8 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6682 0097D0 82 9A 00                     	BRL		.0007
   6683 0097D3                             .0009:
   6684 0097D3 A9 62                        	LDA		#98
   6685 0097D5 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6686 0097DD A9 99                        	LDA		#153
   6687 0097DF 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6688 0097E7 A9 62                        	LDA		#98
   6689 0097E9 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6690 0097F1 A9 EC                        	LDA		#236
   6691 0097F3 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6692 0097FB A9 62                        	LDA		#98
   6693 0097FD 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6694 009805 A9 FB                        	LDA		#251
   6695 009807 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6696 00980F 82 5B 00                     	BRL		.0007
   6697 009812                             .0008:
   6698 009812 A9 FF                        	LDA		#255
   6699 009814 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6700 00981C A9 F8                        	LDA		#248
   6701 00981E 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6702 009826 A9 7F                        	LDA		#127
   6703 009828 42 5B 99 21 98               	STA		ZS:VIDBUf+4,Y
   6704 00982D 20 F6 96                     	JSR		ShiftTick
   6705 009830 90 20                        	BCC		.0010
   6706 009832 A9 FF                        	LDA		#255
   6707 009834 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6708 00983C A9 F9                        	LDA		#249
   6709 00983E 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6710 009846 A9 7F                        	LDA		#127
   6711 009848 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6712 009850 80 1B                        	BRA		.0007
   6713 009852                             .0010:
   6714 009852 A9 E1                        	LDA		#225
   6715 009854 42 5B 99 71 98               	STA		ZS:VIDBUf+84,Y
   6716 009859 A9 F9                        	LDA		#249
   6717 00985B 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6718 009863 A9 60                        	LDA		#96
   6719 009865 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6720 00986D                             .0007:
                                           	; Surround the alien with spaces
   6722 00986D A9 20                        	LDA		#' '
   6723 00986F 42 5B 42 99 AA FF 0C 00      	STA		ZS:VIDBUF-86,Y
                                         
   6724 009877 42 5B 42 99 AC FF 0C 00      	STA		ZS:VIDBUF-84,Y
                                         
   6725 00987F 42 5B 42 99 AE FF 0C 00      	STA		ZS:VIDBUF-82,Y
                                         
   6726 009887 42 5B 42 99 B0 FF 0C 00      	STA		ZS:VIDBUF-80,Y
                                         
   6727 00988F 42 5B 42 99 B2 FF 0C 00      	STA		ZS:VIDBUF-78,Y
                                         
   6728 009897 42 5B 42 99 FE FF 0C 00      	STA		ZS:VIDBUF-2,Y
                                         
   6729 00989F 42 5B 42 99 06 00 0D 00      	STA		ZS:VIDBUF+6,Y
                                         
   6730 0098A7 42 5B 42 99 52 00 0D 00      	STA		ZS:VIDBUF+82,Y
                                         
   6731 0098AF 42 5B 42 99 5A 00 0D 00      	STA		ZS:VIDBUF+90,Y
                                         
   6732 0098B7 42 5B 42 99 A6 00 0D 00      	STA		ZS:VIDBUF+166,Y
                                         
   6733 0098BF 42 5B 42 99 A8 00 0D 00      	STA		ZS:VIDBUF+168,Y
                                         
   6734 0098C7 42 5B 42 99 AA 00 0D 00      	STA		ZS:VIDBUF+170,Y
                                         
   6735 0098CF 42 5B 42 99 AC 00 0D 00      	STA		ZS:VIDBUF+172,Y
                                         
   6736 0098D7 42 5B 42 99 AE 00 0D 00      	STA		ZS:VIDBUF+174,Y
                                         
   6737 0098DF                             .0001:
   6738 0098DF E8                           	INX
   6739 0098E0 E8                           	INX
   6740 0098E1 E0 50 00                     	CPX		#80
   6741 0098E4 D0 FF 32 FE                  	LBNE	.0002
   6742 0098E8 C2 20                        	REP		#$20
                                           	MEM		16
   6744 0098EA 60                           	RTS
                                           
                                           public InvadersTask:
   6747 0098EB                             .0001:
   6748 0098EB F4 00 00                     	PEA		0				; set data segment to $7800
   6749 0098EE F4 00 78                     	PEA		$7800
   6750 0098F1 42 2B                        	PLDS
   6751 0098F3 A9 FF 2B                     	LDA		#$2BFF			; set stack to $2BFF
   6752 0098F6 1B                           	TAS
   6753 0098F7 20 D0 95                     	JSR		Initialize
   6754 0098FA 42 E2 00 10                  	SEP		#$1000			; turn on single step mode
   6755 0098FE 20 01 97                     	JSR		RenderInvaders
   6756 009901                             .0002:
   6757 009901 42 20 18 CF 07               	JCR 	KeybdGetCharNoWaitCtx,7	; check for char at keyboard
   6758 009906                             .0004:
   6759 009906 A2 00 00                     	LDX		#0
   6760 009909                             .0006:
   6761 009909 E8                           	INX
   6762 00990A E0 D0 07                     	CPX		#2000
   6763 00990D D0 FA                        	BNE		.0006
   6764 00990F 42 5B A5 04                  	LDA		ZS:TickCount
   6765 009913 29 03 00                     	AND		#$3
   6766 009916 D0 E9                        	BNE		.0002
   6767 009918 20 1D 94                     	JSR		InvBomb
   6768 00991B 20 01 97                     	JSR		RenderInvaders
   6769 00991E 20 9D 94                     	JSR		RenderBombs
   6770 009921 20 66 94                     	JSR		MoveBombs
   6771 009924 42 5B A5 04                  	LDA		ZS:TickCount
   6772 009928 29 0F 00                     	AND		#$F
   6773 00992B D0 D4                        	BNE		.0002
   6774 00992D 20 38 96                     	JSR		IsAllDestroyed
   6775 009930 D0 B9                        	BNE		.0001
   6776 009932 20 A1 95                     	JSR		Move
   6777 009935 F0 B4                        	BEQ		.0001				; Can't move, re-initialize
   6778 009937 80 C8                        	BRA		.0002
   6779 009939                             .0005:
   6780 009939 85 6A                        	STA		inv_tick
   6781 00993B 80 C4                        	BRA		.0002
   6782 00993D                             .0003:
   6783 00993D C9 03 00                     	CMP		#3
   6784 009940 D0 C4                        	BNE		.0004
   6785 009942 42 5B 9C 68 78               	STZ		ZS:do_invaders
   6786 009947 42 60                        	RTT
   6787 009949 80 A0                        	BRA		.0001
                                           
   6789 00994B                             InvaderRow:
   6790 00994B 00 00                        	.word	0
   6791 00994D 00 00                        	.word	0
   6792 00994F 00 00                        	.word	0
   6793 009951 00 00                        	.word	0
   6794 009953 00 00                        	.word	0
   6795 009955 00 00                        	.word	0
   6796 009957 00 00                        	.word	0
   6797 009959 00 00                        	.word	0
                                           
   6799 00995B 01 00                        	.word	1
   6800 00995D 01 00                        	.word	1
   6801 00995F 01 00                        	.word	1
   6802 009961 01 00                        	.word	1
   6803 009963 01 00                        	.word	1
   6804 009965 01 00                        	.word	1
   6805 009967 01 00                        	.word	1
   6806 009969 01 00                        	.word	1
                                           
   6808 00996B 02 00                        	.word	2
   6809 00996D 02 00                        	.word	2
   6810 00996F 02 00                        	.word	2
   6811 009971 02 00                        	.word	2
   6812 009973 02 00                        	.word	2
   6813 009975 02 00                        	.word	2
   6814 009977 02 00                        	.word	2
   6815 009979 02 00                        	.word	2
                                           
   6817 00997B 03 00                        	.word	3
   6818 00997D 03 00                        	.word	3
   6819 00997F 03 00                        	.word	3
   6820 009981 03 00                        	.word	3
   6821 009983 03 00                        	.word	3
   6822 009985 03 00                        	.word	3
   6823 009987 03 00                        	.word	3
   6824 009989 03 00                        	.word	3
                                           
   6826 00998B 04 00                        	.word	4
   6827 00998D 04 00                        	.word	4
   6828 00998F 04 00                        	.word	4
   6829 009991 04 00                        	.word	4
   6830 009993 04 00                        	.word	4
   6831 009995 04 00                        	.word	4
   6832 009997 04 00                        	.word	4
   6833 009999 04 00                        	.word	4
                                           
   6835 00999B                             InvaderCol:
   6836 00999B 00 00                        	.word	0
   6837 00999D 01 00                        	.word	1
   6838 00999F 02 00                        	.word	2
   6839 0099A1 03 00                        	.word	3
   6840 0099A3 04 00                        	.word	4
   6841 0099A5 05 00                        	.word	5
   6842 0099A7 06 00                        	.word	6
   6843 0099A9 07 00                        	.word	7
                                           
   6845 0099AB 00 00                        	.word	0
   6846 0099AD 01 00                        	.word	1
   6847 0099AF 02 00                        	.word	2
   6848 0099B1 03 00                        	.word	3
   6849 0099B3 04 00                        	.word	4
   6850 0099B5 05 00                        	.word	5
   6851 0099B7 06 00                        	.word	6
   6852 0099B9 07 00                        	.word	7
                                           
   6854 0099BB 00 00                        	.word	0
   6855 0099BD 01 00                        	.word	1
   6856 0099BF 02 00                        	.word	2
   6857 0099C1 03 00                        	.word	3
   6858 0099C3 04 00                        	.word	4
   6859 0099C5 05 00                        	.word	5
   6860 0099C7 06 00                        	.word	6
   6861 0099C9 07 00                        	.word	7
                                           
   6863 0099CB 00 00                        	.word	0
   6864 0099CD 01 00                        	.word	1
   6865 0099CF 02 00                        	.word	2
   6866 0099D1 03 00                        	.word	3
   6867 0099D3 04 00                        	.word	4
   6868 0099D5 05 00                        	.word	5
   6869 0099D7 06 00                        	.word	6
   6870 0099D9 07 00                        	.word	7
                                           
   6872 0099DB 00 00                        	.word	0
   6873 0099DD 01 00                        	.word	1
   6874 0099DF 02 00                        	.word	2
   6875 0099E1 03 00                        	.word	3
   6876 0099E3 04 00                        	.word	4
   6877 0099E5 05 00                        	.word	5
   6878 0099E7 06 00                        	.word	6
   6879 0099E9 07 00                        	.word	7
                                           
                                           ; Starting Y co-ordinate for each invader
                                           
   6883 0099EB                             StartY:
   6884 0099EB 03 00                        	.word	3
   6885 0099ED 03 00                        	.word	3
   6886 0099EF 03 00                        	.word	3
   6887 0099F1 03 00                        	.word	3
   6888 0099F3 03 00                        	.word	3
   6889 0099F5 03 00                        	.word	3
   6890 0099F7 03 00                        	.word	3
   6891 0099F9 03 00                        	.word	3
                                           
   6893 0099FB 06 00                        	.word	6
   6894 0099FD 06 00                        	.word	6
   6895 0099FF 06 00                        	.word	6
   6896 009A01 06 00                        	.word	6
   6897 009A03 06 00                        	.word	6
   6898 009A05 06 00                        	.word	6
   6899 009A07 06 00                        	.word	6
   6900 009A09 06 00                        	.word	6
                                           
   6902 009A0B 09 00                        	.word	9
   6903 009A0D 09 00                        	.word	9
   6904 009A0F 09 00                        	.word	9
   6905 009A11 09 00                        	.word	9
   6906 009A13 09 00                        	.word	9
   6907 009A15 09 00                        	.word	9
   6908 009A17 09 00                        	.word	9
   6909 009A19 09 00                        	.word	9
                                           
   6911 009A1B 0C 00                        	.word	12
   6912 009A1D 0C 00                        	.word	12
   6913 009A1F 0C 00                        	.word	12
   6914 009A21 0C 00                        	.word	12
   6915 009A23 0C 00                        	.word	12
   6916 009A25 0C 00                        	.word	12
   6917 009A27 0C 00                        	.word	12
   6918 009A29 0C 00                        	.word	12
                                           
   6920 009A2B 0F 00                        	.word	15
   6921 009A2D 0F 00                        	.word	15
   6922 009A2F 0F 00                        	.word	15
   6923 009A31 0F 00                        	.word	15
   6924 009A33 0F 00                        	.word	15
   6925 009A35 0F 00                        	.word	15
   6926 009A37 0F 00                        	.word	15
   6927 009A39 0F 00                        	.word	15
                                           
                                           ; Starting X co-ordinate for each invader
                                           
   6931 009A3B                             StartX:
   6932 009A3B 01 00                        	.word	1
   6933 009A3D 05 00                        	.word	5
   6934 009A3F 09 00                        	.word	9
   6935 009A41 0D 00                        	.word	13
   6936 009A43 11 00                        	.word	17
   6937 009A45 15 00                        	.word	21
   6938 009A47 19 00                        	.word	25
   6939 009A49 1D 00                        	.word	29
                                           
   6941 009A4B 01 00                        	.word	1
   6942 009A4D 05 00                        	.word	5
   6943 009A4F 09 00                        	.word	9
   6944 009A51 0D 00                        	.word	13
   6945 009A53 11 00                        	.word	17
   6946 009A55 15 00                        	.word	21
   6947 009A57 19 00                        	.word	25
   6948 009A59 1D 00                        	.word	29
                                           
   6950 009A5B 01 00                        	.word	1
   6951 009A5D 05 00                        	.word	5
   6952 009A5F 09 00                        	.word	9
   6953 009A61 0D 00                        	.word	13
   6954 009A63 11 00                        	.word	17
   6955 009A65 15 00                        	.word	21
   6956 009A67 19 00                        	.word	25
   6957 009A69 1D 00                        	.word	29
                                           
   6959 009A6B 01 00                        	.word	1
   6960 009A6D 05 00                        	.word	5
   6961 009A6F 09 00                        	.word	9
   6962 009A71 0D 00                        	.word	13
   6963 009A73 11 00                        	.word	17
   6964 009A75 15 00                        	.word	21
   6965 009A77 19 00                        	.word	25
   6966 009A79 1D 00                        	.word	29
                                           
   6968 009A7B 01 00                        	.word	1
   6969 009A7D 05 00                        	.word	5
   6970 009A7F 09 00                        	.word	9
   6971 009A81 0D 00                        	.word	13
   6972 009A83 11 00                        	.word	17
   6973 009A85 15 00                        	.word	21
   6974 009A87 19 00                        	.word	25
   6975 009A89 1D 00                        	.word	29
                                           
   6977 009A8B                             InvaderType:
   6978 009A8B 01 00                        	.word	1
   6979 009A8D 01 00                        	.word	1
   6980 009A8F 01 00                        	.word	1
   6981 009A91 01 00                        	.word	1
   6982 009A93 01 00                        	.word	1
   6983 009A95 01 00                        	.word	1
   6984 009A97 01 00                        	.word	1
   6985 009A99 01 00                        	.word	1
                                           
   6987 009A9B 02 00                        	.word	2
   6988 009A9D 02 00                        	.word	2
   6989 009A9F 02 00                        	.word	2
   6990 009AA1 02 00                        	.word	2
   6991 009AA3 02 00                        	.word	2
   6992 009AA5 02 00                        	.word	2
   6993 009AA7 02 00                        	.word	2
   6994 009AA9 02 00                        	.word	2
                                           
   6996 009AAB 02 00                        	.word	2
   6997 009AAD 02 00                        	.word	2
   6998 009AAF 02 00                        	.word	2
   6999 009AB1 02 00                        	.word	2
   7000 009AB3 02 00                        	.word	2
   7001 009AB5 02 00                        	.word	2
   7002 009AB7 02 00                        	.word	2
   7003 009AB9 02 00                        	.word	2
                                           
   7005 009ABB 03 00                        	.word	3
   7006 009ABD 03 00                        	.word	3
   7007 009ABF 03 00                        	.word	3
   7008 009AC1 03 00                        	.word	3
   7009 009AC3 03 00                        	.word	3
   7010 009AC5 03 00                        	.word	3
   7011 009AC7 03 00                        	.word	3
   7012 009AC9 03 00                        	.word	3
                                           
   7014 009ACB 03 00                        	.word	3
   7015 009ACD 03 00                        	.word	3
   7016 009ACF 03 00                        	.word	3
   7017 009AD1 03 00                        	.word	3
   7018 009AD3 03 00                        	.word	3
   7019 009AD5 03 00                        	.word	3
   7020 009AD7 03 00                        	.word	3
   7021 009AD9 03 00                        	.word	3
                                           			
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:35 2017     Page 1
FTBios816.asm


                                           .include "invaders.asm"
                                           
                                           ;	cpu		W65C816S
                                           	cpu		FT832
   7026 009ADB FF FF FF FF FF FF FF FF      	.org	$C000
   7026 009AE3 FF FF FF FF FF FF FF FF    
   7026 009AEB FF FF FF FF FF FF FF FF    
   7026 009AF3 FF FF FF FF FF FF FF FF    
   7026 009AFB FF FF FF FF FF FF FF FF    
   7026 009B03 FF FF FF FF FF FF FF FF    
   7026 009B0B FF FF FF FF FF FF FF FF    
   7026 009B13 FF FF FF FF FF FF FF FF    
   7026 009B1B FF FF FF FF FF FF FF FF    
   7026 009B23 FF FF FF FF FF FF FF FF    
   7026 009B2B FF FF FF FF FF FF FF FF    
   7026 009B33 FF FF FF FF FF FF FF FF    
   7026 009B3B FF FF FF FF FF FF FF FF    
   7026 009B43 FF FF FF FF FF FF FF FF    
   7026 009B4B FF FF FF FF FF FF FF FF    
   7026 009B53 FF FF FF FF FF FF FF FF    
   7026 009B5B FF FF FF FF FF FF FF FF    
   7026 009B63 FF FF FF FF FF FF FF FF    
   7026 009B6B FF FF FF FF FF FF FF FF    
   7026 009B73 FF FF FF FF FF FF FF FF    
   7026 009B7B FF FF FF FF FF FF FF FF    
   7026 009B83 FF FF FF FF FF FF FF FF    
   7026 009B8B FF FF FF FF FF FF FF FF    
   7026 009B93 FF FF FF FF FF FF FF FF    
   7026 009B9B FF FF FF FF FF FF FF FF    
   7026 009BA3 FF FF FF FF FF FF FF FF    
   7026 009BAB FF FF FF FF FF FF FF FF    
   7026 009BB3 FF FF FF FF FF FF FF FF    
   7026 009BBB FF FF FF FF FF FF FF FF    
   7026 009BC3 FF FF FF FF FF FF FF FF    
   7026 009BCB FF FF FF FF FF FF FF FF    
   7026 009BD3 FF FF FF FF FF FF FF FF    
   7026 009BDB FF FF FF FF FF FF FF FF    
   7026 009BE3 FF FF FF FF FF FF FF FF    
   7026 009BEB FF FF FF FF FF FF FF FF    
   7026 009BF3 FF FF FF FF FF FF FF FF    
   7026 009BFB FF FF FF FF FF FF FF FF    
   7026 009C03 FF FF FF FF FF FF FF FF    
   7026 009C0B FF FF FF FF FF FF FF FF    
   7026 009C13 FF FF FF FF FF FF FF FF    
   7026 009C1B FF FF FF FF FF FF FF FF    
   7026 009C23 FF FF FF FF FF FF FF FF    
   7026 009C2B FF FF FF FF FF FF FF FF    
   7026 009C33 FF FF FF FF FF FF FF FF    
   7026 009C3B FF FF FF FF FF FF FF FF    
   7026 009C43 FF FF FF FF FF FF FF FF    
   7026 009C4B FF FF FF FF FF FF FF FF    
   7026 009C53 FF FF FF FF FF FF FF FF    
   7026 009C5B FF FF FF FF FF FF FF FF    
   7026 009C63 FF FF FF FF FF FF FF FF    
   7026 009C6B FF FF FF FF FF FF FF FF    
   7026 009C73 FF FF FF FF FF FF FF FF    
   7026 009C7B FF FF FF FF FF FF FF FF    
   7026 009C83 FF FF FF FF FF FF FF FF    
   7026 009C8B FF FF FF FF FF FF FF FF    
   7026 009C93 FF FF FF FF FF FF FF FF    
   7026 009C9B FF FF FF FF FF FF FF FF    
   7026 009CA3 FF FF FF FF FF FF FF FF    
   7026 009CAB FF FF FF FF FF FF FF FF    
   7026 009CB3 FF FF FF FF FF FF FF FF    
   7026 009CBB FF FF FF FF FF FF FF FF    
   7026 009CC3 FF FF FF FF FF FF FF FF    
   7026 009CCB FF FF FF FF FF FF FF FF    
   7026 009CD3 FF FF FF FF FF FF FF FF    
   7026 009CDB FF FF FF FF FF FF FF FF    
   7026 009CE3 FF FF FF FF FF FF FF FF    
   7026 009CEB FF FF FF FF FF FF FF FF    
   7026 009CF3 FF FF FF FF FF FF FF FF    
   7026 009CFB FF FF FF FF FF FF FF FF    
   7026 009D03 FF FF FF FF FF FF FF FF    
   7026 009D0B FF FF FF FF FF FF FF FF    
   7026 009D13 FF FF FF FF FF FF FF FF    
   7026 009D1B FF FF FF FF FF FF FF FF    
   7026 009D23 FF FF FF FF FF FF FF FF    
   7026 009D2B FF FF FF FF FF FF FF FF    
   7026 009D33 FF FF FF FF FF FF FF FF    
   7026 009D3B FF FF FF FF FF FF FF FF    
   7026 009D43 FF FF FF FF FF FF FF FF    
   7026 009D4B FF FF FF FF FF FF FF FF    
   7026 009D53 FF FF FF FF FF FF FF FF    
   7026 009D5B FF FF FF FF FF FF FF FF    
   7026 009D63 FF FF FF FF FF FF FF FF    
   7026 009D6B FF FF FF FF FF FF FF FF    
   7026 009D73 FF FF FF FF FF FF FF FF    
   7026 009D7B FF FF FF FF FF FF FF FF    
   7026 009D83 FF FF FF FF FF FF FF FF    
   7026 009D8B FF FF FF FF FF FF FF FF    
   7026 009D93 FF FF FF FF FF FF FF FF    
   7026 009D9B FF FF FF FF FF FF FF FF    
   7026 009DA3 FF FF FF FF FF FF FF FF    
   7026 009DAB FF FF FF FF FF FF FF FF    
   7026 009DB3 FF FF FF FF FF FF FF FF    
   7026 009DBB FF FF FF FF FF FF FF FF    
   7026 009DC3 FF FF FF FF FF FF FF FF    
   7026 009DCB FF FF FF FF FF FF FF FF    
   7026 009DD3 FF FF FF FF FF FF FF FF    
   7026 009DDB FF FF FF FF FF FF FF FF    
   7026 009DE3 FF FF FF FF FF FF FF FF    
   7026 009DEB FF FF FF FF FF FF FF FF    
   7026 009DF3 FF FF FF FF FF FF FF FF    
   7026 009DFB FF FF FF FF FF FF FF FF    
   7026 009E03 FF FF FF FF FF FF FF FF    
   7026 009E0B FF FF FF FF FF FF FF FF    
   7026 009E13 FF FF FF FF FF FF FF FF    
   7026 009E1B FF FF FF FF FF FF FF FF    
   7026 009E23 FF FF FF FF FF FF FF FF    
   7026 009E2B FF FF FF FF FF FF FF FF    
   7026 009E33 FF FF FF FF FF FF FF FF    
   7026 009E3B FF FF FF FF FF FF FF FF    
   7026 009E43 FF FF FF FF FF FF FF FF    
   7026 009E4B FF FF FF FF FF FF FF FF    
   7026 009E53 FF FF FF FF FF FF FF FF    
   7026 009E5B FF FF FF FF FF FF FF FF    
   7026 009E63 FF FF FF FF FF FF FF FF    
   7026 009E6B FF FF FF FF FF FF FF FF    
   7026 009E73 FF FF FF FF FF FF FF FF    
   7026 009E7B FF FF FF FF FF FF FF FF    
   7026 009E83 FF FF FF FF FF FF FF FF    
   7026 009E8B FF FF FF FF FF FF FF FF    
   7026 009E93 FF FF FF FF FF FF FF FF    
   7026 009E9B FF FF FF FF FF FF FF FF    
   7026 009EA3 FF FF FF FF FF FF FF FF    
   7026 009EAB FF FF FF FF FF FF FF FF    
   7026 009EB3 FF FF FF FF FF FF FF FF    
   7026 009EBB FF FF FF FF FF FF FF FF    
   7026 009EC3 FF FF FF FF FF FF FF FF    
   7026 009ECB FF FF FF FF FF FF FF FF    
   7026 009ED3 FF FF FF FF FF FF FF FF    
   7026 009EDB FF FF FF FF FF FF FF FF    
   7026 009EE3 FF FF FF FF FF FF FF FF    
   7026 009EEB FF FF FF FF FF FF FF FF    
   7026 009EF3 FF FF FF FF FF FF FF FF    
   7026 009EFB FF FF FF FF FF FF FF FF    
   7026 009F03 FF FF FF FF FF FF FF FF    
   7026 009F0B FF FF FF FF FF FF FF FF    
   7026 009F13 FF FF FF FF FF FF FF FF    
   7026 009F1B FF FF FF FF FF FF FF FF    
   7026 009F23 FF FF FF FF FF FF FF FF    
   7026 009F2B FF FF FF FF FF FF FF FF    
   7026 009F33 FF FF FF FF FF FF FF FF    
   7026 009F3B FF FF FF FF FF FF FF FF    
   7026 009F43 FF FF FF FF FF FF FF FF    
   7026 009F4B FF FF FF FF FF FF FF FF    
   7026 009F53 FF FF FF FF FF FF FF FF    
   7026 009F5B FF FF FF FF FF FF FF FF    
   7026 009F63 FF FF FF FF FF FF FF FF    
   7026 009F6B FF FF FF FF FF FF FF FF    
   7026 009F73 FF FF FF FF FF FF FF FF    
   7026 009F7B FF FF FF FF FF FF FF FF    
   7026 009F83 FF FF FF FF FF FF FF FF    
   7026 009F8B FF FF FF FF FF FF FF FF    
   7026 009F93 FF FF FF FF FF FF FF FF    
   7026 009F9B FF FF FF FF FF FF FF FF    
   7026 009FA3 FF FF FF FF FF FF FF FF    
   7026 009FAB FF FF FF FF FF FF FF FF    
   7026 009FB3 FF FF FF FF FF FF FF FF    
   7026 009FBB FF FF FF FF FF FF FF FF    
   7026 009FC3 FF FF FF FF FF FF FF FF    
   7026 009FCB FF FF FF FF FF FF FF FF    
   7026 009FD3 FF FF FF FF FF FF FF FF    
   7026 009FDB FF FF FF FF FF FF FF FF    
   7026 009FE3 FF FF FF FF FF FF FF FF    
   7026 009FEB FF FF FF FF FF FF FF FF    
   7026 009FF3 FF FF FF FF FF FF FF FF    
   7026 009FFB FF FF FF FF FF FF FF FF    
   7026 00A003 FF FF FF FF FF FF FF FF    
   7026 00A00B FF FF FF FF FF FF FF FF    
   7026 00A013 FF FF FF FF FF FF FF FF    
   7026 00A01B FF FF FF FF FF FF FF FF    
   7026 00A023 FF FF FF FF FF FF FF FF    
   7026 00A02B FF FF FF FF FF FF FF FF    
   7026 00A033 FF FF FF FF FF FF FF FF    
   7026 00A03B FF FF FF FF FF FF FF FF    
   7026 00A043 FF FF FF FF FF FF FF FF    
   7026 00A04B FF FF FF FF FF FF FF FF    
   7026 00A053 FF FF FF FF FF FF FF FF    
   7026 00A05B FF FF FF FF FF FF FF FF    
   7026 00A063 FF FF FF FF FF FF FF FF    
   7026 00A06B FF FF FF FF FF FF FF FF    
   7026 00A073 FF FF FF FF FF FF FF FF    
   7026 00A07B FF FF FF FF FF FF FF FF    
   7026 00A083 FF FF FF FF FF FF FF FF    
   7026 00A08B FF FF FF FF FF FF FF FF    
   7026 00A093 FF FF FF FF FF FF FF FF    
   7026 00A09B FF FF FF FF FF FF FF FF    
   7026 00A0A3 FF FF FF FF FF FF FF FF    
   7026 00A0AB FF FF FF FF FF FF FF FF    
   7026 00A0B3 FF FF FF FF FF FF FF FF    
   7026 00A0BB FF FF FF FF FF FF FF FF    
   7026 00A0C3 FF FF FF FF FF FF FF FF    
   7026 00A0CB FF FF FF FF FF FF FF FF    
   7026 00A0D3 FF FF FF FF FF FF FF FF    
   7026 00A0DB FF FF FF FF FF FF FF FF    
   7026 00A0E3 FF FF FF FF FF FF FF FF    
   7026 00A0EB FF FF FF FF FF FF FF FF    
   7026 00A0F3 FF FF FF FF FF FF FF FF    
   7026 00A0FB FF FF FF FF FF FF FF FF    
   7026 00A103 FF FF FF FF FF FF FF FF    
   7026 00A10B FF FF FF FF FF FF FF FF    
   7026 00A113 FF FF FF FF FF FF FF FF    
   7026 00A11B FF FF FF FF FF FF FF FF    
   7026 00A123 FF FF FF FF FF FF FF FF    
   7026 00A12B FF FF FF FF FF FF FF FF    
   7026 00A133 FF FF FF FF FF FF FF FF    
   7026 00A13B FF FF FF FF FF FF FF FF    
   7026 00A143 FF FF FF FF FF FF FF FF    
   7026 00A14B FF FF FF FF FF FF FF FF    
   7026 00A153 FF FF FF FF FF FF FF FF    
   7026 00A15B FF FF FF FF FF FF FF FF    
   7026 00A163 FF FF FF FF FF FF FF FF    
   7026 00A16B FF FF FF FF FF FF FF FF    
   7026 00A173 FF FF FF FF FF FF FF FF    
   7026 00A17B FF FF FF FF FF FF FF FF    
   7026 00A183 FF FF FF FF FF FF FF FF    
   7026 00A18B FF FF FF FF FF FF FF FF    
   7026 00A193 FF FF FF FF FF FF FF FF    
   7026 00A19B FF FF FF FF FF FF FF FF    
   7026 00A1A3 FF FF FF FF FF FF FF FF    
   7026 00A1AB FF FF FF FF FF FF FF FF    
   7026 00A1B3 FF FF FF FF FF FF FF FF    
   7026 00A1BB FF FF FF FF FF FF FF FF    
   7026 00A1C3 FF FF FF FF FF FF FF FF    
   7026 00A1CB FF FF FF FF FF FF FF FF    
   7026 00A1D3 FF FF FF FF FF FF FF FF    
   7026 00A1DB FF FF FF FF FF FF FF FF    
   7026 00A1E3 FF FF FF FF FF FF FF FF    
   7026 00A1EB FF FF FF FF FF FF FF FF    
   7026 00A1F3 FF FF FF FF FF FF FF FF    
   7026 00A1FB FF FF FF FF FF FF FF FF    
   7026 00A203 FF FF FF FF FF FF FF FF    
   7026 00A20B FF FF FF FF FF FF FF FF    
   7026 00A213 FF FF FF FF FF FF FF FF    
   7026 00A21B FF FF FF FF FF FF FF FF    
   7026 00A223 FF FF FF FF FF FF FF FF    
   7026 00A22B FF FF FF FF FF FF FF FF    
   7026 00A233 FF FF FF FF FF FF FF FF    
   7026 00A23B FF FF FF FF FF FF FF FF    
   7026 00A243 FF FF FF FF FF FF FF FF    
   7026 00A24B FF FF FF FF FF FF FF FF    
   7026 00A253 FF FF FF FF FF FF FF FF    
   7026 00A25B FF FF FF FF FF FF FF FF    
   7026 00A263 FF FF FF FF FF FF FF FF    
   7026 00A26B FF FF FF FF FF FF FF FF    
   7026 00A273 FF FF FF FF FF FF FF FF    
   7026 00A27B FF FF FF FF FF FF FF FF    
   7026 00A283 FF FF FF FF FF FF FF FF    
   7026 00A28B FF FF FF FF FF FF FF FF    
   7026 00A293 FF FF FF FF FF FF FF FF    
   7026 00A29B FF FF FF FF FF FF FF FF    
   7026 00A2A3 FF FF FF FF FF FF FF FF    
   7026 00A2AB FF FF FF FF FF FF FF FF    
   7026 00A2B3 FF FF FF FF FF FF FF FF    
   7026 00A2BB FF FF FF FF FF FF FF FF    
   7026 00A2C3 FF FF FF FF FF FF FF FF    
   7026 00A2CB FF FF FF FF FF FF FF FF    
   7026 00A2D3 FF FF FF FF FF FF FF FF    
   7026 00A2DB FF FF FF FF FF FF FF FF    
   7026 00A2E3 FF FF FF FF FF FF FF FF    
   7026 00A2EB FF FF FF FF FF FF FF FF    
   7026 00A2F3 FF FF FF FF FF FF FF FF    
   7026 00A2FB FF FF FF FF FF FF FF FF    
   7026 00A303 FF FF FF FF FF FF FF FF    
   7026 00A30B FF FF FF FF FF FF FF FF    
   7026 00A313 FF FF FF FF FF FF FF FF    
   7026 00A31B FF FF FF FF FF FF FF FF    
   7026 00A323 FF FF FF FF FF FF FF FF    
   7026 00A32B FF FF FF FF FF FF FF FF    
   7026 00A333 FF FF FF FF FF FF FF FF    
   7026 00A33B FF FF FF FF FF FF FF FF    
   7026 00A343 FF FF FF FF FF FF FF FF    
   7026 00A34B FF FF FF FF FF FF FF FF    
   7026 00A353 FF FF FF FF FF FF FF FF    
   7026 00A35B FF FF FF FF FF FF FF FF    
   7026 00A363 FF FF FF FF FF FF FF FF    
   7026 00A36B FF FF FF FF FF FF FF FF    
   7026 00A373 FF FF FF FF FF FF FF FF    
   7026 00A37B FF FF FF FF FF FF FF FF    
   7026 00A383 FF FF FF FF FF FF FF FF    
   7026 00A38B FF FF FF FF FF FF FF FF    
   7026 00A393 FF FF FF FF FF FF FF FF    
   7026 00A39B FF FF FF FF FF FF FF FF    
   7026 00A3A3 FF FF FF FF FF FF FF FF    
   7026 00A3AB FF FF FF FF FF FF FF FF    
   7026 00A3B3 FF FF FF FF FF FF FF FF    
   7026 00A3BB FF FF FF FF FF FF FF FF    
   7026 00A3C3 FF FF FF FF FF FF FF FF    
   7026 00A3CB FF FF FF FF FF FF FF FF    
   7026 00A3D3 FF FF FF FF FF FF FF FF    
   7026 00A3DB FF FF FF FF FF FF FF FF    
   7026 00A3E3 FF FF FF FF FF FF FF FF    
   7026 00A3EB FF FF FF FF FF FF FF FF    
   7026 00A3F3 FF FF FF FF FF FF FF FF    
   7026 00A3FB FF FF FF FF FF FF FF FF    
   7026 00A403 FF FF FF FF FF FF FF FF    
   7026 00A40B FF FF FF FF FF FF FF FF    
   7026 00A413 FF FF FF FF FF FF FF FF    
   7026 00A41B FF FF FF FF FF FF FF FF    
   7026 00A423 FF FF FF FF FF FF FF FF    
   7026 00A42B FF FF FF FF FF FF FF FF    
   7026 00A433 FF FF FF FF FF FF FF FF    
   7026 00A43B FF FF FF FF FF FF FF FF    
   7026 00A443 FF FF FF FF FF FF FF FF    
   7026 00A44B FF FF FF FF FF FF FF FF    
   7026 00A453 FF FF FF FF FF FF FF FF    
   7026 00A45B FF FF FF FF FF FF FF FF    
   7026 00A463 FF FF FF FF FF FF FF FF    
   7026 00A46B FF FF FF FF FF FF FF FF    
   7026 00A473 FF FF FF FF FF FF FF FF    
   7026 00A47B FF FF FF FF FF FF FF FF    
   7026 00A483 FF FF FF FF FF FF FF FF    
   7026 00A48B FF FF FF FF FF FF FF FF    
   7026 00A493 FF FF FF FF FF FF FF FF    
   7026 00A49B FF FF FF FF FF FF FF FF    
   7026 00A4A3 FF FF FF FF FF FF FF FF    
   7026 00A4AB FF FF FF FF FF FF FF FF    
   7026 00A4B3 FF FF FF FF FF FF FF FF    
   7026 00A4BB FF FF FF FF FF FF FF FF    
   7026 00A4C3 FF FF FF FF FF FF FF FF    
   7026 00A4CB FF FF FF FF FF FF FF FF    
   7026 00A4D3 FF FF FF FF FF FF FF FF    
   7026 00A4DB FF FF FF FF FF FF FF FF    
   7026 00A4E3 FF FF FF FF FF FF FF FF    
   7026 00A4EB FF FF FF FF FF FF FF FF    
   7026 00A4F3 FF FF FF FF FF FF FF FF    
   7026 00A4FB FF FF FF FF FF FF FF FF    
   7026 00A503 FF FF FF FF FF FF FF FF    
   7026 00A50B FF FF FF FF FF FF FF FF    
   7026 00A513 FF FF FF FF FF FF FF FF    
   7026 00A51B FF FF FF FF FF FF FF FF    
   7026 00A523 FF FF FF FF FF FF FF FF    
   7026 00A52B FF FF FF FF FF FF FF FF    
   7026 00A533 FF FF FF FF FF FF FF FF    
   7026 00A53B FF FF FF FF FF FF FF FF    
   7026 00A543 FF FF FF FF FF FF FF FF    
   7026 00A54B FF FF FF FF FF FF FF FF    
   7026 00A553 FF FF FF FF FF FF FF FF    
   7026 00A55B FF FF FF FF FF FF FF FF    
   7026 00A563 FF FF FF FF FF FF FF FF    
   7026 00A56B FF FF FF FF FF FF FF FF    
   7026 00A573 FF FF FF FF FF FF FF FF    
   7026 00A57B FF FF FF FF FF FF FF FF    
   7026 00A583 FF FF FF FF FF FF FF FF    
   7026 00A58B FF FF FF FF FF FF FF FF    
   7026 00A593 FF FF FF FF FF FF FF FF    
   7026 00A59B FF FF FF FF FF FF FF FF    
   7026 00A5A3 FF FF FF FF FF FF FF FF    
   7026 00A5AB FF FF FF FF FF FF FF FF    
   7026 00A5B3 FF FF FF FF FF FF FF FF    
   7026 00A5BB FF FF FF FF FF FF FF FF    
   7026 00A5C3 FF FF FF FF FF FF FF FF    
   7026 00A5CB FF FF FF FF FF FF FF FF    
   7026 00A5D3 FF FF FF FF FF FF FF FF    
   7026 00A5DB FF FF FF FF FF FF FF FF    
   7026 00A5E3 FF FF FF FF FF FF FF FF    
   7026 00A5EB FF FF FF FF FF FF FF FF    
   7026 00A5F3 FF FF FF FF FF FF FF FF    
   7026 00A5FB FF FF FF FF FF FF FF FF    
   7026 00A603 FF FF FF FF FF FF FF FF    
   7026 00A60B FF FF FF FF FF FF FF FF    
   7026 00A613 FF FF FF FF FF FF FF FF    
   7026 00A61B FF FF FF FF FF FF FF FF    
   7026 00A623 FF FF FF FF FF FF FF FF    
   7026 00A62B FF FF FF FF FF FF FF FF    
   7026 00A633 FF FF FF FF FF FF FF FF    
   7026 00A63B FF FF FF FF FF FF FF FF    
   7026 00A643 FF FF FF FF FF FF FF FF    
   7026 00A64B FF FF FF FF FF FF FF FF    
   7026 00A653 FF FF FF FF FF FF FF FF    
   7026 00A65B FF FF FF FF FF FF FF FF    
   7026 00A663 FF FF FF FF FF FF FF FF    
   7026 00A66B FF FF FF FF FF FF FF FF    
   7026 00A673 FF FF FF FF FF FF FF FF    
   7026 00A67B FF FF FF FF FF FF FF FF    
   7026 00A683 FF FF FF FF FF FF FF FF    
   7026 00A68B FF FF FF FF FF FF FF FF    
   7026 00A693 FF FF FF FF FF FF FF FF    
   7026 00A69B FF FF FF FF FF FF FF FF    
   7026 00A6A3 FF FF FF FF FF FF FF FF    
   7026 00A6AB FF FF FF FF FF FF FF FF    
   7026 00A6B3 FF FF FF FF FF FF FF FF    
   7026 00A6BB FF FF FF FF FF FF FF FF    
   7026 00A6C3 FF FF FF FF FF FF FF FF    
   7026 00A6CB FF FF FF FF FF FF FF FF    
   7026 00A6D3 FF FF FF FF FF FF FF FF    
   7026 00A6DB FF FF FF FF FF FF FF FF    
   7026 00A6E3 FF FF FF FF FF FF FF FF    
   7026 00A6EB FF FF FF FF FF FF FF FF    
   7026 00A6F3 FF FF FF FF FF FF FF FF    
   7026 00A6FB FF FF FF FF FF FF FF FF    
   7026 00A703 FF FF FF FF FF FF FF FF    
   7026 00A70B FF FF FF FF FF FF FF FF    
   7026 00A713 FF FF FF FF FF FF FF FF    
   7026 00A71B FF FF FF FF FF FF FF FF    
   7026 00A723 FF FF FF FF FF FF FF FF    
   7026 00A72B FF FF FF FF FF FF FF FF    
   7026 00A733 FF FF FF FF FF FF FF FF    
   7026 00A73B FF FF FF FF FF FF FF FF    
   7026 00A743 FF FF FF FF FF FF FF FF    
   7026 00A74B FF FF FF FF FF FF FF FF    
   7026 00A753 FF FF FF FF FF FF FF FF    
   7026 00A75B FF FF FF FF FF FF FF FF    
   7026 00A763 FF FF FF FF FF FF FF FF    
   7026 00A76B FF FF FF FF FF FF FF FF    
   7026 00A773 FF FF FF FF FF FF FF FF    
   7026 00A77B FF FF FF FF FF FF FF FF    
   7026 00A783 FF FF FF FF FF FF FF FF    
   7026 00A78B FF FF FF FF FF FF FF FF    
   7026 00A793 FF FF FF FF FF FF FF FF    
   7026 00A79B FF FF FF FF FF FF FF FF    
   7026 00A7A3 FF FF FF FF FF FF FF FF    
   7026 00A7AB FF FF FF FF FF FF FF FF    
   7026 00A7B3 FF FF FF FF FF FF FF FF    
   7026 00A7BB FF FF FF FF FF FF FF FF    
   7026 00A7C3 FF FF FF FF FF FF FF FF    
   7026 00A7CB FF FF FF FF FF FF FF FF    
   7026 00A7D3 FF FF FF FF FF FF FF FF    
   7026 00A7DB FF FF FF FF FF FF FF FF    
   7026 00A7E3 FF FF FF FF FF FF FF FF    
   7026 00A7EB FF FF FF FF FF FF FF FF    
   7026 00A7F3 FF FF FF FF FF FF FF FF    
   7026 00A7FB FF FF FF FF FF FF FF FF    
   7026 00A803 FF FF FF FF FF FF FF FF    
   7026 00A80B FF FF FF FF FF FF FF FF    
   7026 00A813 FF FF FF FF FF FF FF FF    
   7026 00A81B FF FF FF FF FF FF FF FF    
   7026 00A823 FF FF FF FF FF FF FF FF    
   7026 00A82B FF FF FF FF FF FF FF FF    
   7026 00A833 FF FF FF FF FF FF FF FF    
   7026 00A83B FF FF FF FF FF FF FF FF    
   7026 00A843 FF FF FF FF FF FF FF FF    
   7026 00A84B FF FF FF FF FF FF FF FF    
   7026 00A853 FF FF FF FF FF FF FF FF    
   7026 00A85B FF FF FF FF FF FF FF FF    
   7026 00A863 FF FF FF FF FF FF FF FF    
   7026 00A86B FF FF FF FF FF FF FF FF    
   7026 00A873 FF FF FF FF FF FF FF FF    
   7026 00A87B FF FF FF FF FF FF FF FF    
   7026 00A883 FF FF FF FF FF FF FF FF    
   7026 00A88B FF FF FF FF FF FF FF FF    
   7026 00A893 FF FF FF FF FF FF FF FF    
   7026 00A89B FF FF FF FF FF FF FF FF    
   7026 00A8A3 FF FF FF FF FF FF FF FF    
   7026 00A8AB FF FF FF FF FF FF FF FF    
   7026 00A8B3 FF FF FF FF FF FF FF FF    
   7026 00A8BB FF FF FF FF FF FF FF FF    
   7026 00A8C3 FF FF FF FF FF FF FF FF    
   7026 00A8CB FF FF FF FF FF FF FF FF    
   7026 00A8D3 FF FF FF FF FF FF FF FF    
   7026 00A8DB FF FF FF FF FF FF FF FF    
   7026 00A8E3 FF FF FF FF FF FF FF FF    
   7026 00A8EB FF FF FF FF FF FF FF FF    
   7026 00A8F3 FF FF FF FF FF FF FF FF    
   7026 00A8FB FF FF FF FF FF FF FF FF    
   7026 00A903 FF FF FF FF FF FF FF FF    
   7026 00A90B FF FF FF FF FF FF FF FF    
   7026 00A913 FF FF FF FF FF FF FF FF    
   7026 00A91B FF FF FF FF FF FF FF FF    
   7026 00A923 FF FF FF FF FF FF FF FF    
   7026 00A92B FF FF FF FF FF FF FF FF    
   7026 00A933 FF FF FF FF FF FF FF FF    
   7026 00A93B FF FF FF FF FF FF FF FF    
   7026 00A943 FF FF FF FF FF FF FF FF    
   7026 00A94B FF FF FF FF FF FF FF FF    
   7026 00A953 FF FF FF FF FF FF FF FF    
   7026 00A95B FF FF FF FF FF FF FF FF    
   7026 00A963 FF FF FF FF FF FF FF FF    
   7026 00A96B FF FF FF FF FF FF FF FF    
   7026 00A973 FF FF FF FF FF FF FF FF    
   7026 00A97B FF FF FF FF FF FF FF FF    
   7026 00A983 FF FF FF FF FF FF FF FF    
   7026 00A98B FF FF FF FF FF FF FF FF    
   7026 00A993 FF FF FF FF FF FF FF FF    
   7026 00A99B FF FF FF FF FF FF FF FF    
   7026 00A9A3 FF FF FF FF FF FF FF FF    
   7026 00A9AB FF FF FF FF FF FF FF FF    
   7026 00A9B3 FF FF FF FF FF FF FF FF    
   7026 00A9BB FF FF FF FF FF FF FF FF    
   7026 00A9C3 FF FF FF FF FF FF FF FF    
   7026 00A9CB FF FF FF FF FF FF FF FF    
   7026 00A9D3 FF FF FF FF FF FF FF FF    
   7026 00A9DB FF FF FF FF FF FF FF FF    
   7026 00A9E3 FF FF FF FF FF FF FF FF    
   7026 00A9EB FF FF FF FF FF FF FF FF    
   7026 00A9F3 FF FF FF FF FF FF FF FF    
   7026 00A9FB FF FF FF FF FF FF FF FF    
   7026 00AA03 FF FF FF FF FF FF FF FF    
   7026 00AA0B FF FF FF FF FF FF FF FF    
   7026 00AA13 FF FF FF FF FF FF FF FF    
   7026 00AA1B FF FF FF FF FF FF FF FF    
   7026 00AA23 FF FF FF FF FF FF FF FF    
   7026 00AA2B FF FF FF FF FF FF FF FF    
   7026 00AA33 FF FF FF FF FF FF FF FF    
   7026 00AA3B FF FF FF FF FF FF FF FF    
   7026 00AA43 FF FF FF FF FF FF FF FF    
   7026 00AA4B FF FF FF FF FF FF FF FF    
   7026 00AA53 FF FF FF FF FF FF FF FF    
   7026 00AA5B FF FF FF FF FF FF FF FF    
   7026 00AA63 FF FF FF FF FF FF FF FF    
   7026 00AA6B FF FF FF FF FF FF FF FF    
   7026 00AA73 FF FF FF FF FF FF FF FF    
   7026 00AA7B FF FF FF FF FF FF FF FF    
   7026 00AA83 FF FF FF FF FF FF FF FF    
   7026 00AA8B FF FF FF FF FF FF FF FF    
   7026 00AA93 FF FF FF FF FF FF FF FF    
   7026 00AA9B FF FF FF FF FF FF FF FF    
   7026 00AAA3 FF FF FF FF FF FF FF FF    
   7026 00AAAB FF FF FF FF FF FF FF FF    
   7026 00AAB3 FF FF FF FF FF FF FF FF    
   7026 00AABB FF FF FF FF FF FF FF FF    
   7026 00AAC3 FF FF FF FF FF FF FF FF    
   7026 00AACB FF FF FF FF FF FF FF FF    
   7026 00AAD3 FF FF FF FF FF FF FF FF    
   7026 00AADB FF FF FF FF FF FF FF FF    
   7026 00AAE3 FF FF FF FF FF FF FF FF    
   7026 00AAEB FF FF FF FF FF FF FF FF    
   7026 00AAF3 FF FF FF FF FF FF FF FF    
   7026 00AAFB FF FF FF FF FF FF FF FF    
   7026 00AB03 FF FF FF FF FF FF FF FF    
   7026 00AB0B FF FF FF FF FF FF FF FF    
   7026 00AB13 FF FF FF FF FF FF FF FF    
   7026 00AB1B FF FF FF FF FF FF FF FF    
   7026 00AB23 FF FF FF FF FF FF FF FF    
   7026 00AB2B FF FF FF FF FF FF FF FF    
   7026 00AB33 FF FF FF FF FF FF FF FF    
   7026 00AB3B FF FF FF FF FF FF FF FF    
   7026 00AB43 FF FF FF FF FF FF FF FF    
   7026 00AB4B FF FF FF FF FF FF FF FF    
   7026 00AB53 FF FF FF FF FF FF FF FF    
   7026 00AB5B FF FF FF FF FF FF FF FF    
   7026 00AB63 FF FF FF FF FF FF FF FF    
   7026 00AB6B FF FF FF FF FF FF FF FF    
   7026 00AB73 FF FF FF FF FF FF FF FF    
   7026 00AB7B FF FF FF FF FF FF FF FF    
   7026 00AB83 FF FF FF FF FF FF FF FF    
   7026 00AB8B FF FF FF FF FF FF FF FF    
   7026 00AB93 FF FF FF FF FF FF FF FF    
   7026 00AB9B FF FF FF FF FF FF FF FF    
   7026 00ABA3 FF FF FF FF FF FF FF FF    
   7026 00ABAB FF FF FF FF FF FF FF FF    
   7026 00ABB3 FF FF FF FF FF FF FF FF    
   7026 00ABBB FF FF FF FF FF FF FF FF    
   7026 00ABC3 FF FF FF FF FF FF FF FF    
   7026 00ABCB FF FF FF FF FF FF FF FF    
   7026 00ABD3 FF FF FF FF FF FF FF FF    
   7026 00ABDB FF FF FF FF FF FF FF FF    
   7026 00ABE3 FF FF FF FF FF FF FF FF    
   7026 00ABEB FF FF FF FF FF FF FF FF    
   7026 00ABF3 FF FF FF FF FF FF FF FF    
   7026 00ABFB FF FF FF FF FF FF FF FF    
   7026 00AC03 FF FF FF FF FF FF FF FF    
   7026 00AC0B FF FF FF FF FF FF FF FF    
   7026 00AC13 FF FF FF FF FF FF FF FF    
   7026 00AC1B FF FF FF FF FF FF FF FF    
   7026 00AC23 FF FF FF FF FF FF FF FF    
   7026 00AC2B FF FF FF FF FF FF FF FF    
   7026 00AC33 FF FF FF FF FF FF FF FF    
   7026 00AC3B FF FF FF FF FF FF FF FF    
   7026 00AC43 FF FF FF FF FF FF FF FF    
   7026 00AC4B FF FF FF FF FF FF FF FF    
   7026 00AC53 FF FF FF FF FF FF FF FF    
   7026 00AC5B FF FF FF FF FF FF FF FF    
   7026 00AC63 FF FF FF FF FF FF FF FF    
   7026 00AC6B FF FF FF FF FF FF FF FF    
   7026 00AC73 FF FF FF FF FF FF FF FF    
   7026 00AC7B FF FF FF FF FF FF FF FF    
   7026 00AC83 FF FF FF FF FF FF FF FF    
   7026 00AC8B FF FF FF FF FF FF FF FF    
   7026 00AC93 FF FF FF FF FF FF FF FF    
   7026 00AC9B FF FF FF FF FF FF FF FF    
   7026 00ACA3 FF FF FF FF FF FF FF FF    
   7026 00ACAB FF FF FF FF FF FF FF FF    
   7026 00ACB3 FF FF FF FF FF FF FF FF    
   7026 00ACBB FF FF FF FF FF FF FF FF    
   7026 00ACC3 FF FF FF FF FF FF FF FF    
   7026 00ACCB FF FF FF FF FF FF FF FF    
   7026 00ACD3 FF FF FF FF FF FF FF FF    
   7026 00ACDB FF FF FF FF FF FF FF FF    
   7026 00ACE3 FF FF FF FF FF FF FF FF    
   7026 00ACEB FF FF FF FF FF FF FF FF    
   7026 00ACF3 FF FF FF FF FF FF FF FF    
   7026 00ACFB FF FF FF FF FF FF FF FF    
   7026 00AD03 FF FF FF FF FF FF FF FF    
   7026 00AD0B FF FF FF FF FF FF FF FF    
   7026 00AD13 FF FF FF FF FF FF FF FF    
   7026 00AD1B FF FF FF FF FF FF FF FF    
   7026 00AD23 FF FF FF FF FF FF FF FF    
   7026 00AD2B FF FF FF FF FF FF FF FF    
   7026 00AD33 FF FF FF FF FF FF FF FF    
   7026 00AD3B FF FF FF FF FF FF FF FF    
   7026 00AD43 FF FF FF FF FF FF FF FF    
   7026 00AD4B FF FF FF FF FF FF FF FF    
   7026 00AD53 FF FF FF FF FF FF FF FF    
   7026 00AD5B FF FF FF FF FF FF FF FF    
   7026 00AD63 FF FF FF FF FF FF FF FF    
   7026 00AD6B FF FF FF FF FF FF FF FF    
   7026 00AD73 FF FF FF FF FF FF FF FF    
   7026 00AD7B FF FF FF FF FF FF FF FF    
   7026 00AD83 FF FF FF FF FF FF FF FF    
   7026 00AD8B FF FF FF FF FF FF FF FF    
   7026 00AD93 FF FF FF FF FF FF FF FF    
   7026 00AD9B FF FF FF FF FF FF FF FF    
   7026 00ADA3 FF FF FF FF FF FF FF FF    
   7026 00ADAB FF FF FF FF FF FF FF FF    
   7026 00ADB3 FF FF FF FF FF FF FF FF    
   7026 00ADBB FF FF FF FF FF FF FF FF    
   7026 00ADC3 FF FF FF FF FF FF FF FF    
   7026 00ADCB FF FF FF FF FF FF FF FF    
   7026 00ADD3 FF FF FF FF FF FF FF FF    
   7026 00ADDB FF FF FF FF FF FF FF FF    
   7026 00ADE3 FF FF FF FF FF FF FF FF    
   7026 00ADEB FF FF FF FF FF FF FF FF    
   7026 00ADF3 FF FF FF FF FF FF FF FF    
   7026 00ADFB FF FF FF FF FF FF FF FF    
   7026 00AE03 FF FF FF FF FF FF FF FF    
   7026 00AE0B FF FF FF FF FF FF FF FF    
   7026 00AE13 FF FF FF FF FF FF FF FF    
   7026 00AE1B FF FF FF FF FF FF FF FF    
   7026 00AE23 FF FF FF FF FF FF FF FF    
   7026 00AE2B FF FF FF FF FF FF FF FF    
   7026 00AE33 FF FF FF FF FF FF FF FF    
   7026 00AE3B FF FF FF FF FF FF FF FF    
   7026 00AE43 FF FF FF FF FF FF FF FF    
   7026 00AE4B FF FF FF FF FF FF FF FF    
   7026 00AE53 FF FF FF FF FF FF FF FF    
   7026 00AE5B FF FF FF FF FF FF FF FF    
   7026 00AE63 FF FF FF FF FF FF FF FF    
   7026 00AE6B FF FF FF FF FF FF FF FF    
   7026 00AE73 FF FF FF FF FF FF FF FF    
   7026 00AE7B FF FF FF FF FF FF FF FF    
   7026 00AE83 FF FF FF FF FF FF FF FF    
   7026 00AE8B FF FF FF FF FF FF FF FF    
   7026 00AE93 FF FF FF FF FF FF FF FF    
   7026 00AE9B FF FF FF FF FF FF FF FF    
   7026 00AEA3 FF FF FF FF FF FF FF FF    
   7026 00AEAB FF FF FF FF FF FF FF FF    
   7026 00AEB3 FF FF FF FF FF FF FF FF    
   7026 00AEBB FF FF FF FF FF FF FF FF    
   7026 00AEC3 FF FF FF FF FF FF FF FF    
   7026 00AECB FF FF FF FF FF FF FF FF    
   7026 00AED3 FF FF FF FF FF FF FF FF    
   7026 00AEDB FF FF FF FF FF FF FF FF    
   7026 00AEE3 FF FF FF FF FF FF FF FF    
   7026 00AEEB FF FF FF FF FF FF FF FF    
   7026 00AEF3 FF FF FF FF FF FF FF FF    
   7026 00AEFB FF FF FF FF FF FF FF FF    
   7026 00AF03 FF FF FF FF FF FF FF FF    
   7026 00AF0B FF FF FF FF FF FF FF FF    
   7026 00AF13 FF FF FF FF FF FF FF FF    
   7026 00AF1B FF FF FF FF FF FF FF FF    
   7026 00AF23 FF FF FF FF FF FF FF FF    
   7026 00AF2B FF FF FF FF FF FF FF FF    
   7026 00AF33 FF FF FF FF FF FF FF FF    
   7026 00AF3B FF FF FF FF FF FF FF FF    
   7026 00AF43 FF FF FF FF FF FF FF FF    
   7026 00AF4B FF FF FF FF FF FF FF FF    
   7026 00AF53 FF FF FF FF FF FF FF FF    
   7026 00AF5B FF FF FF FF FF FF FF FF    
   7026 00AF63 FF FF FF FF FF FF FF FF    
   7026 00AF6B FF FF FF FF FF FF FF FF    
   7026 00AF73 FF FF FF FF FF FF FF FF    
   7026 00AF7B FF FF FF FF FF FF FF FF    
   7026 00AF83 FF FF FF FF FF FF FF FF    
   7026 00AF8B FF FF FF FF FF FF FF FF    
   7026 00AF93 FF FF FF FF FF FF FF FF    
   7026 00AF9B FF FF FF FF FF FF FF FF    
   7026 00AFA3 FF FF FF FF FF FF FF FF    
   7026 00AFAB FF FF FF FF FF FF FF FF    
   7026 00AFB3 FF FF FF FF FF FF FF FF    
   7026 00AFBB FF FF FF FF FF FF FF FF    
   7026 00AFC3 FF FF FF FF FF FF FF FF    
   7026 00AFCB FF FF FF FF FF FF FF FF    
   7026 00AFD3 FF FF FF FF FF FF FF FF    
   7026 00AFDB FF FF FF FF FF FF FF FF    
   7026 00AFE3 FF FF FF FF FF FF FF FF    
   7026 00AFEB FF FF FF FF FF FF FF FF    
   7026 00AFF3 FF FF FF FF FF FF FF FF    
   7026 00AFFB FF FF FF FF FF FF FF FF    
   7026 00B003 FF FF FF FF FF FF FF FF    
   7026 00B00B FF FF FF FF FF FF FF FF    
   7026 00B013 FF FF FF FF FF FF FF FF    
   7026 00B01B FF FF FF FF FF FF FF FF    
   7026 00B023 FF FF FF FF FF FF FF FF    
   7026 00B02B FF FF FF FF FF FF FF FF    
   7026 00B033 FF FF FF FF FF FF FF FF    
   7026 00B03B FF FF FF FF FF FF FF FF    
   7026 00B043 FF FF FF FF FF FF FF FF    
   7026 00B04B FF FF FF FF FF FF FF FF    
   7026 00B053 FF FF FF FF FF FF FF FF    
   7026 00B05B FF FF FF FF FF FF FF FF    
   7026 00B063 FF FF FF FF FF FF FF FF    
   7026 00B06B FF FF FF FF FF FF FF FF    
   7026 00B073 FF FF FF FF FF FF FF FF    
   7026 00B07B FF FF FF FF FF FF FF FF    
   7026 00B083 FF FF FF FF FF FF FF FF    
   7026 00B08B FF FF FF FF FF FF FF FF    
   7026 00B093 FF FF FF FF FF FF FF FF    
   7026 00B09B FF FF FF FF FF FF FF FF    
   7026 00B0A3 FF FF FF FF FF FF FF FF    
   7026 00B0AB FF FF FF FF FF FF FF FF    
   7026 00B0B3 FF FF FF FF FF FF FF FF    
   7026 00B0BB FF FF FF FF FF FF FF FF    
   7026 00B0C3 FF FF FF FF FF FF FF FF    
   7026 00B0CB FF FF FF FF FF FF FF FF    
   7026 00B0D3 FF FF FF FF FF FF FF FF    
   7026 00B0DB FF FF FF FF FF FF FF FF    
   7026 00B0E3 FF FF FF FF FF FF FF FF    
   7026 00B0EB FF FF FF FF FF FF FF FF    
   7026 00B0F3 FF FF FF FF FF FF FF FF    
   7026 00B0FB FF FF FF FF FF FF FF FF    
   7026 00B103 FF FF FF FF FF FF FF FF    
   7026 00B10B FF FF FF FF FF FF FF FF    
   7026 00B113 FF FF FF FF FF FF FF FF    
   7026 00B11B FF FF FF FF FF FF FF FF    
   7026 00B123 FF FF FF FF FF FF FF FF    
   7026 00B12B FF FF FF FF FF FF FF FF    
   7026 00B133 FF FF FF FF FF FF FF FF    
   7026 00B13B FF FF FF FF FF FF FF FF    
   7026 00B143 FF FF FF FF FF FF FF FF    
   7026 00B14B FF FF FF FF FF FF FF FF    
   7026 00B153 FF FF FF FF FF FF FF FF    
   7026 00B15B FF FF FF FF FF FF FF FF    
   7026 00B163 FF FF FF FF FF FF FF FF    
   7026 00B16B FF FF FF FF FF FF FF FF    
   7026 00B173 FF FF FF FF FF FF FF FF    
   7026 00B17B FF FF FF FF FF FF FF FF    
   7026 00B183 FF FF FF FF FF FF FF FF    
   7026 00B18B FF FF FF FF FF FF FF FF    
   7026 00B193 FF FF FF FF FF FF FF FF    
   7026 00B19B FF FF FF FF FF FF FF FF    
   7026 00B1A3 FF FF FF FF FF FF FF FF    
   7026 00B1AB FF FF FF FF FF FF FF FF    
   7026 00B1B3 FF FF FF FF FF FF FF FF    
   7026 00B1BB FF FF FF FF FF FF FF FF    
   7026 00B1C3 FF FF FF FF FF FF FF FF    
   7026 00B1CB FF FF FF FF FF FF FF FF    
   7026 00B1D3 FF FF FF FF FF FF FF FF    
   7026 00B1DB FF FF FF FF FF FF FF FF    
   7026 00B1E3 FF FF FF FF FF FF FF FF    
   7026 00B1EB FF FF FF FF FF FF FF FF    
   7026 00B1F3 FF FF FF FF FF FF FF FF    
   7026 00B1FB FF FF FF FF FF FF FF FF    
   7026 00B203 FF FF FF FF FF FF FF FF    
   7026 00B20B FF FF FF FF FF FF FF FF    
   7026 00B213 FF FF FF FF FF FF FF FF    
   7026 00B21B FF FF FF FF FF FF FF FF    
   7026 00B223 FF FF FF FF FF FF FF FF    
   7026 00B22B FF FF FF FF FF FF FF FF    
   7026 00B233 FF FF FF FF FF FF FF FF    
   7026 00B23B FF FF FF FF FF FF FF FF    
   7026 00B243 FF FF FF FF FF FF FF FF    
   7026 00B24B FF FF FF FF FF FF FF FF    
   7026 00B253 FF FF FF FF FF FF FF FF    
   7026 00B25B FF FF FF FF FF FF FF FF    
   7026 00B263 FF FF FF FF FF FF FF FF    
   7026 00B26B FF FF FF FF FF FF FF FF    
   7026 00B273 FF FF FF FF FF FF FF FF    
   7026 00B27B FF FF FF FF FF FF FF FF    
   7026 00B283 FF FF FF FF FF FF FF FF    
   7026 00B28B FF FF FF FF FF FF FF FF    
   7026 00B293 FF FF FF FF FF FF FF FF    
   7026 00B29B FF FF FF FF FF FF FF FF    
   7026 00B2A3 FF FF FF FF FF FF FF FF    
   7026 00B2AB FF FF FF FF FF FF FF FF    
   7026 00B2B3 FF FF FF FF FF FF FF FF    
   7026 00B2BB FF FF FF FF FF FF FF FF    
   7026 00B2C3 FF FF FF FF FF FF FF FF    
   7026 00B2CB FF FF FF FF FF FF FF FF    
   7026 00B2D3 FF FF FF FF FF FF FF FF    
   7026 00B2DB FF FF FF FF FF FF FF FF    
   7026 00B2E3 FF FF FF FF FF FF FF FF    
   7026 00B2EB FF FF FF FF FF FF FF FF    
   7026 00B2F3 FF FF FF FF FF FF FF FF    
   7026 00B2FB FF FF FF FF FF FF FF FF    
   7026 00B303 FF FF FF FF FF FF FF FF    
   7026 00B30B FF FF FF FF FF FF FF FF    
   7026 00B313 FF FF FF FF FF FF FF FF    
   7026 00B31B FF FF FF FF FF FF FF FF    
   7026 00B323 FF FF FF FF FF FF FF FF    
   7026 00B32B FF FF FF FF FF FF FF FF    
   7026 00B333 FF FF FF FF FF FF FF FF    
   7026 00B33B FF FF FF FF FF FF FF FF    
   7026 00B343 FF FF FF FF FF FF FF FF    
   7026 00B34B FF FF FF FF FF FF FF FF    
   7026 00B353 FF FF FF FF FF FF FF FF    
   7026 00B35B FF FF FF FF FF FF FF FF    
   7026 00B363 FF FF FF FF FF FF FF FF    
   7026 00B36B FF FF FF FF FF FF FF FF    
   7026 00B373 FF FF FF FF FF FF FF FF    
   7026 00B37B FF FF FF FF FF FF FF FF    
   7026 00B383 FF FF FF FF FF FF FF FF    
   7026 00B38B FF FF FF FF FF FF FF FF    
   7026 00B393 FF FF FF FF FF FF FF FF    
   7026 00B39B FF FF FF FF FF FF FF FF    
   7026 00B3A3 FF FF FF FF FF FF FF FF    
   7026 00B3AB FF FF FF FF FF FF FF FF    
   7026 00B3B3 FF FF FF FF FF FF FF FF    
   7026 00B3BB FF FF FF FF FF FF FF FF    
   7026 00B3C3 FF FF FF FF FF FF FF FF    
   7026 00B3CB FF FF FF FF FF FF FF FF    
   7026 00B3D3 FF FF FF FF FF FF FF FF    
   7026 00B3DB FF FF FF FF FF FF FF FF    
   7026 00B3E3 FF FF FF FF FF FF FF FF    
   7026 00B3EB FF FF FF FF FF FF FF FF    
   7026 00B3F3 FF FF FF FF FF FF FF FF    
   7026 00B3FB FF FF FF FF FF FF FF FF    
   7026 00B403 FF FF FF FF FF FF FF FF    
   7026 00B40B FF FF FF FF FF FF FF FF    
   7026 00B413 FF FF FF FF FF FF FF FF    
   7026 00B41B FF FF FF FF FF FF FF FF    
   7026 00B423 FF FF FF FF FF FF FF FF    
   7026 00B42B FF FF FF FF FF FF FF FF    
   7026 00B433 FF FF FF FF FF FF FF FF    
   7026 00B43B FF FF FF FF FF FF FF FF    
   7026 00B443 FF FF FF FF FF FF FF FF    
   7026 00B44B FF FF FF FF FF FF FF FF    
   7026 00B453 FF FF FF FF FF FF FF FF    
   7026 00B45B FF FF FF FF FF FF FF FF    
   7026 00B463 FF FF FF FF FF FF FF FF    
   7026 00B46B FF FF FF FF FF FF FF FF    
   7026 00B473 FF FF FF FF FF FF FF FF    
   7026 00B47B FF FF FF FF FF FF FF FF    
   7026 00B483 FF FF FF FF FF FF FF FF    
   7026 00B48B FF FF FF FF FF FF FF FF    
   7026 00B493 FF FF FF FF FF FF FF FF    
   7026 00B49B FF FF FF FF FF FF FF FF    
   7026 00B4A3 FF FF FF FF FF FF FF FF    
   7026 00B4AB FF FF FF FF FF FF FF FF    
   7026 00B4B3 FF FF FF FF FF FF FF FF    
   7026 00B4BB FF FF FF FF FF FF FF FF    
   7026 00B4C3 FF FF FF FF FF FF FF FF    
   7026 00B4CB FF FF FF FF FF FF FF FF    
   7026 00B4D3 FF FF FF FF FF FF FF FF    
   7026 00B4DB FF FF FF FF FF FF FF FF    
   7026 00B4E3 FF FF FF FF FF FF FF FF    
   7026 00B4EB FF FF FF FF FF FF FF FF    
   7026 00B4F3 FF FF FF FF FF FF FF FF    
   7026 00B4FB FF FF FF FF FF FF FF FF    
   7026 00B503 FF FF FF FF FF FF FF FF    
   7026 00B50B FF FF FF FF FF FF FF FF    
   7026 00B513 FF FF FF FF FF FF FF FF    
   7026 00B51B FF FF FF FF FF FF FF FF    
   7026 00B523 FF FF FF FF FF FF FF FF    
   7026 00B52B FF FF FF FF FF FF FF FF    
   7026 00B533 FF FF FF FF FF FF FF FF    
   7026 00B53B FF FF FF FF FF FF FF FF    
   7026 00B543 FF FF FF FF FF FF FF FF    
   7026 00B54B FF FF FF FF FF FF FF FF    
   7026 00B553 FF FF FF FF FF FF FF FF    
   7026 00B55B FF FF FF FF FF FF FF FF    
   7026 00B563 FF FF FF FF FF FF FF FF    
   7026 00B56B FF FF FF FF FF FF FF FF    
   7026 00B573 FF FF FF FF FF FF FF FF    
   7026 00B57B FF FF FF FF FF FF FF FF    
   7026 00B583 FF FF FF FF FF FF FF FF    
   7026 00B58B FF FF FF FF FF FF FF FF    
   7026 00B593 FF FF FF FF FF FF FF FF    
   7026 00B59B FF FF FF FF FF FF FF FF    
   7026 00B5A3 FF FF FF FF FF FF FF FF    
   7026 00B5AB FF FF FF FF FF FF FF FF    
   7026 00B5B3 FF FF FF FF FF FF FF FF    
   7026 00B5BB FF FF FF FF FF FF FF FF    
   7026 00B5C3 FF FF FF FF FF FF FF FF    
   7026 00B5CB FF FF FF FF FF FF FF FF    
   7026 00B5D3 FF FF FF FF FF FF FF FF    
   7026 00B5DB FF FF FF FF FF FF FF FF    
   7026 00B5E3 FF FF FF FF FF FF FF FF    
   7026 00B5EB FF FF FF FF FF FF FF FF    
   7026 00B5F3 FF FF FF FF FF FF FF FF    
   7026 00B5FB FF FF FF FF FF FF FF FF    
   7026 00B603 FF FF FF FF FF FF FF FF    
   7026 00B60B FF FF FF FF FF FF FF FF    
   7026 00B613 FF FF FF FF FF FF FF FF    
   7026 00B61B FF FF FF FF FF FF FF FF    
   7026 00B623 FF FF FF FF FF FF FF FF    
   7026 00B62B FF FF FF FF FF FF FF FF    
   7026 00B633 FF FF FF FF FF FF FF FF    
   7026 00B63B FF FF FF FF FF FF FF FF    
   7026 00B643 FF FF FF FF FF FF FF FF    
   7026 00B64B FF FF FF FF FF FF FF FF    
   7026 00B653 FF FF FF FF FF FF FF FF    
   7026 00B65B FF FF FF FF FF FF FF FF    
   7026 00B663 FF FF FF FF FF FF FF FF    
   7026 00B66B FF FF FF FF FF FF FF FF    
   7026 00B673 FF FF FF FF FF FF FF FF    
   7026 00B67B FF FF FF FF FF FF FF FF    
   7026 00B683 FF FF FF FF FF FF FF FF    
   7026 00B68B FF FF FF FF FF FF FF FF    
   7026 00B693 FF FF FF FF FF FF FF FF    
   7026 00B69B FF FF FF FF FF FF FF FF    
   7026 00B6A3 FF FF FF FF FF FF FF FF    
   7026 00B6AB FF FF FF FF FF FF FF FF    
   7026 00B6B3 FF FF FF FF FF FF FF FF    
   7026 00B6BB FF FF FF FF FF FF FF FF    
   7026 00B6C3 FF FF FF FF FF FF FF FF    
   7026 00B6CB FF FF FF FF FF FF FF FF    
   7026 00B6D3 FF FF FF FF FF FF FF FF    
   7026 00B6DB FF FF FF FF FF FF FF FF    
   7026 00B6E3 FF FF FF FF FF FF FF FF    
   7026 00B6EB FF FF FF FF FF FF FF FF    
   7026 00B6F3 FF FF FF FF FF FF FF FF    
   7026 00B6FB FF FF FF FF FF FF FF FF    
   7026 00B703 FF FF FF FF FF FF FF FF    
   7026 00B70B FF FF FF FF FF FF FF FF    
   7026 00B713 FF FF FF FF FF FF FF FF    
   7026 00B71B FF FF FF FF FF FF FF FF    
   7026 00B723 FF FF FF FF FF FF FF FF    
   7026 00B72B FF FF FF FF FF FF FF FF    
   7026 00B733 FF FF FF FF FF FF FF FF    
   7026 00B73B FF FF FF FF FF FF FF FF    
   7026 00B743 FF FF FF FF FF FF FF FF    
   7026 00B74B FF FF FF FF FF FF FF FF    
   7026 00B753 FF FF FF FF FF FF FF FF    
   7026 00B75B FF FF FF FF FF FF FF FF    
   7026 00B763 FF FF FF FF FF FF FF FF    
   7026 00B76B FF FF FF FF FF FF FF FF    
   7026 00B773 FF FF FF FF FF FF FF FF    
   7026 00B77B FF FF FF FF FF FF FF FF    
   7026 00B783 FF FF FF FF FF FF FF FF    
   7026 00B78B FF FF FF FF FF FF FF FF    
   7026 00B793 FF FF FF FF FF FF FF FF    
   7026 00B79B FF FF FF FF FF FF FF FF    
   7026 00B7A3 FF FF FF FF FF FF FF FF    
   7026 00B7AB FF FF FF FF FF FF FF FF    
   7026 00B7B3 FF FF FF FF FF FF FF FF    
   7026 00B7BB FF FF FF FF FF FF FF FF    
   7026 00B7C3 FF FF FF FF FF FF FF FF    
   7026 00B7CB FF FF FF FF FF FF FF FF    
   7026 00B7D3 FF FF FF FF FF FF FF FF    
   7026 00B7DB FF FF FF FF FF FF FF FF    
   7026 00B7E3 FF FF FF FF FF FF FF FF    
   7026 00B7EB FF FF FF FF FF FF FF FF    
   7026 00B7F3 FF FF FF FF FF FF FF FF    
   7026 00B7FB FF FF FF FF FF FF FF FF    
   7026 00B803 FF FF FF FF FF FF FF FF    
   7026 00B80B FF FF FF FF FF FF FF FF    
   7026 00B813 FF FF FF FF FF FF FF FF    
   7026 00B81B FF FF FF FF FF FF FF FF    
   7026 00B823 FF FF FF FF FF FF FF FF    
   7026 00B82B FF FF FF FF FF FF FF FF    
   7026 00B833 FF FF FF FF FF FF FF FF    
   7026 00B83B FF FF FF FF FF FF FF FF    
   7026 00B843 FF FF FF FF FF FF FF FF    
   7026 00B84B FF FF FF FF FF FF FF FF    
   7026 00B853 FF FF FF FF FF FF FF FF    
   7026 00B85B FF FF FF FF FF FF FF FF    
   7026 00B863 FF FF FF FF FF FF FF FF    
   7026 00B86B FF FF FF FF FF FF FF FF    
   7026 00B873 FF FF FF FF FF FF FF FF    
   7026 00B87B FF FF FF FF FF FF FF FF    
   7026 00B883 FF FF FF FF FF FF FF FF    
   7026 00B88B FF FF FF FF FF FF FF FF    
   7026 00B893 FF FF FF FF FF FF FF FF    
   7026 00B89B FF FF FF FF FF FF FF FF    
   7026 00B8A3 FF FF FF FF FF FF FF FF    
   7026 00B8AB FF FF FF FF FF FF FF FF    
   7026 00B8B3 FF FF FF FF FF FF FF FF    
   7026 00B8BB FF FF FF FF FF FF FF FF    
   7026 00B8C3 FF FF FF FF FF FF FF FF    
   7026 00B8CB FF FF FF FF FF FF FF FF    
   7026 00B8D3 FF FF FF FF FF FF FF FF    
   7026 00B8DB FF FF FF FF FF FF FF FF    
   7026 00B8E3 FF FF FF FF FF FF FF FF    
   7026 00B8EB FF FF FF FF FF FF FF FF    
   7026 00B8F3 FF FF FF FF FF FF FF FF    
   7026 00B8FB FF FF FF FF FF FF FF FF    
   7026 00B903 FF FF FF FF FF FF FF FF    
   7026 00B90B FF FF FF FF FF FF FF FF    
   7026 00B913 FF FF FF FF FF FF FF FF    
   7026 00B91B FF FF FF FF FF FF FF FF    
   7026 00B923 FF FF FF FF FF FF FF FF    
   7026 00B92B FF FF FF FF FF FF FF FF    
   7026 00B933 FF FF FF FF FF FF FF FF    
   7026 00B93B FF FF FF FF FF FF FF FF    
   7026 00B943 FF FF FF FF FF FF FF FF    
   7026 00B94B FF FF FF FF FF FF FF FF    
   7026 00B953 FF FF FF FF FF FF FF FF    
   7026 00B95B FF FF FF FF FF FF FF FF    
   7026 00B963 FF FF FF FF FF FF FF FF    
   7026 00B96B FF FF FF FF FF FF FF FF    
   7026 00B973 FF FF FF FF FF FF FF FF    
   7026 00B97B FF FF FF FF FF FF FF FF    
   7026 00B983 FF FF FF FF FF FF FF FF    
   7026 00B98B FF FF FF FF FF FF FF FF    
   7026 00B993 FF FF FF FF FF FF FF FF    
   7026 00B99B FF FF FF FF FF FF FF FF    
   7026 00B9A3 FF FF FF FF FF FF FF FF    
   7026 00B9AB FF FF FF FF FF FF FF FF    
   7026 00B9B3 FF FF FF FF FF FF FF FF    
   7026 00B9BB FF FF FF FF FF FF FF FF    
   7026 00B9C3 FF FF FF FF FF FF FF FF    
   7026 00B9CB FF FF FF FF FF FF FF FF    
   7026 00B9D3 FF FF FF FF FF FF FF FF    
   7026 00B9DB FF FF FF FF FF FF FF FF    
   7026 00B9E3 FF FF FF FF FF FF FF FF    
   7026 00B9EB FF FF FF FF FF FF FF FF    
   7026 00B9F3 FF FF FF FF FF FF FF FF    
   7026 00B9FB FF FF FF FF FF FF FF FF    
   7026 00BA03 FF FF FF FF FF FF FF FF    
   7026 00BA0B FF FF FF FF FF FF FF FF    
   7026 00BA13 FF FF FF FF FF FF FF FF    
   7026 00BA1B FF FF FF FF FF FF FF FF    
   7026 00BA23 FF FF FF FF FF FF FF FF    
   7026 00BA2B FF FF FF FF FF FF FF FF    
   7026 00BA33 FF FF FF FF FF FF FF FF    
   7026 00BA3B FF FF FF FF FF FF FF FF    
   7026 00BA43 FF FF FF FF FF FF FF FF    
   7026 00BA4B FF FF FF FF FF FF FF FF    
   7026 00BA53 FF FF FF FF FF FF FF FF    
   7026 00BA5B FF FF FF FF FF FF FF FF    
   7026 00BA63 FF FF FF FF FF FF FF FF    
   7026 00BA6B FF FF FF FF FF FF FF FF    
   7026 00BA73 FF FF FF FF FF FF FF FF    
   7026 00BA7B FF FF FF FF FF FF FF FF    
   7026 00BA83 FF FF FF FF FF FF FF FF    
   7026 00BA8B FF FF FF FF FF FF FF FF    
   7026 00BA93 FF FF FF FF FF FF FF FF    
   7026 00BA9B FF FF FF FF FF FF FF FF    
   7026 00BAA3 FF FF FF FF FF FF FF FF    
   7026 00BAAB FF FF FF FF FF FF FF FF    
   7026 00BAB3 FF FF FF FF FF FF FF FF    
   7026 00BABB FF FF FF FF FF FF FF FF    
   7026 00BAC3 FF FF FF FF FF FF FF FF    
   7026 00BACB FF FF FF FF FF FF FF FF    
   7026 00BAD3 FF FF FF FF FF FF FF FF    
   7026 00BADB FF FF FF FF FF FF FF FF    
   7026 00BAE3 FF FF FF FF FF FF FF FF    
   7026 00BAEB FF FF FF FF FF FF FF FF    
   7026 00BAF3 FF FF FF FF FF FF FF FF    
   7026 00BAFB FF FF FF FF FF FF FF FF    
   7026 00BB03 FF FF FF FF FF FF FF FF    
   7026 00BB0B FF FF FF FF FF FF FF FF    
   7026 00BB13 FF FF FF FF FF FF FF FF    
   7026 00BB1B FF FF FF FF FF FF FF FF    
   7026 00BB23 FF FF FF FF FF FF FF FF    
   7026 00BB2B FF FF FF FF FF FF FF FF    
   7026 00BB33 FF FF FF FF FF FF FF FF    
   7026 00BB3B FF FF FF FF FF FF FF FF    
   7026 00BB43 FF FF FF FF FF FF FF FF    
   7026 00BB4B FF FF FF FF FF FF FF FF    
   7026 00BB53 FF FF FF FF FF FF FF FF    
   7026 00BB5B FF FF FF FF FF FF FF FF    
   7026 00BB63 FF FF FF FF FF FF FF FF    
   7026 00BB6B FF FF FF FF FF FF FF FF    
   7026 00BB73 FF FF FF FF FF FF FF FF    
   7026 00BB7B FF FF FF FF FF FF FF FF    
   7026 00BB83 FF FF FF FF FF FF FF FF    
   7026 00BB8B FF FF FF FF FF FF FF FF    
   7026 00BB93 FF FF FF FF FF FF FF FF    
   7026 00BB9B FF FF FF FF FF FF FF FF    
   7026 00BBA3 FF FF FF FF FF FF FF FF    
   7026 00BBAB FF FF FF FF FF FF FF FF    
   7026 00BBB3 FF FF FF FF FF FF FF FF    
   7026 00BBBB FF FF FF FF FF FF FF FF    
   7026 00BBC3 FF FF FF FF FF FF FF FF    
   7026 00BBCB FF FF FF FF FF FF FF FF    
   7026 00BBD3 FF FF FF FF FF FF FF FF    
   7026 00BBDB FF FF FF FF FF FF FF FF    
   7026 00BBE3 FF FF FF FF FF FF FF FF    
   7026 00BBEB FF FF FF FF FF FF FF FF    
   7026 00BBF3 FF FF FF FF FF FF FF FF    
   7026 00BBFB FF FF FF FF FF FF FF FF    
   7026 00BC03 FF FF FF FF FF FF FF FF    
   7026 00BC0B FF FF FF FF FF FF FF FF    
   7026 00BC13 FF FF FF FF FF FF FF FF    
   7026 00BC1B FF FF FF FF FF FF FF FF    
   7026 00BC23 FF FF FF FF FF FF FF FF    
   7026 00BC2B FF FF FF FF FF FF FF FF    
   7026 00BC33 FF FF FF FF FF FF FF FF    
   7026 00BC3B FF FF FF FF FF FF FF FF    
   7026 00BC43 FF FF FF FF FF FF FF FF    
   7026 00BC4B FF FF FF FF FF FF FF FF    
   7026 00BC53 FF FF FF FF FF FF FF FF    
   7026 00BC5B FF FF FF FF FF FF FF FF    
   7026 00BC63 FF FF FF FF FF FF FF FF    
   7026 00BC6B FF FF FF FF FF FF FF FF    
   7026 00BC73 FF FF FF FF FF FF FF FF    
   7026 00BC7B FF FF FF FF FF FF FF FF    
   7026 00BC83 FF FF FF FF FF FF FF FF    
   7026 00BC8B FF FF FF FF FF FF FF FF    
   7026 00BC93 FF FF FF FF FF FF FF FF    
   7026 00BC9B FF FF FF FF FF FF FF FF    
   7026 00BCA3 FF FF FF FF FF FF FF FF    
   7026 00BCAB FF FF FF FF FF FF FF FF    
   7026 00BCB3 FF FF FF FF FF FF FF FF    
   7026 00BCBB FF FF FF FF FF FF FF FF    
   7026 00BCC3 FF FF FF FF FF FF FF FF    
   7026 00BCCB FF FF FF FF FF FF FF FF    
   7026 00BCD3 FF FF FF FF FF FF FF FF    
   7026 00BCDB FF FF FF FF FF FF FF FF    
   7026 00BCE3 FF FF FF FF FF FF FF FF    
   7026 00BCEB FF FF FF FF FF FF FF FF    
   7026 00BCF3 FF FF FF FF FF FF FF FF    
   7026 00BCFB FF FF FF FF FF FF FF FF    
   7026 00BD03 FF FF FF FF FF FF FF FF    
   7026 00BD0B FF FF FF FF FF FF FF FF    
   7026 00BD13 FF FF FF FF FF FF FF FF    
   7026 00BD1B FF FF FF FF FF FF FF FF    
   7026 00BD23 FF FF FF FF FF FF FF FF    
   7026 00BD2B FF FF FF FF FF FF FF FF    
   7026 00BD33 FF FF FF FF FF FF FF FF    
   7026 00BD3B FF FF FF FF FF FF FF FF    
   7026 00BD43 FF FF FF FF FF FF FF FF    
   7026 00BD4B FF FF FF FF FF FF FF FF    
   7026 00BD53 FF FF FF FF FF FF FF FF    
   7026 00BD5B FF FF FF FF FF FF FF FF    
   7026 00BD63 FF FF FF FF FF FF FF FF    
   7026 00BD6B FF FF FF FF FF FF FF FF    
   7026 00BD73 FF FF FF FF FF FF FF FF    
   7026 00BD7B FF FF FF FF FF FF FF FF    
   7026 00BD83 FF FF FF FF FF FF FF FF    
   7026 00BD8B FF FF FF FF FF FF FF FF    
   7026 00BD93 FF FF FF FF FF FF FF FF    
   7026 00BD9B FF FF FF FF FF FF FF FF    
   7026 00BDA3 FF FF FF FF FF FF FF FF    
   7026 00BDAB FF FF FF FF FF FF FF FF    
   7026 00BDB3 FF FF FF FF FF FF FF FF    
   7026 00BDBB FF FF FF FF FF FF FF FF    
   7026 00BDC3 FF FF FF FF FF FF FF FF    
   7026 00BDCB FF FF FF FF FF FF FF FF    
   7026 00BDD3 FF FF FF FF FF FF FF FF    
   7026 00BDDB FF FF FF FF FF FF FF FF    
   7026 00BDE3 FF FF FF FF FF FF FF FF    
   7026 00BDEB FF FF FF FF FF FF FF FF    
   7026 00BDF3 FF FF FF FF FF FF FF FF    
   7026 00BDFB FF FF FF FF FF FF FF FF    
   7026 00BE03 FF FF FF FF FF FF FF FF    
   7026 00BE0B FF FF FF FF FF FF FF FF    
   7026 00BE13 FF FF FF FF FF FF FF FF    
   7026 00BE1B FF FF FF FF FF FF FF FF    
   7026 00BE23 FF FF FF FF FF FF FF FF    
   7026 00BE2B FF FF FF FF FF FF FF FF    
   7026 00BE33 FF FF FF FF FF FF FF FF    
   7026 00BE3B FF FF FF FF FF FF FF FF    
   7026 00BE43 FF FF FF FF FF FF FF FF    
   7026 00BE4B FF FF FF FF FF FF FF FF    
   7026 00BE53 FF FF FF FF FF FF FF FF    
   7026 00BE5B FF FF FF FF FF FF FF FF    
   7026 00BE63 FF FF FF FF FF FF FF FF    
   7026 00BE6B FF FF FF FF FF FF FF FF    
   7026 00BE73 FF FF FF FF FF FF FF FF    
   7026 00BE7B FF FF FF FF FF FF FF FF    
   7026 00BE83 FF FF FF FF FF FF FF FF    
   7026 00BE8B FF FF FF FF FF FF FF FF    
   7026 00BE93 FF FF FF FF FF FF FF FF    
   7026 00BE9B FF FF FF FF FF FF FF FF    
   7026 00BEA3 FF FF FF FF FF FF FF FF    
   7026 00BEAB FF FF FF FF FF FF FF FF    
   7026 00BEB3 FF FF FF FF FF FF FF FF    
   7026 00BEBB FF FF FF FF FF FF FF FF    
   7026 00BEC3 FF FF FF FF FF FF FF FF    
   7026 00BECB FF FF FF FF FF FF FF FF    
   7026 00BED3 FF FF FF FF FF FF FF FF    
   7026 00BEDB FF FF FF FF FF FF FF FF    
   7026 00BEE3 FF FF FF FF FF FF FF FF    
   7026 00BEEB FF FF FF FF FF FF FF FF    
   7026 00BEF3 FF FF FF FF FF FF FF FF    
   7026 00BEFB FF FF FF FF FF FF FF FF    
   7026 00BF03 FF FF FF FF FF FF FF FF    
   7026 00BF0B FF FF FF FF FF FF FF FF    
   7026 00BF13 FF FF FF FF FF FF FF FF    
   7026 00BF1B FF FF FF FF FF FF FF FF    
   7026 00BF23 FF FF FF FF FF FF FF FF    
   7026 00BF2B FF FF FF FF FF FF FF FF    
   7026 00BF33 FF FF FF FF FF FF FF FF    
   7026 00BF3B FF FF FF FF FF FF FF FF    
   7026 00BF43 FF FF FF FF FF FF FF FF    
   7026 00BF4B FF FF FF FF FF FF FF FF    
   7026 00BF53 FF FF FF FF FF FF FF FF    
   7026 00BF5B FF FF FF FF FF FF FF FF    
   7026 00BF63 FF FF FF FF FF FF FF FF    
   7026 00BF6B FF FF FF FF FF FF FF FF    
   7026 00BF73 FF FF FF FF FF FF FF FF    
   7026 00BF7B FF FF FF FF FF FF FF FF    
   7026 00BF83 FF FF FF FF FF FF FF FF    
   7026 00BF8B FF FF FF FF FF FF FF FF    
   7026 00BF93 FF FF FF FF FF FF FF FF    
   7026 00BF9B FF FF FF FF FF FF FF FF    
   7026 00BFA3 FF FF FF FF FF FF FF FF    
   7026 00BFAB FF FF FF FF FF FF FF FF    
   7026 00BFB3 FF FF FF FF FF FF FF FF    
   7026 00BFBB FF FF FF FF FF FF FF FF    
   7026 00BFC3 FF FF FF FF FF FF FF FF    
   7026 00BFCB FF FF FF FF FF FF FF FF    
   7026 00BFD3 FF FF FF FF FF FF FF FF    
   7026 00BFDB FF FF FF FF FF FF FF FF    
   7026 00BFE3 FF FF FF FF FF FF FF FF    
   7026 00BFEB FF FF FF FF FF FF FF FF    
   7026 00BFF3 FF FF FF FF FF FF FF FF    
   7026 00BFFB FF FF FF FF FF             
                                           
   7028 00C000                             start:
   7029 00C000 78                           	SEI					; not strictly necessary after power on reset
   7030 00C001 D8                           	CLD
                                           ;	CLV					; overflow low
                                           ;	SEC					; carry high
                                           ;	XCE					; sets 32 bit mode, 32 bit registers
                                           ;	REP		#$30		; 32 bit registers
                                           ;	MEM		32
                                           ;	NDX		32
                                           ;	LDA		#$3FFF
                                           ;	TAS
                                           ;
   7040 00C002 18                           	CLC					; switch to '816 mode
   7041 00C003 2C 00 C0                     	BIT		start		; set overflow bit
   7042 00C006 FB                           	XCE
   7043 00C007 C2 30                        	REP		#$30		; set 16 bit regs & mem
                                           	NDX 	16
                                           	MEM		16
                                           
                                           	; Setup all the segment descriptors
                                           	; This must be done before the stack can be accessed, and
                                           	; before subroutine calls and task switching can be made.
                                           
                                           	; First setup segment #0, the segment the core starts running under.
                                           	; It's setup for flat addressing.
   7053 00C009 A9 00 00                     	LDA		#0
   7054 00C00C 42 EB                        	XBAW
   7055 00C00E A9 00 00                     	LDA		#0
   7056 00C011 A2 8D 09                     	LDX		#$98D		; present, writeable, executable, max size.
   7057 00C014 A8                           	TAY
   7058 00C015 42 BA                        	SDU
   7059 00C017 C8                           	INY
                                           
                                           	; Flag remaining segments as not present 
   7062 00C018 A2 00 00                     	LDX		#$000		; not present, non-executable, non-writeable, min size
   7063 00C01B                             .0003:
   7064 00C01B 42 BA                        	SDU					; update segment descriptor
   7065 00C01D C8                           	INY
   7066 00C01E C0 00 10                     	CPY		#4096
   7067 00C021 D0 F8                        	BNE		.0003
                                           
                                           	; setup code segment #1
   7070 00C023 A2 05 09                     	LDX		#$905		; executable, 64k
   7071 00C026 A8                           	TAY
   7072 00C027 C8                           	INY
   7073 00C028 42 BA                        	SDU
                                           	; setup data segment #2
   7075 00C02A A2 8B 08                     	LDX		#$88B		; writeable, 256M
   7076 00C02D C8                           	INY
   7077 00C02E 42 BA                        	SDU
                                           	; setup stack segment #3 (for 65c02 mode)
   7079 00C030 A2 82 08                     	LDX		#$882		; writeable, 1k (based at zero)
   7080 00C033 C8                           	INY
   7081 00C034 42 BA                        	SDU
                                           	; setup stack segment #4 (for 65c816 mode)
   7083 00C036 A2 85 08                     	LDX		#$885		; writeable, 64k (based at zero)
   7084 00C039 C8                           	INY
   7085 00C03A 42 BA                        	SDU
                                           	; seg #5 is the maxed out segment
   7087 00C03C A2 8D 09                     	LDX		#$98D		; executable, writable, max size
   7088 00C03F C8                           	INY
   7089 00C040 42 BA                        	SDU
                                           
                                           	; I/O segment
   7092 00C042 A9 F0 00                     	LDA		#$00F0
   7093 00C045 42 EB                        	XBAW
   7094 00C047 A9 00 00                     	LDA		#$0000
   7095 00C04A A2 87 08                     	LDX		#$887		; writeable, 1M (based at $F00000)
   7096 00C04D A0 FF 0F                     	LDY		#$FFF
   7097 00C050 42 BA                        	SDU
                                           
                                           	; now set the code segment (test far jump)
   7100 00C052 42 5C 59 C0 00 01 00         	JMF		1:.0004
   7101 00C059                             .0004:
                                           	; set the stack segment
                                           	; (must be before PEA/PLDS)
   7104 00C059 A9 05 00                     	LDA		#5
   7105 00C05C 42 5A                        	TASS
   7106 00C05E A9 FF 6B                     	LDA		#$6BFF		; set top of stack
   7107 00C061 1B                           	TAS
                                           
                                           	; setup the programmable address decodes
   7110 00C062 A9 70 00                     	LDA		#$0070		; program chip selects for I/O
   7111 00C065 8D 00 B0                     	STA		PCS0		; at $007000
   7112 00C068 A9 71 00                     	LDA		#$0071
   7113 00C06B 8D 02 B0                     	STA		PCS1
                                           ;	LDA		#$FEA1		; select $FEA1xx I/O
                                           ;	STA		PCS3
                                           ;	LDA		#$0000		; select zero page ram
                                           ;	STA		PCS5
                                           
                                           	; set the data segment
                                           	; this must be setup after address decoding is setup
   7121 00C06E F4 05 00                     	PEA		5
   7122 00C071 42 2B                        	PLDS
                                           
                                           	; Setup the counters
   7125 00C073 E2 30                        	SEP		#$30		; set 8 bit regs
                                           	NDX		8			; tell the assembler
                                           	MEM		8
                                           	; Counter #0 is setup as a free running tick count
   7129 00C075 A9 FF                        	LDA		#$FF		; set limit to $FFFFFF
   7130 00C077 8D 10 B0                     	STA		CTR0_LMT
   7131 00C07A 8D 11 B0                     	STA		CTR0_LMT+1
   7132 00C07D 8D 12 B0                     	STA		CTR0_LMT+2
   7133 00C080 A9 14                        	LDA		#$14		; count up, on mpu clock
   7134 00C082 8D 13 B0                     	STA		CTR0_CTRL
                                           	; Counter #1 is set to interrupt at a 50Hz rate
   7136 00C085 A9 2A                        	LDA		#$2A	;94		; divide by 95794 (for 50Hz)
   7137 00C087 8D 14 B0                     	STA		CTR1_LMT		; FFFFFE = 2Hz with 33MHz clock
   7138 00C08A A9 2C                        	LDA		#$2C	;57
   7139 00C08C 8D 15 B0                     	STA		CTR1_LMT+1
   7140 00C08F A9 0A                        	LDA		#$0A	;09
   7141 00C091 8D 16 B0                     	STA		CTR1_LMT+2
   7142 00C094 A9 05                        	LDA		#$05		; count down, on mpu clock, irq disenabled
   7143 00C096 8D 17 B0                     	STA		CTR1_CTRL
                                           	; Counter #2 isn't setup
                                           
   7146 00C099 C2 30                        	REP		#$30		; set 16 bit regs & mem
                                           	NDX 	16
                                           	MEM		16
                                           
   7150 00C09B A9 20 00                     	LDA		#$20
   7151 00C09E 85 2C                        	STA		TCB_priority
   7152 00C0A0 A9 00 00                     	LDA		#0
   7153 00C0A3 20 D8 DB                     	JSR		InsertIntoReadyFifo
   7154 00C0A6 20 A2 CD                     	JSR		ResetKbd
                                           
   7156 00C0A9 64 D0                        	STZ		TaskSwitchEn
                                           ;	FORK	#8			; fork a BIOS context
                                           ;	TTA
                                           ;	CMP		#8
                                           ;	BNE		.0002
                                           ;	RTT
                                           ;.0002:
                                           	; Setup the task registers
   7164 00C0AB A0 09 00                     	LDY		#9			; # tasks to setup
   7165 00C0AE A2 01 00                     	LDX		#1
   7166 00C0B1                             .0001:
   7167 00C0B1 42 4C 7D DD 00 00            	LDT		TaskStartTbl,X
   7168 00C0B7 E8                           	INX
   7169 00C0B8 88                           	DEY
   7170 00C0B9 D0 F6                        	BNE		.0001
                                           
   7172 00C0BB 42 9C 00 20 05 00            	STZ		running_task
                                           
   7174 00C0C1 A9 12 DD                     	LDA		#BrkRout1
   7175 00C0C4 8D 02 01                     	STA		$0102
                                           
   7177 00C0C7 64 04                        	STZ		TickCount
   7178 00C0C9 64 06                        	STZ		TickCount+2
   7179 00C0CB                             Task0:
   7180 00C0CB 58                           	CLI
   7181 00C0CC EA                           	NOP
   7182 00C0CD EA                           	NOP
   7183 00C0CE EA                           	NOP
                                           	; Start the single stepping task.
   7185 00C0CF A9 01 00                     	LDA		#$01
   7186 00C0D2 8D 00 70                     	STA		$7000
   7187 00C0D5 42 A2 09 00                  	TSK		#9
   7188 00C0D9                             .0001:
   7189 00C0D9 A9 04 00                     	LDA		#$04
   7190 00C0DC 8D 00 70                     	STA		$7000
   7191 00C0DF A9 FF 0F                     	LDA		#$FFF
   7192 00C0E2 85 44                        	STA		Vidptr+4
   7193 00C0E4 85 4A                        	STA		Vidregs+4
   7194 00C0E6 A9 0D 00                     	LDA		#VIDBUF>>16
   7195 00C0E9 85 42                        	STA		Vidptr+2
   7196 00C0EB 64 40                        	STZ		Vidptr
   7197 00C0ED A9 0D BF                     	LDA		#$BF0D	; 'm'
   7198 00C0F0 42 DA 42 87 40               	STA		FAR {Vidptr}
   7199 00C0F5 A9 0E 00                     	LDA		#VIDREGS >> 16
   7200 00C0F8 85 48                        	STA		Vidregs+2
   7201 00C0FA A9 00 A0                     	LDA		#VIDREGS
   7202 00C0FD 85 46                        	STA		Vidregs
   7203 00C0FF A0 07 00                     	LDY		#7	
   7204 00C102 A9 21 00                     	LDA		#$21		; divide by 3 vertically, 2 horizontally
   7205 00C105 20 1D CC                     	JSR		SetVideoReg	; clear POR state
   7206 00C108 A9 54 00                     	LDA		#84		; set window left position 84
   7207 00C10B A0 02 00                     	LDY		#2
   7208 00C10E 20 1D CC                     	JSR		SetVideoReg
   7209 00C111 A9 00 00                     	LDA		#0
   7210 00C114 A0 03 00                     	LDY		#3
   7211 00C117 20 1D CC                     	JSR		SetVideoReg
   7212 00C11A A9 10 00                     	LDA		#16			; set window top position
   7213 00C11D A0 04 00                     	LDY		#4
   7214 00C120 20 1D CC                     	JSR		SetVideoReg
   7215 00C123 20 02 CC                     	JSR		GetTextRowsCols
   7216 00C126 A9 D2 C9                     	LDA		#DisplayChar
   7217 00C129 8D F0 03                     	STA		OutputVec
   7218 00C12C AD F0 03                     	LDA		OutputVec
   7219 00C12F C9 D2 C9                     	CMP		#DisplayChar
   7220 00C132 D0 A5                        	BNE		.0001
   7221 00C134 A9 02 00                     	LDA		#$02
   7222 00C137 8D 00 70                     	STA		$7000
   7223 00C13A A9 00 BF                     	LDA		#$BF00
   7224 00C13D 85 36                        	STA		NormAttr
   7225 00C13F 20 47 CC                     	JSR		ClearScreen
   7226 00C142 20 97 CB                     	JSR		HomeCursor
                                           ;	JSR		beep
   7228 00C145 A9 03 00                     	LDA		#$03
   7229 00C148 42 3B 05 00 8D 00 70         	STA		5:$7000
   7230 00C14F F4 05 00                     	PEA		5
   7231 00C152 F4 56 C8                     	PEA		msgStarting
   7232 00C155 20 D3 CB                     	JSR		DisplayString
   7233 00C158 20 0D D5                     	JSR		rtc_init
   7234 00C15B 20 15 D5                     	JSR		rtc_read
   7235 00C15E C9 00 00                     	CMP		#0
   7236 00C161 F0 09                        	BEQ		.0006
   7237 00C163 F4 01 00                     	PEA		1
   7238 00C166 F4 DD D5                     	PEA		msgRtcReadFail
   7239 00C169 20 D3 CB                     	JSR		DisplayString
   7240 00C16C                             .0006:
                                           ;	SEP		#$1000		; turn on single step mode
                                           ;	LDA		#0
                                           ;	STA		$FFF:FAC1
                                           ;	STA		$FFF:FAC1+2
                                           ;	STA		$FFF:FAC1+4
                                           ;	STA		$FFF:FAC1+6
                                           ;	STA		$FFF:FAC1+8
                                           ;	STA		$FFF:FAC1+10
                                           ;	LDA		#3
                                           ;	STA		$7000
                                           ;	LDA		#1234
                                           ;	STA		FAC1
                                           ;	LDA		#5			; FIX2FLT
                                           ;	JSR 	FPCommandWait
                                           ;	LDA		#4
                                           ;	STA		$7000
                                           ;	JSR		DivideByTen
                                           ;	LDA		#5
                                           ;	STA		$7000
                                           ;	JSR		FAC1ToString
                                           ;	PEA		2
                                           ;	PEA		$3A0
                                           ;	JSR		DisplayString
                                           ;	LDA		#' '
                                           ;	JSR		OutChar
                                           ;	JSR		DispFAC1
                                           
                                           ;	FORK	#11
                                           ;	TTA
                                           ;	CMP		#11
                                           ;	LBEQ	KeybdInit
                                           
                                           	; Create a workhorse BIOS context that will allow subroutine calls into
                                           	; the BIOS code from alternate contexts which may not have the same VM
                                           	; settings.
                                           	;
   7277 00C16C 78                           	SEI
   7278 00C16D 42 A0 FC 00                  	FORK	#$FC
   7279 00C171 42 1A                        	TTA
   7280 00C173 29 FF 01                     	AND		#$01FF
   7281 00C176 C9 FC 00                     	CMP		#$FC
   7282 00C179 D0 1E                        	BNE		TaskMon
   7283 00C17B                             TaskFC:
   7284 00C17B A2 F8 01                     	LDX		#$FC*2
   7285 00C17E A9 20 00                     	LDA		#$20
   7286 00C181 95 2C                        	STA		TCB_priority,X
   7287 00C183 8A                           	TXA
   7288 00C184 4A                           	LSR
   7289 00C185 20 D8 DB                     	JSR		InsertIntoReadyFifo
   7290 00C188                             .0003
   7291 00C188 78                           	SEI
   7292 00C189 68                           	PLA
   7293 00C18A A2 FF 23                     	LDX		#$23FF
   7294 00C18D 9A                           	TXS
   7295 00C18E 48                           	PHA
   7296 00C18F 58                           	CLI
   7297 00C190 EA                           	NOP		; allow CLI to take place
   7298 00C191 EA                           	NOP
   7299 00C192 EA                           	NOP
   7300 00C193 EA                           	NOP
   7301 00C194 EA                           	NOP
   7302 00C195 42 60                        	RTT
   7303 00C197 80 EF                        	BRA		.0003
   7304 00C199                             TaskMon:
   7305 00C199 58                           	CLI
                                           
   7307 00C19A                             Mon1:
   7308 00C19A                             .mon1:
   7309 00C19A A9 FF 6B                     	LDA		#$6BFF
   7310 00C19D 1B                           	TAS
   7311 00C19E 20 27 CC                     	JSR		CursorOn
   7312 00C1A1 20 BB CB                     	JSR		OutCRLF
   7313 00C1A4 A9 24 00                     	LDA		#'$'
   7314 00C1A7 85 D0                        	STA		TaskSwitchEn
   7315 00C1A9                             .mon3:
   7316 00C1A9 20 C4 CB                     	JSR		OutChar
   7317 00C1AC 20 38 CF                     	JSR		KeybdGetCharWait
   7318 00C1AF 29 FF 00                     	AND		#$FF
                                           ;	CMP		#'.'
                                           ;	BEQ		.mon3
   7321 00C1B2 C9 0D 00                     	CMP		#CR
   7322 00C1B5 D0 F2                        	BNE		.mon3
   7323 00C1B7 A5 32                        	LDA		CursorY
   7324 00C1B9 0A                           	ASL
   7325 00C1BA AA                           	TAX
   7326 00C1BB 42 1B BD 3F DD               	LDA		CS:LineTbl,X
   7327 00C1C0 0A                           	ASL
   7328 00C1C1 AA                           	TAX
   7329 00C1C2                             .mon4:
   7330 00C1C2 20 EE C7                     	JSR		IgnoreBlanks
   7331 00C1C5 20 62 C2                     	JSR		MonGetch
   7332 00C1C8 C9 24 00                     	CMP		#'$'
   7333 00C1CB F0 F5                        	BEQ		.mon4
   7334 00C1CD C9 53 00                     	CMP		#'S'
   7335 00C1D0 D0 21                        	BNE		.mon2
   7336 00C1D2 20 62 C2                     	JSR		MonGetch
   7337 00C1D5 C9 45 00                     	CMP		#'E'
   7338 00C1D8 F0 FF 65 01                  	LBEQ	GetSecnum
   7339 00C1DC A9 20 00                     	LDA		#$20
   7340 00C1DF 85 34                        	STA		TCB_priority+8
   7341 00C1E1 64 2D                        	STZ		TCB_status		; monitor is no longer ready
   7342 00C1E3 A9 08 00                     	LDA		#8
   7343 00C1E6 85 CE                        	STA		IOFocusTask
   7344 00C1E8 20 D8 DB                     	JSR		InsertIntoReadyFifo
   7345 00C1EB 42 CB 42 A2 08 00            	TSK		JMP:#8
   7346 00C1F1 80 A7                        	BRA		.mon1
                                           	;JMP		$C000		; invoke Supermon832
   7348 00C1F3                             .mon2:
   7349 00C1F3 C9 43 00                     	CMP		#'C'
   7350 00C1F6 D0 08                        	BNE		.mon5
   7351 00C1F8 20 47 CC                     	JSR		ClearScreen
   7352 00C1FB 20 97 CB                     	JSR		HomeCursor
   7353 00C1FE 80 9A                        	BRA		.mon1
   7354 00C200                             .mon5:
   7355 00C200 C9 4D 00                     	CMP		#'M'
   7356 00C203 D0 05                        	BNE		.mon6
   7357 00C205 20 31 C6                     	JSR		doMemoryDump
   7358 00C208 80 90                        	BRA		Mon1
   7359 00C20A                             .mon6:
   7360 00C20A C9 44 00                     	CMP		#'D'
   7361 00C20D F0 FF 6E 00                  	LBEQ	doD
   7362 00C211 C9 3E 00                     	CMP		#'>'
   7363 00C214 F0 FF 8B 04                  	LBEQ	doMemoryEdit
   7364 00C218 C9 46 00                     	CMP		#'F'
   7365 00C21B F0 FF BF 04                  	LBEQ	doFill
   7366 00C21F C9 4A 00                     	CMP		#'J'
   7367 00C222 F0 FF 5E 05                  	LBEQ	doJump
   7368 00C226 C9 54 00                     	CMP		#'T'
   7369 00C229 F0 FF C9 00                  	LBEQ	doTask
   7370 00C22D C9 49 00                     	CMP		#'I'
   7371 00C230 F0 FF 86 01                  	LBEQ	doInvaders
   7372 00C234 C9 52 00                     	CMP		#'R'
   7373 00C237 D0 0F                        	BNE		.mon7
   7374 00C239 20 62 C2                     	JSR		MonGetch
   7375 00C23C C9 44 00                     	CMP		#'D'
   7376 00C23F F0 FF 13 01                  	LBEQ	doRead
   7377 00C243 CA                           	DEX
   7378 00C244 CA                           	DEX
   7379 00C245 82 7F 01                     	BRL		doRegs
   7380 00C248                             .mon7:
   7381 00C248 C9 42 00                     	CMP		#'B'
   7382 00C24B F0 FF CC 00                  	LBEQ	doBasic
   7383 00C24F C9 57 00                     	CMP		#'W'
   7384 00C252 F0 FF F9 00                  	LBEQ	doWrite
   7385 00C256 82 41 FF                     	BRL		Mon1
                                           
                                           ; Get a character from the screen, skipping over spaces and tabs
                                           ;
   7389 00C259                             MonGetNonSpace:
   7390 00C259                             .0001:
   7391 00C259 20 62 C2                     	JSR		MonGetch
   7392 00C25C C9 20 00                     	CMP		#' '
   7393 00C25F F0 F8                        	BEQ		.0001
   7394 00C261 60                           	RTS
                                           
                                           ; Get a character from the screen.
                                           ;
   7398 00C262                             MonGetch:
   7399 00C262 42 3B FF 0F BF 00 00 0D      	LDA		$FFF:VIDBUF,X
                                         
   7400 00C26A E8                           	INX
   7401 00C26B E8                           	INX
   7402 00C26C 29 FF 00                     	AND		#$FF
   7403 00C26F 20 C6 C9                     	JSR		ScreenToAscii
   7404 00C272 60                           	RTS
                                           
   7406 00C273                             MonErr:
   7407 00C273 F4 01 00                     	PEA		1
   7408 00C276 F4 38 DF                     	PEA		msgErr
   7409 00C279 20 D3 CB                     	JSR		DisplayString
   7410 00C27C 82 1B FF                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   7414 00C27F                             doD:
   7415 00C27F 20 62 C2                     	JSR		MonGetch
   7416 00C282 C9 54 00                     	CMP		#'T'
   7417 00C285 F0 05                        	BEQ		doDate
   7418 00C287 CA                           	DEX
   7419 00C288 CA                           	DEX
   7420 00C289 82 A8 04                     	BRL		doDisassemble
                                           
                                           ;------------------------------------------------------------------------------
                                           ; DT? - displays the date from the RTC
                                           ; DT <year> <month> <day> - updates the RTC with the year, month and day.
                                           ;------------------------------------------------------------------------------
                                           
   7427 00C28C                             doDate:
   7428 00C28C 20 62 C2                     	JSR		MonGetch
   7429 00C28F C9 3F 00                     	CMP		#'?'
   7430 00C292 F0 35                        	BEQ		DispDate
   7431 00C294 CA                           	DEX
   7432 00C295 CA                           	DEX
   7433 00C296 20 FF CC                     	JSR		GetHexNumber
   7434 00C299 C0 00 00                     	CPY		#0
   7435 00C29C F0 28                        	BEQ		.0001
   7436 00C29E A5 0C                        	LDA		NumWorkArea
   7437 00C2A0 42 8B 8D 06 03               	STA.B	RTCBuf+6
   7438 00C2A5 20 FF CC                     	JSR		GetHexNumber
   7439 00C2A8 C0 00 00                     	CPY		#0
   7440 00C2AB F0 19                        	BEQ		.0001
   7441 00C2AD A5 0C                        	LDA		NumWorkArea
   7442 00C2AF 42 8B 8D 05 03               	STA.B	RTCBuf+5
   7443 00C2B4 20 FF CC                     	JSR		GetHexNumber
   7444 00C2B7 C0 00 00                     	CPY		#0
   7445 00C2BA F0 0A                        	BEQ		.0001
   7446 00C2BC A5 0C                        	LDA		NumWorkArea
   7447 00C2BE 42 8B 8D 04 03               	STA.B	RTCBuf+4
   7448 00C2C3 20 97 D5                     	JSR		rtc_write
   7449 00C2C6                             .0001:
   7450 00C2C6 82 D1 FE                     	BRL		Mon1
                                           
   7452 00C2C9                             DispDate:
   7453 00C2C9 20 15 D5                     	JSR		rtc_read
   7454 00C2CC 42 8B AD 06 03               	LDA.B	RTCBuf+6
   7455 00C2D1 20 A9 CC                     	JSR		DispByte
   7456 00C2D4 A9 2F 00                     	LDA		#'/'
   7457 00C2D7 20 C4 CB                     	JSR		OutChar
   7458 00C2DA 42 8B AD 05 03               	LDA.B	RTCBuf+5
   7459 00C2DF 20 A9 CC                     	JSR		DispByte
   7460 00C2E2 A9 2F 00                     	LDA		#'/'
   7461 00C2E5 20 C4 CB                     	JSR		OutChar
   7462 00C2E8 42 8B AD 04 03               	LDA.B	RTCBuf+4
   7463 00C2ED 20 A9 CC                     	JSR		DispByte
   7464 00C2F0 20 BB CB                     	JSR		OutCRLF
   7465 00C2F3 82 A4 FE                     	BRL		Mon1
                                           		
                                           ;------------------------------------------------------------------------------
   7468 00C2F6                             doTask:
   7469 00C2F6 20 62 C2                     	JSR		MonGetch
   7470 00C2F9 C9 53 00                     	CMP		#'S'
   7471 00C2FC D0 14                        	BNE		.0001
   7472 00C2FE 20 FF CC                     	JSR		GetHexNumber
   7473 00C301 A5 0C                        	LDA		NumWorkArea
   7474 00C303 0A                           	ASL
   7475 00C304 AA                           	TAX		
   7476 00C305 A9 20 00                     	LDA		#$20
   7477 00C308 95 2C                        	STA		TCB_priority,X
   7478 00C30A A5 0C                        	LDA		NumWorkArea
   7479 00C30C 20 D8 DB                     	JSR		InsertIntoReadyFifo
                                           ;	TSK
   7481 00C30F 82 88 FE                     	BRL		Mon1
   7482 00C312                             .0001:
   7483 00C312 CA                           	DEX
   7484 00C313 CA                           	DEX
   7485 00C314 20 FF CC                     	JSR		GetHexNumber
   7486 00C317 A5 0C                        	LDA		NumWorkArea
   7487 00C319 42 3A                        	TSK
                                           	BRK		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Start the BASIC interpreter.
                                           ;------------------------------------------------------------------------------
                                           
   7494 00C31B                             doBasic:
   7495 00C31B A9 01 00                     	LDA		#$0001
   7496 00C31E 42 EB                        	XBAW
   7497 00C320 A9 00 00                     	LDA		#$0000
   7498 00C323 A2 85 09                     	LDX		#$985		; executable, writeable, 64k (based at $10000)
   7499 00C326 A0 FD 0F                     	LDY		#$FFD
   7500 00C329 42 BA                        	SDU
   7501 00C32B A9 20 00                     	LDA		#$20
   7502 00C32E 85 33                        	STA		TCB_priority+7
   7503 00C330 64 2D                        	STZ		TCB_status	; monitor is no longer ready
   7504 00C332 A9 07 00                     	LDA		#7
   7505 00C335 85 CE                        	STA		IOFocusTask
   7506 00C337 20 D8 DB                     	JSR		InsertIntoReadyFifo
   7507 00C33A 42 A2 07 00                  	TSK		#7
   7508 00C33E 82 59 FE                     	BRL		Mon1
                                           	
                                           ; Get starting sector number for SD Card read/write routines
                                           ;------------------------------------------------------------------------------
                                           
   7513 00C341                             GetSecnum:
   7514 00C341 20 FF CC                     	JSR		GetHexNumber
   7515 00C344 A5 0C                        	LDA		NumWorkArea
   7516 00C346 85 C4                        	STA		secnum
   7517 00C348 A5 0E                        	LDA		NumWorkArea+2
   7518 00C34A 85 C6                        	STA		secnum+2
   7519 00C34C 82 4B FE                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Read or write a block of memory to SD Card.
                                           ;------------------------------------------------------------------------------
                                           
   7525 00C34F                             doWrite:
   7526 00C34F A9 FF FF                     	LDA		#$FFFF
   7527 00C352 85 BA                        	STA		rw_flag
   7528 00C354 80 02                        	BRA		doReadWrite
   7529 00C356                             doRead:
   7530 00C356 64 BA                        	STZ		rw_flag
   7531 00C358                             doReadWrite:
   7532 00C358 20 D4 CC                     	JSR		GetRange
   7533 00C35B 20 98 D3                     	JSR		spi_master_init
   7534 00C35E C9 00 00                     	CMP		#0
   7535 00C361 F0 03                        	BEQ		.0004
   7536 00C363 82 34 FE                     	BRL		Mon1
   7537 00C366                             .0004:
   7538 00C366 20 BB CB                     	JSR		OutCRLF
   7539 00C369                             .0002:
   7540 00C369 20 AA C3                     	JSR		DispSecnum
   7541 00C36C A5 22                        	LDA		RangeStart+2
   7542 00C36E 48                           	PHA
   7543 00C36F A5 20                        	LDA		RangeStart
   7544 00C371 48                           	PHA
   7545 00C372 A5 C6                        	LDA		secnum+2
   7546 00C374 48                           	PHA
   7547 00C375 A5 C4                        	LDA		secnum
   7548 00C377 48                           	PHA
   7549 00C378 24 BA                        	BIT		rw_flag
   7550 00C37A 50 05                        	BVC		.0005
   7551 00C37C 20 42 D4                     	JSR		spi_master_write
   7552 00C37F 80 03                        	BRA		.0006
   7553 00C381                             .0005:
   7554 00C381 20 CB D3                     	JSR		spi_master_read
   7555 00C384                             .0006:
   7556 00C384 E6 C4                        	INC		secnum
   7557 00C386 D0 02                        	BNE		.0001
   7558 00C388 E6 C6                        	INC		secnum+2
   7559 00C38A                             .0001:
   7560 00C38A 18                           	CLC
   7561 00C38B A5 20                        	LDA		RangeStart
   7562 00C38D 69 00 02                     	ADC		#512
   7563 00C390 85 20                        	STA		RangeStart
   7564 00C392 A5 22                        	LDA		RangeStart+2
   7565 00C394 69 00 00                     	ADC		#0
   7566 00C397 85 22                        	STA		RangeStart+2
   7567 00C399 38                           	SEC
   7568 00C39A A5 20                        	LDA		RangeStart
   7569 00C39C E5 24                        	SBC		RangeEnd
   7570 00C39E A5 22                        	LDA		RangeStart+2
   7571 00C3A0 E5 26                        	SBC		RangeEnd+2
   7572 00C3A2 30 C5                        	BLT		.0002
   7573 00C3A4 20 BB CB                     	JSR		OutCRLF
   7574 00C3A7 82 F0 FD                     	BRL		Mon1
                                           
   7576 00C3AA                             DispSecnum:
   7577 00C3AA A5 C6                        	LDA		secnum+2
   7578 00C3AC 20 A4 CC                     	JSR		DispWord
   7579 00C3AF A5 C4                        	LDA		secnum
   7580 00C3B1 20 A4 CC                     	JSR		DispWord
   7581 00C3B4 A9 0D 00                     	LDA		#$0D
   7582 00C3B7 4C C4 CB                     	JMP		OutChar
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   7586 00C3BA                             doInvaders:
   7587 00C3BA A9 FF FF                     	LDA		#$FFFF
   7588 00C3BD 8D 68 78                     	STA		do_invaders
   7589 00C3C0 42 A2 05 00                  	TSK		#5
                                           ;	FORK	#5
                                           ;	TTA
                                           ;	CMP		#5
                                           ;	LBEQ	InvadersTask
   7594 00C3C4 82 D3 FD                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Display Registers
                                           ; R<xx>		xx = context register to display
                                           ; Update Registers
                                           ; R.<reg> <val>
                                           ;	reg = CS PB PC A X Y SP SR DS DB DP or MP
                                           ;------------------------------------------------------------------------------
                                           
   7604 00C3C7                             doRegs:
   7605 00C3C7 20 62 C2                     	JSR		MonGetch
   7606 00C3CA C9 2E 00                     	CMP		#'.'
   7607 00C3CD D0 FF 31 01                  	LBNE	.0004
   7608 00C3D1 20 62 C2                     	JSR		MonGetch
   7609 00C3D4 C9 43 00                     	CMP		#'C'
   7610 00C3D7 D0 26                        	BNE		.0005
   7611 00C3D9 20 62 C2                     	JSR		MonGetch
   7612 00C3DC C9 53 00                     	CMP		#'S'
   7613 00C3DF D0 FF B7 FD                  	LBNE	Mon1
   7614 00C3E3 20 EE C7                     	JSR		IgnoreBlanks
   7615 00C3E6 20 FF CC                     	JSR		GetHexNumber
   7616 00C3E9 A5 0C                        	LDA		NumWorkArea
   7617 00C3EB 85 80                        	STA		reg_cs
   7618 00C3ED A5 0E                        	LDA		NumWorkArea+2
   7619 00C3EF 85 82                        	STA		reg_cs+2
   7620 00C3F1                             .buildrec
   7621 00C3F1 20 C4 C5                     	JSR		BuildRec
   7622 00C3F4 A6 BE                        	LDX		WorkTR
   7623 00C3F6 42 6C 00 01 00 00            	LDT		ldtrec
   7624 00C3FC 82 9B FD                     	BRL		Mon1
   7625 00C3FF                             .0005:
   7626 00C3FF C9 50 00                     	CMP		#'P'
   7627 00C402 D0 27                        	BNE		.0006
   7628 00C404 20 62 C2                     	JSR		MonGetch
   7629 00C407 C9 42 00                     	CMP		#'B'
   7630 00C40A D0 0C                        	BNE		.0007
   7631 00C40C 20 EE C7                     	JSR		IgnoreBlanks
   7632 00C40F 20 FF CC                     	JSR		GetHexNumber
   7633 00C412 A5 0E                        	LDA		NumWorkArea+2
   7634 00C414 85 8E                        	STA		reg_pc+2
   7635 00C416 80 D9                        	BRA		.buildrec
   7636 00C418                             .0007:
   7637 00C418 C9 43 00                     	CMP		#'C'
   7638 00C41B D0 FF 7B FD                  	LBNE	Mon1
   7639 00C41F 20 EE C7                     	JSR		IgnoreBlanks
   7640 00C422 20 FF CC                     	JSR		GetHexNumber
   7641 00C425 A5 0C                        	LDA		NumWorkArea
   7642 00C427 85 8C                        	STA		reg_pc
   7643 00C429 80 C6                        	BRA		.buildrec
   7644 00C42B                             .0006:
   7645 00C42B C9 41 00                     	CMP		#'A'
   7646 00C42E D0 10                        	BNE		.0008
   7647 00C430 20 EE C7                     	JSR		IgnoreBlanks
   7648 00C433 20 FF CC                     	JSR		GetHexNumber
   7649 00C436 A5 0C                        	LDA		NumWorkArea
   7650 00C438 85 90                        	STA		reg_a
   7651 00C43A A5 0E                        	LDA		NumWorkArea+2
   7652 00C43C 85 92                        	STA		reg_a+2
   7653 00C43E 80 B1                        	BRA		.buildrec
   7654 00C440                             .0008:
   7655 00C440 C9 58 00                     	CMP		#'X'
   7656 00C443 D0 11                        	BNE		.0009
   7657 00C445 20 EE C7                     	JSR		IgnoreBlanks
   7658 00C448 20 FF CC                     	JSR		GetHexNumber
   7659 00C44B A5 0C                        	LDA		NumWorkArea
   7660 00C44D 85 94                        	STA		reg_x
   7661 00C44F A5 0E                        	LDA		NumWorkArea+2
   7662 00C451 85 96                        	STA		reg_x+2
   7663 00C453 82 9B FF                     	BRL		.buildrec
   7664 00C456                             .0009:
   7665 00C456 C9 59 00                     	CMP		#'Y'
   7666 00C459 D0 11                        	BNE		.0010
   7667 00C45B 20 EE C7                     	JSR		IgnoreBlanks
   7668 00C45E 20 FF CC                     	JSR		GetHexNumber
   7669 00C461 A5 0C                        	LDA		NumWorkArea
   7670 00C463 85 98                        	STA		reg_y
   7671 00C465 A5 0E                        	LDA		NumWorkArea+2
   7672 00C467 85 9A                        	STA		reg_y+2
   7673 00C469 82 85 FF                     	BRL		.buildrec
   7674 00C46C                             .0010:
   7675 00C46C C9 53 00                     	CMP		#'S'
   7676 00C46F D0 2D                        	BNE		.0011
   7677 00C471 20 62 C2                     	JSR		MonGetch
   7678 00C474 C9 50 00                     	CMP		#'P'
   7679 00C477 D0 11                        	BNE		.0015
   7680 00C479 20 EE C7                     	JSR		IgnoreBlanks
   7681 00C47C 20 FF CC                     	JSR		GetHexNumber
   7682 00C47F A5 0C                        	LDA		NumWorkArea
   7683 00C481 85 9C                        	STA		reg_sp
   7684 00C483 A5 0E                        	LDA		NumWorkArea+2
   7685 00C485 85 9E                        	STA		reg_sp+2
   7686 00C487 82 67 FF                     	BRL		.buildrec
   7687 00C48A                             .0015:
   7688 00C48A C9 52 00                     	CMP		#'R'
   7689 00C48D D0 FF 09 FD                  	LBNE	Mon1
   7690 00C491 20 EE C7                     	JSR		IgnoreBlanks
   7691 00C494 20 FF CC                     	JSR		GetHexNumber
   7692 00C497 A5 0C                        	LDA		NumWorkArea
   7693 00C499 85 A0                        	STA		reg_sr
   7694 00C49B 82 53 FF                     	BRL		.buildrec
   7695 00C49E                             .0011:
   7696 00C49E C9 44 00                     	CMP		#'D'
   7697 00C4A1 D0 FF FC FF                  	LBNE	Mon14
   7698 00C4A5 20 62 C2                     	JSR		MonGetch
   7699 00C4A8 C9 53 00                     	CMP		#'S'
   7700 00C4AB D0 11                        	BNE		.0012
   7701 00C4AD 20 EE C7                     	JSR		IgnoreBlanks
   7702 00C4B0 20 FF CC                     	JSR		GetHexNumber
   7703 00C4B3 A5 0C                        	LDA		NumWorkArea
   7704 00C4B5 85 84                        	STA		reg_ds
   7705 00C4B7 A5 0E                        	LDA		NumWorkArea+2
   7706 00C4B9 85 86                        	STA		reg_ds+2
   7707 00C4BB 82 33 FF                     	BRL		.buildrec
   7708 00C4BE                             .0012:
   7709 00C4BE C9 42 00                     	CMP		#'B'
   7710 00C4C1 D0 0D                        	BNE		.0013
   7711 00C4C3 20 EE C7                     	JSR		IgnoreBlanks
   7712 00C4C6 20 FF CC                     	JSR		GetHexNumber
   7713 00C4C9 A5 0C                        	LDA		NumWorkArea
   7714 00C4CB 85 A4                        	STA		reg_db
   7715 00C4CD 82 21 FF                     	BRL		.buildrec
   7716 00C4D0                             .0013:
   7717 00C4D0 C9 50 00                     	CMP		#'P'
   7718 00C4D3 D0 FF C3 FC                  	LBNE	Mon1
   7719 00C4D7 20 EE C7                     	JSR		IgnoreBlanks
   7720 00C4DA 20 FF CC                     	JSR		GetHexNumber
   7721 00C4DD A5 0C                        	LDA		NumWorkArea
   7722 00C4DF 85 A8                        	STA		reg_dp
   7723 00C4E1 82 0D FF                     	BRL		.buildrec
   7724 00C4E4                             .0014:
   7725 00C4E4 C9 4D 00                     	CMP		#'M'
   7726 00C4E7 D0 FF AF FC                  	LBNE	Mon1
   7727 00C4EB 20 62 C2                     	JSR		MonGetch
   7728 00C4EE C9 50 00                     	CMP		#'P'
   7729 00C4F1 D0 FF A5 FC                  	LBNE	Mon1
   7730 00C4F5 20 EE C7                     	JSR		IgnoreBlanks
   7731 00C4F8 20 FF CC                     	JSR		GetHexNumber
   7732 00C4FB A5 0C                        	LDA		NumWorkArea
   7733 00C4FD 85 B0                        	STA		reg_mp
   7734 00C4FF 82 EF FE                     	BRL		.buildrec
                                           
   7736 00C502                             .0004:
   7737 00C502 CA                           	DEX
   7738 00C503 CA                           	DEX
                                           ;	JSR		IgnoreBlanks
   7740 00C504 20 FF CC                     	JSR		GetHexNumber
   7741 00C507 C0 00 00                     	CPY		#0
   7742 00C50A F0 FF 8C FC                  	LBEQ	Mon1
   7743 00C50E A5 0C                        	LDA		NumWorkArea
   7744 00C510 85 BE                        	STA		WorkTR
   7745 00C512 42 28 03 00                  	BSR		DispRegs
   7746 00C516 82 81 FC                     	BRL		Mon1
                                           
   7748 00C519                             DispRegs:
   7749 00C519 F4 01 00                     	PEA		1
   7750 00C51C F4 BD DE                     	PEA		msgRegs
   7751 00C51F 20 D3 CB                     	JSR		DisplayString
   7752 00C522 20 CB CC                     	JSR		space
                                           
   7754 00C525 A5 BE                        	LDA		WorkTR
   7755 00C527 0A                           	ASL
   7756 00C528 0A                           	ASL
   7757 00C529 0A                           	ASL
   7758 00C52A 0A                           	ASL
   7759 00C52B AA                           	TAX
                                           
   7761 00C52C A0 00 00                     	LDY		#0
   7762 00C52F                             .0001:
   7763 00C52F 42 4A                        	INF
   7764 00C531 E8                           	INX
   7765 00C532 99 80 00                     	STA		reg_cs,Y
   7766 00C535 42 EB                        	XBAW
   7767 00C537 99 82 00                     	STA		reg_cs+2,Y
   7768 00C53A 42 C8                        	INY4
   7769 00C53C C0 30 00                     	CPY		#48
   7770 00C53F D0 EE                        	BNE		.0001
                                           
                                           	; Display CS
   7773 00C541 A5 80                        	LDA		reg_cs
   7774 00C543 20 A4 CC                     	JSR		DispWord
   7775 00C546 A9 3A 00                     	LDA		#':'
   7776 00C549 20 C4 CB                     	JSR		OutChar
                                           
                                           	; Display PB PC
   7779 00C54C A5 8E                        	LDA		reg_pc+2
   7780 00C54E 20 A9 CC                     	JSR		DispByte
   7781 00C551 A5 8C                        	LDA		reg_pc
   7782 00C553 20 A4 CC                     	JSR		DispWord
   7783 00C556 20 CB CC                     	JSR		space
                                           
                                           	; Display SRX,SR
   7786 00C559 A5 A0                        	LDA		reg_cs+32
   7787 00C55B A2 10 00                     	LDX		#16
   7788 00C55E                             .0003:
   7789 00C55E 0A                           	ASL
   7790 00C55F 48                           	PHA
   7791 00C560 A9 30 00                     	LDA		#'0'
   7792 00C563 69 00 00                     	ADC		#0
   7793 00C566 20 B2 CC                     	JSR		DispNybble
   7794 00C569 68                           	PLA
   7795 00C56A CA                           	DEX
   7796 00C56B D0 F1                        	BNE		.0003
   7797 00C56D 20 CB CC                     	JSR		space
                                           
   7799 00C570 A2 10 00                     	LDX		#16
   7800 00C573                             .0002
                                           	; display Acc,.X,.Y,.SP
   7802 00C573 B5 82                        	LDA		reg_cs+2,X
   7803 00C575 20 A4 CC                     	JSR		DispWord
   7804 00C578 B5 80                        	LDA		reg_cs,X
   7805 00C57A 20 A4 CC                     	JSR		DispWord
   7806 00C57D 20 CB CC                     	JSR		space
   7807 00C580 42 E8                        	INX4
   7808 00C582 E0 20 00                     	CPX		#32
   7809 00C585 D0 EC                        	BNE		.0002
                                           
   7811 00C587 F4 01 00                     	PEA		1
   7812 00C58A F4 19 DF                     	PEA		msgRegs2
   7813 00C58D 20 D3 CB                     	JSR		DisplayString
   7814 00C590 20 CB CC                     	JSR		space
                                           
                                           	; Display SS
   7817 00C593 A5 88                        	LDA		reg_ss
   7818 00C595 20 A4 CC                     	JSR		DispWord
   7819 00C598 20 CB CC                     	JSR		space
                                           
                                           	; Display DS
   7822 00C59B A5 84                        	LDA		reg_ds
   7823 00C59D 20 A4 CC                     	JSR		DispWord
   7824 00C5A0 20 CB CC                     	JSR		space
                                           
                                           	; Display DB
   7827 00C5A3 A5 A4                        	LDA		reg_db
   7828 00C5A5 20 A9 CC                     	JSR		DispByte
   7829 00C5A8 20 CB CC                     	JSR		space
                                           
                                           	; Display DPR
   7832 00C5AB A5 A8                        	LDA		reg_dp
   7833 00C5AD 20 A4 CC                     	JSR		DispWord
   7834 00C5B0 20 CB CC                     	JSR		space
                                           
                                           	; Display back link
   7837 00C5B3 A5 AC                        	LDA		reg_bl
   7838 00C5B5 20 A4 CC                     	JSR		DispWord
                                           
                                           	; Display map number
   7841 00C5B8 20 CB CC                     	JSR		space
   7842 00C5BB A5 B0                        	LDA		reg_mp
   7843 00C5BD 20 A9 CC                     	JSR		DispByte
                                           
   7845 00C5C0 20 BB CB                     	JSR		OutCRLF
   7846 00C5C3 60                           	RTS
                                           
                                           ; Build a startup record from the register values so that a context reg
                                           ; may be loaded
                                           
   7851 00C5C4                             BuildRec:
   7852 00C5C4 A5 80                        	LDA		reg_cs
   7853 00C5C6 8D 00 01                     	STA		ldtrec
   7854 00C5C9 A5 84                        	LDA		reg_ds
   7855 00C5CB 8D 02 01                     	STA		ldtrec+2
   7856 00C5CE A5 88                        	LDA		reg_ss
   7857 00C5D0 8D 04 01                     	STA		ldtrec+4
   7858 00C5D3 A5 8C                        	LDA		reg_pc
   7859 00C5D5 8D 06 01                     	STA		ldtrec+6
   7860 00C5D8 A5 8E                        	LDA		reg_pc+2
   7861 00C5DA 29 FF 00                     	AND		#$FF
   7862 00C5DD E2 30                        	SEP		#$30		; 8 bit regs
                                           	MEM		8
   7864 00C5DF EB                           	XBA
   7865 00C5E0 A5 90                        	LDA		reg_a
   7866 00C5E2 EB                           	XBA
   7867 00C5E3 C2 30                        	REP		#$30
                                           	MEM		16
   7869 00C5E5 8D 08 01                     	STA		ldtrec+8
   7870 00C5E8 A5 91                        	LDA		reg_a+1
   7871 00C5EA 8D 0A 01                     	STA		ldtrec+10
   7872 00C5ED A5 93                        	LDA		reg_a+3
   7873 00C5EF 8D 0C 01                     	STA		ldtrec+12
   7874 00C5F2 A5 95                        	LDA		reg_x+1
   7875 00C5F4 8D 0E 01                     	STA		ldtrec+14
   7876 00C5F7 A5 97                        	LDA		reg_x+3
   7877 00C5F9 8D 10 01                     	STA		ldtrec+16
   7878 00C5FC A5 99                        	LDA		reg_y+1
   7879 00C5FE 8D 12 01                     	STA		ldtrec+18
   7880 00C601 A5 9B                        	LDA		reg_y+3
   7881 00C603 8D 14 01                     	STA		ldtrec+20
   7882 00C606 A5 9D                        	LDA		reg_sp+1
   7883 00C608 8D 16 01                     	STA		ldtrec+22
   7884 00C60B A5 9F                        	LDA		reg_sp+3
   7885 00C60D 8D 18 01                     	STA		ldtrec+24
   7886 00C610 E2 30                        	SEP		#$30
   7887 00C612 A5 A1                        	LDA		reg_sr+1
   7888 00C614 8D 1A 01                     	STA		ldtrec+26
   7889 00C617 A5 A4                        	LDA		reg_db
   7890 00C619 8D 1B 01                     	STA		ldtrec+27
   7891 00C61C A5 A8                        	LDA		reg_dp
   7892 00C61E 8D 1C 01                     	STA		ldtrec+28
   7893 00C621 A5 A9                        	LDA		reg_dp+1
   7894 00C623 8D 1D 01                     	STA		ldtrec+29
   7895 00C626 A5 B0                        	LDA		reg_mp
   7896 00C628 8D 1E 01                     	STA		ldtrec+30
   7897 00C62B 9C 1F 01                     	STZ		ldtrec+31
   7898 00C62E C2 30                        	REP		#$30
   7899 00C630 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Dump memory.
                                           ;------------------------------------------------------------------------------
                                           
   7905 00C631                             doMemoryDump:
   7906 00C631 20 EE C7                     	JSR		IgnoreBlanks
   7907 00C634 20 D4 CC                     	JSR		GetRange
   7908 00C637 20 BB CB                     	JSR		OutCRLF
   7909 00C63A                             .0007:
   7910 00C63A A9 3E 00                     	LDA		#'>'
   7911 00C63D 20 C4 CB                     	JSR		OutChar
   7912 00C640 20 DE C7                     	JSR		DispRangeStart
   7913 00C643 A0 00 00                     	LDY		#0
   7914 00C646                             .0001:
   7915 00C646 42 B7 20                     	LDA		{RangeStart},Y
   7916 00C649 20 A9 CC                     	JSR		DispByte
   7917 00C64C A9 20 00                     	LDA		#' '
   7918 00C64F 20 C4 CB                     	JSR		OutChar
   7919 00C652 C8                           	INY
   7920 00C653 C0 08 00                     	CPY		#8
   7921 00C656 D0 EE                        	BNE		.0001
   7922 00C658 A0 00 00                     	LDY 	#0
   7923 00C65B                             .0005:
   7924 00C65B 42 B7 20                     	LDA		{RangeStart},Y
   7925 00C65E 29 FF 00                     	AND		#$FF
   7926 00C661 C9 20 00                     	CMP		#' '
   7927 00C664 B0 05                        	BCS		.0002
   7928 00C666                             .0004:
   7929 00C666 A9 2E 00                     	LDA		#'.'
   7930 00C669 80 05                        	BRA		.0003
   7931 00C66B                             .0002:
   7932 00C66B C9 7F 00                     	CMP		#$7f
   7933 00C66E B0 F6                        	BCS		.0004
   7934 00C670                             .0003:
   7935 00C670 20 C4 CB                     	JSR		OutChar
   7936 00C673 C8                           	INY
   7937 00C674 C0 08 00                     	CPY		#8
   7938 00C677 D0 E2                        	BNE		.0005
   7939 00C679 20 BB CB                     	JSR		OutCRLF
   7940 00C67C 18                           	CLC
   7941 00C67D A5 20                        	LDA		RangeStart
   7942 00C67F 69 08 00                     	ADC		#8
   7943 00C682 85 20                        	STA		RangeStart
   7944 00C684 90 02                        	BCC		.0006
   7945 00C686 E6 22                        	INC		RangeStart+2
   7946 00C688                             .0006:
   7947 00C688 38                           	SEC
   7948 00C689 A5 24                        	LDA		RangeEnd
   7949 00C68B E5 20                        	SBC		RangeStart
   7950 00C68D A5 26                        	LDA		RangeEnd+2
   7951 00C68F E5 22                        	SBC		RangeStart+2
   7952 00C691 08                           	PHP
   7953 00C692 20 1E CF                     	JSR		KeybdGetCharNoWait;Ctx,7
   7954 00C695 29 FF 00                     	AND		#$FF
   7955 00C698 C9 03 00                     	CMP		#CTRLC
   7956 00C69B F0 04                        	BEQ		.0009
   7957 00C69D 28                           	PLP
   7958 00C69E 10 9A                        	BPL		.0007
   7959 00C6A0                             .0008:
   7960 00C6A0 60                           	RTS
   7961 00C6A1                             .0009:
   7962 00C6A1 28                           	PLP
   7963 00C6A2 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Edit memory.
                                           ; ><memory address> <val1> <val2> ... <val8>
                                           ;------------------------------------------------------------------------------
                                           
   7970 00C6A3                             doMemoryEdit:
   7971 00C6A3 20 EE C7                     	JSR		IgnoreBlanks
   7972 00C6A6 20 FF CC                     	JSR		GetHexNumber
   7973 00C6A9 C0 00 00                     	CPY		#0
   7974 00C6AC F0 FF EA FA                  	LBEQ	Mon1
   7975 00C6B0 A5 0C                        	LDA		NumWorkArea
   7976 00C6B2 85 20                        	STA		RangeStart
   7977 00C6B4 A5 0E                        	LDA		NumWorkArea+2
   7978 00C6B6 85 22                        	STA		RangeStart+2
   7979 00C6B8 A0 00 00                     	LDY		#0
   7980 00C6BB                             .0001:
   7981 00C6BB 5A                           	PHY
   7982 00C6BC 20 EE C7                     	JSR		IgnoreBlanks
   7983 00C6BF 20 FF CC                     	JSR		GetHexNumber
   7984 00C6C2 C0 00 00                     	CPY		#0
   7985 00C6C5 F0 13                        	BEQ		.0002
   7986 00C6C7 7A                           	PLY
   7987 00C6C8 E2 20                        	SEP		#$20
   7988 00C6CA A5 0C                        	LDA		NumWorkArea
   7989 00C6CC 42 97 20                     	STA		{RangeStart},Y
   7990 00C6CF C2 20                        	REP		#$20
   7991 00C6D1 C8                           	INY
   7992 00C6D2 C0 08 00                     	CPY		#8
   7993 00C6D5 D0 E4                        	BNE		.0001
   7994 00C6D7 82 C0 FA                     	BRL		Mon1
   7995 00C6DA                             .0002:
   7996 00C6DA 7A                           	PLY
   7997 00C6DB 82 BC FA                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Fill memory.
                                           ; $F <start address> <end address> <val1>
                                           ;------------------------------------------------------------------------------
                                           
   8004 00C6DE                             doFill:
   8005 00C6DE 20 EE C7                     	JSR		IgnoreBlanks
   8006 00C6E1 20 FF CC                     	JSR		GetHexNumber
   8007 00C6E4 C0 00 00                     	CPY		#0
   8008 00C6E7 F0 FF 88 FB                  	LBEQ	MonErr
   8009 00C6EB A5 0C                        	LDA		NumWorkArea
   8010 00C6ED 85 20                        	STA		RangeStart
   8011 00C6EF A5 0E                        	LDA		NumWorkArea+2
   8012 00C6F1 85 22                        	STA		RangeStart+2
   8013 00C6F3 20 EE C7                     	JSR		IgnoreBlanks
   8014 00C6F6 20 FF CC                     	JSR		GetHexNumber
   8015 00C6F9 C0 00 00                     	CPY		#0
   8016 00C6FC F0 FF 73 FB                  	LBEQ	MonErr
   8017 00C700 A5 0C                        	LDA		NumWorkArea
   8018 00C702 85 24                        	STA		RangeEnd
   8019 00C704 A5 0E                        	LDA		NumWorkArea+2
   8020 00C706 85 26                        	STA		RangeEnd+2
   8021 00C708 20 EE C7                     	JSR		IgnoreBlanks
   8022 00C70B 20 FF CC                     	JSR		GetHexNumber
   8023 00C70E C0 00 00                     	CPY		#0
   8024 00C711 F0 FF 5E FB                  	LBEQ	MonErr
   8025 00C715 A6 0C                        	LDX		NumWorkArea
                                           	; Process in 32 bit mode
   8027 00C717 42 E2 00 02                  	SEP		#$200
   8028 00C71B 42 C2 00 01                  	REP		#$100
   8029 00C71F A5 24                        	LDA		RangeEnd
   8030 00C721 38                           	SEC
   8031 00C722 E5 20                        	SBC		RangeStart
   8032 00C724 A4 20                        	LDY		RangeStart
   8033 00C726 42 44 00                     	FIL		$00
                                           	; Back to 16 bits mode
   8035 00C729 42 C2 00 02                  	REP		#$200
   8036 00C72D 42 E2 00 01                  	SEP		#$100
   8037 00C731 82 66 FA                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Disassemble code
                                           ;------------------------------------------------------------------------------
                                           
   8043 00C734                             doDisassemble:
   8044 00C734 20 62 C2                     	JSR		MonGetch
   8045 00C737 C9 4D 00                     	CMP		#'M'
   8046 00C73A F0 11                        	BEQ		.0002
   8047 00C73C                             .0004:
   8048 00C73C C9 4E 00                     	CMP		#'N'
   8049 00C73F D0 1B                        	BNE		.0003
   8050 00C741 E2 20                        	SEP		#$20
                                           	MEM		8
   8052 00C743 A5 BC                        	LDA		$BC
   8053 00C745 09 40                        	ORA		#$40
   8054 00C747 85 BC                        	STA		$BC
   8055 00C749 C2 20                        	REP		#$20
   8056 00C74B 80 11                        	BRA		.0005
   8057 00C74D                             .0002:
   8058 00C74D E2 20                        	SEP		#$20
   8059 00C74F A5 BC                        	LDA		$BC
   8060 00C751 09 80                        	ORA		#$80
   8061 00C753 85 BC                        	STA		$BC
   8062 00C755 C2 20                        	REP		#$20
   8063 00C757 20 62 C2                     	JSR		MonGetch
   8064 00C75A 80 E0                        	BRA		.0004
                                           	MEM		16
   8066 00C75C                             .0003:
   8067 00C75C CA                           	DEX
   8068 00C75D CA                           	DEX
   8069 00C75E                             .0005:
   8070 00C75E 20 EE C7                     	JSR		IgnoreBlanks
   8071 00C761 20 D4 CC                     	JSR		GetRange
   8072 00C764 A5 20                        	LDA		RangeStart
   8073 00C766 85 8F                        	STA		$8F				; addra
   8074 00C768 A5 21                        	LDA		RangeStart+1
   8075 00C76A 85 90                        	STA		$90
   8076 00C76C 20 BB CB                     	JSR		OutCRLF
   8077 00C76F A0 14 00                     	LDY		#20
   8078 00C772                             .0001:
   8079 00C772 5A                           	PHY
   8080 00C773 E2 30                        	SEP		#$30
   8081 00C775 20 59 86                     	JSR		dpycod
   8082 00C778 C2 30                        	REP		#$30
   8083 00C77A 20 BB CB                     	JSR		OutCRLF
   8084 00C77D 7A                           	PLY
   8085 00C77E 88                           	DEY
   8086 00C77F D0 F1                        	BNE		.0001
   8087 00C781 4C 9A C1                     	JMP		Mon1
                                           
                                           ;$BC flimflag
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Jump to subroutine
                                           ;
                                           ; Either JSR for 16 bit address or JSL for 24 bit address
                                           ;------------------------------------------------------------------------------
                                           
   8097 00C784                             doJump:
   8098 00C784 20 62 C2                     	JSR		MonGetch
   8099 00C787 C9 53 00                     	CMP		#'S'
   8100 00C78A D0 FF 0C FA                  	LBNE	Mon1
   8101 00C78E 20 62 C2                     	JSR		MonGetch
   8102 00C791 C9 52 00                     	CMP		#'R'
   8103 00C794 D0 1A                        	BNE		.testL
   8104 00C796 20 EE C7                     	JSR		IgnoreBlanks
   8105 00C799 20 FF CC                     	JSR		GetHexNumber
   8106 00C79C C0 00 00                     	CPY		#0
   8107 00C79F F0 FF F7 F9                  	LBEQ	Mon1
   8108 00C7A3 A5 0C                        	LDA		NumWorkArea
   8109 00C7A5 85 24                        	STA		RangeEnd
   8110 00C7A7 A2 00 00                     	LDX		#0
   8111 00C7AA FC 24 00                     	JSR		(RangeEnd,X)
   8112 00C7AD 82 EA F9                     	BRL		Mon1
   8113 00C7B0                             .testL:
   8114 00C7B0 C9 4C 00                     	CMP		#'L'
   8115 00C7B3 D0 FF E3 F9                  	LBNE	Mon1
   8116 00C7B7 20 EE C7                     	JSR		IgnoreBlanks
   8117 00C7BA 20 FF CC                     	JSR		GetHexNumber
   8118 00C7BD C0 00 00                     	CPY		#0
   8119 00C7C0 F0 FF D6 F9                  	LBEQ	Mon1
   8120 00C7C4 A9 5C 00                     	LDA		#$5C			; JML opcode
   8121 00C7C7 85 23                        	STA		RangeEnd-1
   8122 00C7C9 A5 0C                        	LDA		NumWorkArea
   8123 00C7CB 85 24                        	STA		RangeEnd
   8124 00C7CD A5 0D                        	LDA		NumWorkArea+1
   8125 00C7CF 85 25                        	STA		RangeEnd+1
   8126 00C7D1 A9 24 00                     	LDA		#RangeEnd
   8127 00C7D4 42 E0 01                     	CACHE	#1				; 1= invalidate instruction line identified by accumulator
   8128 00C7D7 22 24 00 00                  	JSL		RangeEnd
   8129 00C7DB 82 BC F9                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   8133 00C7DE                             DispRangeStart:
   8134 00C7DE A5 21                        	LDA		RangeStart+1
   8135 00C7E0 20 A4 CC                     	JSR		DispWord
   8136 00C7E3 A5 20                        	LDA		RangeStart
   8137 00C7E5 20 A9 CC                     	JSR		DispByte
   8138 00C7E8 A9 20 00                     	LDA		#' '
   8139 00C7EB 4C C4 CB                     	JMP		OutChar
                                           	
                                           ; Skip over blanks in the input
                                           ;------------------------------------------------------------------------------
                                           
   8144 00C7EE                             IgnoreBlanks:
   8145 00C7EE                             .0001:
   8146 00C7EE 20 62 C2                     	JSR		MonGetch
   8147 00C7F1 C9 20 00                     	CMP		#' '
   8148 00C7F4 F0 F8                        	BEQ		.0001
   8149 00C7F6 CA                           	DEX
   8150 00C7F7 CA                           	DEX
   8151 00C7F8 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; BIOSInput allows full screen editing of text until a carriage return is keyed
                                           ; at which point the line the cursor is on is copied to a buffer. The buffer
                                           ; must be at least TEXTCOLS characters in size.
                                           ;------------------------------------------------------------------------------
                                           ;
   8159 00C7F9                             BIOSInput:
   8160 00C7F9                             .bin1:
   8161 00C7F9 20 38 CF                     	JSR		KeybdGetCharWait
   8162 00C7FC 29 FF 00                     	AND		#$FF
   8163 00C7FF C9 0D 00                     	CMP		#CR
   8164 00C802 F0 05                        	BEQ		.bin2
   8165 00C804 20 C4 CB                     	JSR		OutChar
   8166 00C807 80 F0                        	BRA		.bin1
   8167 00C809                             .bin2:
   8168 00C809 A5 30                        	LDA		CursorX
   8169 00C80B F0 1E                        	BEQ		.bin4
   8170 00C80D A5 34                        	LDA		VideoPos	; get current video position
   8171 00C80F 38                           	SEC
   8172 00C810 E5 30                        	SBC		CursorX		; go back to the start of the line
   8173 00C812 0A                           	ASL
   8174 00C813 AA                           	TAX
   8175 00C814                             .bin3:
   8176 00C814 42 3B FF 0F BF 00 00 0D      	LDA		$FFF:VIDBUF,X
                                         
   8177 00C81C 29 FF 00                     	AND		#$FF
   8178 00C81F 93 03                        	STA		(3,s),Y
   8179 00C821 E8                           	INX
   8180 00C822 E8                           	INX
   8181 00C823 C8                           	INY
   8182 00C824 C6 30                        	DEC		CursorX
   8183 00C826 D0 EC                        	BNE		.bin3
   8184 00C828 A9 00 00                     	LDA		#0
   8185 00C82B                             .bin4:
   8186 00C82B 93 03                        	STA		(3,s),Y	; NULL terminate buffer
   8187 00C82D 60                           	RTS
                                           
   8189 00C82E                             .st0003:
   8190 00C82E 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD
                                         
   8191 00C836 10 F6                        	BPL		.st0003
   8192 00C838 48                           	PHA						; save off the char (we need to trash acc)
   8193 00C839 42 3B FF 0F AF 14 A1 0E      	LDA		$FFF:KEYBD+4	; clear keyboard strobe (must be a read operation)
                                         
   8194 00C841 68                           	PLA						; restore char
   8195 00C842 20 D2 C9                     	JSR		DisplayChar
   8196 00C845 80 E7                        	BRA		.st0003
   8197 00C847 A0 00 00                     	ldy		#$0000
   8198 00C84A                             .st0001:
   8199 00C84A A2 00 00                     	ldx		#$0000
   8200 00C84D                             .st0002:
   8201 00C84D E8                           	inx
   8202 00C84E D0 FD                        	bne		.st0002
   8203 00C850 20 73 C8                     	jsr		echo_switch
   8204 00C853 C8                           	iny
   8205 00C854 80 F4                        	bra		.st0001
                                           
   8207 00C856                             msgStarting:
   8208 00C856 46 54 38 33 32 20 54 65      	.byte	"FT832 Test System Starting",CR,LF,0
   8208 00C85E 73 74 20 53 79 73 74 65    
   8208 00C866 6D 20 53 74 61 72 74 69    
   8208 00C86E 6E 67 0D 0A 00             
                                           
   8210 00C873                             echo_switch:
   8211 00C873 AD 00 71                     	lda		$7100
   8212 00C876 8D 00 70                     	sta		$7000
   8213 00C879 60                           	rts
                                           
                                           ;------------------------------------------------------------------------------
                                           ; On entry to the SSM task the .A register will be set to the task number
                                           ; being single stepped. The .X register will contain the address of the
                                           ; next instruction to execute.
                                           ;------------------------------------------------------------------------------
                                           
   8221 00C87A                             SSMInit:
                                           	; setup SSM data segment in SDT
   8223 00C87A A0 06 00                     	LDY		#6
   8224 00C87D A9 01 00                     	LDA		#1
   8225 00C880 42 EB                        	XBAW
   8226 00C882 A9 00 00                     	LDA		#$0000
   8227 00C885 A2 82 08                     	LDX		#$882		; 1k data
   8228 00C888 42 BA                        	SDU
                                           	; Setup SSM stack segment in SDT
   8230 00C88A C8                           	INY
   8231 00C88B A9 00 04                     	LDA		#$0400
   8232 00C88E A2 82 08                     	LDX		#$882		; 1k stack
   8233 00C891 42 BA                        	SDU
                                           	; Setup SSM code segment in SDT
   8235 00C893 C8                           	INY
   8236 00C894 A9 00 00                     	LDA		#$0000
   8237 00C897 42 EB                        	XBAW
   8238 00C899 A9 00 00                     	LDA		#$0000
   8239 00C89C A2 05 09                     	LDX		#$905
   8240 00C89F 42 BA                        	SDU
   8241 00C8A1 42 5C A8 C8 00 08 00         	JMF		8:.0001
   8242 00C8A8                             .0001:
                                           	; Initialize data selector and stack selector, pointer
                                           	; The stack is begin switched from the one currently defined by
                                           	; by the task table. So the return task needs to be popped off
                                           	; the current stack and placed on the new one.
   8247 00C8A8 FA                           	PLX					; get the task to return to
   8248 00C8A9 A9 07 00                     	LDA		#7
   8249 00C8AC 78                           	SEI
   8250 00C8AD 42 5A                        	TASS
   8251 00C8AF A9 FF 03                     	LDA		#$3FF		; setup stack pointer
   8252 00C8B2 1B                           	TAS
   8253 00C8B3 58                           	CLI
   8254 00C8B4 DA                           	PHX					; save return task on new stack
   8255 00C8B5 F4 06 00                     	PEA		6
   8256 00C8B8 42 2B                        	PLDS
                                           
   8258 00C8BA A9 00 61                     	LDA		#$6100
   8259 00C8BD 85 36                        	STA		NormAttr
   8260 00C8BF A9 FF 0F                     	LDA		#4095		; set segment
   8261 00C8C2 85 44                        	STA		Vidptr+4
   8262 00C8C4 85 4A                        	STA		Vidregs+4
   8263 00C8C6 A9 0B 00                     	LDA		#$000B		; screen location is $FB0000
   8264 00C8C9 85 42                        	STA		Vidptr+2
   8265 00C8CB 64 40                        	STZ		Vidptr
   8266 00C8CD A9 0E 00                     	LDA		#$000E		; regset is at $FEA010
   8267 00C8D0 85 48                        	STA		Vidregs+2
   8268 00C8D2 A9 10 A0                     	LDA		#$A010
   8269 00C8D5 85 46                        	STA		Vidregs
   8270 00C8D7 A0 07 00                     	LDY		#7
   8271 00C8DA A9 10 00                     	LDA		#$10		; divide by 2 vertically, 1 horizontally
   8272 00C8DD 20 1D CC                     	JSR		SetVideoReg
   8273 00C8E0 A9 B4 00                     	LDA		#180		; set window left position 672
   8274 00C8E3 A0 02 00                     	LDY		#2
   8275 00C8E6 20 1D CC                     	JSR		SetVideoReg
   8276 00C8E9 A9 02 00                     	LDA		#2
   8277 00C8EC A0 03 00                     	LDY		#3
   8278 00C8EF 20 1D CC                     	JSR		SetVideoReg
   8279 00C8F2 A9 20 00                     	LDA		#32			; set window top position
   8280 00C8F5 A0 04 00                     	LDY		#4
   8281 00C8F8 20 1D CC                     	JSR		SetVideoReg
   8282 00C8FB 20 02 CC                     	JSR		GetTextRowsCols
   8283 00C8FE A9 D2 C9                     	LDA		#DisplayChar
   8284 00C901 8D F0 03                     	STA		OutputVec
   8285 00C904 20 47 CC                     	JSR		ClearScreen
   8286 00C907 20 97 CB                     	JSR		HomeCursor
   8287 00C90A F4 08 00                     	PEA		8
   8288 00C90D F4 88 C9                     	PEA		msgSSM
   8289 00C910 20 D3 CB                     	JSR		DisplayString
   8290 00C913 42 60                        	RTT
   8291 00C915                             SSMTask:
   8292 00C915 85 BE                        	STA		WorkTR
   8293 00C917 20 19 C5                     	JSR		DispRegs
   8294 00C91A                             .0004:
   8295 00C91A A9 53 00                     	LDA		#'S'
   8296 00C91D 20 C4 CB                     	JSR		OutChar
   8297 00C920 A9 53 00                     	LDA		#'S'
   8298 00C923 20 C4 CB                     	JSR		OutChar
   8299 00C926 A9 4D 00                     	LDA		#'M'
   8300 00C929 20 C4 CB                     	JSR		OutChar
   8301 00C92C A9 3E 00                     	LDA		#'>'
   8302 00C92F                             .0005:
   8303 00C92F 20 C4 CB                     	JSR		OutChar
   8304 00C932                             .0008:
   8305 00C932 20 38 CF                     	JSR		KeybdGetCharWait
   8306 00C935 B0 FB                        	BCS		.0008
   8307 00C937 29 FF 00                     	AND		#$FF
   8308 00C93A C9 53 00                     	CMP		#'S'		; step
   8309 00C93D D0 04                        	BNE		.0001
   8310 00C93F                             .0002:
   8311 00C93F 42 60                        	RTT
   8312 00C941 80 D2                        	BRA		SSMTask
   8313 00C943                             .0001:
   8314 00C943 C9 58 00                     	CMP		#'X'
   8315 00C946 D0 16                        	BNE		.0006
   8316 00C948 A5 A0                        	LDA		reg_sr
   8317 00C94A 29 FF EF                     	AND		#$EFFF
   8318 00C94D 85 A0                        	STA		reg_sr
   8319 00C94F 20 C4 C5                     	JSR		BuildRec
   8320 00C952 A6 BE                        	LDX		WorkTR
   8321 00C954 42 6C 00 01 00 00            	LDT		ldtrec
   8322 00C95A 42 60                        	RTT
   8323 00C95C 80 B7                        	BRA		SSMTask
   8324 00C95E                             .0006:
   8325 00C95E C9 0D 00                     	CMP		#CR
   8326 00C961 D0 CC                        	BNE		.0005
   8327 00C963 A5 32                        	LDA		CursorY
   8328 00C965 0A                           	ASL
   8329 00C966 AA                           	TAX
   8330 00C967 42 1B BD 3F DD               	LDA		CS:LineTbl,X
   8331 00C96C 18                           	CLC
   8332 00C96D 69 04 00                     	ADC		#4
   8333 00C970 0A                           	ASL
   8334 00C971 AA                           	TAX
   8335 00C972 20 EE C7                     	JSR		IgnoreBlanks
   8336 00C975 20 62 C2                     	JSR		MonGetch
   8337 00C978 C9 4D 00                     	CMP		#'M'
   8338 00C97B D0 03                        	BNE		.0007
   8339 00C97D 20 31 C6                     	JSR		doMemoryDump
   8340 00C980                             .0007:
   8341 00C980 82 AC FF                     	BRL		.0005
   8342 00C983 42 60                        	RTT
   8343 00C985 82 8D FF                     	BRL		SSMTask
                                           
   8345 00C988                             msgSSM:
   8346 00C988 53 69 6E 67 6C 65 20 73      	.byte	"Single step mode task starting.",CR,LF,0
   8346 00C990 74 65 70 20 6D 6F 64 65    
   8346 00C998 20 74 61 73 6B 20 73 74    
   8346 00C9A0 61 72 74 69 6E 67 2E 0D    
   8346 00C9A8 0A 00                      
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Convert Ascii character to screen character.
                                           ;------------------------------------------------------------------------------
                                           
   8352 00C9AA                             AsciiToScreen:
   8353 00C9AA 29 FF 00                     	AND		#$FF
   8354 00C9AD 89 20 00                     	BIT		#%00100000	; if bit 5 isn't set
   8355 00C9B0 F0 08                        	BEQ		.00001
   8356 00C9B2 89 40 00                     	BIT		#%01000000	; or bit 6 isn't set
   8357 00C9B5 F0 03                        	BEQ		.00001
   8358 00C9B7 29 9F 00                     	AND		#%10011111
   8359 00C9BA                             .00001:
   8360 00C9BA 60                           	rts
                                           
                                           	MEM		8
   8363 00C9BB                             AsciiToScreen8:
   8364 00C9BB 89 20                        	BIT		#%00100000	; if bit 5 isn't set
   8365 00C9BD F0 06                        	BEQ		.00001
   8366 00C9BF 89 40                        	BIT		#%01000000	; or bit 6 isn't set
   8367 00C9C1 F0 02                        	BEQ		.00001
   8368 00C9C3 29 9F                        	AND		#%10011111
   8369 00C9C5                             .00001:
   8370 00C9C5 60                           	rts
                                           
                                           	MEM		16
                                           ;------------------------------------------------------------------------------
                                           ; Convert screen character to ascii character
                                           ;------------------------------------------------------------------------------
                                           ;
   8377 00C9C6                             ScreenToAscii:
   8378 00C9C6 29 FF 00                     	AND		#$FF
   8379 00C9C9 C9 1B 00                     	CMP		#26+1
   8380 00C9CC B0 03                        	BCS		.0001
   8381 00C9CE 69 60 00                     	ADC		#$60
   8382 00C9D1                             .0001:
   8383 00C9D1 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Display a character on the screen device
                                           ; Expects the processor to be in 16 bit mode with 16 bit acc and 16 bit indexes
                                           ;------------------------------------------------------------------------------
                                           ;
   8390 00C9D2                             DisplayChar:
   8391 00C9D2 29 FF 00                     	AND		#$0FF
   8392 00C9D5 24 3C                        	BIT		EscState		; check if processing escape sequence
   8393 00C9D7 30 FF 89 00                  	LBMI	processEsc
   8394 00C9DB C9 08 00                     	CMP		#BS
   8395 00C9DE F0 FF 33 01                  	LBEQ	doBackSpace
   8396 00C9E2 C9 91 00                     	CMP		#$91			; cursor right
   8397 00C9E5 F0 FF 89 01                  	LBEQ	doCursorRight
   8398 00C9E9 C9 93 00                     	CMP		#$93			; cursor left
   8399 00C9EC F0 FF 8D 01                  	LBEQ	doCursorLeft
   8400 00C9F0 C9 90 00                     	CMP		#$90			; cursor up
   8401 00C9F3 F0 FF 8D 01                  	LBEQ	doCursorUp
   8402 00C9F7 C9 92 00                     	CMP		#$92			; cursor down
   8403 00C9FA F0 FF 8D 01                  	LBEQ	doCursorDown
   8404 00C9FE C9 99 00                     	CMP		#$99			; delete
   8405 00CA01 F0 FF 3B 01                  	LBEQ	doDelete
   8406 00CA05 C9 0D 00                     	CMP		#CR
   8407 00CA08 F0 47                        	BEQ		doCR
   8408 00CA0A C9 0A 00                     	CMP		#LF
   8409 00CA0D F0 47                        	BEQ		doLF
   8410 00CA0F C9 94 00                     	CMP		#$94
   8411 00CA12 F0 FF 54 01                  	LBEQ	doCursorHome	; cursor home
   8412 00CA16 C9 1B 00                     	CMP		#ESC
   8413 00CA19 D0 05                        	BNE		.0003
   8414 00CA1B 64 3C                        	STZ		EscState		; put a -1 in the escape state
   8415 00CA1D C6 3C                        	DEC		EscState
   8416 00CA1F 60                           	RTS
   8417 00CA20                             .0003:
   8418 00CA20 20 AA C9                     	JSR		AsciiToScreen
   8419 00CA23 05 36                        	ORA		NormAttr
   8420 00CA25 48                           	PHA
   8421 00CA26 A5 34                        	LDA		VideoPos
   8422 00CA28 0A                           	ASL
   8423 00CA29 A8                           	TAY
   8424 00CA2A 68                           	PLA
   8425 00CA2B 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8426 00CA30 A5 30                        	LDA		CursorX
   8427 00CA32 1A                           	INA
   8428 00CA33 C5 4C                        	CMP		Textcols
   8429 00CA35 D0 15                        	BNE		.0001
   8430 00CA37 64 30                        	STZ		CursorX
   8431 00CA39 A5 32                        	LDA		CursorY
   8432 00CA3B 1A                           	INA
   8433 00CA3C C5 4E                        	CMP		Textrows
   8434 00CA3E F0 05                        	BEQ		.0002
   8435 00CA40 85 32                        	STA		CursorY
   8436 00CA42 82 59 01                     	BRL		SyncVideoPos
   8437 00CA45                             .0002:
   8438 00CA45 3A                           	DEA
   8439 00CA46 20 9E CB                     	JSR		SyncVideoPos
   8440 00CA49 82 14 02                     	BRL		ScrollUp
   8441 00CA4C                             .0001:
   8442 00CA4C 85 30                        	STA		CursorX
   8443 00CA4E 82 4D 01                     	BRL		SyncVideoPos
   8444 00CA51                             doCR:
   8445 00CA51 64 30                        	STZ		CursorX
   8446 00CA53 82 48 01                     	BRL		SyncVideoPos
   8447 00CA56                             doLF:
   8448 00CA56 A5 32                        	LDA		CursorY
   8449 00CA58 1A                           	INA
   8450 00CA59 C5 4E                        	CMP		Textrows
   8451 00CA5B 10 FF 01 02                  	LBPL	ScrollUp
   8452 00CA5F 85 32                        	STA		CursorY
   8453 00CA61 82 3A 01                     	BRL		SyncVideoPos
                                           
                                           ; Process escape sequences for WYSE terminal emulation
                                           ; Handles:
                                           ; {esc}T		- clear to end of line
                                           ; {esc}W		- delete character
                                           ; {esc}`1		- cursor on
                                           ; {esc}`0		- cursor off
                                           ; {esc}({esc}G4	- reverse video
                                           ; {esc}({esc}G0	- normal video
                                           ;
                                           ; EscState
                                           ; -1 = first esc char
                                           ; -2 = second esc char
                                           ; ...
                                           ;
   8469 00CA64                             processEsc:
   8470 00CA64 A6 3C                        	LDX		EscState
   8471 00CA66 E0 FF FF                     	CPX		#-1
   8472 00CA69 D0 45                        	BNE		.0006
   8473 00CA6B C9 54 00                     	CMP		#'T'	; clear to EOL
   8474 00CA6E D0 1D                        	BNE		.0003
   8475 00CA70 A5 34                        	LDA		VideoPos
   8476 00CA72 0A                           	ASL
   8477 00CA73 A8                           	TAY
   8478 00CA74 A6 30                        	LDX		CursorX
   8479 00CA76 E8                           	INX
   8480 00CA77                             .0001:
   8481 00CA77 E4 4C                        	CPX		Textcols
   8482 00CA79 10 0F                        	BPL		.0002
   8483 00CA7B A9 20 00                     	LDA		#' '
   8484 00CA7E 05 36                        	ORA		NormAttr
   8485 00CA80 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8486 00CA85 E8                           	INX
   8487 00CA86 C8                           	INY
   8488 00CA87 C8                           	INY
   8489 00CA88 D0 ED                        	BNE		.0001
   8490 00CA8A                             .0002:
   8491 00CA8A 64 3C                        	STZ		EscState
   8492 00CA8C 60                           	RTS
   8493 00CA8D                             .0003:
   8494 00CA8D C9 57 00                     	CMP		#'W'
   8495 00CA90 D0 05                        	BNE		.0004
   8496 00CA92 64 3C                        	STZ		EscState
   8497 00CA94 82 A9 00                     	BRL		doDelete
   8498 00CA97                             .0004:
   8499 00CA97 C9 60 00                     	CMP		#'`'
   8500 00CA9A D0 06                        	BNE		.0005
   8501 00CA9C A9 FE FF                     	LDA		#-2
   8502 00CA9F 85 3C                        	STA		EscState
   8503 00CAA1 60                           	RTS
   8504 00CAA2                             .0005:
   8505 00CAA2 C9 28 00                     	CMP		#'('
   8506 00CAA5 D0 06                        	BNE		.0008
   8507 00CAA7 A9 FD FF                     	LDA		#-3
   8508 00CAAA 85 3C                        	STA		EscState
   8509 00CAAC 60                           	RTS
   8510 00CAAD                             .0008:
   8511 00CAAD 64 3C                        	STZ		EscState
   8512 00CAAF 60                           	RTS
   8513 00CAB0                             .0006:
   8514 00CAB0 E0 FE FF                     	CPX		#-2
   8515 00CAB3 D0 11                        	BNE		.0007
   8516 00CAB5 64 3C                        	STZ		EscState
   8517 00CAB7 C9 31 00                     	CMP		#'1'
   8518 00CABA F0 FF 69 01                  	LBEQ	CursorOn
   8519 00CABE C9 30 00                     	CMP		#'0'
   8520 00CAC1 F0 FF 72 01                  	LBEQ	CursorOff
   8521 00CAC5 60                           	RTS
   8522 00CAC6                             .0007:
   8523 00CAC6 E0 FD FF                     	CPX		#-3
   8524 00CAC9 D0 0B                        	BNE		.0009
   8525 00CACB C9 1B 00                     	CMP		#ESC
   8526 00CACE D0 DD                        	BNE		.0008
   8527 00CAD0 A9 FC FF                     	LDA		#-4
   8528 00CAD3 85 3C                        	STA		EscState
   8529 00CAD5 60                           	RTS
   8530 00CAD6                             .0009:
   8531 00CAD6 E0 FC FF                     	CPX		#-4
   8532 00CAD9 D0 0B                        	BNE		.0010
   8533 00CADB C9 47 00                     	CMP		#'G'
   8534 00CADE D0 CD                        	BNE		.0008
   8535 00CAE0 A9 FB FF                     	LDA		#-5
   8536 00CAE3 85 3C                        	STA		EscState
   8537 00CAE5 60                           	RTS
   8538 00CAE6                             .0010:
   8539 00CAE6 E0 FB FF                     	CPX		#-5
   8540 00CAE9 D0 C2                        	BNE		.0008
   8541 00CAEB 64 3C                        	STZ		EscState
   8542 00CAED C9 34 00                     	CMP		#'4'
   8543 00CAF0 D0 12                        	BNE		.0011
   8544 00CAF2 A5 36                        	LDA		NormAttr
                                           	; Swap the high nybbles of the attribute
   8546 00CAF4 EB                           	XBA				
   8547 00CAF5 E2 30                        	SEP		#$30		; set 8 bit regs
                                           	NDX		8			; tell the assembler
                                           	MEM		8
   8550 00CAF7 2A                           	ROL
   8551 00CAF8 2A                           	ROL
   8552 00CAF9 2A                           	ROL
   8553 00CAFA 2A                           	ROL
   8554 00CAFB C2 30                        	REP		#$30		; set 16 bit regs
                                           	NDX		16			; tell the assembler
                                           	MEM		16
   8557 00CAFD EB                           	XBA
   8558 00CAFE 29 00 FF                     	AND		#$FF00
   8559 00CB01 85 36                        	STA		NormAttr
   8560 00CB03 60                           	RTS
   8561 00CB04                             .0011:
   8562 00CB04 C9 30 00                     	CMP		#'0'
   8563 00CB07 D0 06                        	BNE		.0012
   8564 00CB09 A9 00 BF                     	LDA		#$BF00		; Light Grey on Dark Grey
   8565 00CB0C 85 36                        	STA		NormAttr
   8566 00CB0E 60                           	RTS
   8567 00CB0F                             .0012:
   8568 00CB0F A9 00 BF                     	LDA		#$BF00		; Light Grey on Dark Grey
   8569 00CB12 85 36                        	STA		NormAttr
   8570 00CB14 60                           	RTS
                                           
   8572 00CB15                             doBackSpace:
   8573 00CB15 A6 30                        	LDX		CursorX
   8574 00CB17 F0 26                        	BEQ		.0001		; Can't backspace anymore
   8575 00CB19 A5 34                        	LDA		VideoPos
   8576 00CB1B 0A                           	ASL
   8577 00CB1C A8                           	TAY
   8578 00CB1D                             .0002:
   8579 00CB1D 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y
   8580 00CB22 88                           	DEY
   8581 00CB23 88                           	DEY
   8582 00CB24 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8583 00CB29 42 C8                        	INY4
   8584 00CB2B E8                           	INX
   8585 00CB2C E4 4C                        	CPX		Textcols
   8586 00CB2E D0 ED                        	BNE		.0002
   8587 00CB30                             .0003:
   8588 00CB30 A9 20 00                     	LDA		#' '
   8589 00CB33 05 36                        	ORA		NormAttr
   8590 00CB35 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8591 00CB3A C6 30                        	DEC		CursorX
   8592 00CB3C 82 5F 00                     	BRL		SyncVideoPos
   8593 00CB3F                             .0001:
   8594 00CB3F 60                           	RTS
                                           
                                           ; Deleting a character does not change the video position so there's no need
                                           ; to resynchronize it.
                                           
   8599 00CB40                             doDelete:
   8600 00CB40 A6 30                        	LDX		CursorX
   8601 00CB42 A5 34                        	LDA		VideoPos
   8602 00CB44 0A                           	ASL
   8603 00CB45 A8                           	TAY
   8604 00CB46                             .0002:
   8605 00CB46 E8                           	INX
   8606 00CB47 E4 4C                        	CPX		Textcols
   8607 00CB49 10 14                        	BPL		.0001
   8608 00CB4B CA                           	DEX
   8609 00CB4C C8                           	INY
   8610 00CB4D C8                           	INY
   8611 00CB4E 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y
   8612 00CB53 88                           	DEY
   8613 00CB54 88                           	DEY
   8614 00CB55 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8615 00CB5A C8                           	INY
   8616 00CB5B C8                           	INY
   8617 00CB5C E8                           	INX
   8618 00CB5D 80 E7                        	BRA		.0002
   8619 00CB5F                             .0001:
   8620 00CB5F A9 20 00                     	LDA		#' '
   8621 00CB62 05 36                        	ORA		NormAttr
   8622 00CB64 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8623 00CB69 60                           	RTS
                                           
   8625 00CB6A                             doCursorHome:
   8626 00CB6A A5 30                        	LDA		CursorX
   8627 00CB6C F0 24                        	BEQ		doCursor1
   8628 00CB6E 64 30                        	STZ		CursorX
   8629 00CB70 80 2C                        	BRA		SyncVideoPos
   8630 00CB72                             doCursorRight:
   8631 00CB72 A5 30                        	LDA		CursorX
   8632 00CB74 1A                           	INA
   8633 00CB75 C5 4C                        	CMP		Textcols
   8634 00CB77 10 1D                        	BPL		doRTS
   8635 00CB79                             doCursor2:
   8636 00CB79 85 30                        	STA		CursorX
   8637 00CB7B 80 21                        	BRA		SyncVideoPos
   8638 00CB7D                             doCursorLeft:
   8639 00CB7D A5 30                        	LDA		CursorX
   8640 00CB7F F0 15                        	BEQ		doRTS
   8641 00CB81 3A                           	DEA
   8642 00CB82 80 F5                        	BRA		doCursor2
   8643 00CB84                             doCursorUp:
   8644 00CB84 A5 32                        	LDA		CursorY
   8645 00CB86 F0 0E                        	BEQ		doRTS
   8646 00CB88 3A                           	DEA
   8647 00CB89 80 07                        	BRA		doCursor1
   8648 00CB8B                             doCursorDown:
   8649 00CB8B A5 32                        	LDA		CursorY
   8650 00CB8D 1A                           	INA
   8651 00CB8E C5 4E                        	CMP		Textrows
   8652 00CB90 10 04                        	BPL		doRTS
   8653 00CB92                             doCursor1:
   8654 00CB92 85 32                        	STA		CursorY
   8655 00CB94 80 08                        	BRA		SyncVideoPos
   8656 00CB96                             doRTS:
   8657 00CB96 60                           	RTS
                                           
   8659 00CB97                             HomeCursor:
   8660 00CB97 A9 00 00                     	LDA		#0
   8661 00CB9A 64 30                        	STZ		CursorX
   8662 00CB9C 64 32                        	STZ		CursorY
                                           
                                           ; Synchronize the absolute video position with the cursor co-ordinates.
                                           ;
   8666 00CB9E                             SyncVideoPos:
   8667 00CB9E 48                           	PHA
   8668 00CB9F 5A                           	PHY
   8669 00CBA0 A5 32                        	LDA		CursorY
   8670 00CBA2 0A                           	ASL
   8671 00CBA3 AA                           	TAX
   8672 00CBA4 42 3B 05 00 BD 3F DD         	LDA		5:LineTbl,X
   8673 00CBAB 18                           	CLC
   8674 00CBAC 65 30                        	ADC		CursorX
   8675 00CBAE 85 34                        	STA		VideoPos
   8676 00CBB0 A0 0D 00                     	LDY		#13
   8677 00CBB3 42 DA 42 97 46               	STA		FAR {Vidregs},Y		; Update the position in the text controller
   8678 00CBB8 7A                           	PLY
   8679 00CBB9 68                           	PLA
   8680 00CBBA 60                           	RTS
                                           
   8682 00CBBB                             OutCRLF:
   8683 00CBBB A9 0D 00                     	LDA		#CR
   8684 00CBBE 20 C4 CB                     	JSR		OutChar
   8685 00CBC1 A9 0A 00                     	LDA		#LF
                                           
   8687 00CBC4                             OutChar:
   8688 00CBC4 DA                           	PHX
   8689 00CBC5 5A                           	PHY
   8690 00CBC6 08                           	PHP
   8691 00CBC7 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   8694 00CBC9 A2 00 00                     	LDX		#0
   8695 00CBCC FC F0 03                     	JSR		(OutputVec,x)
   8696 00CBCF 28                           	PLP
   8697 00CBD0 7A                           	PLY
   8698 00CBD1 FA                           	PLX
   8699 00CBD2 60                           	RTS
                                           
   8701 00CBD3                             DisplayString:
                                           ;	PLA							; pop return address
                                           ;	PLX							; get string address parameter
                                           ;	PHA							; push return address
   8705 00CBD3 08                           	PHP							; push reg settings
   8706 00CBD4 E2 20                        	SEP		#$20				; ACC = 8 bit
                                           	MEM		8
                                           ;	STX		StringPos
   8709 00CBD6 A0 00 00                     	LDY		#0
   8710 00CBD9                             .0002:
   8711 00CBD9 42 DA B3 04                  	LDA		FAR (4,S),Y
   8712 00CBDD F0 06                        	BEQ		.0001
   8713 00CBDF 20 C4 CB                     	JSR		OutChar
   8714 00CBE2 C8                           	INY
   8715 00CBE3 80 F4                        	BRA		.0002
   8716 00CBE5                             .0001:
   8717 00CBE5 28                           	PLP							; restore regs settings
                                           ;	REP		#$20				; ACC 16 bits
                                           	MEM		16
   8720 00CBE6 42 C0 04                     	RTS		#4					; pop stack argument
                                           
   8722 00CBE9                             DisplayString2:
   8723 00CBE9 68                           	PLA							; pop return address
   8724 00CBEA FA                           	PLX							; get string address parameter
   8725 00CBEB 48                           	PHA							; push return address
   8726 00CBEC E2 20                        	SEP		#$20				; ACC = 8 bit
   8727 00CBEE 86 38                        	STX		StringPos
   8728 00CBF0 A0 00 00                     	LDY		#0
   8729 00CBF3 A2 32 00                     	LDX		#50
   8730 00CBF6                             .0002:
   8731 00CBF6 B1 38                        	LDA		(StringPos),Y
   8732 00CBF8 20 C4 CB                     	JSR		OutChar
   8733 00CBFB C8                           	INY
   8734 00CBFC CA                           	DEX
   8735 00CBFD D0 F7                        	BNE		.0002
   8736 00CBFF                             .0001:
   8737 00CBFF C2 20                        	REP		#$20				; ACC 16 bits
   8738 00CC01 60                           	RTS
                                           
   8740 00CC02                             GetTextRowsCols:
   8741 00CC02 48                           	PHA
   8742 00CC03 5A                           	PHY
   8743 00CC04 A0 00 00                     	LDY		#0
   8744 00CC07 42 DA 42 9B 42 B7 46         	LDA.UB	FAR {Vidregs},Y
   8745 00CC0E 85 4C                        	STA		Textcols
   8746 00CC10 C8                           	INY
   8747 00CC11 42 DA 42 9B 42 B7 46         	LDA.UB	FAR {Vidregs},Y
   8748 00CC18 85 4E                        	STA		Textrows
   8749 00CC1A 7A                           	PLY
   8750 00CC1B 68                           	PLA
   8751 00CC1C 60                           	RTS
                                           
                                           ; .Y = register number to set
                                           ; Acc = value
                                           ;
   8756 00CC1D                             SetVideoReg:
   8757 00CC1D 08                           	PHP								; save regs size settings
   8758 00CC1E E2 20                        	SEP		#$20
   8759 00CC20 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8760 00CC25 28                           	PLP								; restore reg size settings
   8761 00CC26 60                           	RTS
                                           
   8763 00CC27                             CursorOn:
   8764 00CC27 48                           	PHA
   8765 00CC28 5A                           	PHY
   8766 00CC29 A0 09 00                     	LDY		#9
   8767 00CC2C A9 60 1F                     	LDA		#$1F60
   8768 00CC2F 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8769 00CC34 7A                           	PLY
   8770 00CC35 68                           	PLA
   8771 00CC36 60                           	RTS
                                           
   8773 00CC37                             CursorOff:
   8774 00CC37 48                           	PHA
   8775 00CC38 5A                           	PHY
   8776 00CC39 A0 09 00                     	LDY		#9
   8777 00CC3C A9 20 00                     	LDA		#$0020
   8778 00CC3F 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8779 00CC44 7A                           	PLY
   8780 00CC45 68                           	PLA
   8781 00CC46 60                           	RTS
                                           
   8783 00CC47                             ClearScreen:
   8784 00CC47 A2 FF 0F                     	LDX		#4095
   8785 00CC4A A0 00 00                     	LDY		#$00
   8786 00CC4D A9 20 00                     	LDA		#' '
   8787 00CC50 20 AA C9                     	JSR		AsciiToScreen
   8788 00CC53 05 36                        	ORA		NormAttr
   8789 00CC55                             .0001:
   8790 00CC55 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8791 00CC5A C8                           	INY
   8792 00CC5B C8                           	INY
   8793 00CC5C CA                           	DEX
   8794 00CC5D D0 F6                        	BNE		.0001
   8795 00CC5F 60                           	RTS
                                           
   8797 00CC60                             ScrollUp:
   8798 00CC60 A0 00 00                     	LDY		#0				; .Y used as index to char
   8799 00CC63 A2 2B 0A                     	LDX 	#2603			; number of chars on screen
   8800 00CC66                             .0001:
   8801 00CC66 5A                           	PHY						; save off current .Y
   8802 00CC67 98                           	TYA								
   8803 00CC68 18                           	CLC						; Add double the number of text
   8804 00CC69 65 4C                        	ADC		Textcols		; columns to .Y to find start of next
   8805 00CC6B 18                           	CLC						; row 
   8806 00CC6C 65 4C                        	ADC		Textcols
   8807 00CC6E A8                           	TAY						
   8808 00CC6F 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y	; .A = Load buffer[textcols+Y]
   8809 00CC74 7A                           	PLY						; .Y = restore current .Y
   8810 00CC75 42 DA 42 97 40               	STA		FAR {Vidptr},Y	; Store .A in buffer[0+Y]
   8811 00CC7A C8                           	INY						; advance to next character
   8812 00CC7B C8                           	INY						; decrement total char count
   8813 00CC7C CA                           	DEX
   8814 00CC7D D0 E7                        	BNE		.0001
   8815 00CC7F A5 4E                        	LDA		Textrows
   8816 00CC81 3A                           	DEA
                                           
   8818 00CC82                             BlankLine:
   8819 00CC82 0A                           	ASL
   8820 00CC83 A8                           	TAY
   8821 00CC84 42 1B B9 3F DD               	LDA		CS:LineTbl,Y
   8822 00CC89 0A                           	ASL
   8823 00CC8A A8                           	TAY
   8824 00CC8B A6 4C                        	LDX		Textcols		; number of chars to clear
   8825 00CC8D A5 36                        	LDA		NormAttr
   8826 00CC8F 09 20 00                     	ORA		#$20			; space
   8827 00CC92                             .0001:
   8828 00CC92 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8829 00CC97 C8                           	INY						; increment to next char
   8830 00CC98 C8                           	INY
   8831 00CC99 CA                           	DEX						; decrement number of chars
   8832 00CC9A D0 F6                        	BNE		.0001
   8833 00CC9C 60                           	RTS
                                           
   8835 00CC9D                             DispDWord:
   8836 00CC9D 42 EB                        	XBAW
   8837 00CC9F 20 A4 CC                     	JSR		DispWord
   8838 00CCA2 42 EB                        	XBAW
   8839 00CCA4                             DispWord:
   8840 00CCA4 EB                           	XBA
   8841 00CCA5 20 A9 CC                     	JSR		DispByte
   8842 00CCA8 EB                           	XBA
   8843 00CCA9                             DispByte:
   8844 00CCA9 48                           	PHA
   8845 00CCAA 4A                           	LSR
   8846 00CCAB 4A                           	LSR
   8847 00CCAC 4A                           	LSR
   8848 00CCAD 4A                           	LSR
   8849 00CCAE 20 B2 CC                     	JSR		DispNybble
   8850 00CCB1 68                           	PLA
   8851 00CCB2                             DispNybble:
   8852 00CCB2 48                           	PHA
   8853 00CCB3 29 0F 00                     	AND		#$0F
   8854 00CCB6 C9 0A 00                     	CMP		#10
   8855 00CCB9 90 08                        	BCC		.0001
   8856 00CCBB 69 36 00                     	ADC		#'A'-11			; -11 cause the carry is set
   8857 00CCBE 20 C4 CB                     	JSR		OutChar
   8858 00CCC1 68                           	PLA
   8859 00CCC2 60                           	RTS
   8860 00CCC3                             .0001:
   8861 00CCC3 09 30 00                     	ORA		#'0'
   8862 00CCC6 20 C4 CB                     	JSR		OutChar
   8863 00CCC9 68                           	PLA
   8864 00CCCA 60                           	RTS
                                           
   8866 00CCCB                             space:
   8867 00CCCB 48                           	PHA
   8868 00CCCC A9 20 00                     	LDA		#' '
   8869 00CCCF 20 C4 CB                     	JSR		OutChar
   8870 00CCD2 68                           	PLA
   8871 00CCD3 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Get a range (two hex numbers)
                                           ;------------------------------------------------------------------------------
                                           
   8877 00CCD4                             GetRange:
   8878 00CCD4 20 EE C7                     	JSR		IgnoreBlanks
   8879 00CCD7 20 FF CC                     	JSR		GetHexNumber
   8880 00CCDA C0 00 00                     	CPY		#0
   8881 00CCDD F0 1F                        	BEQ		.0001
   8882 00CCDF A5 0C                        	LDA		NumWorkArea
   8883 00CCE1 85 20                        	STA		RangeStart
   8884 00CCE3 85 24                        	STA		RangeEnd
   8885 00CCE5 A5 0E                        	LDA		NumWorkArea+2
   8886 00CCE7 85 22                        	STA		RangeStart+2
   8887 00CCE9 85 26                        	STA		RangeEnd+2
   8888 00CCEB 20 EE C7                     	JSR		IgnoreBlanks
   8889 00CCEE 20 FF CC                     	JSR		GetHexNumber
   8890 00CCF1 C0 00 00                     	CPY		#0
   8891 00CCF4 F0 08                        	BEQ		.0001
   8892 00CCF6 A5 0C                        	LDA		NumWorkArea
   8893 00CCF8 85 24                        	STA		RangeEnd
   8894 00CCFA A5 0E                        	LDA		NumWorkArea+2
   8895 00CCFC 85 26                        	STA		RangeEnd+2
   8896 00CCFE                             .0001:
   8897 00CCFE 60                           	RTS
                                           	
                                           ; Get a hexidecimal number. Maximum of six digits.
                                           ; .X = text pointer (updated)
                                           ;------------------------------------------------------------------------------
                                           ;
   8903 00CCFF                             GetHexNumber:
   8904 00CCFF A0 00 00                     	LDY		#0					; maximum of eight digits
   8905 00CD02 64 0C                        	STZ		NumWorkArea
   8906 00CD04 64 0E                        	STZ		NumWorkArea+2
   8907 00CD06                             gthxn2:
   8908 00CD06 20 62 C2                     	JSR		MonGetch
   8909 00CD09 20 2C CD                     	JSR		AsciiToHexNybble
   8910 00CD0C 30 1B                        	BMI		gthxn1
   8911 00CD0E 06 0C                        	ASL		NumWorkArea
   8912 00CD10 26 0E                        	ROL		NumWorkArea+2
   8913 00CD12 06 0C                        	ASL		NumWorkArea
   8914 00CD14 26 0E                        	ROL		NumWorkArea+2
   8915 00CD16 06 0C                        	ASL		NumWorkArea
   8916 00CD18 26 0E                        	ROL		NumWorkArea+2
   8917 00CD1A 06 0C                        	ASL		NumWorkArea
   8918 00CD1C 26 0E                        	ROL		NumWorkArea+2
   8919 00CD1E 05 0C                        	ORA		NumWorkArea
   8920 00CD20 85 0C                        	STA		NumWorkArea
   8921 00CD22 C8                           	INY
   8922 00CD23 C0 08 00                     	CPY		#8
   8923 00CD26 D0 DE                        	BNE		gthxn2
   8924 00CD28 60                           	RTS
   8925 00CD29                             gthxn1:
   8926 00CD29 CA                           	DEX
   8927 00CD2A CA                           	DEX
   8928 00CD2B 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Convert ASCII character in the range '0' to '9', 'a' to 'f' or 'A' to 'F'
                                           ; to a hex nybble.
                                           ;------------------------------------------------------------------------------
                                           ;
   8935 00CD2C                             AsciiToHexNybble:
   8936 00CD2C C9 30 00                     	CMP		#'0'
   8937 00CD2F 90 30                        	BCC		gthx3
   8938 00CD31 C9 3A 00                     	CMP		#'9'+1
   8939 00CD34 B0 05                        	BCS		gthx5
   8940 00CD36 38                           	SEC
   8941 00CD37 E9 30 00                     	SBC		#'0'
   8942 00CD3A 60                           	RTS
   8943 00CD3B                             gthx5:
   8944 00CD3B C9 41 00                     	CMP		#'A'
   8945 00CD3E 90 21                        	BCC		gthx3
   8946 00CD40 C9 47 00                     	CMP		#'F'+1
   8947 00CD43 B0 09                        	BCS		gthx6
   8948 00CD45 38                           	SEC
   8949 00CD46 E9 41 00                     	SBC		#'A'
   8950 00CD49 18                           	CLC
   8951 00CD4A 69 0A 00                     	ADC		#10
   8952 00CD4D 60                           	RTS
   8953 00CD4E                             gthx6:
   8954 00CD4E C9 61 00                     	CMP		#'a'
   8955 00CD51 90 0E                        	BCC		gthx3
   8956 00CD53 C9 7B 00                     	CMP		#'z'+1
   8957 00CD56 B0 09                        	BCS		gthx3
   8958 00CD58 38                           	SEC
   8959 00CD59 E9 61 00                     	SBC		#'a'
   8960 00CD5C 18                           	CLC
   8961 00CD5D 69 0A 00                     	ADC		#10
   8962 00CD60 60                           	RTS
   8963 00CD61                             gthx3:
   8964 00CD61 A9 FF FF                     	LDA		#-1		; not a hex number
   8965 00CD64 60                           	RTS
                                           
   8967 00CD65                             AsciiToDecNybble:
   8968 00CD65 C9 30 00                     	CMP		#'0'
   8969 00CD68 90 0A                        	BCC		gtdc3
   8970 00CD6A C9 3A 00                     	CMP		#'9'+1
   8971 00CD6D B0 05                        	BCS		gtdc3
   8972 00CD6F 38                           	SEC
   8973 00CD70 E9 30 00                     	SBC		#'0'
   8974 00CD73 60                           	RTS
   8975 00CD74                             gtdc3:
   8976 00CD74 A9 FF FF                     	LDA		#-1
   8977 00CD77 60                           	RTS
                                           
   8979 00CD78                             getcharNoWait:
   8980 00CD78 A9 01 00                     	LDA		#1
   8981 00CD7B 42 5B 85 BC                  	STA		ZS:keybd_cmd
   8982 00CD7F 42 A2 06 00                  	TSK		#6
   8983 00CD83 42 5B A5 BA                  	LDA		ZS:keybd_char
   8984 00CD87 10 02                        	BPL		.0001
   8985 00CD89 38                           	SEC
   8986 00CD8A 60                           	RTS
   8987 00CD8B                             .0001:
   8988 00CD8B 18                           	CLC
   8989 00CD8C 60                           	RTS
                                           
   8991 00CD8D                             getcharWait:
   8992 00CD8D A9 02 00                     	LDA		#2
   8993 00CD90 42 5B 85 BC                  	STA		ZS:keybd_cmd
   8994 00CD94 42 A2 06 00                  	TSK		#6
   8995 00CD98 42 5B A5 BA                  	LDA		ZS:keybd_char
   8996 00CD9C 10 02                        	BPL		.0001
   8997 00CD9E 38                           	SEC
   8998 00CD9F 60                           	RTS
   8999 00CDA0                             .0001:
   9000 00CDA0 18                           	CLC
   9001 00CDA1 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; Keyboard processing routines follow.
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   9008 00CDA2                             ResetKbd:
   9009 00CDA2 E2 30                        	SEP		#$30
                                           	MEM		8
                                           	NDX		8
   9012 00CDA4 64 08                        	STZ		KeyState1
   9013 00CDA6 64 09                        	STZ		KeyState2
   9014 00CDA8 A9 FF                        	LDA		#$FF
   9015 00CDAA 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9016 00CDB2 20 C5 CE                     	JSR		KeybdWaitTx
   9017 00CDB5 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9020 00CDB7 60                           	RTS
   9021 00CDB8                             KeybdInit:
   9022 00CDB8 A9 00 20                     	LDA		#$2000
   9023 00CDBB 1B                           	TAS
   9024 00CDBC A9 05 00                     	LDA		#5
   9025 00CDBF 85 BC                        	STA		keybd_cmd
   9026 00CDC1 E2 30                        	SEP		#$30
                                           	MEM		8
                                           	NDX		8
   9029 00CDC3 64 08                        	STZ		KeyState1
   9030 00CDC5 64 09                        	STZ		KeyState2
   9031 00CDC7 A0 0C                        	LDY		#12
   9032 00CDC9 42 60                        	RTT
   9033 00CDCB                             .resetAgain:
   9034 00CDCB A9 FF                        	LDA		#$FF			; send reset code to keyboard
   9035 00CDCD 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9036 00CDD5 20 C5 CE                     	JSR		KeybdWaitTx
   9037 00CDD8                             .0001:
   9038 00CDD8 20 A0 CE                     	JSR		KeybdRecvByte	; Look for $AA
   9039 00CDDB 90 5A                        	BCC		.tryAgain
   9040 00CDDD C9 AA                        	CMP		#$AA			;
   9041 00CDDF F0 37                        	BEQ		.config
   9042 00CDE1                             .0002:
                                           	; wait until keyboard not busy
   9044 00CDE1 20 E3 CE                     	JSR		Wait10ms
   9045 00CDE4 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1		;
                                         
   9046 00CDEC 89 40                        	BIT		#$40
   9047 00CDEE D0 47                        	BNE		.tryAgain
   9048 00CDF0 A9 FF                        	LDA		#$FF			; send reset code to keyboard
   9049 00CDF2 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9050 00CDFA 20 E3 CE                     	JSR		Wait10ms
   9051 00CDFD 20 C5 CE                     	JSR		KeybdWaitTx		; wait until no longer busy
   9052 00CE00 20 A0 CE                     	JSR		KeybdRecvByte	; look for an ACK ($FA)
   9053 00CE03 90 32                        	BCC		.tryAgain
   9054 00CE05 C9 FE                        	CMP		#$FE
   9055 00CE07 F0 2E                        	BEQ		.tryAgain
   9056 00CE09 C9 FA                        	CMP		#$FA
   9057 00CE0B D0 2A                        	BNE		.tryAgain
   9058 00CE0D 20 A0 CE                     	JSR		KeybdRecvByte
   9059 00CE10 C9 FC                        	CMP		#$FC			; reset error ?
   9060 00CE12 F0 23                        	BEQ		.tryAgain
   9061 00CE14 C9 AA                        	CMP		#$AA			; reset complete okay ?
   9062 00CE16 D0 1F                        	BNE		.tryAgain
   9063 00CE18                             .config:
   9064 00CE18 20 C5 CE                     	JSR		KeybdWaitBusy
   9065 00CE1B A9 F0                        	LDA		#$F0			; send scan code select
   9066 00CE1D 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9067 00CE25 20 C5 CE                     	JSR		KeybdWaitTx
   9068 00CE28 90 0D                        	BCC		.tryAgain
   9069 00CE2A 20 A0 CE                     	JSR		KeybdRecvByte	; wait for response from keyboard
   9070 00CE2D 90 08                        	BCC		.tryAgain
   9071 00CE2F C9 FE                        	CMP		#$FE
   9072 00CE31 F0 04                        	BEQ		.tryAgain
   9073 00CE33 C9 FA                        	CMP		#$FA
   9074 00CE35 F0 16                        	BEQ		.0004
   9075 00CE37                             .tryAgain:
   9076 00CE37 88                           	DEY
   9077 00CE38 D0 9E                        	BNE		.0001
   9078 00CE3A C6 BC                        	DEC		keybd_cmd
   9079 00CE3C D0 8D                        	BNE		.resetAgain
   9080 00CE3E                             .keybdErr:
   9081 00CE3E C2 30                        	REP		#$30
   9082 00CE40 F4 01 00                     	PEA		1
   9083 00CE43 F4 FB CE                     	PEA		msgKeybdNR
   9084 00CE46 20 D3 CB                     	JSR		DisplayString
   9085 00CE49 42 60                        	RTT
   9086 00CE4B 80 1A                        	BRA		KeybdService
   9087 00CE4D                             .0004:
   9088 00CE4D A9 02                        	LDA		#2				; select scan code set #2
   9089 00CE4F 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9090 00CE57 20 C5 CE                     	JSR		KeybdWaitTx
   9091 00CE5A 90 DB                        	BCC		.tryAgain
   9092 00CE5C 20 A0 CE                     	JSR		KeybdRecvByte
   9093 00CE5F 90 D6                        	BCC		.tryAgain
   9094 00CE61 C2 30                        	REP		#$30
   9095 00CE63 42 60                        	RTT
   9096 00CE65 80 00                        	BRA		KeybdService
                                           
   9098 00CE67                             KeybdService:
   9099 00CE67 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9102 00CE69 A9 00 20                     	LDA		#$2000
   9103 00CE6C 1B                           	TAS
   9104 00CE6D A5 BC                        	LDA		keybd_cmd
   9105 00CE6F C9 01 00                     	CMP		#1
   9106 00CE72 D0 18                        	BNE		.0001
   9107 00CE74 20 1E CF                     	JSR		KeybdGetCharNoWait
   9108 00CE77 B0 08                        	BCS		.nokey
   9109 00CE79 64 BC                        	STZ		keybd_cmd
   9110 00CE7B 85 BA                        	STA		keybd_char
   9111 00CE7D 42 60                        	RTT
   9112 00CE7F 80 E6                        	BRA		KeybdService
   9113 00CE81                             .nokey
   9114 00CE81 A9 FF FF                     	LDA		#-1
   9115 00CE84 64 BC                        	STZ		keybd_cmd
   9116 00CE86 85 BA                        	STA		keybd_char
   9117 00CE88 42 60                        	RTT
   9118 00CE8A 80 DB                        	BRA		KeybdService
   9119 00CE8C                             .0001:
   9120 00CE8C C9 02 00                     	CMP		#2
   9121 00CE8F D0 0B                        	BNE		.0002
   9122 00CE91 20 38 CF                     	JSR		KeybdGetCharWait
   9123 00CE94 64 BC                        	STZ		keybd_cmd
   9124 00CE96 85 BA                        	STA		keybd_char
   9125 00CE98 42 60                        	RTT
   9126 00CE9A 80 CB                        	BRA		KeybdService
   9127 00CE9C                             .0002:
   9128 00CE9C 42 60                        	RTT
   9129 00CE9E 80 C7                        	BRA		KeybdService
                                           
                                           	MEM		8
                                           	NDX		8
                                           
                                           ; Receive a byte from the keyboard, used after a command is sent to the
                                           ; keyboard in order to wait for a response.
                                           ;
   9137 00CEA0                             KeybdRecvByte:
   9138 00CEA0 5A                           	PHY
   9139 00CEA1 A0 14                        	LDY		#20				; wait up to .2s
   9140 00CEA3                             .0003:
   9141 00CEA3 20 C5 CE                     	JSR		KeybdWaitBusy
   9142 00CEA6 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1	; wait for response from keyboard
                                         
   9143 00CEAE 0A                           	ASL						; is input buffer full ?
   9144 00CEAF B0 09                        	BCS		.0004			; yes, branch
   9145 00CEB1 20 E3 CE                     	JSR		Wait10ms		; wait a bit
   9146 00CEB4 88                           	DEY
   9147 00CEB5 D0 EC                        	BNE		.0003			; go back and try again
   9148 00CEB7 7A                           	PLY						; timeout
   9149 00CEB8 18                           	CLC						; carry clear = no code
   9150 00CEB9 60                           	RTS
   9151 00CEBA                             .0004:
   9152 00CEBA 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD		; clear recieve state
                                         
   9153 00CEC2 7A                           	PLY
   9154 00CEC3 38                           	SEC						; carry set = code available
   9155 00CEC4 60                           	RTS
                                           
                                           ; Wait until the keyboard isn't busy anymore
                                           ; Wait until the keyboard transmit is complete
                                           ; Returns .CF = 1 if successful, .CF=0 timeout
                                           ;
   9161 00CEC5                             KeybdWaitBusy:				; alias for KeybdWaitTx
   9162 00CEC5                             KeybdWaitTx:
   9163 00CEC5 48                           	PHA
   9164 00CEC6 5A                           	PHY
   9165 00CEC7 A0 0A                        	LDY		#10				; wait a max of .1s
   9166 00CEC9                             .0001:
   9167 00CEC9 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1
                                         
   9168 00CED1 89 40                        	BIT		#$40			; check for transmit busy bit
   9169 00CED3 F0 0A                        	BEQ		.0002			; branch if bit clear
   9170 00CED5 20 E3 CE                     	JSR		Wait10ms		; delay a little bit
   9171 00CED8 88                           	DEY						; go back and try again
   9172 00CED9 D0 EE                        	BNE		.0001
   9173 00CEDB 7A                           	PLY						; timed out
   9174 00CEDC 68                           	PLA
   9175 00CEDD 18                           	CLC						; return carry clear
   9176 00CEDE 60                           	RTS
   9177 00CEDF                             .0002:
   9178 00CEDF 7A                           	PLY						; wait complete, return 
   9179 00CEE0 68                           	PLA
   9180 00CEE1 38                           	SEC						; carry set
   9181 00CEE2 60                           	RTS
                                           
                                           ; Wait approximately 10ms. Used by keyboard routines. Makes use of the free
                                           ; running counter #0.
                                           ; .A = trashed (=-5)
                                           ;
   9187 00CEE3                             Wait10ms:
   9188 00CEE3 48                           	PHA
   9189 00CEE4 DA                           	PHX				; save .X
   9190 00CEE5 42 5B A5 12                  	LDA		ZS:CNT0H	; get starting count
   9191 00CEE9 AA                           	TAX				; save it off in .X
   9192 00CEEA                             .0002:
   9193 00CEEA 38                           	SEC				; compare to current counter value
   9194 00CEEB 42 5B E5 12                  	SBC		ZS:CNT0H
   9195 00CEEF 49 FF                        	EOR		#$FF	; make negative
   9196 00CEF1 C9 0A                        	CMP		#10
   9197 00CEF3 10 03                        	BPL     .0001
   9198 00CEF5 8A                           	TXA				; prepare for next check, get startcount in .A
   9199 00CEF6 80 F2                        	BRA		.0002	; go back if less than 5 ticks
   9200 00CEF8                             .0001:
   9201 00CEF8 FA                           	PLX				; restore .X
   9202 00CEF9 68                           	PLA
   9203 00CEFA 60                           	RTS
                                           
                                           	MEM		16
                                           	NDX		16
                                           
   9208 00CEFB                             msgKeybdNR:
   9209 00CEFB 0D 0A 4B 65 79 62 6F 61      	.byte	CR,LF,"Keyboard not responding.",CR,LF,0
   9209 00CF03 72 64 20 6E 6F 74 20 72    
   9209 00CF0B 65 73 70 6F 6E 64 69 6E    
   9209 00CF13 67 2E 0D 0A 00             
                                           
                                           	cpu		FT832
                                           
   9213 00CF18                             KeybdGetCharNoWaitCtx:
   9214 00CF18 20 1E CF                     	JSR		KeybdGetCharNoWait
   9215 00CF1B 42 40 00                     	RTC		#0
   9216 00CF1E                             	
   9217 00CF1E 08                           	PHP
   9218 00CF1F 78                           	SEI
   9219 00CF20 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9222 00CF22 42 1A                        	TTA
   9223 00CF24 C5 CE                        	CMP		IOFocusTask
   9224 00CF26 D0 0D                        	BNE		.noFocus
   9225 00CF28 E2 20                        	SEP		#$20
   9226 00CF2A C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9229 00CF2C 64 D0                        	STZ		TaskSwitchEn
   9230 00CF2E 58                           	CLI
   9231 00CF2F A9 00                        	LDA		#0
   9232 00CF31 85 0B                        	STA		KeybdWaitFlag
   9233 00CF33 80 13                        	BRA		KeybdGetChar1
   9234 00CF35                             .noFocus:
   9235 00CF35 28                           	PLP
   9236 00CF36 38                           	SEC		; flag no key available
   9237 00CF37 60                           	RTS
                                           
   9239 00CF38                             KeybdGetCharWait:
   9240 00CF38 08                           	PHP
   9241 00CF39 E2 20                        	SEP		#$20
   9242 00CF3B C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9245 00CF3D A9 FF                        	LDA		#$FF
   9246 00CF3F 85 0B                        	STA		KeybdWaitFlag
   9247 00CF41 80 05                        	BRA		KeybdGetChar1
                                           
                                           ; Wait for a keyboard character to be available
                                           ; Returns (CF=1) if no key available
                                           ; Return key (CF=0) if key is available
                                           ;
                                           ;
   9254 00CF43                             KeybdGetChar:
   9255 00CF43 08                           	PHP
   9256 00CF44 E2 20                        	SEP		#$20		; 8 bit acc
   9257 00CF46 C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9260 00CF48                             KeybdGetChar1:
   9261 00CF48 DA                           	PHX
   9262 00CF49 EB                           	XBA					; force .B to zero for TAX
   9263 00CF4A A9 00                        	LDA		#0
   9264 00CF4C EB                           	XBA
   9265 00CF4D                             .0002:
   9266 00CF4D                             .0003:
   9267 00CF4D 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1		; check MSB of keyboard status reg.
                                         
   9268 00CF55 2A                           	ROL
   9269 00CF56 2A                           	ROL
   9270 00CF57 B0 F4                        	BCS		.0003		; check busy flag, branch if busy
   9271 00CF59 6A                           	ROR
   9272 00CF5A B0 08                        	BCS		.0006		; branch if keystroke ready
   9273 00CF5C 24 0B                        	BIT		KeybdWaitFlag
   9274 00CF5E 30 ED                        	BMI		.0003
   9275 00CF60 FA                           	PLX
   9276 00CF61 28                           	PLP
   9277 00CF62 38                           	SEC
   9278 00CF63 60                           	RTS
   9279 00CF64                             .0006:
   9280 00CF64 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD	; get scan code value
                                         
   9281 00CF6C 42 3B FF 0F 42 9C 12 A1      	STZ		$FFF:KEYBD+2	; clear read flag
   9281 00CF74 0E 00                      
                                           	;REP		#$20
                                           	;JSR		DispByte
                                           	;JSR		space
                                           	;SEP		#$20
   9286 00CF76                             .0001:
   9287 00CF76 C9 F0                        	CMP		#SC_KEYUP	; keyup scan code ?
   9288 00CF78 F0 FF 6F 00                  	LBEQ	.doKeyup	; 
   9289 00CF7C C9 E0                        	CMP		#SC_EXTEND	; extended scan code ?
   9290 00CF7E F0 FF 70 00                  	LBEQ	.doExtend
   9291 00CF82 C9 14                        	CMP		#$14		; control ?
   9292 00CF84 F0 FF 73 00                  	LBEQ	.doCtrl
   9293 00CF88 C9 12                        	CMP		#$12		; left shift
   9294 00CF8A F0 FF 7D 00                  	LBEQ	.doShift
   9295 00CF8E C9 59                        	CMP		#$59		; right shift
   9296 00CF90 F0 FF 77 00                  	LBEQ	.doShift
   9297 00CF94 C9 77                        	CMP		#SC_NUMLOCK
   9298 00CF96 F0 FF 81 00                  	LBEQ	.doNumLock
   9299 00CF9A C9 58                        	CMP		#SC_CAPSLOCK
   9300 00CF9C F0 FF 8B 00                  	LBEQ	.doCapsLock
   9301 00CFA0 C9 7E                        	CMP		#SC_SCROLLLOCK
   9302 00CFA2 F0 FF 95 00                  	LBEQ	.doScrollLock
   9303 00CFA6 46 08                        	LSR		KeyState1
   9304 00CFA8 B0 A3                        	BCS		.0003
   9305 00CFAA AA                           	TAX
   9306 00CFAB A9 80                        	LDA		#$80
   9307 00CFAD 24 09                        	BIT		KeyState2	; Is extended code ?
   9308 00CFAF F0 13                        	BEQ		.0010
   9309 00CFB1 A9 7F                        	LDA		#$7F
   9310 00CFB3 25 09                        	AND		KeyState2
   9311 00CFB5 85 09                        	STA		KeyState2
   9312 00CFB7 46 08                        	LSR		KeyState1	; clear keyup
   9313 00CFB9 8A                           	TXA
   9314 00CFBA 29 7F                        	AND		#$7F
   9315 00CFBC AA                           	TAX
   9316 00CFBD 42 1B BD 18 D3               	LDA		cs:keybdExtendedCodes,X
   9317 00CFC2 80 23                        	BRA		.0008
   9318 00CFC4                             .0010:
   9319 00CFC4 A9 04                        	LDA		#4
   9320 00CFC6 24 09                        	BIT		KeyState2	; Is Cntrl down ?
   9321 00CFC8 F0 0B                        	BEQ		.0009
   9322 00CFCA 8A                           	TXA
   9323 00CFCB 29 7F                        	AND		#$7F		; table is 128 chars
   9324 00CFCD AA                           	TAX
   9325 00CFCE 42 1B BD 98 D2               	LDA		cs:keybdControlCodes,X
   9326 00CFD3 80 12                        	BRA		.0008
   9327 00CFD5                             .0009:
   9328 00CFD5 A9 01                        	LDA		#$1			; Is shift down ?
   9329 00CFD7 24 09                        	BIT		KeyState2
   9330 00CFD9 F0 07                        	BEQ		.0007
   9331 00CFDB 42 1B BD 98 D1               	LDA		cs:shiftedScanCodes,X
   9332 00CFE0 80 05                        	BRA		.0008
   9333 00CFE2                             .0007:
   9334 00CFE2 42 1B BD 98 D0               	LDA		cs:unshiftedScanCodes,X
   9335 00CFE7                             .0008:
   9336 00CFE7 FA                           	PLX
   9337 00CFE8 28                           	PLP
   9338 00CFE9 18                           	CLC
   9339 00CFEA 60                           	RTS
                                           	MEM		8
   9341 00CFEB                             .doKeyup:
   9342 00CFEB A9 01                        	LDA		#1
   9343 00CFED 04 08                        	TSB		KeyState1
   9344 00CFEF 82 5B FF                     	BRL		.0003
   9345 00CFF2                             .doExtend:				; set extended key flag
   9346 00CFF2 A5 09                        	LDA		KeyState2
   9347 00CFF4 09 80                        	ORA		#$80
   9348 00CFF6 85 09                        	STA		KeyState2
   9349 00CFF8 82 52 FF                     	BRL		.0003
   9350 00CFFB                             .doCtrl:
   9351 00CFFB A9 04                        	LDA		#4
   9352 00CFFD 46 08                        	LSR		KeyState1	; check key up/down	
   9353 00CFFF 90 05                        	BCC		.0004		; keydown = carry clear
   9354 00D001 14 09                        	TRB		KeyState2
   9355 00D003 82 47 FF                     	BRL		.0003
   9356 00D006                             .0004:
   9357 00D006 04 09                        	TSB		KeyState2	; set control active bit
   9358 00D008 82 42 FF                     	BRL		.0003
   9359 00D00B                             .doShift:
   9360 00D00B A9 01                        	LDA		#1
   9361 00D00D 46 08                        	LSR		KeyState1	; check key up/down	
   9362 00D00F 90 05                        	BCC		.0005
   9363 00D011 14 09                        	TRB		KeyState2
   9364 00D013 82 37 FF                     	BRL		.0003
   9365 00D016                             .0005:
   9366 00D016 04 09                        	TSB		KeyState2
   9367 00D018 82 32 FF                     	BRL		.0003
   9368 00D01B                             .doNumLock:
   9369 00D01B A5 09                        	LDA		KeyState2
   9370 00D01D 49 10                        	EOR		#16
   9371 00D01F 85 09                        	STA		KeyState2
   9372 00D021 E2 30                        	SEP		#$30
   9373 00D023 20 4B D0                     	JSR		KeybdSetLEDStatus
   9374 00D026 C2 20                        	REP		#$20
   9375 00D028 82 22 FF                     	BRL		.0003
   9376 00D02B                             .doCapsLock:
   9377 00D02B A5 09                        	LDA		KeyState2
   9378 00D02D 49 20                        	EOR		#32
   9379 00D02F 85 09                        	STA		KeyState2
   9380 00D031 E2 30                        	SEP		#$30
   9381 00D033 20 4B D0                     	JSR		KeybdSetLEDStatus
   9382 00D036 C2 20                        	REP		#$20
   9383 00D038 82 12 FF                     	BRL		.0003
   9384 00D03B                             .doScrollLock:
   9385 00D03B A5 09                        	LDA		KeyState2
   9386 00D03D 49 40                        	EOR		#64
   9387 00D03F 85 09                        	STA		KeyState2
   9388 00D041 E2 30                        	SEP		#$30
   9389 00D043 20 4B D0                     	JSR		KeybdSetLEDStatus
   9390 00D046 C2 20                        	REP		#$20
   9391 00D048 82 02 FF                     	BRL		.0003
                                           
   9393 00D04B                             KeybdSetLEDStatus:
                                           ;	PHDS				; save off DS
                                           ;	PEA		5			; set DS to zero
                                           ;	PLDS
   9397 00D04B A9 00                        	LDA		#0
   9398 00D04D 85 0A                        	STA		KeybdLEDs
   9399 00D04F A9 10                        	LDA		#16
   9400 00D051 24 09                        	BIT		KeyState2
   9401 00D053 F0 06                        	BEQ		.0002
   9402 00D055 A5 0A                        	LDA		KeybdLEDs	; set bit 1 for Num lock, 0 for scrolllock , 2 for caps lock
   9403 00D057 09 02                        	ORA		#$2
   9404 00D059 85 0A                        	STA		KeybdLEDs
   9405 00D05B                             .0002:
   9406 00D05B A9 20                        	LDA		#32
   9407 00D05D 24 09                        	BIT		KeyState2
   9408 00D05F F0 06                        	BEQ		.0003
   9409 00D061 A5 0A                        	LDA		KeybdLEDs
   9410 00D063 09 04                        	ORA		#$4
   9411 00D065 85 0A                        	STA		KeybdLEDs
   9412 00D067                             .0003:
   9413 00D067 A9 40                        	LDA		#64
   9414 00D069 24 09                        	BIT		KeyState2
   9415 00D06B F0 06                        	BEQ		.0004
   9416 00D06D A5 0A                        	LDA		KeybdLEDs
   9417 00D06F 09 01                        	ORA		#1
   9418 00D071 85 0A                        	STA		KeybdLEDs
   9419 00D073                             .0004:
   9420 00D073 A9 ED                        	LDA		#$ED		; set status LEDs command
   9421 00D075 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9422 00D07D 20 C5 CE                     	JSR		KeybdWaitTx
   9423 00D080 20 A0 CE                     	JSR		KeybdRecvByte
   9424 00D083 90 12                        	BCC		.0001
   9425 00D085 C9 FA                        	CMP		#$FA
   9426 00D087 A5 0A                        	LDA		KeybdLEDs
   9427 00D089 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9428 00D091 20 C5 CE                     	JSR		KeybdWaitTx
   9429 00D094 20 A0 CE                     	JSR		KeybdRecvByte	; wait for $FA byte
   9430 00D097                             .0001:
                                           ;	PLDS				; recover DS
   9432 00D097 60                           	RTS
                                           
                                           
                                           	;--------------------------------------------------------------------------
                                           	; PS2 scan codes to ascii conversion tables.
                                           	;--------------------------------------------------------------------------
                                           	;
   9439 00D098                             unshiftedScanCodes:
   9440 00D098 2E A9 2E A5 A3 A1 A2 AC      	.byte	$2e,$a9,$2e,$a5,$a3,$a1,$a2,$ac
                                         
   9441 00D0A0 2E AA A8 A6 A4 09 60 2E      	.byte	$2e,$aa,$a8,$a6,$a4,$09,$60,$2e
                                         
   9442 00D0A8 2E 2E 2E 2E 2E 71 31 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$71,$31,$2e
                                         
   9443 00D0B0 2E 2E 7A 73 61 77 32 2E      	.byte	$2e,$2e,$7a,$73,$61,$77,$32,$2e
                                         
   9444 00D0B8 2E 63 78 64 65 34 33 2E      	.byte	$2e,$63,$78,$64,$65,$34,$33,$2e
                                         
   9445 00D0C0 2E 20 76 66 74 72 35 2E      	.byte	$2e,$20,$76,$66,$74,$72,$35,$2e
                                         
   9446 00D0C8 2E 6E 62 68 67 79 36 2E      	.byte	$2e,$6e,$62,$68,$67,$79,$36,$2e
                                         
   9447 00D0D0 2E 2E 6D 6A 75 37 38 2E      	.byte	$2e,$2e,$6d,$6a,$75,$37,$38,$2e
                                         
   9448 00D0D8 2E 2C 6B 69 6F 30 39 2E      	.byte	$2e,$2c,$6b,$69,$6f,$30,$39,$2e
                                         
   9449 00D0E0 2E 2E 2F 6C 3B 70 2D 2E      	.byte	$2e,$2e,$2f,$6c,$3b,$70,$2d,$2e
                                         
   9450 00D0E8 2E 2E 27 2E 5B 3D 2E 2E      	.byte	$2e,$2e,$27,$2e,$5b,$3d,$2e,$2e
                                         
   9451 00D0F0 AD 2E 0D 5D 2E 5C 2E 2E      	.byte	$ad,$2e,$0d,$5d,$2e,$5c,$2e,$2e
                                         
   9452 00D0F8 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9453 00D100 2E 95 2E 93 94 2E 2E 2E      	.byte	$2e,$95,$2e,$93,$94,$2e,$2e,$2e
                                         
   9454 00D108 98 7F 92 2E 91 90 1B AF      	.byte	$98,$7f,$92,$2e,$91,$90,$1b,$af
                                         
   9455 00D110 AB 2E 97 2E 2E 96 AE 2E      	.byte	$ab,$2e,$97,$2e,$2e,$96,$ae,$2e
                                         
                                           
   9457 00D118 2E 2E 2E A7 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$a7,$2e,$2e,$2e,$2e
                                         
   9458 00D120 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9459 00D128 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9460 00D130 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9461 00D138 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9462 00D140 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9463 00D148 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9464 00D150 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9465 00D158 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9466 00D160 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9467 00D168 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9468 00D170 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9469 00D178 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9470 00D180 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9471 00D188 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9472 00D190 2E 2E FA 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$fa,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9474 00D198                             shiftedScanCodes:
   9475 00D198 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9476 00D1A0 2E 2E 2E 2E 2E 09 7E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$09,$7e,$2e
                                         
   9477 00D1A8 2E 2E 2E 2E 2E 51 21 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$51,$21,$2e
                                         
   9478 00D1B0 2E 2E 5A 53 41 57 40 2E      	.byte	$2e,$2e,$5a,$53,$41,$57,$40,$2e
                                         
   9479 00D1B8 2E 43 58 44 45 24 23 2E      	.byte	$2e,$43,$58,$44,$45,$24,$23,$2e
                                         
   9480 00D1C0 2E 20 56 46 54 52 25 2E      	.byte	$2e,$20,$56,$46,$54,$52,$25,$2e
                                         
   9481 00D1C8 2E 4E 42 48 47 59 5E 2E      	.byte	$2e,$4e,$42,$48,$47,$59,$5e,$2e
                                         
   9482 00D1D0 2E 2E 4D 4A 55 26 2A 2E      	.byte	$2e,$2e,$4d,$4a,$55,$26,$2a,$2e
                                         
   9483 00D1D8 2E 3C 4B 49 4F 29 28 2E      	.byte	$2e,$3c,$4b,$49,$4f,$29,$28,$2e
                                         
   9484 00D1E0 2E 3E 3F 4C 3A 50 5F 2E      	.byte	$2e,$3e,$3f,$4c,$3a,$50,$5f,$2e
                                         
   9485 00D1E8 2E 2E 22 2E 7B 2B 2E 2E      	.byte	$2e,$2e,$22,$2e,$7b,$2b,$2e,$2e
                                         
   9486 00D1F0 2E 2E 0D 7D 2E 7C 2E 2E      	.byte	$2e,$2e,$0d,$7d,$2e,$7c,$2e,$2e
                                         
   9487 00D1F8 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9488 00D200 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9489 00D208 2E 7F 2E 2E 2E 2E 1B 2E      	.byte	$2e,$7f,$2e,$2e,$2e,$2e,$1b,$2e
                                         
   9490 00D210 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9492 00D218 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9493 00D220 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9494 00D228 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9495 00D230 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9496 00D238 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9497 00D240 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9498 00D248 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9499 00D250 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9500 00D258 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9501 00D260 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9502 00D268 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9503 00D270 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9504 00D278 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9505 00D280 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9506 00D288 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9507 00D290 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
                                           ; control
   9510 00D298                             keybdControlCodes:
   9511 00D298 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9512 00D2A0 2E 2E 2E 2E 2E 09 7E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$09,$7e,$2e
                                         
   9513 00D2A8 2E 2E 2E 2E 2E 11 21 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$11,$21,$2e
                                         
   9514 00D2B0 2E 2E 1A 13 01 17 40 2E      	.byte	$2e,$2e,$1a,$13,$01,$17,$40,$2e
                                         
   9515 00D2B8 2E 03 18 04 05 24 23 2E      	.byte	$2e,$03,$18,$04,$05,$24,$23,$2e
                                         
   9516 00D2C0 2E 20 16 06 14 12 25 2E      	.byte	$2e,$20,$16,$06,$14,$12,$25,$2e
                                         
   9517 00D2C8 2E 0E 02 08 07 19 5E 2E      	.byte	$2e,$0e,$02,$08,$07,$19,$5e,$2e
                                         
   9518 00D2D0 2E 2E 0D 0A 15 26 2A 2E      	.byte	$2e,$2e,$0d,$0a,$15,$26,$2a,$2e
                                         
   9519 00D2D8 2E 3C 0B 09 0F 29 28 2E      	.byte	$2e,$3c,$0b,$09,$0f,$29,$28,$2e
                                         
   9520 00D2E0 2E 3E 3F 0C 3A 10 5F 2E      	.byte	$2e,$3e,$3f,$0c,$3a,$10,$5f,$2e
                                         
   9521 00D2E8 2E 2E 22 2E 7B 2B 2E 2E      	.byte	$2e,$2e,$22,$2e,$7b,$2b,$2e,$2e
                                         
   9522 00D2F0 2E 2E 0D 7D 2E 7C 2E 2E      	.byte	$2e,$2e,$0d,$7d,$2e,$7c,$2e,$2e
                                         
   9523 00D2F8 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9524 00D300 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9525 00D308 2E 7F 2E 2E 2E 2E 1B 2E      	.byte	$2e,$7f,$2e,$2e,$2e,$2e,$1b,$2e
                                         
   9526 00D310 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9528 00D318                             keybdExtendedCodes:
   9529 00D318 2E 2E 2E 2E A3 A1 A2 2E      	.byte	$2e,$2e,$2e,$2e,$a3,$a1,$a2,$2e
                                         
   9530 00D320 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9531 00D328 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9532 00D330 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9533 00D338 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9534 00D340 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9535 00D348 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9536 00D350 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9537 00D358 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9538 00D360 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9539 00D368 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9540 00D370 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9541 00D378 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9542 00D380 2E 95 2E 93 94 2E 2E 2E      	.byte	$2e,$95,$2e,$93,$94,$2e,$2e,$2e
                                         
   9543 00D388 98 99 92 2E 91 90 2E 2E      	.byte	$98,$99,$92,$2e,$91,$90,$2e,$2e
                                         
   9544 00D390 2E 2E 97 2E 2E 96 2E 2E      	.byte	$2e,$2e,$97,$2e,$2e,$96,$2e,$2e
                                         
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; SPI MASTER driver
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ; spi_master_init
                                           ; Initialize the spi master controller
                                           
   9555 00D398                             spi_master_init:
   9556 00D398 08                           	
   9557 00D399 E2 20                        	SEP		#$20
                                           	MEM		8
   9559 00D39B A9 01                        	LDA		#SPI_INIT_SD
   9560 00D39D 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9561 00D3A1 A9 01                        	LDA		#SPI_TRANS_START
   9562 00D3A3 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9563 00D3A7                             .0001:
   9564 00D3A7 AD A3 D3                     	LDA		SPI_TRANS_STS_REG		; wait for SPI transfer to complete
   9565 00D3AA C9 01                        	CMP		#SPI_TRANS_BUSY
   9566 00D3AC F0 F9                        	BEQ		.0001
   9567 00D3AE AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9568 00D3B2 29 03                        	AND		#3	; INIT errors
   9569 00D3B4 C9 00                        	CMP		#SPI_INIT_NO_ERROR
   9570 00D3B6 F0 0E                        	BEQ		.0004
   9571 00D3B8 28                           	PLP
                                           	MEM		16
                                           	NDX		16
   9574 00D3B9 F4 01 00                     	PEA		1
   9575 00D3BC F4 B6 D4                     	PEA		msgSpiInitError
   9576 00D3BF 20 D3 CB                     	JSR		DisplayString
   9577 00D3C2 A9 01 00                     	LDA		#1
   9578 00D3C5 60                           	RTS
   9579 00D3C6                             .0004:
   9580 00D3C6 28                           	PLP
                                           	;PEA		1
                                           	;PEA		msgSpiInited
                                           	;JSR		DisplayString
   9584 00D3C7 A9 00 00                     	LDA		#0
   9585 00D3CA 60                           	RTS
                                           
                                           ; spi_master_read
                                           ; read a block from the SD card
                                           ;
                                           ; Parameters:
                                           ;	32 bit buffer address pushed onto stack
                                           ;	32 bit block number pushed onto stack
                                           ;
   9594 00D3CB                             spi_master_read:
   9595 00D3CB 08                           	PHP
   9596 00D3CC E2 20                        	SEP		#$20
                                           	MEM		8
                                           	NDX		16
   9599 00D3CE BA                           	TSX
   9600 00D3CF B5 04                        	LDA		4,X
   9601 00D3D1 8F 07 C0 FE                  	STA		SPI_SD_SECT_7_0_REG
   9602 00D3D5 B5 05                        	LDA		5,X
   9603 00D3D7 8F 08 C0 FE                  	STA		SPI_SD_SECT_15_8_REG
   9604 00D3DB B5 06                        	LDA		6,X
   9605 00D3DD 8F 09 C0 FE                  	STA		SPI_SD_SECT_23_16_REG
   9606 00D3E1 B5 07                        	LDA		7,X
   9607 00D3E3 8F 0A C0 FE                  	STA		SPI_SD_SECT_31_24_REG
   9608 00D3E7 B5 08                        	LDA		8,X
   9609 00D3E9 85 C8                        	STA		bufptr
   9610 00D3EB B5 09                        	LDA		9,X
   9611 00D3ED 85 C9                        	STA		bufptr+1
   9612 00D3EF B5 0A                        	LDA		10,X
   9613 00D3F1 85 CA                        	STA		bufptr+2
   9614 00D3F3 B5 0B                        	LDA		11,X
   9615 00D3F5 85 CB                        	STA		bufptr+3
   9616 00D3F7 A9 02                        	LDA		#SPI_RW_READ_SD_BLOCK
   9617 00D3F9 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9618 00D3FD A9 01                        	LDA		#SPI_TRANS_START
   9619 00D3FF 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9620 00D403                             .0001:
   9621 00D403 AD A3 D3                     	LDA		SPI_TRANS_STS_REG		; wait for SPI transfer to complete
   9622 00D406 C9 01                        	CMP		#SPI_TRANS_BUSY
   9623 00D408 F0 F9                        	BEQ		.0001
   9624 00D40A AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9625 00D40E 4A                           	LSR
   9626 00D40F 4A                           	LSR
   9627 00D410 29 03                        	AND		#3	; INIT errors
   9628 00D412 C9 00                        	CMP		#SPI_READ_NO_ERROR
   9629 00D414 F0 10                        	BEQ		.0004
   9630 00D416 28                           	PLP
                                           	MEM		16
   9632 00D417 F4 01 00                     	PEA		1
   9633 00D41A F4 EA D4                     	PEA		msgSpiReadError
   9634 00D41D 20 D3 CB                     	JSR		DisplayString
   9635 00D420 A9 01 00                     	LDA		#1
   9636 00D423 42 C0 08                     	RTS		#8
   9637 00D426                             .0004:
   9638 00D426 C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9641 00D428 A2 00 02                     	LDX		#512
   9642 00D42B A0 00 00                     	LDY		#0
   9643 00D42E                             .0003:
                                           	;TXA
                                           	;AND		#$0F
                                           	;BNE		.0002
                                           	;PLP
                                           	;JSR		OutCRLF
                                           	;PHP
                                           	;SEP		#$20
   9651 00D42E                             .0002:
   9652 00D42E AF 10 C0 FE                  	LDA		SPI_RX_FIFO_DATA_REG
   9653 00D432 42 97 C8                     	STA		{bufptr},Y
   9654 00D435 C8                           	INY
                                           	;PLP
                                           	;JSR		DispByte
                                           	;JSR		space
                                           	;PHP
   9659 00D436 E2 20                        	SEP		#$20
   9660 00D438 CA                           	DEX
   9661 00D439 D0 F3                        	BNE		.0003
   9662 00D43B 28                           	PLP
                                           	;JSR		OutCRLF
                                           	MEM		16
                                           	NDX		16
   9666 00D43C A9 00 00                     	LDA		#0
   9667 00D43F 42 C0 08                     	RTS		#8
                                           
   9669 00D442                             spi_master_write:
   9670 00D442 08                           	PHP
   9671 00D443 E2 20                        	SEP		#$20
                                           	MEM		8
                                           	NDX		16
                                           
   9675 00D445 BA                           	TSX
   9676 00D446 B5 08                        	LDA		8,X
   9677 00D448 85 C8                        	STA		bufptr
   9678 00D44A B5 09                        	LDA		9,X
   9679 00D44C 85 C9                        	STA		bufptr+1
   9680 00D44E B5 0A                        	LDA		10,X
   9681 00D450 85 CA                        	STA		bufptr+2
   9682 00D452 B5 0B                        	LDA		11,X
   9683 00D454 85 CB                        	STA		bufptr+3
                                           
   9685 00D456 A0 00 00                     	LDY		#0
   9686 00D459                             .0001:
   9687 00D459 42 B7 C8                     	LDA		{bufptr},Y
   9688 00D45C 8F 20 C0 FE                  	STA		SPI_TX_FIFO_DATA_REG
   9689 00D460 C8                           	INY
   9690 00D461 C0 00 02                     	CPY		#512
   9691 00D464 D0 F3                        	BNE		.0001
                                           
   9693 00D466 B5 04                        	LDA		4,X
   9694 00D468 8F 07 C0 FE                  	STA		SPI_SD_SECT_7_0_REG
   9695 00D46C B5 05                        	LDA		5,X
   9696 00D46E 8F 08 C0 FE                  	STA		SPI_SD_SECT_15_8_REG
   9697 00D472 B5 06                        	LDA		6,X
   9698 00D474 8F 09 C0 FE                  	STA		SPI_SD_SECT_23_16_REG
   9699 00D478 B5 07                        	LDA		7,X
   9700 00D47A 8F 0A C0 FE                  	STA		SPI_SD_SECT_31_24_REG
                                           
   9702 00D47E A9 03                        	LDA		#SPI_RW_WRITE_SD_BLOCK
   9703 00D480 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9704 00D484 A9 01                        	LDA		#SPI_TRANS_START
   9705 00D486 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9706 00D48A                             .0002:
   9707 00D48A AD A3 D3                     	LDA		SPI_TRANS_STS_REG		; wait for SPI transfer to complete
   9708 00D48D C9 01                        	CMP		#SPI_TRANS_BUSY
   9709 00D48F F0 F9                        	BEQ		.0002
   9710 00D491 AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9711 00D495 4A                           	LSR
   9712 00D496 4A                           	LSR
   9713 00D497 4A                           	LSR
   9714 00D498 4A                           	LSR
   9715 00D499 29 03                        	AND		#3	; write errors
   9716 00D49B C9 00                        	CMP		#SPI_WRITE_NO_ERROR
   9717 00D49D F0 10                        	BEQ		.0004
   9718 00D49F 28                           	PLP
                                           	MEM		16
   9720 00D4A0 F4 01 00                     	PEA		1
   9721 00D4A3 F4 FB D4                     	PEA		msgSpiWriteError
   9722 00D4A6 20 D3 CB                     	JSR		DisplayString
   9723 00D4A9 A9 01 00                     	LDA		#1
   9724 00D4AC 42 C0 08                     	RTS		#8
   9725 00D4AF                             .0004:
   9726 00D4AF 28                           	PLP
   9727 00D4B0 A9 00 00                     	LDA		#0
   9728 00D4B3 42 C0 08                     	RTS		#8
                                           
   9730 00D4B6                             msgSpiInitError:
   9731 00D4B6 45 72 72 6F 72 20 69 6E      .byte	"Error initializing SPI master",$0D,$0A,$00
   9731 00D4BE 69 74 69 61 6C 69 7A 69    
   9731 00D4C6 6E 67 20 53 50 49 20 6D    
   9731 00D4CE 61 73 74 65 72 0D 0A 00    
                                         
   9732 00D4D6                             msgSpiInited:
   9733 00D4D6 53 50 49 20 6D 61 73 74      .byte	"SPI master inited",$0D,$0A,$00
   9733 00D4DE 65 72 20 69 6E 69 74 65    
   9733 00D4E6 64 0D 0A 00                
   9734 00D4EA                             msgSpiReadError:
   9735 00D4EA 53 50 49 20 72 65 61 64      .byte	"SPI read error",$0D,$0A,$00
   9735 00D4F2 20 65 72 72 6F 72 0D 0A    
   9735 00D4FA 00                         
   9736 00D4FB                             msgSpiWriteError:
   9737 00D4FB 53 50 49 20 77 72 69 74      .byte	"SPI write error",$0D,$0A,$00
   9737 00D503 65 20 65 72 72 6F 72 0D    
   9737 00D50B 0A 00                      
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; RTC driver for MCP7941x
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
   9745 00D50D                             rtc_init:
   9746 00D50D A9 35 00                     		LDA		#53					; constant for 125kHz I2C from 33MHz 
   9747 00D510 8F 00 C1 FE                  		STA		I2C_PRESCALE_LO
   9748 00D514 60                           		RTS
                                           
                                           ; Read all the RTC sram registers into a buffer
                                           
   9752 00D515                             rtc_read:
   9753 00D515 08                           		PHP
   9754 00D516 E2 30                        		SEP		#$30
                                           		MEM		8
                                           		NDX		8
   9757 00D518 A9 80                        		LDA		#$80				; enable I2C
   9758 00D51A 8F 02 C1 FE                  		STA		I2C_CONTROL
   9759 00D51E A9 DE                        		LDA		#$DE				; read address, write op
   9760 00D520 A0 90                        		LDY		#$90				; STA + wr bit
   9761 00D522 20 85 D5                     		JSR		rtc_wr_cmd
   9762 00D525 30 4D                        		BMI		.rxerr
   9763 00D527 A9 00                        		LDA		#$00				; address zero
   9764 00D529 A0 10                        		LDY		#$10				; wr bit
   9765 00D52B 20 85 D5                     		JSR		rtc_wr_cmd
   9766 00D52E 30 44                        		BMI		.rxerr
   9767 00D530 A9 DF                        		LDA		#$DF				; read address, read op
   9768 00D532 A0 90                        		LDY		#$90				; STA + wr bit
   9769 00D534 20 85 D5                     		JSR		rtc_wr_cmd
   9770 00D537 30 3B                        		BMI		.rxerr
   9771 00D539 A2 00                        		LDX		#0
   9772 00D53B                             .0001:
   9773 00D53B A9 20                        		LDA		#$20				; rd bit
   9774 00D53D 8F 04 C1 FE                  		STA		I2C_CMD
   9775 00D541 20 7C D5                     		JSR		rtc_wait_tip
   9776 00D544 AF 04 C1 FE                  		LDA		I2C_STAT
   9777 00D548 30 2A                        		BMI		.rxerr
   9778 00D54A AF 03 C1 FE                  		LDA		I2C_RX
   9779 00D54E 9D 00 03                     		STA		RTCBuf,X
   9780 00D551 E8                           		INX
   9781 00D552 E0 5F                        		CPX		#$5F
   9782 00D554 D0 E5                        		BNE		.0001
   9783 00D556 A9 68                        		LDA		#$68				; STO, rd bit + nack
   9784 00D558 8F 04 C1 FE                  		STA		I2C_CMD
   9785 00D55C 20 7C D5                     		JSR		rtc_wait_tip
   9786 00D55F AF 04 C1 FE                  		LDA		I2C_STAT
   9787 00D563 30 0F                        		BMI		.rxerr
   9788 00D565 AF 03 C1 FE                  		LDA		I2C_RX
   9789 00D569 9D 00 03                     		STA		RTCBuf,X
   9790 00D56C A9 00                        		LDA		#0					; disable I2C and return 0
   9791 00D56E 8F 02 C1 FE                  		STA		I2C_CONTROL
   9792 00D572 28                           		PLP
   9793 00D573 60                           		RTS
   9794 00D574                             .rxerr:
   9795 00D574 42 9C 02 C1 FE 00            		STZ		I2C_CONTROL			; disable I2C and return status
   9796 00D57A 28                           		PLP
   9797 00D57B 60                           		RTS
                                           
   9799 00D57C                             rtc_wait_tip:
   9800 00D57C                             .0001:
   9801 00D57C AF 04 C1 FE                  		LDA		I2C_STAT
   9802 00D580 29 04                        		AND		#$4					; transmit in progress bit
   9803 00D582 D0 F8                        		BNE		.0001
   9804 00D584 60                           		RTS
                                           
   9806 00D585                             rtc_wr_cmd:
   9807 00D585 8F 03 C1 FE                  		STA		I2C_TX
   9808 00D589 42 8C 04 C1 FE 00            		STY		I2C_CMD
   9809 00D58F 20 7C D5                     		JSR		rtc_wait_tip
   9810 00D592 AF 04 C1 FE                  		LDA		I2C_STAT
   9811 00D596 60                           		RTS
                                           
   9813 00D597                             rtc_write:
   9814 00D597 08                           		PHP
   9815 00D598 E2 30                        		SEP		#$30
                                           		MEM		8
                                           		NDX		8
   9818 00D59A A9 80                        		LDA		#$80				; enable I2C
   9819 00D59C 8F 02 C1 FE                  		STA		I2C_CONTROL
   9820 00D5A0 A9 DE                        		LDA		#$DE				; read address, write op
   9821 00D5A2 A0 90                        		LDY		#$90				; STA + wr bit
   9822 00D5A4 20 85 D5                     		JSR		rtc_wr_cmd
   9823 00D5A7 30 2C                        		BMI		.rxerr
   9824 00D5A9 A9 00                        		LDA		#$00				; address zero
   9825 00D5AB A0 10                        		LDY		#$10				; wr bit
   9826 00D5AD 20 85 D5                     		JSR		rtc_wr_cmd
   9827 00D5B0 30 23                        		BMI		.rxerr
   9828 00D5B2 A2 00                        		LDX		#0
   9829 00D5B4                             .0001:
   9830 00D5B4 BD 00 03                     		LDA		RTCBuf,X
   9831 00D5B7 A0 10                        		LDY		#$10
   9832 00D5B9 20 85 D5                     		JSR		rtc_wr_cmd
   9833 00D5BC 30 17                        		BMI		.rxerr
   9834 00D5BE E8                           		INX
   9835 00D5BF E0 5F                        		CPX		#$5F
   9836 00D5C1 D0 F1                        		BNE		.0001
   9837 00D5C3 BD 00 03                     		LDA		RTCBuf,X
   9838 00D5C6 A0 50                        		LDY		#$50				; STO, wr bit
   9839 00D5C8 20 85 D5                     		JSR		rtc_wr_cmd
   9840 00D5CB 30 08                        		BMI		.rxerr
   9841 00D5CD A9 00                        		LDA		#0					; disable I2C and return 0
   9842 00D5CF 8F 02 C1 FE                  		STA		I2C_CONTROL
   9843 00D5D3 28                           		PLP
   9844 00D5D4 60                           		RTS
   9845 00D5D5                             .rxerr:
   9846 00D5D5 42 9C 02 C1 FE 00            		STZ		I2C_CONTROL			; disable I2C and return status
   9847 00D5DB 28                           		PLP
   9848 00D5DC 60                           		RTS
                                           
   9850 00D5DD                             msgRtcReadFail:
   9851 00D5DD 52 54 43 20 72 65 61 64      	.byte	"RTC read/write failed.",$0D,$0A,$00
   9851 00D5E5 2F 77 72 69 74 65 20 66    
   9851 00D5ED 61 69 6C 65 64 2E 0D 0A    
   9851 00D5F5 00                         
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ; Get char routine for Supermon
                                           ; This routine might be called with 8 bit regs.
                                           ;
                                           	MEM		16
                                           	NDX		16
   9863 00D5F6                             SuperGetch:
   9864 00D5F6 20 1E CF                     	JSR		KeybdGetCharNoWait
   9865 00D5F9 29 FF 00                     	AND		#$FF
   9866 00D5FC 42 40 00                     	RTC		#0
   9867 00D5FF 82 79 EB                     	BRL		TaskFC
                                           
                                           ; Put char routine for Supermon
                                           ;
   9871 00D602                             SuperPutch:
   9872 00D602 20 C4 CB                     	JSR		OutChar
   9873 00D605 42 40 00                     	RTC		#0
   9874 00D608 82 70 EB                     	BRL		TaskFC
                                           
                                           ; Char get routine for BASIC
                                           ; Same thing as for Supermon, except carry flag needs to be inverted
                                           ; This routine should be called from a different context than the BIOS,
                                           ; otherwise the call will be ignored.
                                           ;
   9881 00D60B                             BasicGetch:
   9882 00D60B A9 F1 00                     	LDA		#$F1
   9883 00D60E 8D 00 70                     	STA		$7000
   9884 00D611 20 1E CF                     	JSR		KeybdGetCharNoWait
   9885 00D614 29 FF 00                     	AND		#$FF
   9886 00D617 42 18                        	CMC
   9887 00D619 42 40 00                     	RTC		#0
   9888 00D61C 82 5C EB                     	BRL		TaskFC
                                           
   9890 00D61F                             xitBasic:
   9891 00D61F FA                           	PLX						; get rid of task to return to, we won't be returning
   9892 00D620 85 C0                        	STA		ExitCode
   9893 00D622 64 34                        	STZ		TCB_status+7	; no longer ready
   9894 00D624 64 CE                        	STZ		IOFocusTask
   9895 00D626 64 CF                        	STZ		IOFocusTask+1
   9896 00D628 42 CB 42 A2 00 00            	TSK		JMP:#0
   9897 00D62E 82 4A EB                     	BRL		TaskFC
                                           
   9899 00D631                             warm_start:
   9900 00D631 42 E2 00 01                  	SEP		#$100		; 16 bit mode
   9901 00D635 C2 30                        	REP		#$30		; 16 bit MEM,NDX
                                           	MEM		16
                                           	NDX		16
   9904 00D637 A9 FF 3F                     	LDA		#$3FFF
   9905 00D63A 1B                           	TAS
   9906 00D63B 20 27 CC                     	JSR		CursorOn
   9907 00D63E 82 59 EB                     	BRL		Mon1
                                           
                                           	cpu		FT832
   9910 00D641                             ICacheIL832:
   9911 00D641 42 E0 01                     	CACHE	#1			; 1= invalidate instruction line identified by accumulator
   9912 00D644 60                           	RTS
                                           
                                           ;============================================================================
                                           ; Multi-tasking kernel
                                           ;============================================================================
                                           
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:36 2017     Page 1
FMTKmsg.asm

                                           ; ============================================================================
                                           ; FMTKmsg.asm
                                           ;        __
                                           ;   \\__/ o\    (C) 2017  Robert Finch, Waterloo
                                           ;    \  __ /    All rights reserved.
                                           ;     \/_//     robfinch<remove>@finitron.ca
                                           ;       ||
                                           ;  
                                           ;
                                           ; This source file is free software: you can redistribute it and/or modify 
                                           ; it under the terms of the GNU Lesser General Public License as published 
                                           ; by the Free Software Foundation, either version 3 of the License, or     
                                           ; (at your option) any later version.                                      
                                           ;                                                                          
                                           ; This source file is distributed in the hope that it will be useful,      
                                           ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                           ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                           ; GNU General Public License for more details.                             
                                           ;                                                                          
                                           ; You should have received a copy of the GNU General Public License        
                                           ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                           ;                   
                                           ;
                                           ; Messaging Primitives for FMTK                                                       
                                           ; ============================================================================
                                           ;
                                           
                                           		CPU		FT832
                                           		MEM		32
                                           		NDX		32
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Handle to address conversion functions.
                                           ;----------------------------------------------------------------------------
                                           
   9954 00D645                             hJcbToAddr:
   9955 00D645 48                           		PHA
   9956 00D646 A2 00 04 00 00               		LDX		#JCB_SIZE
   9957 00D64B 42 2A                        		MUL
   9958 00D64D 18                           		CLC
   9959 00D64E 69 00 80 02 00               		ADC		#jcbs
   9960 00D653 FA                           		PLX
   9961 00D654 60                           		RTS
                                           
   9963 00D655                             hTcbToAddr:
   9964 00D655 DA                           		PHX
   9965 00D656 A2 40 00 00 00               		LDX		#TCB_SIZE
   9966 00D65B 42 2A                        		MUL
   9967 00D65D 18                           		CLC
   9968 00D65E 69 00 00 02 00               		ADC		#tcbs
   9969 00D663 FA                           		PLX
   9970 00D664 60                           		RTS
                                           
   9972 00D665                             hMbxToAddr:
   9973 00D665 DA                           		PHX
   9974 00D666 A2 18 00 00 00               		LDX		#MBX_SIZE
   9975 00D66B 42 2A                        		MUL
   9976 00D66D 18                           		CLC
   9977 00D66E 69 00 80 03 00               		ADC		#mailboxes
   9978 00D673 FA                           		PLX
   9979 00D674 60                           		RTS
                                           
   9981 00D675                             hMsgToAddr:
   9982 00D675 DA                           		PHX
   9983 00D676 A2 14 00 00 00               		LDX		#MSG_SIZE
   9984 00D67B 42 2A                        		MUL
   9985 00D67D 18                           		CLC
   9986 00D67E 69 00 E0 03 00               		ADC		#messages
   9987 00D683 FA                           		PLX
   9988 00D684 60                           		RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; QueueMsg
                                           ;	Queue a message at a mailbox
                                           ; Parameters:
                                           ;	.A	mailbox handle
                                           ;	.X  message handle
                                           ;----------------------------------------------------------------------------
                                           ;
   9998 00D685                             QueueMsg:
   9999 00D685 42 AB 86 94                  		STX.H	reg_x
  10000 00D689 42 AB 85 90                  		STA.H	reg_a
  10001 00D68D 20 65 D6                     		JSR		hMbxToAddr
  10002 00D690 AA                           		TAX
  10003 00D691 42 AB F6 0E                  		INC.H	MBX_mq_count,X	; increment queued messages count
  10004 00D695 42 BB B5 08                  		LDA.UH	MBX_mq_tail,X	; if (mailboxes[hMbx]->mq_tail >= 0)
  10005 00D699 30 0E                        		BMI		.0001			; branch if no messages queued
  10006 00D69B 20 75 D6                     		JSR		hMsgToAddr
  10007 00D69E AA                           		TAX
  10008 00D69F 42 BB A5 94                  		LDA.UH	reg_x			; .A = message handle
  10009 00D6A3 42 AB 95 10                  		STA.H	MSG_link,X		; message[mailbox[hMbx]->mq_tail].link = hMsg
  10010 00D6A7 80 10                        		BRA		.0002
  10011 00D6A9                             .0001:							; else
  10012 00D6A9 42 AB A5 90                  		LDA.H	reg_a			;	.A = mailbox handle
  10013 00D6AD 20 65 D6                     		JSR		hMbxToAddr
  10014 00D6B0 AA                           		TAX
  10015 00D6B1 42 BB A5 94                  		LDA.UH	reg_x
  10016 00D6B5 42 AB 95 06                  		STA.H	MBX_mq_head,X	; mailbox[hMbx].mq_head = hMsg
  10017 00D6B9                             .0002:
  10018 00D6B9 42 BB A5 90                  		LDA.UH	reg_a			; .A = mailbox handle
  10019 00D6BD 20 65 D6                     		JSR		hMbxToAddr
  10020 00D6C0 AA                           		TAX						; .X = index into mailboxes array
  10021 00D6C1 42 BB A5 94                  		LDA.UH	reg_x			; .A = message handle
  10022 00D6C5 42 AB 95 08                  		STA.H	MBX_mq_tail,X	; mailbox[hMbx]->mq_tail = hMsg
  10023 00D6C9 20 75 D6                     		JSR		hMsgToAddr
  10024 00D6CC AA                           		TAX
  10025 00D6CD A9 FF FF FF FF               		LDA		#$FFFFFFFF
  10026 00D6D2 42 AB 95 10                  		STA.H	MSG_link,X		; message[hMsg]->link = -1
  10027 00D6D6 60                           		RTS		
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Dequeue message from mailbox
                                           ;
                                           ; Assumes:
                                           ;	Mailbox parameter is valid
                                           ;	System semaphore is locked already
                                           ; Parameters:
                                           ;	.A = mailbox number
                                           ; Returns:
                                           ;	.A = -1 if no messages available
                                           ;	.A = handle of message
                                           ;----------------------------------------------------------------------------
                                           ;
  10042 00D6D7                             DequeueMsg:
  10043 00D6D7 20 65 D6                     	JSR		hMbxToAddr
  10044 00D6DA AA                           	TAX
  10045 00D6DB 42 BB B5 0E                  	LDA.UH	MBX_mq_count,X	; if (mbx->mq_count)
  10046 00D6DF F0 2A                        	BEQ		.noMessage
  10047 00D6E1 42 AB D6 0E                  	DEC.H	MBX_mq_count,X	; mbx->mq_count--;
  10048 00D6E5 42 BB B5 06                  	LDA.UH	MBX_mq_head,X	; .A = message handle
  10049 00D6E9 30 20                        	BMI		.noMessage
  10050 00D6EB 20 75 D6                     	JSR		hMsgToAddr
  10051 00D6EE 48                           	PHA
  10052 00D6EF A8                           	TAY
  10053 00D6F0 42 AB B9 10 00               	LDA.H	MSG_link,Y
  10054 00D6F5 42 AB 95 06                  	STA.H	MBX_mq_head,X
  10055 00D6F9 10 09                        	BPL		.0001
  10056 00D6FB A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10057 00D700 42 AB 95 08                  	STA.H	MBX_mq_tail,X
  10058 00D704                             .0001:
  10059 00D704 68                           	PLA
  10060 00D705 42 AB 99 10 00               	STA.H	MSG_link,Y		; tmpmsg->link = hm
  10061 00D70A 60                           	RTS						; return hm
  10062 00D70B                             .noMessage:
  10063 00D70B A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10064 00D710 60                           	RTS
                                           
                                           
                                           ;----------------------------------------------------------------------------
                                           ;		Dequeues a thread from a mailbox. The thread will also
                                           ;	be removed from the timeout list (if it's present there),
                                           ;	and	the timeout list will be adjusted accordingly.
                                           ;
                                           ;	.A = handle to mailbox
                                           ; Returns:
                                           ;	.A = handle to thread (-1 if none available)
                                           ;----------------------------------------------------------------------------
                                           
  10077 00D711                             DequeueThreadFromMbx:
  10078 00D711 20 0C D7                     	JSR		LockSysSema
  10079 00D714 20 65 D6                     	JSR		hMbxToAddr
  10080 00D717 AA                           	TAX
  10081 00D718 42 AB B5 02                  	LDA.H	MBX_tq_head,X
  10082 00D71C 10 09                        	BPL		.0001
  10083 00D71E 20 19 D7                     	JSR		UnlockSysSema
  10084 00D721 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10085 00D726 60                           	RTS						; return .A < 0
  10086 00D727                             .0001:
  10087 00D727 42 AB D6 0C                  	DEC.H	MBX_tq_count,X
  10088 00D72B 42 BB B5 02                  	LDA.UH	MBX_tq_head,X
  10089 00D72F 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10090 00D735 20 55 D6                     	JSR		hTcbToAddr
  10091 00D738 A8                           	TAY
  10092 00D739 42 AB B9 08 00               	LDA.H	TCB_mbq_next,Y
  10093 00D73E 42 AB 95 02                  	STA.H	MBX_tq_head,X
  10094 00D742 30 0C                        	BMI		.0002
  10095 00D744 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10096 00D749 42 AB 99 0A 00               	STA.H	TCB_mbq_prev,Y
  10097 00D74E 80 09                        	BRA		.0003
  10098 00D750                             .0002:
  10099 00D750 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10100 00D755 42 AB 95 04                  	STA.H	MBX_tq_tail,X
  10101 00D759                             .0003:
  10102 00D759 20 19 D7                     	JSR		UnlockSysSema
  10103 00D75C 42 8B B9 2D 00               	LDA.B	TCB_status,Y
  10104 00D761 29 5C D7 00 00               	AND		#TS_TIMEOUT
  10105 00D766 F0 17                        	BEQ		.0004
  10106 00D768 42 BB AF 02 20 05            	LDA.UH	hTcbTmp
  10107 00D76E 42 AB 8F 02 C3 FE            	STA.H	TIMEOUT_LIST+2	; which task to remove
  10108 00D774 A9 03 00 00 00               	LDA		#TOL_RMV		; remove command to timeout list
  10109 00D779 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST	; remove the task
  10110 00D77F                             .0004:
  10111 00D77F A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10112 00D784 42 AB 99 0A 00               	STA.H	TCB_mbq_prev,Y
  10113 00D789 42 AB 99 08 00               	STA.H	TCB_mbq_next,Y
  10114 00D78E 42 AB 99 28 00               	STA.H	TCB_hWaitMbx,Y
  10115 00D793 42 AB B9 2D 00               	LDA.H	TCB_status,Y
  10116 00D798 29 FD FF FF FF               	AND		#~TS_WAITMSG
  10117 00D79D 42 AB 99 2D 00               	STA.H	TCB_status,Y
  10118 00D7A2 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10119 00D7A8 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; .A = handle to TCB
                                           ; .X = mailbox
                                           ;----------------------------------------------------------------------------
                                           
  10126 00D7A9                             QueueThreadAtMbx:
  10127 00D7A9 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10128 00D7AF 42 AB 42 8E 04 20 05 00      	STX.H	hMbxTmp
                                         
  10129 00D7B7 20 55 D6                     	JSR		hTcbToAddr
  10130 00D7BA AA                           	TAX
  10131 00D7BB 42 8B B5 2D                  	LDA.B	TCB_status,X
  10132 00D7BF 09 02 00 00 00               	ORA		#TS_WAITMSG
  10133 00D7C4 42 8B 95 2D                  	STA.B	TCB_status,X
  10134 00D7C8 42 AB 42 AE 04 20 05 00      	LDX.H	hMbxTmp
                                         
  10135 00D7D0 42 AB 95 28                  	STA.H	TCB_hWaitMbx,X
  10136 00D7D4 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10137 00D7D9 42 AB 95 08                  	STA.H	TCB_mbq_next,X
  10138 00D7DD 20 0C D7                     	JSR		LockSysSema
  10139 00D7E0 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10140 00D7E6 20 65 D6                     	JSR		hMbxToAddr
  10141 00D7E9 A8                           	TAY
  10142 00D7EA B9 02 00                     	LDA		MBX_tq_head,Y
  10143 00D7ED 10 23                        	BPL		.0001
  10144 00D7EF A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10145 00D7F4 42 AB 95 0A                  	STA.H	TCB_mbq_prev,X
  10146 00D7F8 AF 02 20 05                  	LDA		hTcbTmp
  10147 00D7FC 42 AB 99 02 00               	STA.H	MBX_tq_head,Y
  10148 00D801 42 AB 99 04 00               	STA.H	MBX_tq_tail,Y
  10149 00D806 A9 01 00 00 00               	LDA		#1
  10150 00D80B 42 AB 99 0C 00               	STA.H	MBX_tq_count,Y
  10151 00D810 80 32                        	BRA		.0002
  10152 00D812                             .0001:
  10153 00D812 42 AB B9 04 00               	LDA.H	MBX_tq_tail,Y
  10154 00D817 42 AB 95 0A                  	STA.H	TCB_mbq_prev,X
  10155 00D81B 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10156 00D821 42 AB 99 04 00               	STA.H	MBX_tq_tail,Y
  10157 00D826 42 AB B9 0C 00               	LDA.H	MBX_tq_count,Y
  10158 00D82B 1A                           	INA
  10159 00D82C 42 AB 99 0C 00               	STA.H	MBX_tq_count,Y
  10160 00D831 42 AB B9 04 00               	LDA.H	MBX_tq_tail,Y
  10161 00D836 20 55 D6                     	JSR		hTcbToAddr
  10162 00D839 AA                           	TAX
  10163 00D83A 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10164 00D840 42 AB 95 08                  	STA.H	TCB_mbq_next,X
  10165 00D844                             .0002:
  10166 00D844 20 19 D7                     	JSR		UnlockSysSema
  10167 00D847 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Allocate a mailbox
                                           ;	The default queue strategy is to queue the eight most recent messages.
                                           ; Parameters:
                                           ;	<none>
                                           ; Returns:
                                           ; .A = handle to mailbox (-1 = no mailbox available)
                                           ;----------------------------------------------------------------------------
                                           
  10178 00D848                             FMTK_AllocMbx:
  10179 00D848 20 0C D7                     	JSR		LockSysSema
  10180 00D84B 42 AB AD 46 D8               	LDA.H	freeMBX
  10181 00D850 10 09                        	BPL		.0001
  10182 00D852 20 19 D7                     	JSR		UnlockSysSema
  10183 00D855 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10184 00D85A 60                           	RTS
  10185 00D85B                             .0001:
  10186 00D85B 48                           	PHA
  10187 00D85C 20 65 D6                     	JSR		hMbxToAddr
  10188 00D85F AA                           	TAX
  10189 00D860 42 AB B5 00                  	LDA.H	MBX_link,X
  10190 00D864 42 AB 8D 46 D8               	STA.H	freeMBX
  10191 00D869 42 AB CE 63 D8               	DEC.H	nMailbox
  10192 00D86E 20 19 D7                     	JSR		UnlockSysSema
  10193 00D871 20 6A D8                     	JSR		GetJCB
  10194 00D874 42 AB 95 01                  	STA.H	MBX_owner,X
  10195 00D878 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10196 00D87D 42 AB 95 02                  	STA.H	MBX_tq_head,X
  10197 00D881 42 AB 95 04                  	STA.H	MBX_tq_tail,X
  10198 00D885 42 AB 95 06                  	STA.H	MBX_mq_head,X
  10199 00D889 42 AB 95 08                  	STA.H	MBX_mq_tail,X
  10200 00D88D 42 AB 74 0C                  	STZ.H	MBX_tq_count,X
  10201 00D891 42 AB 74 0E                  	STZ.H	MBX_mq_count,X
  10202 00D895 42 AB 74 12                  	STZ.H	MBX_mq_missed,X
  10203 00D899 A9 08 00 00 00               	LDA		#8
  10204 00D89E 42 AB 95 10                  	STA.H	MBX_mq_size,X
  10205 00D8A2 A9 00 00 00 00               	LDA		#MQS_NEWEST
  10206 00D8A7 95 14                        	STA		MBX_mq_strategy,X
  10207 00D8A9 68                           	PLA
  10208 00D8AA 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; SendMsg
                                           ;
                                           ; Parameters:
                                           ;	.A = mailbox handle
                                           ;	D1  (on stack word)
                                           ;	D2  (on stack word)
                                           ;	D3	(on stack word)
                                           ;----------------------------------------------------------------------------
                                           
  10220 00D8AB                             FMTK_SendMsg:
  10221 00D8AB                             FMTK_PostMsg:
  10222 00D8AB 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10223 00D8B1 20 65 D6                     	JSR		hMbxToAddr
  10224 00D8B4 20 0C D7                     	JSR		LockSysSema
  10225 00D8B7 B5 01                        	LDA		MBX_owner,X
  10226 00D8B9 30 07                        	BMI		.notOwned
  10227 00D8BB C9 00 04 00 00               	CMP		#NR_MBX
  10228 00D8C0 30 0B                        	BLT		.ownerOk
  10229 00D8C2                             .notOwned:
  10230 00D8C2 20 19 D7                     	JSR		UnlockSysSema
  10231 00D8C5 A9 BE D8 00 00               	LDA		#E_NotAlloc
  10232 00D8CA 42 C0 0C                     	RTS		#12
  10233 00D8CD                             .ownerOk:
  10234 00D8CD 42 AB AD C6 D8               	LDA.H	freeMSG
  10235 00D8D2 30 07                        	BMI		.noMsg
  10236 00D8D4 C9 00 10 00 00               	CMP		#NR_MSG
  10237 00D8D9 30 0B                        	BLT		.msgOk
  10238 00D8DB                             .noMsg:
  10239 00D8DB 20 19 D7                     	JSR		UnlockSysSema
  10240 00D8DE A9 D6 D8 00 00               	LDA		#E_NoMoreMsgBlks
  10241 00D8E3 42 C0 0C                     	RTS		#12
  10242 00D8E6                             .msgOk:
  10243 00D8E6 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10244 00D8EC 20 75 D6                     	JSR		hMsgToAddr
  10245 00D8EF AA                           	TAX
  10246 00D8F0 B5 10                        	LDA		MSG_link,X
  10247 00D8F2 8D C6 D8                     	STA		freeMSG
  10248 00D8F5 CE ED D8                     	DEC		nMsgBlk
  10249 00D8F8 A9 EF D8 00 00               	LDA		#MBT_DATA
  10250 00D8FD 42 8B 95 12                  	STA.B	MSG_type,X
  10251 00D901 9B                           	TXY
  10252 00D902 BA                           	TSX
  10253 00D903 B5 03                        	LDA		3,X
  10254 00D905 99 00 00                     	STA		MSG_d1,Y
  10255 00D908 B5 07                        	LDA		7,X
  10256 00D90A 99 04 00                     	STA		MSG_d2,Y
  10257 00D90D B5 0B                        	LDA		11,X
  10258 00D90F 99 08 00                     	STA		MSG_d3,Y
  10259 00D912 20 11 D7                     	JSR		DequeueThreadFromMbx
  10260 00D915 20 19 D7                     	JSR		UnlockSysSema
  10261 00D918 C9 00 00 00 00               	CMP		#0
  10262 00D91D 10 11                        	BPL		.thrdOk
  10263 00D91F 42 BB AF 04 20 05            	LDA.UH	hMbxTmp
  10264 00D925 42 BB AE C6 D8               	LDX.UH	freeMSG
  10265 00D92A 20 85 D6                     	JSR		QueueMsg
  10266 00D92D 42 C0 0C                     	RTS		#12
  10267 00D930                             .thrdOk:
  10268 00D930 8F 02 20 05                  	STA		hTcbTmp
  10269 00D934 20 0C D7                     	JSR		LockSysSema
  10270 00D937 20 2E D9                     	JSR		hTcbtoAddr
  10271 00D93A 42 8B B9 12 00               	LDA.B	MSG_type,Y
  10272 00D93F 42 8B 95 1E                  	STA.B	TCB_msg_type,X
  10273 00D943 B9 00 00                     	LDA		MSG_d1,Y
  10274 00D946 95 0C                        	STA		TCB_msg_d1,X
  10275 00D948 B9 04 00                     	LDA		MSG_d2,Y
  10276 00D94B 95 10                        	STA		TCB_msg_d2,X
  10277 00D94D B9 08 00                     	LDA		MSG_d3,Y
  10278 00D950 95 14                        	STA		TCB_msg_d3,X
  10279 00D952 A9 01 00 00 00               	LDA		#MT_FREE
  10280 00D957 99 12 00                     	STA		MSG_type,Y
  10281 00D95A 42 AB AD C6 D8               	LDA.H	freeMSG
  10282 00D95F 42 AB 99 10 00               	STA.H	MSG_link,Y
  10283 00D964 AF 06 20 05                  	LDA		hMsgTmp
  10284 00D968 8D C6 D8                     	STA		freeMSG
  10285 00D96B 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10286 00D971 20 55 D6                     	JSR		hTcbToAddr
  10287 00D974 AA                           	TAX
  10288 00D975 42 8B B5 2D                  	LDA.B	TCB_status,X
  10289 00D979 29 5C D7 00 00               	AND		#TS_TIMEOUT
  10290 00D97E F0 17                        	BEQ		.noTimeout
  10291 00D980 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10292 00D986 42 AB 8F 02 C3 FE            	STA.H	TIMEOUT_LIST+2
  10293 00D98C A9 03 00 00 00               	LDA		#TOL_RMV
  10294 00D991 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST
  10295 00D997                             .noTimeout:
  10296 00D997 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10297 00D99D 20 D8 DB                     	JSR		InsertIntoReadyFifo		
  10298 00D9A0 20 19 D7                     	JSR		UnlockSysSema
  10299 00D9A3 A9 9A D9 00 00               	LDA		#E_Ok
  10300 00D9A8 42 C0 0C                     	RTS		#12
                                           
                                           ;----------------------------------------------------------------------------
                                           ;		Wait for message. If timelimit is zero then the thread
                                           ;	will wait indefinately for a message.
                                           ;----------------------------------------------------------------------------
                                           
  10307 00D9AB                             FMTK_WaitMsg:
  10308 00D9AB 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10309 00D9B1 20 65 D6                     	JSR		hMbxToAddr
  10310 00D9B4 20 0C D7                     	JSR		LockSysSema
  10311 00D9B7 B5 01                        	LDA		MBX_owner,X
  10312 00D9B9 30 07                        	BMI		.notOwned
  10313 00D9BB C9 00 04 00 00               	CMP		#NR_MBX
  10314 00D9C0 30 0B                        	BLT		.ownerOk
  10315 00D9C2                             .notOwned:
  10316 00D9C2 20 19 D7                     	JSR		UnlockSysSema
  10317 00D9C5 A9 BE D8 00 00               	LDA		#E_NotAlloc
  10318 00D9CA 42 C0 10                     	RTS		#16
  10319 00D9CD                             .ownerOk:
  10320 00D9CD AF 04 20 05                  	LDA		hMbxTmp
  10321 00D9D1 20 D7 D6                     	JSR		DequeueMsg
  10322 00D9D4 20 19 D7                     	JSR		UnlockSysSema
  10323 00D9D7 C9 00 00 00 00               	CMP		#0
  10324 00D9DC 10 FF 74 00                  	LBPL	.gotMsg
  10325 00D9E0 20 0C D7                     	JSR		LockSysSema
  10326 00D9E3 42 1A                        	TTA
  10327 00D9E5 48                           	PHA
  10328 00D9E6 20 55 D6                     	JSR		hTcbToAddr
  10329 00D9E9 AA                           	TAX
  10330 00D9EA 74 2D                        	STZ		TCB_status,X	; remove thread from ready list
  10331 00D9EC 20 19 D7                     	JSR		UnlockSysSema
  10332 00D9EF 20 A9 D7                     	JSR		QueueThreadAtMbx
  10333 00D9F2 BA                           	TSX
  10334 00D9F3 B5 0F                        	LDA		15,X			; .A = time limit param
  10335 00D9F5 F0 1E                        	BEQ		.noTimelimit
  10336 00D9F7 20 0C D7                     	JSR		LockSysSema
  10337 00D9FA 8F 00 C3 FE                  	STA		TIMEOUT_LIST + 4
  10338 00D9FE 68                           	PLA
  10339 00D9FF 42 AB 8F 00 C3 FE            	STA.H	TIMEOUT_LIST + 2
  10340 00DA05 A9 02 00 00 00               	LDA		#TOL_INS
  10341 00DA0A 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST
  10342 00DA10 20 19 D7                     	JSR		UnlockSysSema
  10343 00DA13 80 01                        	BRA		.0001
  10344 00DA15                             .noTimelimit:
  10345 00DA15 68                           	PLA
  10346 00DA16                             .0001:
  10347 00DA16 00                           	BRK			; invoke scheduler
  10348 00DA17 02                           	.byte	2
                                           	; Control will return here as a result of a SendMsg or timeout
  10350 00DA18 42 1A                        	TTA
  10351 00DA1A 20 55 D6                     	JSR		hTcbToAddr
  10352 00DA1D AA                           	TAX
  10353 00DA1E B5 1E                        	LDA		TCB_msg_type,X
  10354 00DA20 C9 00 00 00 00               	CMP		#MT_NONE
  10355 00DA25 D0 08                        	BNE		.0002
  10356 00DA27 A9 1E DA 00 00               	LDA		#E_NoMsg
  10357 00DA2C 42 C0 10                     	RTS		#16
  10358 00DA2F                             .0002:
  10359 00DA2F A9 00 00 00 00               	LDA		#MT_NONE
  10360 00DA34 42 8B 95 1E                  	STA.B	TCB_msg_type,X
  10361 00DA38 A0 00 00 00 00               	LDY		#0
  10362 00DA3D B5 0C                        	LDA		TCB_msg_d1,X
  10363 00DA3F 42 93 03                     	STA		{3,S},Y
  10364 00DA42 B5 10                        	LDA		TCB_msg_d2,X
  10365 00DA44 42 93 07                     	STA		{7,S},Y
  10366 00DA47 B5 14                        	LDA		TCB_msg_d3,X
  10367 00DA49 42 93 0B                     	STA		{11,S},Y
  10368 00DA4C A9 9A D9 00 00               	LDA		#E_Ok
  10369 00DA51 42 C0 10                     	RTS		#16
                                           	;-----------------------------------------------------
                                           	; We get here if there was initially a message
                                           	; available in the mailbox, or a message was made
                                           	; available after a task switch.
                                           	;-----------------------------------------------------
  10375 00DA54                             .gotMsg:
  10376 00DA54 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10377 00DA5A 20 75 D6                     	JSR		hMsgToAddr
  10378 00DA5D AA                           	TAX
  10379 00DA5E B5 00                        	LDA		MSG_d1,X
  10380 00DA60 A0 00 00 00 00               	LDY		#0
  10381 00DA65 42 93 03                     	STA		{3,S},Y
  10382 00DA68 B5 04                        	LDA		MSG_d2,X
  10383 00DA6A 42 93 07                     	STA		{7,S},Y
  10384 00DA6D B5 08                        	LDA		MSG_d3,X
  10385 00DA6F 42 93 0B                     	STA		{11,S},Y
  10386 00DA72 20 0C D7                     	JSR		LockSysSema
  10387 00DA75 A9 01 00 00 00               	LDA		#MT_FREE
  10388 00DA7A 42 8B 95 12                  	STA.B	MSG_type,X
  10389 00DA7E 42 AB AD C6 D8               	LDA.H	freeMSG
  10390 00DA83 42 AB 95 10                  	STA.H	MSG_link,X
  10391 00DA87 42 AB AF 06 20 05            	LDA.H	hMsgTmp
  10392 00DA8D 42 AB 8D C6 D8               	STA.H	freeMSG
  10393 00DA92 42 AB EE ED D8               	INC.H	nMsgBlk
  10394 00DA97 20 19 D7                     	JSR		UnlockSysSema
  10395 00DA9A A9 9A D9 00 00               	LDA		#E_Ok
  10396 00DA9F 42 C0 10                     	RTS		#16
                                           
                                           ;----------------------------------------------------------------------------
                                           ; FMTK_CheckMsg(hMbx,int *d1, int *d2, int *d3, int qrmv);
                                           ;
                                           ;		Check for message at mailbox. If no message is
                                           ;	available return immediately to the caller (CheckMsg() is
                                           ;	non blocking). Optionally removes the message from the
                                           ;	mailbox.
                                           ;
                                           ; Parameters:
                                           ;	.A = handle to mailbox
                                           ;	d1 = address to store d1 in (word on stack)
                                           ;	d2 = address to store d2 in (word on stack)
                                           ;	d3 = address to store d3 in (word on stack)
                                           ;	qrmv = 1=remove message from queue (word on stack)
                                           ;----------------------------------------------------------------------------
                                           
  10414 00DAA2                             FMTK_CheckMsg:
  10415 00DAA2 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10416 00DAA8 20 65 D6                     	JSR		hMbxToAddr
  10417 00DAAB 20 0C D7                     	JSR		LockSysSema
  10418 00DAAE B5 01                        	LDA		MBX_owner,X
  10419 00DAB0 30 07                        	BMI		.notOwned
  10420 00DAB2 C9 00 04 00 00               	CMP		#NR_MBX
  10421 00DAB7 30 0B                        	BLT		.ownerOk
  10422 00DAB9                             .notOwned:
  10423 00DAB9 20 19 D7                     	JSR		UnlockSysSema
  10424 00DABC A9 BE D8 00 00               	LDA		#E_NotAlloc
  10425 00DAC1 42 C0 10                     	RTS		#16
  10426 00DAC4                             .ownerOk:
  10427 00DAC4 BA                           	TSX
  10428 00DAC5 B5 0F                        	LDA		15,X
  10429 00DAC7 F0 0B                        	BEQ		.0001
  10430 00DAC9 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10431 00DACF 20 D7 D6                     	JSR		DequeueMsg
  10432 00DAD2 80 0C                        	BRA		.0002
  10433 00DAD4                             .0001:
  10434 00DAD4 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10435 00DADA 20 65 D6                     	JSR		hMbxToAddr
  10436 00DADD AA                           	TAX
  10437 00DADE B5 06                        	LDA		MBX_mq_head,X
  10438 00DAE0                             .0002:
  10439 00DAE0 20 19 D7                     	JSR		UnlockSysSema
  10440 00DAE3 C9 00 00 00 00               	CMP		#0
  10441 00DAE8 10 08                        	BPL		.gotMsg
  10442 00DAEA A9 1E DA 00 00               	LDA		#E_NoMsg
  10443 00DAEF 42 C0 10                     	RTS		#16
  10444 00DAF2                             .gotMsg:
  10445 00DAF2 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10446 00DAF8 20 75 D6                     	JSR		hMsgToAddr
  10447 00DAFB AA                           	TAX
  10448 00DAFC A0 00 00 00 00               	LDY		#0
  10449 00DB01 B5 00                        	LDA		MSG_d1,X
  10450 00DB03 42 93 03                     	STA		{3,S},Y
  10451 00DB06 B5 04                        	LDA		MSG_d2,X
  10452 00DB08 42 93 07                     	STA		{7,S},Y
  10453 00DB0B B5 08                        	LDA		MSG_d3,X
  10454 00DB0D 42 93 0B                     	STA		{11,S},Y
  10455 00DB10 DA                           	PHX
  10456 00DB11 BA                           	TSX
  10457 00DB12 B5 0F                        	LDA		15,X
  10458 00DB14 F0 2B                        	BEQ		.noRmv
  10459 00DB16 20 0C D7                     	JSR		LockSysSema
  10460 00DB19 FA                           	PLX
  10461 00DB1A A9 01 00 00 00               	LDA		#MT_FREE
  10462 00DB1F 42 8B 95 12                  	STA.B	MSG_type,X
  10463 00DB23 42 AB AD C6 D8               	LDA.H	freeMSG
  10464 00DB28 42 AB 95 10                  	STA.H	MSG_link,X
  10465 00DB2C 42 AB AF 06 20 05            	LDA.H	hMsgTmp
  10466 00DB32 42 AB 8D C6 D8               	STA.H	freeMSG
  10467 00DB37 42 AB EE 2E DB               	INC.H	nMsgblk
  10468 00DB3C 20 19 D7                     	JSR		UnlockSysSema
  10469 00DB3F 80 01                        	BRA		.0003
  10470 00DB41                             .noRmv:
  10471 00DB41 FA                           	PLX
  10472 00DB42                             .0003:
  10473 00DB42 A9 9A D9 00 00               	LDA		#E_Ok
  10474 00DB47 42 C0 10                     	RTS		#16
                                           
                                           ;----------------------------------------------------------------------------
                                           ; PeekMsg(hMbx,int *d1, int *d2, int *d3);
                                           ;
                                           ; Checks for a message without removing it from the queue.
                                           ;----------------------------------------------------------------------------
                                           
  10482 00DB4A                             FMTK_PeekMsg:
  10483 00DB4A 8F 04 20 05                  	STA		hMbxTmp
  10484 00DB4E A9 00 00 00 00               	LDA		#0
  10485 00DB53 48                           	PHA
  10486 00DB54 BA                           	TSX
  10487 00DB55 B5 0B                        	LDA		11,X
  10488 00DB57 48                           	PHA
  10489 00DB58 B5 0B                        	LDA		11,X
  10490 00DB5A 48                           	PHA
  10491 00DB5B B5 0B                        	LDA		11,X
  10492 00DB5D 48                           	PHA
  10493 00DB5E AF 04 20 05                  	LDA		hMbxTmp
  10494 00DB62 20 A2 DA                     	JSR		FMTK_CheckMsg
  10495 00DB65 42 C0 0C                     	RTS		#12
                                           
Finitron FT832 assembler   version 1.4   Fri Jun 02 09:59:36 2017     Page 1
FTBios816.asm


                                           .include "FMTKmsg.asm"
                                           
                                           	MEM		32
                                           	NDX		32
                                           ;----------------------------------------------------------------------------
                                           ; SelectTaskToRun:
                                           ;
                                           ; Selects a task to run from the ready fifo. The ready fifo is really a 
                                           ; group of fifos, one each for a priority group. Priority groups are
                                           ; $0x, $1x, $2x, $3x, $4x
                                           ;
                                           ; Returns
                                           ;	.A = task number to run
                                           ; Modifies:
                                           ;	.X, .Y, and flags
                                           ;----------------------------------------------------------------------------
                                           
  10513 00DB68                             StartQ:
  10514 00DB68 00 01 00 02 00 03 00 04      	.byte	0,1,0,2,0,3,0,4,0,1,0,2,0,3,0,4
  10514 00DB70 00 01 00 02 00 03 00 04    
                                         
                                           
  10516 00DB78                             SelectTaskToRun:
  10517 00DB78 A9 04 00 00 00               	LDA		#4
  10518 00DB7D 42 8B 85 CC                  	STA.B	qcnt
  10519 00DB81 A5 04                        	LDA		TickCount		; vary the starting queue to check
  10520 00DB83 29 0F 00 00 00               	AND		#$0F			; based on the tick count
  10521 00DB88 A8                           	TAY
  10522 00DB89 42 8B B9 68 DB               	LDA.B	StartQ,Y
  10523 00DB8E 0A                           	ASL
  10524 00DB8F AA                           	TAX
  10525 00DB90                             .nextQ:
  10526 00DB90                             .notReady:
  10527 00DB90 42 AB BF 10 C2 FE            	LDA.H	READY_FIFO_CNT,X	; get count of ready tasks in fifo
  10528 00DB96 F0 29                        	BEQ		.fifoEmpty
  10529 00DB98 42 AB BF 00 C2 FE            	LDA.H	READY_FIFO,X	; get ready task from fifo
  10530 00DB9E 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10531 00DBA4 20 9A DB                     	JSR		hTcbToAddr
  10532 00DBA7 A8                           	TAY
  10533 00DBA8 42 8B B9 2D 00               	LDA.B	TCB_status,Y	; check the status and make sure it's ready
  10534 00DBAD C9 01 00 00 00               	CMP		#TS_READY
  10535 00DBB2 D0 DC                        	BNE		.notReady
  10536 00DBB4 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10537 00DBBA 42 AB 9F 00 C2 FE            	STA.H	READY_FIFO,X	; add back to fifo as last entry
  10538 00DBC0 60                           	RTS
                                           
                                           	; move to the next queue
  10541 00DBC1                             .fifoEmpty:
  10542 00DBC1 E8                           	INX
  10543 00DBC2 E8                           	INX
  10544 00DBC3 E0 0A 00 00 00               	CPX		#10
  10545 00DBC8 30 05                        	BLT		.0001
  10546 00DBCA A2 00 00 00 00               	LDX		#0				; cycle back around to first Q
  10547 00DBCF                             .0001:
  10548 00DBCF 42 8B C6 CC                  	DEC.B	qcnt
  10549 00DBD3 D0 BB                        	BNE		.nextQ
  10550 00DBD5 42 1A                        	TTA						; if all queues empty, keep running the current
  10551 00DBD7 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Insert task into ready fifo.
                                           ; Parameters:
                                           ;	.A = handle to TCB
                                           ;----------------------------------------------------------------------------
                                           
  10559 00DBD8                             InsertIntoReadyFifo:
  10560 00DBD8 48                           	PHA
  10561 00DBD9 20 9A DB                     	JSR		hTcbToAddr
  10562 00DBDC AA                           	TAX							; .X = task number (index into tables)
  10563 00DBDD A9 01 00 00 00               	LDA		#TS_READY			; set task status to ready
  10564 00DBE2 42 8B 95 2D                  	STA.B	TCB_status,X
  10565 00DBE6 42 8B B5 2C                  	LDA.B	TCB_priority,X		; get the priority
  10566 00DBEA 4A                           	LSR							; use upper nybble to identify priority que
  10567 00DBEB 4A                           	LSR
  10568 00DBEC 4A                           	LSR
  10569 00DBED 4A                           	LSR
  10570 00DBEE 0A                           	ASL
  10571 00DBEF A8                           	TAY
  10572 00DBF0 68                           	PLA
  10573 00DBF1 42 AB 42 99 00 C2 FE 00      	STA.H	READY_FIFO,Y
                                         
  10574 00DBF9 60                           	RTS
                                           
                                           ; IRQ routine for all modes. The interrupted task must of had interrupts
                                           ; enabled and this status should be saved on the stack with the value of
                                           ; the status register. The RTI instruction will pop the status register off
                                           ; the stack and restore the interrupt enable.
                                           ; Note that all this routine does is switch to a task which has a different
                                           ; register set, so there's no need to stack and restore registers. The
                                           ; task switch also allows the routine to be located anywhere in the memory
                                           ; system, so we don't have to worry about using up bank 0 memory.
                                           
  10585 00DBFA                             IRQRout832:
  10586 00DBFA                             IRQRout816:
  10587 00DBFA                             IRQRout02:
  10588 00DBFA 42 A2 01 00                  	TSK		#1			; switch to the interrupt handling task
  10589 00DBFE 40                           	RTI
                                           
                                           ; This task has interrupts masked in it's startup record and therefore runs
                                           ; with interrupts masked as the task never enables interrupts. Note that it's
                                           ; important that interrupts are masked while this is running, otherwise the
                                           ; uncleared interrupt status would cause another interrupt resulting in an
                                           ; infinite interrupt loop.
                                           
  10597 00DBFF                             Task1:
  10598 00DBFF 42 8B AD 1F B0               	LDA.B	MPU_IRQ_STATUS	; check if counter expired
  10599 00DC04 89 02 00 00 00               	BIT		#2				; counter #1 IRQ active bit
  10600 00DC09 F0 5A                        	BEQ		.0001			; no IRQ ?
  10601 00DC0B A5 04                        	LDA		TickCount		; increment the tick count
  10602 00DC0D 1A                           	INA						; lower 16 bits
  10603 00DC0E 85 04                        	STA		TickCount
  10604 00DC10 42 3B FF 0F 42 8B 8F A4      	STA.B	$FFF:$D00A4		; update on-screen IRQ live indicator
  10604 00DC18 00 0D                      
  10605 00DC1A A9 05 00 00 00               	LDA		#$05			; count down, on mpu clock, irq enabled (clears irq)
  10606 00DC1F 42 8B 8D 17 B0               	STA.B	CTR1_CTRL		; set control register clearing interrupt
  10607 00DC24 42 3B 00 00 42 8B AF DF      	LDA.B	$0:$100DF		; Set flag for EhBASIC Irq
  10607 00DC2C 00 01                      
  10608 00DC2E 09 20 00 00 00               	ORA		#$20
  10609 00DC33 42 3B 00 00 42 8B 8F DF      	STA.B	$0:$100DF
  10609 00DC3B 00 01                      
  10610 00DC3D                             .nextTo:
  10611 00DC3D A9 01 00 00 00               	LDA		#TOL_DEC
  10612 00DC42 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST	; decrement the timeout list
  10613 00DC48 EA                           	NOP						; might take up to 3 clock cycles
  10614 00DC49 EA                           	NOP
  10615 00DC4A 42 AB AF 02 C3 FE            	LDA.H	TIMEOUT_LIST+2	; get any timedout task
  10616 00DC50 30 05                        	BMI		.noMoreTos
  10617 00DC52 20 D8 DB                     	JSR		InsertIntoReadyFifo
  10618 00DC55 80 E6                        	BRA		.nextTo
  10619 00DC57                             .noMoreTos:
  10620 00DC57 42 8B A5 D0                  	LDA.B	TaskSwitchEn	; only switch tasks if enabled
  10621 00DC5B F0 08                        	BEQ		.0001
  10622 00DC5D 20 78 DB                     	JSR		SelectTaskToRun
  10623 00DC60 BA                           	TSX
  10624 00DC61 42 AB 95 01                  	STA.H	$1,X			; change return task # on stack
  10625 00DC65                             .0001:
  10626 00DC65 42 50                        	RIT					; return from interrupt task
  10627 00DC67 80 96                        	BRA		Task1		; the next time task1 is run it will start here
                                           
                                           	MEM		16
                                           	NDX		16
  10631 00DC69                             BtnuIRQ:
  10632 00DC69 42 3B FF 0F 42 8B AF A0      	LDA.B	$FFF:$D00A0
  10632 00DC71 00 0D                      
  10633 00DC73 1A                           	INA
  10634 00DC74 42 3B FF 0F 42 8B 8F A0      	STA.B	$FFF:$D00A0
  10634 00DC7C 00 0D                      
  10635 00DC7E 20 98 D3                     	JSR		spi_master_init
  10636 00DC81 C9 00 00                     	CMP		#0
  10637 00DC84 D0 1D                        	BNE		.0001
  10638 00DC86 A2 00 00                     	LDX		#0
  10639 00DC89                             .0002:
  10640 00DC89 F4 0F 00                     	PEA		$000F
  10641 00DC8C 8A                           	TXA
  10642 00DC8D EB                           	XBA
  10643 00DC8E 0A                           	ASL
  10644 00DC8F 48                           	PHA
  10645 00DC90 F4 00 00                     	PEA		0
  10646 00DC93 F4 00 00                     	PEA		0
  10647 00DC96 86 94                        	STX		reg_x
  10648 00DC98 20 CB D3                     	JSR		spi_master_read
  10649 00DC9B A6 94                        	LDX		reg_x
  10650 00DC9D E8                           	INX
  10651 00DC9E E0 80 00                     	CPX		#128
  10652 00DCA1 D0 E6                        	BNE		.0002
  10653 00DCA3                             .0001:
  10654 00DCA3 42 50                        	RIT
  10655 00DCA5 80 C2                        	BRA		BtnuIRQ
                                           
                                           ; IRQ handler task - 32 bit
                                           ;
  10659 00DCA7                             IRQTask:
                                           	MEM		8
                                           	NDX		32
  10662 00DCA7                             IRQTask1:
  10663 00DCA7 AD 1F B0                     	LDA		MPU_IRQ_STATUS	; check if counter expired
  10664 00DCAA 89 02                        	BIT		#2
  10665 00DCAC F0 16                        	BEQ		.0001
  10666 00DCAE A6 04                        	LDX		TickCount		; increment the tick count
  10667 00DCB0 E8                           	INX
  10668 00DCB1 86 04                        	STX		TickCount
  10669 00DCB3 42 3B FF 0F 42 8B 42 8E      	STX.B	$FFF:$D00A2			; update on-screen IRQ live indicator
  10669 00DCBB A2 00 0D 00                
  10670 00DCBF A9 05                        	LDA		#$05			; count down, on mpu clock, irq enabled (clears irq)
  10671 00DCC1 8D 17 B0                     	STA		CTR1_CTRL
  10672 00DCC4                             .0001:
  10673 00DCC4 42 60                        	RTT					; go back to interrupted task
  10674 00DCC6 80 DF                        	BRA		IRQTask1	; the next time task is run it will start here
                                           
                                           ; This little task sample runs in native 32 bit mode and displays
                                           ; "Hello World!" on the screen.
                                           
                                           	CPU		FT832
                                           	MEM		8
                                           	NDX		32
                                           
  10683 00DCC8                             Task2:
  10684 00DCC8 A2 F8 01 00 00               	LDX		#84*2*3
  10685 00DCCD                             .0003:
  10686 00DCCD A0 00 00 00 00               	LDY		#0
  10687 00DCD2                             .0002:
  10688 00DCD2 42 1B B9 ED DC               	LDA		CS:msgHelloWorld,Y
  10689 00DCD7 F0 10                        	BEQ		.0001
  10690 00DCD9 20 BB C9                     	JSR		AsciiToScreen8
  10691 00DCDC 42 3B FF 0F 9F 00 00 0D      	STA		$FFF:VIDBUF,X
                                         
  10692 00DCE4 E8                           	INX
  10693 00DCE5 E8                           	INX
  10694 00DCE6 C8                           	INY
  10695 00DCE7 80 E9                        	BRA		.0002
  10696 00DCE9                             .0001:
  10697 00DCE9 42 60                        	RTT
  10698 00DCEB 80 E0                        	BRA		.0003
                                           
  10700 00DCED                             msgHelloWorld:
  10701 00DCED 0D 0A 48 65 6C 6C 6F 20      	.byte	CR,LF,"Hello World!",CR,LF,0
  10701 00DCF5 57 6F 72 6C 64 21 0D 0A    
  10701 00DCFD 00                         
                                           
                                           	NDX		16
                                           	MEM		16
                                           
  10706 00DCFE                             BrkTask:
  10707 00DCFE 42 EE 00 00 D0 FF            	INC		$FFD00000
  10708 00DD04 42 60                        	RTT
  10709 00DD06 80 F6                        	BRA		BrkTask
                                           
                                           ; The following store sequence for the benefit of Supermon816
                                           ;
  10713 00DD08                             BrkRout:
  10714 00DD08 0B                           	PHD
  10715 00DD09 8B                           	PHB
  10716 00DD0A C2 30                        	REP		#$30
  10717 00DD0C 48                           	PHA
  10718 00DD0D DA                           	PHX
  10719 00DD0E 5A                           	PHY
  10720 00DD0F 6C 02 01                     	JMP		($0102)		; This jump normally points to BrkRout1
  10721 00DD12                             BrkRout1:
  10722 00DD12 C2 30                        	REP		#$30
  10723 00DD14 7A                           	PLY
  10724 00DD15 FA                           	PLX
  10725 00DD16 68                           	PLA
  10726 00DD17 AB                           	PLB
  10727 00DD18 2B                           	PLD
  10728 00DD19 E2 20                        	SEP		#$20
  10729 00DD1B 68                           	PLA
  10730 00DD1C C2 30                        	REP		#$30
  10731 00DD1E 68                           	PLA
  10732 00DD1F 20 A4 CC                     	JSR		DispWord
  10733 00DD22 A2 00 00                     	LDX		#0
  10734 00DD25 A0 40 00                     	LDY		#64
  10735 00DD28                             .0001:
  10736 00DD28 42 F0                        	.word	$f042		; pchist
  10737 00DD2A 20 A4 CC                     	JSR		DispWord
  10738 00DD2D A9 20 00                     	LDA		#' '
  10739 00DD30 20 C4 CB                     	JSR		OutChar
  10740 00DD33 E8                           	INX
  10741 00DD34 88                           	DEY
  10742 00DD35 D0 F1                        	BNE		.0001
  10743 00DD37 A9 FF FF                     	LDA		#$FFFF
  10744 00DD3A 8D 00 70                     	STA		$7000
  10745 00DD3D                             Hung:
  10746 00DD3D 80 FE                        	BRA		Hung
                                           
                                           	;--------------------------------------------------------
                                           	;--------------------------------------------------------
                                           	; I/O page is located at $F0xx
                                           	;--------------------------------------------------------
                                           	;--------------------------------------------------------	
                                           	;org		$F100
                                           
  10755 00DD3F                             LineTbl:
  10756 00DD3F 00 00                        	.WORD	0
  10757 00DD41 54 00                        	.WORD	TEXTCOLS
  10758 00DD43 A8 00                        	.WORD	TEXTCOLS*2
  10759 00DD45 FC 00                        	.WORD	TEXTCOLS*3
  10760 00DD47 50 01                        	.WORD	TEXTCOLS*4
  10761 00DD49 A4 01                        	.WORD	TEXTCOLS*5
  10762 00DD4B F8 01                        	.WORD	TEXTCOLS*6
  10763 00DD4D 4C 02                        	.WORD	TEXTCOLS*7
  10764 00DD4F A0 02                        	.WORD	TEXTCOLS*8
  10765 00DD51 F4 02                        	.WORD	TEXTCOLS*9
  10766 00DD53 48 03                        	.WORD	TEXTCOLS*10
  10767 00DD55 9C 03                        	.WORD	TEXTCOLS*11
  10768 00DD57 F0 03                        	.WORD	TEXTCOLS*12
  10769 00DD59 44 04                        	.WORD	TEXTCOLS*13
  10770 00DD5B 98 04                        	.WORD	TEXTCOLS*14
  10771 00DD5D EC 04                        	.WORD	TEXTCOLS*15
  10772 00DD5F 40 05                        	.WORD	TEXTCOLS*16
  10773 00DD61 94 05                        	.WORD	TEXTCOLS*17
  10774 00DD63 E8 05                        	.WORD	TEXTCOLS*18
  10775 00DD65 3C 06                        	.WORD	TEXTCOLS*19
  10776 00DD67 90 06                        	.WORD	TEXTCOLS*20
  10777 00DD69 E4 06                        	.WORD	TEXTCOLS*21
  10778 00DD6B 38 07                        	.WORD	TEXTCOLS*22
  10779 00DD6D 8C 07                        	.WORD	TEXTCOLS*23
  10780 00DD6F E0 07                        	.WORD	TEXTCOLS*24
  10781 00DD71 34 08                        	.WORD	TEXTCOLS*25
  10782 00DD73 88 08                        	.WORD	TEXTCOLS*26
  10783 00DD75 DC 08                        	.WORD	TEXTCOLS*27
  10784 00DD77 30 09                        	.WORD	TEXTCOLS*28
  10785 00DD79 84 09                        	.WORD	TEXTCOLS*29
  10786 00DD7B D8 09                        	.WORD	TEXTCOLS*30
                                           
  10788 00DD7D                             TaskStartTbl:
  10789 00DD7D 00 00                        	.WORD	0			; CS
  10790 00DD7F 00 00                        	.WORD	0			; DS
  10791 00DD81 00 00                        	.WORD	0			; SS
  10792 00DD83 CB C0                        	.WORD	Task0		; PC
  10793 00DD85 00                           	.BYTE	Task0>>16	; PB
  10794 00DD86 00 00                        	.WORD	0			; acc
  10795 00DD88 00 00                        	.WORD	0
  10796 00DD8A 00 00                        	.WORD	0			; x
  10797 00DD8C 00 00                        	.WORD	0
  10798 00DD8E 00 00                        	.WORD	0			; y
  10799 00DD90 00 00                        	.WORD	0
  10800 00DD92 FF 3F                        	.WORD	$3FFF		; sp
  10801 00DD94 00 00                        	.WORD	0
  10802 00DD96 04                           	.BYTE	4			; SR
  10803 00DD97 01                           	.BYTE	1			; SR extension
  10804 00DD98 00                           	.BYTE	0			; DB
  10805 00DD99 00 00                        	.WORD	0			; DPR
  10806 00DD9B 00 00                        	.WORD	0
                                           
                                           	; TASK #1
                                           	; Interrupt handler task
  10810 00DD9D 00 00                        	.WORD	0			; CS
  10811 00DD9F 05 00                        	.WORD	5			; DS
  10812 00DDA1 05 00                        	.WORD	5			; SS
  10813 00DDA3 FF DB                        	.WORD	Task1		; PC
  10814 00DDA5 00                           	.BYTE	Task1>>16
  10815 00DDA6 00 00                        	.WORD	0			; acc
  10816 00DDA8 00 00                        	.WORD	0
  10817 00DDAA 00 00                        	.WORD	0			; x
  10818 00DDAC 00 00                        	.WORD	0
  10819 00DDAE 00 00                        	.WORD	0			; y
  10820 00DDB0 00 00                        	.WORD	0
  10821 00DDB2 FF 3B                        	.WORD	$3BFF		; sp
  10822 00DDB4 00 00                        	.WORD	0
  10823 00DDB6 04                           	.BYTE	4			; SR
  10824 00DDB7 02                           	.BYTE	2			; SR extension	(32 bit mode)
  10825 00DDB8 00                           	.BYTE	0			; DB
  10826 00DDB9 00 00                        	.WORD	0			; DPR
  10827 00DDBB 00 00                        	.WORD	0
                                           
  10829 00DDBD 00 00                        	.WORD	0			; CS
  10830 00DDBF 00 00                        	.WORD	0			; DS
  10831 00DDC1 00 00                        	.WORD	0			; SS
  10832 00DDC3 C8 DC                        	.WORD	Task2		; PC
  10833 00DDC5 00                           	.BYTE	Task2>>16
  10834 00DDC6 00 00                        	.WORD	0			; acc
  10835 00DDC8 00 00                        	.WORD	0
  10836 00DDCA 00 00                        	.WORD	0			; x
  10837 00DDCC 00 00                        	.WORD	0
  10838 00DDCE 00 00                        	.WORD	0			; y
  10839 00DDD0 00 00                        	.WORD	0
  10840 00DDD2 FF 37                        	.WORD	$37FF		; sp
  10841 00DDD4 00 00                        	.WORD	0
  10842 00DDD6 20                           	.BYTE	$20			; SR			; eight bit mem
  10843 00DDD7 02                           	.BYTE	2			; SR extension
  10844 00DDD8 00                           	.BYTE	0			; DB
  10845 00DDD9 00 00                        	.WORD	0			; DPR
  10846 00DDDB 00 00                        	.WORD	0
                                           
                                           	; TASK #3
                                           	; Button Interrupt handler task
  10850 00DDDD 00 00                        	.WORD	0			; CS
  10851 00DDDF 05 00                        	.WORD	5			; DS
  10852 00DDE1 05 00                        	.WORD	5			; SS
  10853 00DDE3 69 DC                        	.WORD	BtnuIRQ		; PC
  10854 00DDE5 00                           	.BYTE	BtnuIRQ>>16
  10855 00DDE6 00 00                        	.WORD	0			; acc
  10856 00DDE8 00 00                        	.WORD	0
  10857 00DDEA 00 00                        	.WORD	0			; x
  10858 00DDEC 00 00                        	.WORD	0
  10859 00DDEE 00 00                        	.WORD	0			; y
  10860 00DDF0 00 00                        	.WORD	0
  10861 00DDF2 FF 3A                        	.WORD	$3AFF		; sp
  10862 00DDF4 00 00                        	.WORD	0
  10863 00DDF6 04                           	.BYTE	4			; SR
  10864 00DDF7 01                           	.BYTE	1			; SR extension
  10865 00DDF8 00                           	.BYTE	0			; DB
  10866 00DDF9 00 00                        	.WORD	0			; DPR
  10867 00DDFB 00 00                        	.WORD	0
                                           
  10869 00DDFD 00 00                        	.WORD	0			; CS
  10870 00DDFF 00 00                        	.WORD	0			; DS
  10871 00DE01 00 00                        	.WORD	0			; SS
  10872 00DE03 FE DC                        	.WORD	BrkTask		; PC
  10873 00DE05 00                           	.BYTE	BrkTask>>16
  10874 00DE06 00 00                        	.WORD	0			; acc
  10875 00DE08 00 00                        	.WORD	0
  10876 00DE0A 00 00                        	.WORD	0			; x
  10877 00DE0C 00 00                        	.WORD	0
  10878 00DE0E 00 00                        	.WORD	0			; y
  10879 00DE10 00 00                        	.WORD	0
  10880 00DE12 FF 2F                        	.WORD	$2FFF		; sp
  10881 00DE14 00 00                        	.WORD	0
  10882 00DE16 00                           	.BYTE	0			; SR
  10883 00DE17 01                           	.BYTE	1			; SR extension
  10884 00DE18 00                           	.BYTE	0			; DB
  10885 00DE19 00 00                        	.WORD	0			; DPR
  10886 00DE1B 00 00                        	.WORD	0
                                           
                                           	; task #5
                                           	; DS is placed at $7800
  10890 00DE1D 00 00                        	.WORD	0			; CS
  10891 00DE1F 00 00                        	.WORD	0    		; DS
  10892 00DE21 00 00                        	.WORD	0			; SS
  10893 00DE23 EB 98                        	.WORD	InvadersTask	; PC
  10894 00DE25 00                           	.BYTE	InvadersTask>>16
  10895 00DE26 00 00                        	.WORD	0			; acc
  10896 00DE28 00 00                        	.WORD	0
  10897 00DE2A 00 00                        	.WORD	0			; x
  10898 00DE2C 00 00                        	.WORD	0
  10899 00DE2E 00 00                        	.WORD	0			; y
  10900 00DE30 00 00                        	.WORD	0
  10901 00DE32 FF 2B                        	.WORD	$2BFF		; sp
  10902 00DE34 00 00                        	.WORD	0
  10903 00DE36 00                           	.BYTE	0			; SR
  10904 00DE37 01                           	.BYTE	1			; SR extension
  10905 00DE38 00                           	.BYTE	0			; DB
  10906 00DE39 00 00                        	.WORD	0			; DPR
  10907 00DE3B 00 00                        	.WORD	0
                                           
  10909 00DE3D 00 00                        	.WORD	0			; CS
  10910 00DE3F 00 00                        	.WORD	0			; DS
  10911 00DE41 00 00                        	.WORD	0			; SS
  10912 00DE43 A7 DC                        	.WORD	IRQTask		; PC
  10913 00DE45 00                           	.BYTE	IRQTask>>16
  10914 00DE46 00 00                        	.WORD	0			; acc
  10915 00DE48 00 00                        	.WORD	0
  10916 00DE4A 00 00                        	.WORD	0			; x
  10917 00DE4C 00 00                        	.WORD	0
  10918 00DE4E 00 00                        	.WORD	0			; y
  10919 00DE50 00 00                        	.WORD	0
  10920 00DE52 FF 27                        	.WORD	$27FF		; sp
  10921 00DE54 00 00                        	.WORD	0
  10922 00DE56 24                           	.BYTE	$24			; SR	8 bit acc, mask interrupts
  10923 00DE57 02                           	.BYTE	2			; SR extension - 832 mode
  10924 00DE58 00                           	.BYTE	0			; DB
  10925 00DE59 00 00                        	.WORD	0			; DPR
  10926 00DE5B 00 00                        	.WORD	0
                                           
                                           	; task 7 (Basic)
  10929 00DE5D FD 0F                        	.WORD	$FFD		; CS
  10930 00DE5F FD 0F                        	.WORD	$FFD		; DS
  10931 00DE61 FD 0F                        	.WORD	$FFD		; SS
  10932 00DE63 00 C0                        	.WORD	$C000		; PC
  10933 00DE65 00                           	.BYTE	$00
  10934 00DE66 00 00                        	.WORD	0			; acc
  10935 00DE68 00 00                        	.WORD	0
  10936 00DE6A 00 00                        	.WORD	0			; x
  10937 00DE6C 00 00                        	.WORD	0
  10938 00DE6E 00 00                        	.WORD	0			; y
  10939 00DE70 00 00                        	.WORD	0
  10940 00DE72 FF 01                        	.WORD	$01FF		; sp
  10941 00DE74 00 00                        	.WORD	0
  10942 00DE76 00                           	.BYTE	0			; SR
  10943 00DE77 00                           	.BYTE	0			; SR extension - 832 mode
  10944 00DE78 00                           	.BYTE	0			; DB
  10945 00DE79 00 00                        	.WORD	0			; DPR
  10946 00DE7B 3F 00                        	.WORD	63			; map
                                           
                                           	; task 8 (Supermon)
  10949 00DE7D 00 00                        	.WORD	$0			; CS
  10950 00DE7F 05 00                        	.WORD	$5			; DS
  10951 00DE81 05 00                        	.WORD	$5			; SS
  10952 00DE83 00 C0                        	.WORD	$C000		; PC
  10953 00DE85 00                           	.BYTE	$00
  10954 00DE86 00 00                        	.WORD	0			; acc
  10955 00DE88 00 00                        	.WORD	0
  10956 00DE8A 00 00                        	.WORD	0			; x
  10957 00DE8C 00 00                        	.WORD	0
  10958 00DE8E 00 00                        	.WORD	0			; y
  10959 00DE90 00 00                        	.WORD	0
  10960 00DE92 FF 2B                        	.WORD	$2BFF		; sp
  10961 00DE94 00 00                        	.WORD	0
  10962 00DE96 00                           	.BYTE	0			; SR
  10963 00DE97 01                           	.BYTE	1			; SR extension - 832 mode
  10964 00DE98 00                           	.BYTE	0			; DB
  10965 00DE99 00 00                        	.WORD	0			; DPR
  10966 00DE9B 00 00                        	.WORD	0			; map
                                           
                                           	; task 9 (single step)
  10969 00DE9D 00 00                        	.WORD	0			; CS
  10970 00DE9F 00 00                        	.WORD	0			; DS
  10971 00DEA1 00 00                        	.WORD	0			; SS
  10972 00DEA3 7A C8                        	.WORD	SSMInit		; PC
  10973 00DEA5 00                           	.BYTE	SSMTnit>>16
  10974 00DEA6 00 00                        	.WORD	0			; acc
  10975 00DEA8 00 00                        	.WORD	0
  10976 00DEAA 00 00                        	.WORD	0			; x
  10977 00DEAC 00 00                        	.WORD	0
  10978 00DEAE 00 00                        	.WORD	0			; y
  10979 00DEB0 00 00                        	.WORD	0
  10980 00DEB2 FF 33                        	.WORD	$33FF		; sp
  10981 00DEB4 00 00                        	.WORD	0
  10982 00DEB6 04                           	.BYTE	$4			; SR	16 bit regs, mask interrupts
  10983 00DEB7 01                           	.BYTE	1			; SR extension - 816 mode
  10984 00DEB8 00                           	.BYTE	0			; DB
  10985 00DEB9 00 00                        	.WORD	0			; DPR
  10986 00DEBB 00 00                        	.WORD	0
                                           
  10988 00DEBD                             msgRegs:
  10989 00DEBD 0D 0A                        	.byte	CR,LF
  10990 00DEBF 20 20 20 20 20 20 20 20          .byte   "             xxxsxi31",CR,LF
  10990 00DEC7 20 20 20 20 20 78 78 78    
  10990 00DECF 73 78 69 33 31 0D 0A       
  10991 00DED6 20 20 43 53 20 20 50 42          .byte   "  CS  PB PC  xxxsxn26NVmxDIZC    .A       .X       .Y       SP  ",CR,LF,0
  10991 00DEDE 20 50 43 20 20 78 78 78    
  10991 00DEE6 73 78 6E 32 36 4E 56 6D    
  10991 00DEEE 78 44 49 5A 43 20 20 20    
  10991 00DEF6 20 2E 41 20 20 20 20 20    
  10991 00DEFE 20 20 2E 58 20 20 20 20    
  10991 00DF06 20 20 20 2E 59 20 20 20    
  10991 00DF0E 20 20 20 20 53 50 20 20    
  10991 00DF16 0D 0A 00                   
  10992 00DF19                             msgRegs2:
  10993 00DF19 0D 0A                        	.byte	CR,LF
  10994 00DF1B 20 20 53 53 20 20 20 44      	.byte	"  SS   DS  DB  DP   BL  MP",CR,LF,0
  10994 00DF23 53 20 20 44 42 20 20 44    
  10994 00DF2B 50 20 20 20 42 4C 20 20    
  10994 00DF33 4D 50 0D 0A 00             
  10995 00DF38                             msgErr:
  10996 00DF38 2A 2A 2A 45 72 72 0D 0A      	.byte	"***Err",CR,LF,0
  10996 00DF40 00                         
                                           
                                           ;	cpu		FT832
                                           ;	MEM		32
                                           ;	NDX		32
                                           ;	LDA		#$12345678
                                           ;	LDX		#$98765432
                                           ;	STA.B	{$23},Y
                                           ;	LDY.UH	$44455556,X
                                           ;	LDA.H	CS:$44455556,X
                                           ;	LDA.UB	SEG $8888:$1234,Y
                                           ;	JSF	    $0000:start
                                           ;	RTF
                                           ;	ADC     SEG $9821:$1200,X
                                           ;	EOR     $821:$1200,X
                                           ;	EOR     $841:$12
                                           ;	SBC     FAR {$24},Y
                                           ;	AND     FAR($25)
                                           ;	ORA     FAR ($26,x)
                                           ;	TSK		#2
                                           ;	TSK
                                           ;	LDT		$10000,X
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; +---------------------------+
                                           ; | block status / ptr to free|
                                           ; +---------------------------+
                                           ; | pointer to previous block |
                                           ; +---------------------------+
                                           ; | pointer to next block     |
                                           ; +---------------------------+
                                           ;
                                           	MEM		32
                                           	NDX		32
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
  11036 00DF41                             FreeSysMem:
  11037 00DF41 38                           	SEC
  11038 00DF42 E9 0C 00 00 00               	SBC		#12		;	backup to block header
  11039 00DF47 A8                           	TAY				;	.Y = pointer to block to free (this)
  11040 00DF48 08                           	PHP				; save interrupt mask
  11041 00DF49 78                           	SEI				; no interrupts
                                           	STZ		$0,Y	; set status as free
  11043 00DF4A B6 08                        	LDX		$8,Y	;	.X = pointer to next block
  11044 00DF4C B5 00                        	LDA		$0,X	;	.A = next->status
  11045 00DF4E F0 39                        	BEQ		.0001	;	branch if not free
                                           	; merge block with next free block
  11047 00DF50 B5 08                        	LDA		$8,X	;   .A = pointer to next next block
  11048 00DF52 99 08 00                     	STA		$8,Y	;
  11049 00DF55 AA                           	TAX
  11050 00DF56 94 04                        	STY		$4,X	;	next->next->prev = this
  11051 00DF58                             .0001:
                                           	; merge block with a previous free block
  11053 00DF58 B6 04                        	LDX		$4,Y	;	.X = pointer to prev block
  11054 00DF5A B5 00                        	LDA		$0,X	;	.A = prev->status
  11055 00DF5C F0 1F                        	BEQ		.0002	;	branch if not free
  11056 00DF5E B9 08 00                     	LDA		$8,Y	;   prev->next = this->next
  11057 00DF61 95 08                        	STA		$8,X
  11058 00DF63 A8                           	TAY				;	.Y = this->next
  11059 00DF64 96 04                        	STX		$4,Y	;	this->next->prev = this->prev
  11060 00DF66 9B                           	TXY
  11061 00DF67                             .0002:
  11062 00DF67 AD 5D DF                     	LDA		heap_free_ptr
  11063 00DF6A 99 00 00                     	STA		$0,Y
  11064 00DF6D 8C 5D DF                     	STY		heap_free_ptr
  11065 00DF70 28                           	PLP
  11066 00DF71 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           	; round allocation size to mmu available sizes
                                           
  11072 00DF72 A2 00 00 00 00               	LDX		#0
  11073 00DF77 18                           	CLC				; add room for header
  11074 00DF78 69 0C 00 00 00               	ADC		#12
  11075 00DF7D                             .0002:
  11076 00DF7D DD B2 DF                     	CMP		mmas,X
  11077 00DF80 42 B0 D5                     	BLE		.0001
  11078 00DF83 E8                           	INX
  11079 00DF84 E8                           	INX
  11080 00DF85 E8                           	INX
  11081 00DF86 E8                           	INX
  11082 00DF87 80 F4                        	BRA		.0002
  11083 00DF89                             .0001:
  11084 00DF89 BD B2 DF                     	LDA		mmas,X
  11085 00DF8C AA                           	TAX
  11086 00DF8D AC 81 DF                     	LDY		free_heap_ptr
                                           	; subtract .Y from .A
  11088 00DF90 38                           	SEC
  11089 00DF91 B9 08 00                     	LDA		$8,Y
  11090 00DF94 8C 87 DF                     	STY		tmpy
  11091 00DF97 ED 87 DF                     	SBC		tmpy
  11092 00DF9A DD B2 DF                     	CMP		mmas,X
  11093 00DF9D 30 F0                        	BLT		.0003
                                           	; here block is big enough
  11095 00DF9F 48                           	PHA
  11096 00DFA0 B9 00 00                     	LDA		$0,Y
  11097 00DFA3 8D 81 DF                     	STA		free_heap_ptr
                                           	STZ		$0,Y
  11099 00DFA6 68                           	PLA
  11100 00DFA7 38                           	SEC
  11101 00DFA8 FD B2 DF                     	SBC		mmas,X
  11102 00DFAB C9 FF 00 00 00               	CMP		#$0FF
  11103 00DFB0 30 00                        	BLT		.0004
                                           
  11105 00DFB2                             .0004:
                                           	
                                           
                                           ; Memory management allocation sizes
                                           ;
  11110 00DFB2                             mmas:
  11111 00DFB2 00 00 00 00                  	WORD	$0000,$0000
  11112 00DFB6 FF 00 00 00                  	WORD	$00FF,$0000
  11113 00DFBA FF 03 00 00                  	WORD	$03FF,$0000
  11114 00DFBE FF 0F 00 00                  	WORD	$0FFF,$0000
  11115 00DFC2 FF 3F 00 00                  	WORD	$3FFF,$0000
  11116 00DFC6 FF FF 00 00                  	WORD	$FFFF,$0000
  11117 00DFCA FF FF 03 00                  	WORD	$FFFF,$0003
  11118 00DFCE FF FF 0F 00                  	WORD	$FFFF,$000F
  11119 00DFD2 FF FF 3F 00                  	WORD	$FFFF,$003F
  11120 00DFD6 FF FF FF 00                  	WORD	$FFFF,$00FF
  11121 00DFDA FF FF FF 03                  	WORD	$FFFF,$03FF
  11122 00DFDE FF FF FF 0F                  	WORD	$FFFF,$0FFF
  11123 00DFE2 FF FF FF 3F                  	WORD	$FFFF,$3FFF
  11124 00DFE6 FF FF FF FF                  	WORD	$FFFF,$FFFF
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           	MEM		16
                                           	NDX		16
  11132 00DFEA 4C B2 E0                     	JMP		MusicPlay
  11133 00DFED                             beep:
  11134 00DFED A9 0F 00                     	LDA		#15					; set volume to max
  11135 00DFF0 42 3B FF 0F 8F B0 B0 0E      	STA		$FFF:SID+SID_VOLUME		
                                         
  11136 00DFF8 A9 6F 0C                     	LDA		#$0C6F				; 10C6F = 800 Hz
  11137 00DFFB 42 3B FF 0F 8F 00 B0 0E      	STA		$FFF:SID+SID_FREQ0
                                         
  11138 00E003 A9 01 00                     	LDA		#1
  11139 00E006 42 3B FF 0F 8F 02 B0 0E      	STA		$FFF:SID+SID_FREQ0+2
                                         
  11140 00E00E A9 C3 00                     	LDA		#195				; 2ms
  11141 00E011 42 3B FF 0F 8F 0C B0 0E      	STA		$FFF:SID+SID_ATTACK0
                                         
  11142 00E019 42 3B FF 0F 42 9C 0E B0      	STZ		$FFF:SID+SID_ATTACK0+2
  11142 00E021 0E 00                      
  11143 00E023 A9 28 09                     	LDA		#2344				; 24 ms decay
  11144 00E026 42 3B FF 0F 8F 10 B0 0E      	STA		$FFF:SID+SID_DECAY0
                                         
  11145 00E02E 42 3B FF 0F 42 9C 12 B0      	STZ		$FFF:SID+SID_DECAY0+2
  11145 00E036 0E 00                      
  11146 00E038 A9 80 00                     	LDA		#$80				; 50% sustain level
  11147 00E03B 42 3B FF 0F 8F 14 B0 0E      	STA		$FFF:SID+SID_SUSTAIN0
                                         
  11148 00E043 A9 BC BE                     	LDA		#48828				; 500 ms release
  11149 00E046 42 3B FF 0F 8F 18 B0 0E      	STA		$FFF:SID+SID_RELEASE0
                                         
  11150 00E04E 42 3B FF 0F 42 9C 1A B0      	STZ		$FFF:SID+SID_RELEASE0+2
  11150 00E056 0E 00                      
  11151 00E058 A9 01 00                     	LDA		#1					; reset envelope generator
  11152 00E05B 42 3B FF 0F 8F 0A B0 0E      	STA		$FFF:SID+SID_CTRL0+2
                                         
  11153 00E063 EA                           	NOP
  11154 00E064 EA                           	NOP
  11155 00E065 42 3B FF 0F 42 9C 0A B0      	STZ		$FFF:SID+SID_CTRL0+2
  11155 00E06D 0E 00                      
  11156 00E06F A9 04 15                     	LDA		#$1504				; gate on
  11157 00E072 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
                                           	; delay for about 1s
  11159 00E07A A0 27 00                     	LDY		#39
  11160 00E07D                             .0002:
  11161 00E07D A2 FF FF                     	LDX		#65535
  11162 00E080                             .0001:
  11163 00E080 CA                           	DEX
  11164 00E081 D0 FD                        	BNE		.0001
  11165 00E083 88                           	DEY
  11166 00E084 D0 F7                        	BNE		.0002
  11167 00E086 A9 04 05                     	LDA		#$0504				; gate off
  11168 00E089 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11169 00E091 60                           	RTS
  11170 00E092                             	
  11171 00E092 01 00                        	dh	1
  11172 00E094 89 83                        	dw	33673		; G4
  11173 00E096 0C 00                        	dw	12			; 1/8 sec
  11174 00E098 04 00                        	dw	4			; space
                                           
  11176 00E09A 01 00                        	dh	1
  11177 00E09C 89 83                        	dw	33673		; G4
  11178 00E09E 0C 00                        	dw	12			; 1/8
  11179 00E0A0 04 00                        	dw	4			; space
                                           
  11181 00E0A2 01 00                        	dh	1
  11182 00E0A4 89 83                        	dw	33673		; G4
  11183 00E0A6 0C 00                        	dw	12			; 1/8
  11184 00E0A8 04 00                        	dw	4			; space
                                           
  11186 00E0AA 00 00                        	dh	0
  11187 00E0AC 00 00                        	dw	0			; G4
  11188 00E0AE 00 00                        	dw	0			; 1/8
  11189 00E0B0 00 00                        	dw	0			; space
                                           
  11191 00E0B2                             MusicPlay:
  11192 00E0B2 A2 00 00                     	LDX		#0
  11193 00E0B5 A9 C3 00                     	LDA		#195				; 2ms
  11194 00E0B8 42 3B FF 0F 8F 0C B0 0E      	STA		$FFF:SID+SID_ATTACK0
                                         
  11195 00E0C0 42 3B FF 0F 42 9C 0E B0      	STZ		$FFF:SID+SID_ATTACK0+2
  11195 00E0C8 0E 00                      
  11196 00E0CA A9 28 09                     	LDA		#2344				; 24 ms decay
  11197 00E0CD 42 3B FF 0F 8F 10 B0 0E      	STA		$FFF:SID+SID_DECAY0
                                         
  11198 00E0D5 42 3B FF 0F 42 9C 12 B0      	STZ		$FFF:SID+SID_DECAY0+2
  11198 00E0DD 0E 00                      
  11199 00E0DF A9 D0 00                     	LDA		#$D0				; sustain level
  11200 00E0E2 42 3B FF 0F 8F 14 B0 0E      	STA		$FFF:SID+SID_SUSTAIN0
                                         
  11201 00E0EA A9 F8 11                     	LDA		#4600				; ??? ms release
  11202 00E0ED 42 3B FF 0F 8F 18 B0 0E      	STA		$FFF:SID+SID_RELEASE0
                                         
  11203 00E0F5 42 3B FF 0F 42 9C 1A B0      	STZ		$FFF:SID+SID_RELEASE0+2
  11203 00E0FD 0E 00                      
  11204 00E0FF                             .0001:
  11205 00E0FF BD 92 E0                     	LDA		music_tbl,x			; check for last note
  11206 00E102 F0 56                        	BEQ		.xit
  11207 00E104 BD 94 E0                     	LDA		music_tbl+2,x			; set the frequency
  11208 00E107 42 3B FF 0F 8F 00 B0 0E      	STA		$FFF:SID+SID_FREQ0
                                         
  11209 00E10F BD 96 E0                     	LDA		music_tbl+4,x
  11210 00E112 42 3B FF 0F 8F 02 B0 0E      	STA		$FFF:SID+SID_FREQ0+2
                                         
  11211 00E11A A9 04 15                     	LDA		#$1504				; gate on
  11212 00E11D 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11213 00E125 78                           	SEI
  11214 00E126 BD 98 E0                     	LDA		music_tbl+6,x
  11215 00E129 8D 04 01                     	STA		timeout1
  11216 00E12C BD 9A E0                     	LDA		music_tbl+8,x
  11217 00E12F 8D 06 01                     	STA		timeout1+2
  11218 00E132 20 5B E1                     	JSR		MusicWaitTimeout
  11219 00E135 A9 04 05                     	LDA		#$0504				; gate off
  11220 00E138 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11221 00E140 78                           	SEI
  11222 00E141 BD 9C E0                     	LDA		music_tbl+10,x		; note release delay
  11223 00E144 8D 04 01                     	STA		timeout1
  11224 00E147 BD 9E E0                     	LDA		music_tbl+12,x
  11225 00E14A 8D 06 01                     	STA		timeout1+2
  11226 00E14D 20 5B E1                     	JSR		MusicWaitTimeout
  11227 00E150 E8                           	INX
  11228 00E151 E8                           	INX
  11229 00E152 42 E8                        	INX4
  11230 00E154 42 E8                        	INX4
  11231 00E156 42 E8                        	INX4
  11232 00E158 80 A5                        	BRA		.0001
  11233 00E15A                             .xit:
  11234 00E15A 60                           	RTS
                                           
  11236 00E15B                             MusicWaitTimeout:
  11237 00E15B                             .0001:
  11238 00E15B 58                           	CLI
  11239 00E15C EA                           	NOP
  11240 00E15D EA                           	NOP
  11241 00E15E 78                           	SEI
  11242 00E15F AD 04 01                     	LDA		timeout1
  11243 00E162 0D 06 01                     	ORA		timeout1+2
  11244 00E165 D0 F4                        	BNE		.0001
  11245 00E167 58                           	CLI
  11246 00E168 60                           	RTS
                                           
  11248 00E169                             MusicTimeoutIRQ:
  11249 00E169 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
  11252 00E16B AD 04 01                     	LDA		timeout1
  11253 00E16E 0D 06 01                     	ORA		timeout1+2
  11254 00E171 F0 13                        	BEQ		.0001
  11255 00E173 38                           	SEC
  11256 00E174 AD 04 01                     	LDA		timeout1
  11257 00E177 E9 01 00                     	SBC		#1
  11258 00E17A 8D 04 01                     	STA		timeout1
  11259 00E17D AD 06 01                     	LDA		timeout1+2
  11260 00E180 E9 00 00                     	SBC		#0
  11261 00E183 8D 06 01                     	STA		timeout1+2
  11262 00E186                             .0001:
  11263 00E186 60                           	RTS
                                           
  11265 00E187 FF FF FF FF FF FF FF FF      	.org	$FE00
  11265 00E18F FF FF FF FF FF FF FF FF    
  11265 00E197 FF FF FF FF FF FF FF FF    
  11265 00E19F FF FF FF FF FF FF FF FF    
  11265 00E1A7 FF FF FF FF FF FF FF FF    
  11265 00E1AF FF FF FF FF FF FF FF FF    
  11265 00E1B7 FF FF FF FF FF FF FF FF    
  11265 00E1BF FF FF FF FF FF FF FF FF    
  11265 00E1C7 FF FF FF FF FF FF FF FF    
  11265 00E1CF FF FF FF FF FF FF FF FF    
  11265 00E1D7 FF FF FF FF FF FF FF FF    
  11265 00E1DF FF FF FF FF FF FF FF FF    
  11265 00E1E7 FF FF FF FF FF FF FF FF    
  11265 00E1EF FF FF FF FF FF FF FF FF    
  11265 00E1F7 FF FF FF FF FF FF FF FF    
  11265 00E1FF FF FF FF FF FF FF FF FF    
  11265 00E207 FF FF FF FF FF FF FF FF    
  11265 00E20F FF FF FF FF FF FF FF FF    
  11265 00E217 FF FF FF FF FF FF FF FF    
  11265 00E21F FF FF FF FF FF FF FF FF    
  11265 00E227 FF FF FF FF FF FF FF FF    
  11265 00E22F FF FF FF FF FF FF FF FF    
  11265 00E237 FF FF FF FF FF FF FF FF    
  11265 00E23F FF FF FF FF FF FF FF FF    
  11265 00E247 FF FF FF FF FF FF FF FF    
  11265 00E24F FF FF FF FF FF FF FF FF    
  11265 00E257 FF FF FF FF FF FF FF FF    
  11265 00E25F FF FF FF FF FF FF FF FF    
  11265 00E267 FF FF FF FF FF FF FF FF    
  11265 00E26F FF FF FF FF FF FF FF FF    
  11265 00E277 FF FF FF FF FF FF FF FF    
  11265 00E27F FF FF FF FF FF FF FF FF    
  11265 00E287 FF FF FF FF FF FF FF FF    
  11265 00E28F FF FF FF FF FF FF FF FF    
  11265 00E297 FF FF FF FF FF FF FF FF    
  11265 00E29F FF FF FF FF FF FF FF FF    
  11265 00E2A7 FF FF FF FF FF FF FF FF    
  11265 00E2AF FF FF FF FF FF FF FF FF    
  11265 00E2B7 FF FF FF FF FF FF FF FF    
  11265 00E2BF FF FF FF FF FF FF FF FF    
  11265 00E2C7 FF FF FF FF FF FF FF FF    
  11265 00E2CF FF FF FF FF FF FF FF FF    
  11265 00E2D7 FF FF FF FF FF FF FF FF    
  11265 00E2DF FF FF FF FF FF FF FF FF    
  11265 00E2E7 FF FF FF FF FF FF FF FF    
  11265 00E2EF FF FF FF FF FF FF FF FF    
  11265 00E2F7 FF FF FF FF FF FF FF FF    
  11265 00E2FF FF FF FF FF FF FF FF FF    
  11265 00E307 FF FF FF FF FF FF FF FF    
  11265 00E30F FF FF FF FF FF FF FF FF    
  11265 00E317 FF FF FF FF FF FF FF FF    
  11265 00E31F FF FF FF FF FF FF FF FF    
  11265 00E327 FF FF FF FF FF FF FF FF    
  11265 00E32F FF FF FF FF FF FF FF FF    
  11265 00E337 FF FF FF FF FF FF FF FF    
  11265 00E33F FF FF FF FF FF FF FF FF    
  11265 00E347 FF FF FF FF FF FF FF FF    
  11265 00E34F FF FF FF FF FF FF FF FF    
  11265 00E357 FF FF FF FF FF FF FF FF    
  11265 00E35F FF FF FF FF FF FF FF FF    
  11265 00E367 FF FF FF FF FF FF FF FF    
  11265 00E36F FF FF FF FF FF FF FF FF    
  11265 00E377 FF FF FF FF FF FF FF FF    
  11265 00E37F FF FF FF FF FF FF FF FF    
  11265 00E387 FF FF FF FF FF FF FF FF    
  11265 00E38F FF FF FF FF FF FF FF FF    
  11265 00E397 FF FF FF FF FF FF FF FF    
  11265 00E39F FF FF FF FF FF FF FF FF    
  11265 00E3A7 FF FF FF FF FF FF FF FF    
  11265 00E3AF FF FF FF FF FF FF FF FF    
  11265 00E3B7 FF FF FF FF FF FF FF FF    
  11265 00E3BF FF FF FF FF FF FF FF FF    
  11265 00E3C7 FF FF FF FF FF FF FF FF    
  11265 00E3CF FF FF FF FF FF FF FF FF    
  11265 00E3D7 FF FF FF FF FF FF FF FF    
  11265 00E3DF FF FF FF FF FF FF FF FF    
  11265 00E3E7 FF FF FF FF FF FF FF FF    
  11265 00E3EF FF FF FF FF FF FF FF FF    
  11265 00E3F7 FF FF FF FF FF FF FF FF    
  11265 00E3FF FF FF FF FF FF FF FF FF    
  11265 00E407 FF FF FF FF FF FF FF FF    
  11265 00E40F FF FF FF FF FF FF FF FF    
  11265 00E417 FF FF FF FF FF FF FF FF    
  11265 00E41F FF FF FF FF FF FF FF FF    
  11265 00E427 FF FF FF FF FF FF FF FF    
  11265 00E42F FF FF FF FF FF FF FF FF    
  11265 00E437 FF FF FF FF FF FF FF FF    
  11265 00E43F FF FF FF FF FF FF FF FF    
  11265 00E447 FF FF FF FF FF FF FF FF    
  11265 00E44F FF FF FF FF FF FF FF FF    
  11265 00E457 FF FF FF FF FF FF FF FF    
  11265 00E45F FF FF FF FF FF FF FF FF    
  11265 00E467 FF FF FF FF FF FF FF FF    
  11265 00E46F FF FF FF FF FF FF FF FF    
  11265 00E477 FF FF FF FF FF FF FF FF    
  11265 00E47F FF FF FF FF FF FF FF FF    
  11265 00E487 FF FF FF FF FF FF FF FF    
  11265 00E48F FF FF FF FF FF FF FF FF    
  11265 00E497 FF FF FF FF FF FF FF FF    
  11265 00E49F FF FF FF FF FF FF FF FF    
  11265 00E4A7 FF FF FF FF FF FF FF FF    
  11265 00E4AF FF FF FF FF FF FF FF FF    
  11265 00E4B7 FF FF FF FF FF FF FF FF    
  11265 00E4BF FF FF FF FF FF FF FF FF    
  11265 00E4C7 FF FF FF FF FF FF FF FF    
  11265 00E4CF FF FF FF FF FF FF FF FF    
  11265 00E4D7 FF FF FF FF FF FF FF FF    
  11265 00E4DF FF FF FF FF FF FF FF FF    
  11265 00E4E7 FF FF FF FF FF FF FF FF    
  11265 00E4EF FF FF FF FF FF FF FF FF    
  11265 00E4F7 FF FF FF FF FF FF FF FF    
  11265 00E4FF FF FF FF FF FF FF FF FF    
  11265 00E507 FF FF FF FF FF FF FF FF    
  11265 00E50F FF FF FF FF FF FF FF FF    
  11265 00E517 FF FF FF FF FF FF FF FF    
  11265 00E51F FF FF FF FF FF FF FF FF    
  11265 00E527 FF FF FF FF FF FF FF FF    
  11265 00E52F FF FF FF FF FF FF FF FF    
  11265 00E537 FF FF FF FF FF FF FF FF    
  11265 00E53F FF FF FF FF FF FF FF FF    
  11265 00E547 FF FF FF FF FF FF FF FF    
  11265 00E54F FF FF FF FF FF FF FF FF    
  11265 00E557 FF FF FF FF FF FF FF FF    
  11265 00E55F FF FF FF FF FF FF FF FF    
  11265 00E567 FF FF FF FF FF FF FF FF    
  11265 00E56F FF FF FF FF FF FF FF FF    
  11265 00E577 FF FF FF FF FF FF FF FF    
  11265 00E57F FF FF FF FF FF FF FF FF    
  11265 00E587 FF FF FF FF FF FF FF FF    
  11265 00E58F FF FF FF FF FF FF FF FF    
  11265 00E597 FF FF FF FF FF FF FF FF    
  11265 00E59F FF FF FF FF FF FF FF FF    
  11265 00E5A7 FF FF FF FF FF FF FF FF    
  11265 00E5AF FF FF FF FF FF FF FF FF    
  11265 00E5B7 FF FF FF FF FF FF FF FF    
  11265 00E5BF FF FF FF FF FF FF FF FF    
  11265 00E5C7 FF FF FF FF FF FF FF FF    
  11265 00E5CF FF FF FF FF FF FF FF FF    
  11265 00E5D7 FF FF FF FF FF FF FF FF    
  11265 00E5DF FF FF FF FF FF FF FF FF    
  11265 00E5E7 FF FF FF FF FF FF FF FF    
  11265 00E5EF FF FF FF FF FF FF FF FF    
  11265 00E5F7 FF FF FF FF FF FF FF FF    
  11265 00E5FF FF FF FF FF FF FF FF FF    
  11265 00E607 FF FF FF FF FF FF FF FF    
  11265 00E60F FF FF FF FF FF FF FF FF    
  11265 00E617 FF FF FF FF FF FF FF FF    
  11265 00E61F FF FF FF FF FF FF FF FF    
  11265 00E627 FF FF FF FF FF FF FF FF    
  11265 00E62F FF FF FF FF FF FF FF FF    
  11265 00E637 FF FF FF FF FF FF FF FF    
  11265 00E63F FF FF FF FF FF FF FF FF    
  11265 00E647 FF FF FF FF FF FF FF FF    
  11265 00E64F FF FF FF FF FF FF FF FF    
  11265 00E657 FF FF FF FF FF FF FF FF    
  11265 00E65F FF FF FF FF FF FF FF FF    
  11265 00E667 FF FF FF FF FF FF FF FF    
  11265 00E66F FF FF FF FF FF FF FF FF    
  11265 00E677 FF FF FF FF FF FF FF FF    
  11265 00E67F FF FF FF FF FF FF FF FF    
  11265 00E687 FF FF FF FF FF FF FF FF    
  11265 00E68F FF FF FF FF FF FF FF FF    
  11265 00E697 FF FF FF FF FF FF FF FF    
  11265 00E69F FF FF FF FF FF FF FF FF    
  11265 00E6A7 FF FF FF FF FF FF FF FF    
  11265 00E6AF FF FF FF FF FF FF FF FF    
  11265 00E6B7 FF FF FF FF FF FF FF FF    
  11265 00E6BF FF FF FF FF FF FF FF FF    
  11265 00E6C7 FF FF FF FF FF FF FF FF    
  11265 00E6CF FF FF FF FF FF FF FF FF    
  11265 00E6D7 FF FF FF FF FF FF FF FF    
  11265 00E6DF FF FF FF FF FF FF FF FF    
  11265 00E6E7 FF FF FF FF FF FF FF FF    
  11265 00E6EF FF FF FF FF FF FF FF FF    
  11265 00E6F7 FF FF FF FF FF FF FF FF    
  11265 00E6FF FF FF FF FF FF FF FF FF    
  11265 00E707 FF FF FF FF FF FF FF FF    
  11265 00E70F FF FF FF FF FF FF FF FF    
  11265 00E717 FF FF FF FF FF FF FF FF    
  11265 00E71F FF FF FF FF FF FF FF FF    
  11265 00E727 FF FF FF FF FF FF FF FF    
  11265 00E72F FF FF FF FF FF FF FF FF    
  11265 00E737 FF FF FF FF FF FF FF FF    
  11265 00E73F FF FF FF FF FF FF FF FF    
  11265 00E747 FF FF FF FF FF FF FF FF    
  11265 00E74F FF FF FF FF FF FF FF FF    
  11265 00E757 FF FF FF FF FF FF FF FF    
  11265 00E75F FF FF FF FF FF FF FF FF    
  11265 00E767 FF FF FF FF FF FF FF FF    
  11265 00E76F FF FF FF FF FF FF FF FF    
  11265 00E777 FF FF FF FF FF FF FF FF    
  11265 00E77F FF FF FF FF FF FF FF FF    
  11265 00E787 FF FF FF FF FF FF FF FF    
  11265 00E78F FF FF FF FF FF FF FF FF    
  11265 00E797 FF FF FF FF FF FF FF FF    
  11265 00E79F FF FF FF FF FF FF FF FF    
  11265 00E7A7 FF FF FF FF FF FF FF FF    
  11265 00E7AF FF FF FF FF FF FF FF FF    
  11265 00E7B7 FF FF FF FF FF FF FF FF    
  11265 00E7BF FF FF FF FF FF FF FF FF    
  11265 00E7C7 FF FF FF FF FF FF FF FF    
  11265 00E7CF FF FF FF FF FF FF FF FF    
  11265 00E7D7 FF FF FF FF FF FF FF FF    
  11265 00E7DF FF FF FF FF FF FF FF FF    
  11265 00E7E7 FF FF FF FF FF FF FF FF    
  11265 00E7EF FF FF FF FF FF FF FF FF    
  11265 00E7F7 FF FF FF FF FF FF FF FF    
  11265 00E7FF FF FF FF FF FF FF FF FF    
  11265 00E807 FF FF FF FF FF FF FF FF    
  11265 00E80F FF FF FF FF FF FF FF FF    
  11265 00E817 FF FF FF FF FF FF FF FF    
  11265 00E81F FF FF FF FF FF FF FF FF    
  11265 00E827 FF FF FF FF FF FF FF FF    
  11265 00E82F FF FF FF FF FF FF FF FF    
  11265 00E837 FF FF FF FF FF FF FF FF    
  11265 00E83F FF FF FF FF FF FF FF FF    
  11265 00E847 FF FF FF FF FF FF FF FF    
  11265 00E84F FF FF FF FF FF FF FF FF    
  11265 00E857 FF FF FF FF FF FF FF FF    
  11265 00E85F FF FF FF FF FF FF FF FF    
  11265 00E867 FF FF FF FF FF FF FF FF    
  11265 00E86F FF FF FF FF FF FF FF FF    
  11265 00E877 FF FF FF FF FF FF FF FF    
  11265 00E87F FF FF FF FF FF FF FF FF    
  11265 00E887 FF FF FF FF FF FF FF FF    
  11265 00E88F FF FF FF FF FF FF FF FF    
  11265 00E897 FF FF FF FF FF FF FF FF    
  11265 00E89F FF FF FF FF FF FF FF FF    
  11265 00E8A7 FF FF FF FF FF FF FF FF    
  11265 00E8AF FF FF FF FF FF FF FF FF    
  11265 00E8B7 FF FF FF FF FF FF FF FF    
  11265 00E8BF FF FF FF FF FF FF FF FF    
  11265 00E8C7 FF FF FF FF FF FF FF FF    
  11265 00E8CF FF FF FF FF FF FF FF FF    
  11265 00E8D7 FF FF FF FF FF FF FF FF    
  11265 00E8DF FF FF FF FF FF FF FF FF    
  11265 00E8E7 FF FF FF FF FF FF FF FF    
  11265 00E8EF FF FF FF FF FF FF FF FF    
  11265 00E8F7 FF FF FF FF FF FF FF FF    
  11265 00E8FF FF FF FF FF FF FF FF FF    
  11265 00E907 FF FF FF FF FF FF FF FF    
  11265 00E90F FF FF FF FF FF FF FF FF    
  11265 00E917 FF FF FF FF FF FF FF FF    
  11265 00E91F FF FF FF FF FF FF FF FF    
  11265 00E927 FF FF FF FF FF FF FF FF    
  11265 00E92F FF FF FF FF FF FF FF FF    
  11265 00E937 FF FF FF FF FF FF FF FF    
  11265 00E93F FF FF FF FF FF FF FF FF    
  11265 00E947 FF FF FF FF FF FF FF FF    
  11265 00E94F FF FF FF FF FF FF FF FF    
  11265 00E957 FF FF FF FF FF FF FF FF    
  11265 00E95F FF FF FF FF FF FF FF FF    
  11265 00E967 FF FF FF FF FF FF FF FF    
  11265 00E96F FF FF FF FF FF FF FF FF    
  11265 00E977 FF FF FF FF FF FF FF FF    
  11265 00E97F FF FF FF FF FF FF FF FF    
  11265 00E987 FF FF FF FF FF FF FF FF    
  11265 00E98F FF FF FF FF FF FF FF FF    
  11265 00E997 FF FF FF FF FF FF FF FF    
  11265 00E99F FF FF FF FF FF FF FF FF    
  11265 00E9A7 FF FF FF FF FF FF FF FF    
  11265 00E9AF FF FF FF FF FF FF FF FF    
  11265 00E9B7 FF FF FF FF FF FF FF FF    
  11265 00E9BF FF FF FF FF FF FF FF FF    
  11265 00E9C7 FF FF FF FF FF FF FF FF    
  11265 00E9CF FF FF FF FF FF FF FF FF    
  11265 00E9D7 FF FF FF FF FF FF FF FF    
  11265 00E9DF FF FF FF FF FF FF FF FF    
  11265 00E9E7 FF FF FF FF FF FF FF FF    
  11265 00E9EF FF FF FF FF FF FF FF FF    
  11265 00E9F7 FF FF FF FF FF FF FF FF    
  11265 00E9FF FF FF FF FF FF FF FF FF    
  11265 00EA07 FF FF FF FF FF FF FF FF    
  11265 00EA0F FF FF FF FF FF FF FF FF    
  11265 00EA17 FF FF FF FF FF FF FF FF    
  11265 00EA1F FF FF FF FF FF FF FF FF    
  11265 00EA27 FF FF FF FF FF FF FF FF    
  11265 00EA2F FF FF FF FF FF FF FF FF    
  11265 00EA37 FF FF FF FF FF FF FF FF    
  11265 00EA3F FF FF FF FF FF FF FF FF    
  11265 00EA47 FF FF FF FF FF FF FF FF    
  11265 00EA4F FF FF FF FF FF FF FF FF    
  11265 00EA57 FF FF FF FF FF FF FF FF    
  11265 00EA5F FF FF FF FF FF FF FF FF    
  11265 00EA67 FF FF FF FF FF FF FF FF    
  11265 00EA6F FF FF FF FF FF FF FF FF    
  11265 00EA77 FF FF FF FF FF FF FF FF    
  11265 00EA7F FF FF FF FF FF FF FF FF    
  11265 00EA87 FF FF FF FF FF FF FF FF    
  11265 00EA8F FF FF FF FF FF FF FF FF    
  11265 00EA97 FF FF FF FF FF FF FF FF    
  11265 00EA9F FF FF FF FF FF FF FF FF    
  11265 00EAA7 FF FF FF FF FF FF FF FF    
  11265 00EAAF FF FF FF FF FF FF FF FF    
  11265 00EAB7 FF FF FF FF FF FF FF FF    
  11265 00EABF FF FF FF FF FF FF FF FF    
  11265 00EAC7 FF FF FF FF FF FF FF FF    
  11265 00EACF FF FF FF FF FF FF FF FF    
  11265 00EAD7 FF FF FF FF FF FF FF FF    
  11265 00EADF FF FF FF FF FF FF FF FF    
  11265 00EAE7 FF FF FF FF FF FF FF FF    
  11265 00EAEF FF FF FF FF FF FF FF FF    
  11265 00EAF7 FF FF FF FF FF FF FF FF    
  11265 00EAFF FF FF FF FF FF FF FF FF    
  11265 00EB07 FF FF FF FF FF FF FF FF    
  11265 00EB0F FF FF FF FF FF FF FF FF    
  11265 00EB17 FF FF FF FF FF FF FF FF    
  11265 00EB1F FF FF FF FF FF FF FF FF    
  11265 00EB27 FF FF FF FF FF FF FF FF    
  11265 00EB2F FF FF FF FF FF FF FF FF    
  11265 00EB37 FF FF FF FF FF FF FF FF    
  11265 00EB3F FF FF FF FF FF FF FF FF    
  11265 00EB47 FF FF FF FF FF FF FF FF    
  11265 00EB4F FF FF FF FF FF FF FF FF    
  11265 00EB57 FF FF FF FF FF FF FF FF    
  11265 00EB5F FF FF FF FF FF FF FF FF    
  11265 00EB67 FF FF FF FF FF FF FF FF    
  11265 00EB6F FF FF FF FF FF FF FF FF    
  11265 00EB77 FF FF FF FF FF FF FF FF    
  11265 00EB7F FF FF FF FF FF FF FF FF    
  11265 00EB87 FF FF FF FF FF FF FF FF    
  11265 00EB8F FF FF FF FF FF FF FF FF    
  11265 00EB97 FF FF FF FF FF FF FF FF    
  11265 00EB9F FF FF FF FF FF FF FF FF    
  11265 00EBA7 FF FF FF FF FF FF FF FF    
  11265 00EBAF FF FF FF FF FF FF FF FF    
  11265 00EBB7 FF FF FF FF FF FF FF FF    
  11265 00EBBF FF FF FF FF FF FF FF FF    
  11265 00EBC7 FF FF FF FF FF FF FF FF    
  11265 00EBCF FF FF FF FF FF FF FF FF    
  11265 00EBD7 FF FF FF FF FF FF FF FF    
  11265 00EBDF FF FF FF FF FF FF FF FF    
  11265 00EBE7 FF FF FF FF FF FF FF FF    
  11265 00EBEF FF FF FF FF FF FF FF FF    
  11265 00EBF7 FF FF FF FF FF FF FF FF    
  11265 00EBFF FF FF FF FF FF FF FF FF    
  11265 00EC07 FF FF FF FF FF FF FF FF    
  11265 00EC0F FF FF FF FF FF FF FF FF    
  11265 00EC17 FF FF FF FF FF FF FF FF    
  11265 00EC1F FF FF FF FF FF FF FF FF    
  11265 00EC27 FF FF FF FF FF FF FF FF    
  11265 00EC2F FF FF FF FF FF FF FF FF    
  11265 00EC37 FF FF FF FF FF FF FF FF    
  11265 00EC3F FF FF FF FF FF FF FF FF    
  11265 00EC47 FF FF FF FF FF FF FF FF    
  11265 00EC4F FF FF FF FF FF FF FF FF    
  11265 00EC57 FF FF FF FF FF FF FF FF    
  11265 00EC5F FF FF FF FF FF FF FF FF    
  11265 00EC67 FF FF FF FF FF FF FF FF    
  11265 00EC6F FF FF FF FF FF FF FF FF    
  11265 00EC77 FF FF FF FF FF FF FF FF    
  11265 00EC7F FF FF FF FF FF FF FF FF    
  11265 00EC87 FF FF FF FF FF FF FF FF    
  11265 00EC8F FF FF FF FF FF FF FF FF    
  11265 00EC97 FF FF FF FF FF FF FF FF    
  11265 00EC9F FF FF FF FF FF FF FF FF    
  11265 00ECA7 FF FF FF FF FF FF FF FF    
  11265 00ECAF FF FF FF FF FF FF FF FF    
  11265 00ECB7 FF FF FF FF FF FF FF FF    
  11265 00ECBF FF FF FF FF FF FF FF FF    
  11265 00ECC7 FF FF FF FF FF FF FF FF    
  11265 00ECCF FF FF FF FF FF FF FF FF    
  11265 00ECD7 FF FF FF FF FF FF FF FF    
  11265 00ECDF FF FF FF FF FF FF FF FF    
  11265 00ECE7 FF FF FF FF FF FF FF FF    
  11265 00ECEF FF FF FF FF FF FF FF FF    
  11265 00ECF7 FF FF FF FF FF FF FF FF    
  11265 00ECFF FF FF FF FF FF FF FF FF    
  11265 00ED07 FF FF FF FF FF FF FF FF    
  11265 00ED0F FF FF FF FF FF FF FF FF    
  11265 00ED17 FF FF FF FF FF FF FF FF    
  11265 00ED1F FF FF FF FF FF FF FF FF    
  11265 00ED27 FF FF FF FF FF FF FF FF    
  11265 00ED2F FF FF FF FF FF FF FF FF    
  11265 00ED37 FF FF FF FF FF FF FF FF    
  11265 00ED3F FF FF FF FF FF FF FF FF    
  11265 00ED47 FF FF FF FF FF FF FF FF    
  11265 00ED4F FF FF FF FF FF FF FF FF    
  11265 00ED57 FF FF FF FF FF FF FF FF    
  11265 00ED5F FF FF FF FF FF FF FF FF    
  11265 00ED67 FF FF FF FF FF FF FF FF    
  11265 00ED6F FF FF FF FF FF FF FF FF    
  11265 00ED77 FF FF FF FF FF FF FF FF    
  11265 00ED7F FF FF FF FF FF FF FF FF    
  11265 00ED87 FF FF FF FF FF FF FF FF    
  11265 00ED8F FF FF FF FF FF FF FF FF    
  11265 00ED97 FF FF FF FF FF FF FF FF    
  11265 00ED9F FF FF FF FF FF FF FF FF    
  11265 00EDA7 FF FF FF FF FF FF FF FF    
  11265 00EDAF FF FF FF FF FF FF FF FF    
  11265 00EDB7 FF FF FF FF FF FF FF FF    
  11265 00EDBF FF FF FF FF FF FF FF FF    
  11265 00EDC7 FF FF FF FF FF FF FF FF    
  11265 00EDCF FF FF FF FF FF FF FF FF    
  11265 00EDD7 FF FF FF FF FF FF FF FF    
  11265 00EDDF FF FF FF FF FF FF FF FF    
  11265 00EDE7 FF FF FF FF FF FF FF FF    
  11265 00EDEF FF FF FF FF FF FF FF FF    
  11265 00EDF7 FF FF FF FF FF FF FF FF    
  11265 00EDFF FF FF FF FF FF FF FF FF    
  11265 00EE07 FF FF FF FF FF FF FF FF    
  11265 00EE0F FF FF FF FF FF FF FF FF    
  11265 00EE17 FF FF FF FF FF FF FF FF    
  11265 00EE1F FF FF FF FF FF FF FF FF    
  11265 00EE27 FF FF FF FF FF FF FF FF    
  11265 00EE2F FF FF FF FF FF FF FF FF    
  11265 00EE37 FF FF FF FF FF FF FF FF    
  11265 00EE3F FF FF FF FF FF FF FF FF    
  11265 00EE47 FF FF FF FF FF FF FF FF    
  11265 00EE4F FF FF FF FF FF FF FF FF    
  11265 00EE57 FF FF FF FF FF FF FF FF    
  11265 00EE5F FF FF FF FF FF FF FF FF    
  11265 00EE67 FF FF FF FF FF FF FF FF    
  11265 00EE6F FF FF FF FF FF FF FF FF    
  11265 00EE77 FF FF FF FF FF FF FF FF    
  11265 00EE7F FF FF FF FF FF FF FF FF    
  11265 00EE87 FF FF FF FF FF FF FF FF    
  11265 00EE8F FF FF FF FF FF FF FF FF    
  11265 00EE97 FF FF FF FF FF FF FF FF    
  11265 00EE9F FF FF FF FF FF FF FF FF    
  11265 00EEA7 FF FF FF FF FF FF FF FF    
  11265 00EEAF FF FF FF FF FF FF FF FF    
  11265 00EEB7 FF FF FF FF FF FF FF FF    
  11265 00EEBF FF FF FF FF FF FF FF FF    
  11265 00EEC7 FF FF FF FF FF FF FF FF    
  11265 00EECF FF FF FF FF FF FF FF FF    
  11265 00EED7 FF FF FF FF FF FF FF FF    
  11265 00EEDF FF FF FF FF FF FF FF FF    
  11265 00EEE7 FF FF FF FF FF FF FF FF    
  11265 00EEEF FF FF FF FF FF FF FF FF    
  11265 00EEF7 FF FF FF FF FF FF FF FF    
  11265 00EEFF FF FF FF FF FF FF FF FF    
  11265 00EF07 FF FF FF FF FF FF FF FF    
  11265 00EF0F FF FF FF FF FF FF FF FF    
  11265 00EF17 FF FF FF FF FF FF FF FF    
  11265 00EF1F FF FF FF FF FF FF FF FF    
  11265 00EF27 FF FF FF FF FF FF FF FF    
  11265 00EF2F FF FF FF FF FF FF FF FF    
  11265 00EF37 FF FF FF FF FF FF FF FF    
  11265 00EF3F FF FF FF FF FF FF FF FF    
  11265 00EF47 FF FF FF FF FF FF FF FF    
  11265 00EF4F FF FF FF FF FF FF FF FF    
  11265 00EF57 FF FF FF FF FF FF FF FF    
  11265 00EF5F FF FF FF FF FF FF FF FF    
  11265 00EF67 FF FF FF FF FF FF FF FF    
  11265 00EF6F FF FF FF FF FF FF FF FF    
  11265 00EF77 FF FF FF FF FF FF FF FF    
  11265 00EF7F FF FF FF FF FF FF FF FF    
  11265 00EF87 FF FF FF FF FF FF FF FF    
  11265 00EF8F FF FF FF FF FF FF FF FF    
  11265 00EF97 FF FF FF FF FF FF FF FF    
  11265 00EF9F FF FF FF FF FF FF FF FF    
  11265 00EFA7 FF FF FF FF FF FF FF FF    
  11265 00EFAF FF FF FF FF FF FF FF FF    
  11265 00EFB7 FF FF FF FF FF FF FF FF    
  11265 00EFBF FF FF FF FF FF FF FF FF    
  11265 00EFC7 FF FF FF FF FF FF FF FF    
  11265 00EFCF FF FF FF FF FF FF FF FF    
  11265 00EFD7 FF FF FF FF FF FF FF FF    
  11265 00EFDF FF FF FF FF FF FF FF FF    
  11265 00EFE7 FF FF FF FF FF FF FF FF    
  11265 00EFEF FF FF FF FF FF FF FF FF    
  11265 00EFF7 FF FF FF FF FF FF FF FF    
  11265 00EFFF FF FF FF FF FF FF FF FF    
  11265 00F007 FF FF FF FF FF FF FF FF    
  11265 00F00F FF FF FF FF FF FF FF FF    
  11265 00F017 FF FF FF FF FF FF FF FF    
  11265 00F01F FF FF FF FF FF FF FF FF    
  11265 00F027 FF FF FF FF FF FF FF FF    
  11265 00F02F FF FF FF FF FF FF FF FF    
  11265 00F037 FF FF FF FF FF FF FF FF    
  11265 00F03F FF FF FF FF FF FF FF FF    
  11265 00F047 FF FF FF FF FF FF FF FF    
  11265 00F04F FF FF FF FF FF FF FF FF    
  11265 00F057 FF FF FF FF FF FF FF FF    
  11265 00F05F FF FF FF FF FF FF FF FF    
  11265 00F067 FF FF FF FF FF FF FF FF    
  11265 00F06F FF FF FF FF FF FF FF FF    
  11265 00F077 FF FF FF FF FF FF FF FF    
  11265 00F07F FF FF FF FF FF FF FF FF    
  11265 00F087 FF FF FF FF FF FF FF FF    
  11265 00F08F FF FF FF FF FF FF FF FF    
  11265 00F097 FF FF FF FF FF FF FF FF    
  11265 00F09F FF FF FF FF FF FF FF FF    
  11265 00F0A7 FF FF FF FF FF FF FF FF    
  11265 00F0AF FF FF FF FF FF FF FF FF    
  11265 00F0B7 FF FF FF FF FF FF FF FF    
  11265 00F0BF FF FF FF FF FF FF FF FF    
  11265 00F0C7 FF FF FF FF FF FF FF FF    
  11265 00F0CF FF FF FF FF FF FF FF FF    
  11265 00F0D7 FF FF FF FF FF FF FF FF    
  11265 00F0DF FF FF FF FF FF FF FF FF    
  11265 00F0E7 FF FF FF FF FF FF FF FF    
  11265 00F0EF FF FF FF FF FF FF FF FF    
  11265 00F0F7 FF FF FF FF FF FF FF FF    
  11265 00F0FF FF FF FF FF FF FF FF FF    
  11265 00F107 FF FF FF FF FF FF FF FF    
  11265 00F10F FF FF FF FF FF FF FF FF    
  11265 00F117 FF FF FF FF FF FF FF FF    
  11265 00F11F FF FF FF FF FF FF FF FF    
  11265 00F127 FF FF FF FF FF FF FF FF    
  11265 00F12F FF FF FF FF FF FF FF FF    
  11265 00F137 FF FF FF FF FF FF FF FF    
  11265 00F13F FF FF FF FF FF FF FF FF    
  11265 00F147 FF FF FF FF FF FF FF FF    
  11265 00F14F FF FF FF FF FF FF FF FF    
  11265 00F157 FF FF FF FF FF FF FF FF    
  11265 00F15F FF FF FF FF FF FF FF FF    
  11265 00F167 FF FF FF FF FF FF FF FF    
  11265 00F16F FF FF FF FF FF FF FF FF    
  11265 00F177 FF FF FF FF FF FF FF FF    
  11265 00F17F FF FF FF FF FF FF FF FF    
  11265 00F187 FF FF FF FF FF FF FF FF    
  11265 00F18F FF FF FF FF FF FF FF FF    
  11265 00F197 FF FF FF FF FF FF FF FF    
  11265 00F19F FF FF FF FF FF FF FF FF    
  11265 00F1A7 FF FF FF FF FF FF FF FF    
  11265 00F1AF FF FF FF FF FF FF FF FF    
  11265 00F1B7 FF FF FF FF FF FF FF FF    
  11265 00F1BF FF FF FF FF FF FF FF FF    
  11265 00F1C7 FF FF FF FF FF FF FF FF    
  11265 00F1CF FF FF FF FF FF FF FF FF    
  11265 00F1D7 FF FF FF FF FF FF FF FF    
  11265 00F1DF FF FF FF FF FF FF FF FF    
  11265 00F1E7 FF FF FF FF FF FF FF FF    
  11265 00F1EF FF FF FF FF FF FF FF FF    
  11265 00F1F7 FF FF FF FF FF FF FF FF    
  11265 00F1FF FF FF FF FF FF FF FF FF    
  11265 00F207 FF FF FF FF FF FF FF FF    
  11265 00F20F FF FF FF FF FF FF FF FF    
  11265 00F217 FF FF FF FF FF FF FF FF    
  11265 00F21F FF FF FF FF FF FF FF FF    
  11265 00F227 FF FF FF FF FF FF FF FF    
  11265 00F22F FF FF FF FF FF FF FF FF    
  11265 00F237 FF FF FF FF FF FF FF FF    
  11265 00F23F FF FF FF FF FF FF FF FF    
  11265 00F247 FF FF FF FF FF FF FF FF    
  11265 00F24F FF FF FF FF FF FF FF FF    
  11265 00F257 FF FF FF FF FF FF FF FF    
  11265 00F25F FF FF FF FF FF FF FF FF    
  11265 00F267 FF FF FF FF FF FF FF FF    
  11265 00F26F FF FF FF FF FF FF FF FF    
  11265 00F277 FF FF FF FF FF FF FF FF    
  11265 00F27F FF FF FF FF FF FF FF FF    
  11265 00F287 FF FF FF FF FF FF FF FF    
  11265 00F28F FF FF FF FF FF FF FF FF    
  11265 00F297 FF FF FF FF FF FF FF FF    
  11265 00F29F FF FF FF FF FF FF FF FF    
  11265 00F2A7 FF FF FF FF FF FF FF FF    
  11265 00F2AF FF FF FF FF FF FF FF FF    
  11265 00F2B7 FF FF FF FF FF FF FF FF    
  11265 00F2BF FF FF FF FF FF FF FF FF    
  11265 00F2C7 FF FF FF FF FF FF FF FF    
  11265 00F2CF FF FF FF FF FF FF FF FF    
  11265 00F2D7 FF FF FF FF FF FF FF FF    
  11265 00F2DF FF FF FF FF FF FF FF FF    
  11265 00F2E7 FF FF FF FF FF FF FF FF    
  11265 00F2EF FF FF FF FF FF FF FF FF    
  11265 00F2F7 FF FF FF FF FF FF FF FF    
  11265 00F2FF FF FF FF FF FF FF FF FF    
  11265 00F307 FF FF FF FF FF FF FF FF    
  11265 00F30F FF FF FF FF FF FF FF FF    
  11265 00F317 FF FF FF FF FF FF FF FF    
  11265 00F31F FF FF FF FF FF FF FF FF    
  11265 00F327 FF FF FF FF FF FF FF FF    
  11265 00F32F FF FF FF FF FF FF FF FF    
  11265 00F337 FF FF FF FF FF FF FF FF    
  11265 00F33F FF FF FF FF FF FF FF FF    
  11265 00F347 FF FF FF FF FF FF FF FF    
  11265 00F34F FF FF FF FF FF FF FF FF    
  11265 00F357 FF FF FF FF FF FF FF FF    
  11265 00F35F FF FF FF FF FF FF FF FF    
  11265 00F367 FF FF FF FF FF FF FF FF    
  11265 00F36F FF FF FF FF FF FF FF FF    
  11265 00F377 FF FF FF FF FF FF FF FF    
  11265 00F37F FF FF FF FF FF FF FF FF    
  11265 00F387 FF FF FF FF FF FF FF FF    
  11265 00F38F FF FF FF FF FF FF FF FF    
  11265 00F397 FF FF FF FF FF FF FF FF    
  11265 00F39F FF FF FF FF FF FF FF FF    
  11265 00F3A7 FF FF FF FF FF FF FF FF    
  11265 00F3AF FF FF FF FF FF FF FF FF    
  11265 00F3B7 FF FF FF FF FF FF FF FF    
  11265 00F3BF FF FF FF FF FF FF FF FF    
  11265 00F3C7 FF FF FF FF FF FF FF FF    
  11265 00F3CF FF FF FF FF FF FF FF FF    
  11265 00F3D7 FF FF FF FF FF FF FF FF    
  11265 00F3DF FF FF FF FF FF FF FF FF    
  11265 00F3E7 FF FF FF FF FF FF FF FF    
  11265 00F3EF FF FF FF FF FF FF FF FF    
  11265 00F3F7 FF FF FF FF FF FF FF FF    
  11265 00F3FF FF FF FF FF FF FF FF FF    
  11265 00F407 FF FF FF FF FF FF FF FF    
  11265 00F40F FF FF FF FF FF FF FF FF    
  11265 00F417 FF FF FF FF FF FF FF FF    
  11265 00F41F FF FF FF FF FF FF FF FF    
  11265 00F427 FF FF FF FF FF FF FF FF    
  11265 00F42F FF FF FF FF FF FF FF FF    
  11265 00F437 FF FF FF FF FF FF FF FF    
  11265 00F43F FF FF FF FF FF FF FF FF    
  11265 00F447 FF FF FF FF FF FF FF FF    
  11265 00F44F FF FF FF FF FF FF FF FF    
  11265 00F457 FF FF FF FF FF FF FF FF    
  11265 00F45F FF FF FF FF FF FF FF FF    
  11265 00F467 FF FF FF FF FF FF FF FF    
  11265 00F46F FF FF FF FF FF FF FF FF    
  11265 00F477 FF FF FF FF FF FF FF FF    
  11265 00F47F FF FF FF FF FF FF FF FF    
  11265 00F487 FF FF FF FF FF FF FF FF    
  11265 00F48F FF FF FF FF FF FF FF FF    
  11265 00F497 FF FF FF FF FF FF FF FF    
  11265 00F49F FF FF FF FF FF FF FF FF    
  11265 00F4A7 FF FF FF FF FF FF FF FF    
  11265 00F4AF FF FF FF FF FF FF FF FF    
  11265 00F4B7 FF FF FF FF FF FF FF FF    
  11265 00F4BF FF FF FF FF FF FF FF FF    
  11265 00F4C7 FF FF FF FF FF FF FF FF    
  11265 00F4CF FF FF FF FF FF FF FF FF    
  11265 00F4D7 FF FF FF FF FF FF FF FF    
  11265 00F4DF FF FF FF FF FF FF FF FF    
  11265 00F4E7 FF FF FF FF FF FF FF FF    
  11265 00F4EF FF FF FF FF FF FF FF FF    
  11265 00F4F7 FF FF FF FF FF FF FF FF    
  11265 00F4FF FF FF FF FF FF FF FF FF    
  11265 00F507 FF FF FF FF FF FF FF FF    
  11265 00F50F FF FF FF FF FF FF FF FF    
  11265 00F517 FF FF FF FF FF FF FF FF    
  11265 00F51F FF FF FF FF FF FF FF FF    
  11265 00F527 FF FF FF FF FF FF FF FF    
  11265 00F52F FF FF FF FF FF FF FF FF    
  11265 00F537 FF FF FF FF FF FF FF FF    
  11265 00F53F FF FF FF FF FF FF FF FF    
  11265 00F547 FF FF FF FF FF FF FF FF    
  11265 00F54F FF FF FF FF FF FF FF FF    
  11265 00F557 FF FF FF FF FF FF FF FF    
  11265 00F55F FF FF FF FF FF FF FF FF    
  11265 00F567 FF FF FF FF FF FF FF FF    
  11265 00F56F FF FF FF FF FF FF FF FF    
  11265 00F577 FF FF FF FF FF FF FF FF    
  11265 00F57F FF FF FF FF FF FF FF FF    
  11265 00F587 FF FF FF FF FF FF FF FF    
  11265 00F58F FF FF FF FF FF FF FF FF    
  11265 00F597 FF FF FF FF FF FF FF FF    
  11265 00F59F FF FF FF FF FF FF FF FF    
  11265 00F5A7 FF FF FF FF FF FF FF FF    
  11265 00F5AF FF FF FF FF FF FF FF FF    
  11265 00F5B7 FF FF FF FF FF FF FF FF    
  11265 00F5BF FF FF FF FF FF FF FF FF    
  11265 00F5C7 FF FF FF FF FF FF FF FF    
  11265 00F5CF FF FF FF FF FF FF FF FF    
  11265 00F5D7 FF FF FF FF FF FF FF FF    
  11265 00F5DF FF FF FF FF FF FF FF FF    
  11265 00F5E7 FF FF FF FF FF FF FF FF    
  11265 00F5EF FF FF FF FF FF FF FF FF    
  11265 00F5F7 FF FF FF FF FF FF FF FF    
  11265 00F5FF FF FF FF FF FF FF FF FF    
  11265 00F607 FF FF FF FF FF FF FF FF    
  11265 00F60F FF FF FF FF FF FF FF FF    
  11265 00F617 FF FF FF FF FF FF FF FF    
  11265 00F61F FF FF FF FF FF FF FF FF    
  11265 00F627 FF FF FF FF FF FF FF FF    
  11265 00F62F FF FF FF FF FF FF FF FF    
  11265 00F637 FF FF FF FF FF FF FF FF    
  11265 00F63F FF FF FF FF FF FF FF FF    
  11265 00F647 FF FF FF FF FF FF FF FF    
  11265 00F64F FF FF FF FF FF FF FF FF    
  11265 00F657 FF FF FF FF FF FF FF FF    
  11265 00F65F FF FF FF FF FF FF FF FF    
  11265 00F667 FF FF FF FF FF FF FF FF    
  11265 00F66F FF FF FF FF FF FF FF FF    
  11265 00F677 FF FF FF FF FF FF FF FF    
  11265 00F67F FF FF FF FF FF FF FF FF    
  11265 00F687 FF FF FF FF FF FF FF FF    
  11265 00F68F FF FF FF FF FF FF FF FF    
  11265 00F697 FF FF FF FF FF FF FF FF    
  11265 00F69F FF FF FF FF FF FF FF FF    
  11265 00F6A7 FF FF FF FF FF FF FF FF    
  11265 00F6AF FF FF FF FF FF FF FF FF    
  11265 00F6B7 FF FF FF FF FF FF FF FF    
  11265 00F6BF FF FF FF FF FF FF FF FF    
  11265 00F6C7 FF FF FF FF FF FF FF FF    
  11265 00F6CF FF FF FF FF FF FF FF FF    
  11265 00F6D7 FF FF FF FF FF FF FF FF    
  11265 00F6DF FF FF FF FF FF FF FF FF    
  11265 00F6E7 FF FF FF FF FF FF FF FF    
  11265 00F6EF FF FF FF FF FF FF FF FF    
  11265 00F6F7 FF FF FF FF FF FF FF FF    
  11265 00F6FF FF FF FF FF FF FF FF FF    
  11265 00F707 FF FF FF FF FF FF FF FF    
  11265 00F70F FF FF FF FF FF FF FF FF    
  11265 00F717 FF FF FF FF FF FF FF FF    
  11265 00F71F FF FF FF FF FF FF FF FF    
  11265 00F727 FF FF FF FF FF FF FF FF    
  11265 00F72F FF FF FF FF FF FF FF FF    
  11265 00F737 FF FF FF FF FF FF FF FF    
  11265 00F73F FF FF FF FF FF FF FF FF    
  11265 00F747 FF FF FF FF FF FF FF FF    
  11265 00F74F FF FF FF FF FF FF FF FF    
  11265 00F757 FF FF FF FF FF FF FF FF    
  11265 00F75F FF FF FF FF FF FF FF FF    
  11265 00F767 FF FF FF FF FF FF FF FF    
  11265 00F76F FF FF FF FF FF FF FF FF    
  11265 00F777 FF FF FF FF FF FF FF FF    
  11265 00F77F FF FF FF FF FF FF FF FF    
  11265 00F787 FF FF FF FF FF FF FF FF    
  11265 00F78F FF FF FF FF FF FF FF FF    
  11265 00F797 FF FF FF FF FF FF FF FF    
  11265 00F79F FF FF FF FF FF FF FF FF    
  11265 00F7A7 FF FF FF FF FF FF FF FF    
  11265 00F7AF FF FF FF FF FF FF FF FF    
  11265 00F7B7 FF FF FF FF FF FF FF FF    
  11265 00F7BF FF FF FF FF FF FF FF FF    
  11265 00F7C7 FF FF FF FF FF FF FF FF    
  11265 00F7CF FF FF FF FF FF FF FF FF    
  11265 00F7D7 FF FF FF FF FF FF FF FF    
  11265 00F7DF FF FF FF FF FF FF FF FF    
  11265 00F7E7 FF FF FF FF FF FF FF FF    
  11265 00F7EF FF FF FF FF FF FF FF FF    
  11265 00F7F7 FF FF FF FF FF FF FF FF    
  11265 00F7FF FF FF FF FF FF FF FF FF    
  11265 00F807 FF FF FF FF FF FF FF FF    
  11265 00F80F FF FF FF FF FF FF FF FF    
  11265 00F817 FF FF FF FF FF FF FF FF    
  11265 00F81F FF FF FF FF FF FF FF FF    
  11265 00F827 FF FF FF FF FF FF FF FF    
  11265 00F82F FF FF FF FF FF FF FF FF    
  11265 00F837 FF FF FF FF FF FF FF FF    
  11265 00F83F FF FF FF FF FF FF FF FF    
  11265 00F847 FF FF FF FF FF FF FF FF    
  11265 00F84F FF FF FF FF FF FF FF FF    
  11265 00F857 FF FF FF FF FF FF FF FF    
  11265 00F85F FF FF FF FF FF FF FF FF    
  11265 00F867 FF FF FF FF FF FF FF FF    
  11265 00F86F FF FF FF FF FF FF FF FF    
  11265 00F877 FF FF FF FF FF FF FF FF    
  11265 00F87F FF FF FF FF FF FF FF FF    
  11265 00F887 FF FF FF FF FF FF FF FF    
  11265 00F88F FF FF FF FF FF FF FF FF    
  11265 00F897 FF FF FF FF FF FF FF FF    
  11265 00F89F FF FF FF FF FF FF FF FF    
  11265 00F8A7 FF FF FF FF FF FF FF FF    
  11265 00F8AF FF FF FF FF FF FF FF FF    
  11265 00F8B7 FF FF FF FF FF FF FF FF    
  11265 00F8BF FF FF FF FF FF FF FF FF    
  11265 00F8C7 FF FF FF FF FF FF FF FF    
  11265 00F8CF FF FF FF FF FF FF FF FF    
  11265 00F8D7 FF FF FF FF FF FF FF FF    
  11265 00F8DF FF FF FF FF FF FF FF FF    
  11265 00F8E7 FF FF FF FF FF FF FF FF    
  11265 00F8EF FF FF FF FF FF FF FF FF    
  11265 00F8F7 FF FF FF FF FF FF FF FF    
  11265 00F8FF FF FF FF FF FF FF FF FF    
  11265 00F907 FF FF FF FF FF FF FF FF    
  11265 00F90F FF FF FF FF FF FF FF FF    
  11265 00F917 FF FF FF FF FF FF FF FF    
  11265 00F91F FF FF FF FF FF FF FF FF    
  11265 00F927 FF FF FF FF FF FF FF FF    
  11265 00F92F FF FF FF FF FF FF FF FF    
  11265 00F937 FF FF FF FF FF FF FF FF    
  11265 00F93F FF FF FF FF FF FF FF FF    
  11265 00F947 FF FF FF FF FF FF FF FF    
  11265 00F94F FF FF FF FF FF FF FF FF    
  11265 00F957 FF FF FF FF FF FF FF FF    
  11265 00F95F FF FF FF FF FF FF FF FF    
  11265 00F967 FF FF FF FF FF FF FF FF    
  11265 00F96F FF FF FF FF FF FF FF FF    
  11265 00F977 FF FF FF FF FF FF FF FF    
  11265 00F97F FF FF FF FF FF FF FF FF    
  11265 00F987 FF FF FF FF FF FF FF FF    
  11265 00F98F FF FF FF FF FF FF FF FF    
  11265 00F997 FF FF FF FF FF FF FF FF    
  11265 00F99F FF FF FF FF FF FF FF FF    
  11265 00F9A7 FF FF FF FF FF FF FF FF    
  11265 00F9AF FF FF FF FF FF FF FF FF    
  11265 00F9B7 FF FF FF FF FF FF FF FF    
  11265 00F9BF FF FF FF FF FF FF FF FF    
  11265 00F9C7 FF FF FF FF FF FF FF FF    
  11265 00F9CF FF FF FF FF FF FF FF FF    
  11265 00F9D7 FF FF FF FF FF FF FF FF    
  11265 00F9DF FF FF FF FF FF FF FF FF    
  11265 00F9E7 FF FF FF FF FF FF FF FF    
  11265 00F9EF FF FF FF FF FF FF FF FF    
  11265 00F9F7 FF FF FF FF FF FF FF FF    
  11265 00F9FF FF FF FF FF FF FF FF FF    
  11265 00FA07 FF FF FF FF FF FF FF FF    
  11265 00FA0F FF FF FF FF FF FF FF FF    
  11265 00FA17 FF FF FF FF FF FF FF FF    
  11265 00FA1F FF FF FF FF FF FF FF FF    
  11265 00FA27 FF FF FF FF FF FF FF FF    
  11265 00FA2F FF FF FF FF FF FF FF FF    
  11265 00FA37 FF FF FF FF FF FF FF FF    
  11265 00FA3F FF FF FF FF FF FF FF FF    
  11265 00FA47 FF FF FF FF FF FF FF FF    
  11265 00FA4F FF FF FF FF FF FF FF FF    
  11265 00FA57 FF FF FF FF FF FF FF FF    
  11265 00FA5F FF FF FF FF FF FF FF FF    
  11265 00FA67 FF FF FF FF FF FF FF FF    
  11265 00FA6F FF FF FF FF FF FF FF FF    
  11265 00FA77 FF FF FF FF FF FF FF FF    
  11265 00FA7F FF FF FF FF FF FF FF FF    
  11265 00FA87 FF FF FF FF FF FF FF FF    
  11265 00FA8F FF FF FF FF FF FF FF FF    
  11265 00FA97 FF FF FF FF FF FF FF FF    
  11265 00FA9F FF FF FF FF FF FF FF FF    
  11265 00FAA7 FF FF FF FF FF FF FF FF    
  11265 00FAAF FF FF FF FF FF FF FF FF    
  11265 00FAB7 FF FF FF FF FF FF FF FF    
  11265 00FABF FF FF FF FF FF FF FF FF    
  11265 00FAC7 FF FF FF FF FF FF FF FF    
  11265 00FACF FF FF FF FF FF FF FF FF    
  11265 00FAD7 FF FF FF FF FF FF FF FF    
  11265 00FADF FF FF FF FF FF FF FF FF    
  11265 00FAE7 FF FF FF FF FF FF FF FF    
  11265 00FAEF FF FF FF FF FF FF FF FF    
  11265 00FAF7 FF FF FF FF FF FF FF FF    
  11265 00FAFF FF FF FF FF FF FF FF FF    
  11265 00FB07 FF FF FF FF FF FF FF FF    
  11265 00FB0F FF FF FF FF FF FF FF FF    
  11265 00FB17 FF FF FF FF FF FF FF FF    
  11265 00FB1F FF FF FF FF FF FF FF FF    
  11265 00FB27 FF FF FF FF FF FF FF FF    
  11265 00FB2F FF FF FF FF FF FF FF FF    
  11265 00FB37 FF FF FF FF FF FF FF FF    
  11265 00FB3F FF FF FF FF FF FF FF FF    
  11265 00FB47 FF FF FF FF FF FF FF FF    
  11265 00FB4F FF FF FF FF FF FF FF FF    
  11265 00FB57 FF FF FF FF FF FF FF FF    
  11265 00FB5F FF FF FF FF FF FF FF FF    
  11265 00FB67 FF FF FF FF FF FF FF FF    
  11265 00FB6F FF FF FF FF FF FF FF FF    
  11265 00FB77 FF FF FF FF FF FF FF FF    
  11265 00FB7F FF FF FF FF FF FF FF FF    
  11265 00FB87 FF FF FF FF FF FF FF FF    
  11265 00FB8F FF FF FF FF FF FF FF FF    
  11265 00FB97 FF FF FF FF FF FF FF FF    
  11265 00FB9F FF FF FF FF FF FF FF FF    
  11265 00FBA7 FF FF FF FF FF FF FF FF    
  11265 00FBAF FF FF FF FF FF FF FF FF    
  11265 00FBB7 FF FF FF FF FF FF FF FF    
  11265 00FBBF FF FF FF FF FF FF FF FF    
  11265 00FBC7 FF FF FF FF FF FF FF FF    
  11265 00FBCF FF FF FF FF FF FF FF FF    
  11265 00FBD7 FF FF FF FF FF FF FF FF    
  11265 00FBDF FF FF FF FF FF FF FF FF    
  11265 00FBE7 FF FF FF FF FF FF FF FF    
  11265 00FBEF FF FF FF FF FF FF FF FF    
  11265 00FBF7 FF FF FF FF FF FF FF FF    
  11265 00FBFF FF FF FF FF FF FF FF FF    
  11265 00FC07 FF FF FF FF FF FF FF FF    
  11265 00FC0F FF FF FF FF FF FF FF FF    
  11265 00FC17 FF FF FF FF FF FF FF FF    
  11265 00FC1F FF FF FF FF FF FF FF FF    
  11265 00FC27 FF FF FF FF FF FF FF FF    
  11265 00FC2F FF FF FF FF FF FF FF FF    
  11265 00FC37 FF FF FF FF FF FF FF FF    
  11265 00FC3F FF FF FF FF FF FF FF FF    
  11265 00FC47 FF FF FF FF FF FF FF FF    
  11265 00FC4F FF FF FF FF FF FF FF FF    
  11265 00FC57 FF FF FF FF FF FF FF FF    
  11265 00FC5F FF FF FF FF FF FF FF FF    
  11265 00FC67 FF FF FF FF FF FF FF FF    
  11265 00FC6F FF FF FF FF FF FF FF FF    
  11265 00FC77 FF FF FF FF FF FF FF FF    
  11265 00FC7F FF FF FF FF FF FF FF FF    
  11265 00FC87 FF FF FF FF FF FF FF FF    
  11265 00FC8F FF FF FF FF FF FF FF FF    
  11265 00FC97 FF FF FF FF FF FF FF FF    
  11265 00FC9F FF FF FF FF FF FF FF FF    
  11265 00FCA7 FF FF FF FF FF FF FF FF    
  11265 00FCAF FF FF FF FF FF FF FF FF    
  11265 00FCB7 FF FF FF FF FF FF FF FF    
  11265 00FCBF FF FF FF FF FF FF FF FF    
  11265 00FCC7 FF FF FF FF FF FF FF FF    
  11265 00FCCF FF FF FF FF FF FF FF FF    
  11265 00FCD7 FF FF FF FF FF FF FF FF    
  11265 00FCDF FF FF FF FF FF FF FF FF    
  11265 00FCE7 FF FF FF FF FF FF FF FF    
  11265 00FCEF FF FF FF FF FF FF FF FF    
  11265 00FCF7 FF FF FF FF FF FF FF FF    
  11265 00FCFF FF FF FF FF FF FF FF FF    
  11265 00FD07 FF FF FF FF FF FF FF FF    
  11265 00FD0F FF FF FF FF FF FF FF FF    
  11265 00FD17 FF FF FF FF FF FF FF FF    
  11265 00FD1F FF FF FF FF FF FF FF FF    
  11265 00FD27 FF FF FF FF FF FF FF FF    
  11265 00FD2F FF FF FF FF FF FF FF FF    
  11265 00FD37 FF FF FF FF FF FF FF FF    
  11265 00FD3F FF FF FF FF FF FF FF FF    
  11265 00FD47 FF FF FF FF FF FF FF FF    
  11265 00FD4F FF FF FF FF FF FF FF FF    
  11265 00FD57 FF FF FF FF FF FF FF FF    
  11265 00FD5F FF FF FF FF FF FF FF FF    
  11265 00FD67 FF FF FF FF FF FF FF FF    
  11265 00FD6F FF FF FF FF FF FF FF FF    
  11265 00FD77 FF FF FF FF FF FF FF FF    
  11265 00FD7F FF FF FF FF FF FF FF FF    
  11265 00FD87 FF FF FF FF FF FF FF FF    
  11265 00FD8F FF FF FF FF FF FF FF FF    
  11265 00FD97 FF FF FF FF FF FF FF FF    
  11265 00FD9F FF FF FF FF FF FF FF FF    
  11265 00FDA7 FF FF FF FF FF FF FF FF    
  11265 00FDAF FF FF FF FF FF FF FF FF    
  11265 00FDB7 FF FF FF FF FF FF FF FF    
  11265 00FDBF FF FF FF FF FF FF FF FF    
  11265 00FDC7 FF FF FF FF FF FF FF FF    
  11265 00FDCF FF FF FF FF FF FF FF FF    
  11265 00FDD7 FF FF FF FF FF FF FF FF    
  11265 00FDDF FF FF FF FF FF FF FF FF    
  11265 00FDE7 FF FF FF FF FF FF FF FF    
  11265 00FDEF FF FF FF FF FF FF FF FF    
  11265 00FDF7 FF FF FF FF FF FF FF FF    
  11265 00FDFF FF                         
  11266 00FE00 4C F6 D5                     	JMP		SuperGetch
  11267 00FE03 4C 31 D6                     	JMP		warm_start
  11268 00FE06 4C 02 D6                     	JMP		SuperPutch
  11269 00FE09 4C F9 C7                     	JMP		BIOSInput
  11270 00FE0C 4C 0B D6                     	JMP		BasicGetch
  11271 00FE0F 4C 1F D6                     	JMP		xitBasic
                                           
  11273 00FE12 FF FF FF FF FF FF FF FF      	.org 	$FFD6
  11273 00FE1A FF FF FF FF FF FF FF FF    
  11273 00FE22 FF FF FF FF FF FF FF FF    
  11273 00FE2A FF FF FF FF FF FF FF FF    
  11273 00FE32 FF FF FF FF FF FF FF FF    
  11273 00FE3A FF FF FF FF FF FF FF FF    
  11273 00FE42 FF FF FF FF FF FF FF FF    
  11273 00FE4A FF FF FF FF FF FF FF FF    
  11273 00FE52 FF FF FF FF FF FF FF FF    
  11273 00FE5A FF FF FF FF FF FF FF FF    
  11273 00FE62 FF FF FF FF FF FF FF FF    
  11273 00FE6A FF FF FF FF FF FF FF FF    
  11273 00FE72 FF FF FF FF FF FF FF FF    
  11273 00FE7A FF FF FF FF FF FF FF FF    
  11273 00FE82 FF FF FF FF FF FF FF FF    
  11273 00FE8A FF FF FF FF FF FF FF FF    
  11273 00FE92 FF FF FF FF FF FF FF FF    
  11273 00FE9A FF FF FF FF FF FF FF FF    
  11273 00FEA2 FF FF FF FF FF FF FF FF    
  11273 00FEAA FF FF FF FF FF FF FF FF    
  11273 00FEB2 FF FF FF FF FF FF FF FF    
  11273 00FEBA FF FF FF FF FF FF FF FF    
  11273 00FEC2 FF FF FF FF FF FF FF FF    
  11273 00FECA FF FF FF FF FF FF FF FF    
  11273 00FED2 FF FF FF FF FF FF FF FF    
  11273 00FEDA FF FF FF FF FF FF FF FF    
  11273 00FEE2 FF FF FF FF FF FF FF FF    
  11273 00FEEA FF FF FF FF FF FF FF FF    
  11273 00FEF2 FF FF FF FF FF FF FF FF    
  11273 00FEFA FF FF FF FF FF FF FF FF    
  11273 00FF02 FF FF FF FF FF FF FF FF    
  11273 00FF0A FF FF FF FF FF FF FF FF    
  11273 00FF12 FF FF FF FF FF FF FF FF    
  11273 00FF1A FF FF FF FF FF FF FF FF    
  11273 00FF22 FF FF FF FF FF FF FF FF    
  11273 00FF2A FF FF FF FF FF FF FF FF    
  11273 00FF32 FF FF FF FF FF FF FF FF    
  11273 00FF3A FF FF FF FF FF FF FF FF    
  11273 00FF42 FF FF FF FF FF FF FF FF    
  11273 00FF4A FF FF FF FF FF FF FF FF    
  11273 00FF52 FF FF FF FF FF FF FF FF    
  11273 00FF5A FF FF FF FF FF FF FF FF    
  11273 00FF62 FF FF FF FF FF FF FF FF    
  11273 00FF6A FF FF FF FF FF FF FF FF    
  11273 00FF72 FF FF FF FF FF FF FF FF    
  11273 00FF7A FF FF FF FF FF FF FF FF    
  11273 00FF82 FF FF FF FF FF FF FF FF    
  11273 00FF8A FF FF FF FF FF FF FF FF    
  11273 00FF92 FF FF FF FF FF FF FF FF    
  11273 00FF9A FF FF FF FF FF FF FF FF    
  11273 00FFA2 FF FF FF FF FF FF FF FF    
  11273 00FFAA FF FF FF FF FF FF FF FF    
  11273 00FFB2 FF FF FF FF FF FF FF FF    
  11273 00FFBA FF FF FF FF FF FF FF FF    
  11273 00FFC2 FF FF FF FF FF FF FF FF    
  11273 00FFCA FF FF FF FF FF FF FF FF    
  11273 00FFD2 FF FF FF FF                
  11274 00FFD6 04 00                        	dw		4			; task #4
                                           
  11276 00FFD8 FF FF FF FF FF FF            	.org	$FFDE
  11277 00FFDE 06 00                        	dw		6			; task #6
                                           
                                           	.org	$FFE0
  11280 00FFE0 03 00                        	dw		3
                                           
  11282 00FFE2 FF FF FF FF                  	.org 	$FFE6
  11283 00FFE6 08 DD                        	dw		BrkRout
                                           
  11285 00FFE8 FF FF FF FF FF FF            	.org	$FFEE		; '816 IRQ vector
  11286 00FFEE 01 00                        	dw		1			; IRQRout816
                                           
  11288 00FFF0 FF FF FF FF FF FF FF FF      	.org	$FFFC
  11288 00FFF8 FF FF FF FF                
  11289 00FFFC 00 E0                        	dw		$E000
                                           
                                           	.org	$FFFE
  11292 00FFFE 01 00                        	dw		1			; IRQRout02

Checksum=B5B97443

Number of instructions processed: 4985
Number of opcode bytes: 11859
Bytes per instruction: 2.378937 (19.031494 bits)
Clock cycle count: 5419
Clocks per instruction: 1.087061

The above statistics are only estimates.

	The CPI assumes data memory access requires two clock cycles and instruction
	access is single cycle. The actual CPI may be higher if there are memory wait 
	states, or lower if data is found in the cache.
