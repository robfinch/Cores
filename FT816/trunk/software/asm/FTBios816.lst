Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FTBios816.asm

                                        ; ============================================================================
                                        ; FTBios816.asm
                                        ;        __
                                        ;   \\__/ o\    (C) 2014-2017  Robert Finch, Waterloo
                                        ;    \  __ /    All rights reserved.
                                        ;     \/_//     robfinch<remove>@finitron.ca
                                        ;       ||
                                        ;  
                                        ;
                                        ; This source file is free software: you can redistribute it and/or modify 
                                        ; it under the terms of the GNU Lesser General Public License as published 
                                        ; by the Free Software Foundation, either version 3 of the License, or     
                                        ; (at your option) any later version.                                      
                                        ;                                                                          
                                        ; This source file is distributed in the hope that it will be useful,      
                                        ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                        ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                        ; GNU General Public License for more details.                             
                                        ;                                                                          
                                        ; You should have received a copy of the GNU General Public License        
                                        ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                        ;                                                                          
                                        ; ============================================================================
                                        ;
     25 = 000000000000000D                            CR			EQU		13
     26 = 000000000000000A                            LF			EQU		10
     27 = 000000000000001B                            ESC			EQU		$1B
     28 = 0000000000000008                            BS			EQU		8
     29 = 0000000000000003                            CTRLC		EQU		3
                                        
     31 = 0000000000000012                            SC_LSHIFT	EQU		$12
     32 = 0000000000000059                            SC_RSHIFT	EQU		$59
     33 = 00000000000000F0                            SC_KEYUP	EQU		$F0
     34 = 00000000000000E0                            SC_EXTEND	EQU		$E0
     35 = 0000000000000014                            SC_CTRL		EQU		$14
     36 = 0000000000000011                            SC_ALT		EQU		$11
     37 = 0000000000000071                            SC_DEL		EQU		$71		; extend
     38 = 0000000000000058                            SC_LCTRL	EQU		$58
     39 = 0000000000000077                            SC_NUMLOCK	EQU		$77
     40 = 000000000000007E                            SC_SCROLLLOCK	EQU	$7E
     41 = 0000000000000058                            SC_CAPSLOCK	EQU		$58
                                        
     43 = 000000000000001F                            TEXTROWS	EQU		31
     44 = 0000000000000054                            TEXTCOLS	EQU		84
                                        
     46 = 0000000000000004                            TickCount	EQU		$4
     47 = 0000000000000008                            KeyState1	EQU		$8
     48 = 0000000000000009                            KeyState2	EQU		$9
     49 = 000000000000000A                            KeybdLEDs	EQU		$A
     50 = 000000000000000B                            KeybdWaitFlag	EQU	$B
     51 = 000000000000000C                            NumWorkArea	EQU		$C
                                        
                                        ; Range $10 to $1F reserved for hardware counters
     54 = 0000000000000010                            CNT0L		EQU		$10
     55 = 0000000000000011                            CNT0M		EQU		$11
     56 = 0000000000000012                            CNT0H		EQU		$12
     57 = 0000000000000020                            RangeStart	EQU		$20
     58 = 0000000000000024                            RangeEnd	EQU		$24
     59 = 0000000000000030                            CursorX		EQU		$30
     60 = 0000000000000032                            CursorY		EQU		$32
     61 = 0000000000000034                            VideoPos	EQU		$34
     62 = 0000000000000036                            NormAttr	EQU		$36
     63 = 0000000000000038                            StringPos	EQU		$38
     64 = 000000000000003C                            EscState	EQU		$3C
     65 = 0000000000000040                            Vidptr		EQU		$40
     66 = 0000000000000046                            Vidregs		EQU		$46
     67 = 000000000000004C                            Textcols	EQU		$4C
     68 = 000000000000004E                            Textrows	EQU		$4E
                                        
     70 = 0000000000000080                            reg_cs		EQU		$80
     71 = 00000084                      reg_ds		EQU		reg_cs + 4	; Yes, these values need 4 bytes as that is
     72 = 00000088                      reg_ss		EQU		reg_ds + 4	; the format read from the INF instruction.
     73 = 0000008C                      reg_pc		EQU		reg_ss + 4
     74 = 00000090                      reg_a		EQU		reg_pc + 4
     75 = 00000094                      reg_x		EQU		reg_a + 4
     76 = 00000098                      reg_y		EQU		reg_x + 4
     77 = 0000009C                      reg_sp		EQU		reg_y + 4
     78 = 000000A0                      reg_sr		EQU		reg_sp + 4
     79 = 000000A4                      reg_db		EQU		reg_sr + 4
     80 = 000000A8                      reg_dp		EQU		reg_db + 4
     81 = 000000AC                      reg_bl		EQU		reg_dp + 4
     82 = 000000B0                      reg_mp		EQU		reg_bl + 4
                                        
     84 = 0000000000000080                            cs_save		EQU		$80
     85 = 0000000000000084                            ds_save		EQU		$84
     86 = 0000000000000088                            pc_save		EQU		$88
     87 = 000000000000008C                            pb_save		EQU		$8C
     88 = 0000000000000090                            acc_save	EQU		$90
     89 = 0000000000000094                            x_save		EQU		$94
     90 = 0000000000000098                            y_save		EQU		$98
     91 = 000000000000009C                            sp_save		EQU		$9C
     92 = 00000000000000A0                            sr_save		EQU		$A0
     93 = 00000000000000A4                            srx_save	EQU		$A4
     94 = 00000000000000A8                            db_save		EQU		$A8
     95 = 00000000000000AC                            dpr_save	EQU		$AC
                                        
     97 = 00000000000000B8                            running_task	EQU		$B8
                                        
     99 = 00000000000000BA                            keybd_char	EQU		$BA
    100 = 00000000000000BA                            rw_flag		EQU		$BA
    101 = 00000000000000BC                            keybd_cmd	EQU		$BC
    102 = 00000000000000BE                            WorkTR		EQU		$BE
    103 = 00000000000000C0                            ExitCode	EQU		$C0
    104 = 00000000000000C4                            secnum		EQU		$C4
    105 = 00000000000000C8                            bufptr		EQU		$C8
    106 = 00000000000000CC                            qcnt		EQU		$CC
    107 = 00000000000000CE                            IOFocusTask	EQU		$CE
    108 = 00000000000000D0                            TaskSwitchEn	EQU	$D0
    109 = 00000000000000D2                            numsec		EQU		$D2
    110 = 00000000000000D4                            TimeoutList	EQU		$D4
    111 = 0000000000000100                            ldtrec		EQU		$100
    112 = 0000000000000104                            timeout1	EQU		$104
                                        
    114 = 0000000000000300                            RTCBuf		EQU		$300
    115 = 0000000000000380                            FilenameBuf	EQU		$380
    116 = 00000000000003F0                            OutputVec	EQU		$03F0
    117 = 00000000000003F4                            spi_rw_vect	EQU		$03F4
                                        
    119 = 000000000000B000                            PCS0		EQU		$B000
    120 = 0000B002                      PCS1		EQU		PCS0 + 2
    121 = 0000B004                      PCS2		EQU		PCS1 + 2
    122 = 0000B006                      PCS3		EQU		PCS2 + 2
    123 = 0000B008                      PCS4	    EQU		PCS3 + 2
    124 = 0000B00A                      PCS5		EQU		PCS4 + 2
    125 = 0000B010                      CTR0_LMT	EQU		PCS0 + 16
    126 = 0000B013                      CTR0_CTRL	EQU		CTR0_LMT + 3
    127 = 0000B014                      CTR1_LMT	EQU		CTR0_CTRL + 1
    128 = 0000B017                      CTR1_CTRL	EQU		CTR1_LMT + 3
    129 = 000000000000B01F                            MPU_IRQ_STATUS	EQU		$B01F
                                        
    131 = 00000000000D0000                            VIDBUF		EQU		$D0000		; FD0000
    132 = 00000000000EA000                            VIDREGS		EQU		$EA000
    133 = 00000000000EA100                            PRNG		EQU		$EA100
    134 = 00000000000EA110                            KEYBD		EQU		$EA110
    135 = 00000000000EA200                            FAC1		EQU		$EA200
                                        
    137 = 0000000000FEC000                            SPIMASTER	EQU		$00FEC000
    138 = 00FEC000                      SPI_MASTER_VERSION_REG	EQU	SPIMASTER+$00
    139 = 00FEC001                      SPI_MASTER_CONTROL_REG	EQU	SPIMASTER+$01
    140 = 00FEC002                      SPI_TRANS_TYPE_REG	EQU		SPIMASTER+$02
    141 = 00FEC003                      SPI_TRANS_CTRL_REG	EQU		SPIMASTER+$03
    142 = 00FEC004                      SPI_TRANS_STATUS_REG	EQU	SPIMASTER+$04
    143 = 00FEC005                      SPI_TRANS_ERROR_REG		EQU	SPIMASTER+$05
    144 = 00FEC006                      SPI_DIRECT_ACCESS_DATA_REG		EQU	SPIMASTER+$06
    145 = 00FEC007                      SPI_SD_SECT_7_0_REG		EQU	SPIMASTER+$07
    146 = 00FEC008                      SPI_SD_SECT_15_8_REG	EQU	SPIMASTER+$08
    147 = 00FEC009                      SPI_SD_SECT_23_16_REG	EQU	SPIMASTER+$09
    148 = 00FEC00A                      SPI_SD_SECT_31_24_REG	EQU	SPIMASTER+$0A
    149 = 00FEC010                      SPI_RX_FIFO_DATA_REG	EQU	SPIMASTER+$10
    150 = 00FEC011                      SPI_RX_FIFO_DATA_COUNT_MSB	EQU	SPIMASTER+$11
    151 = 00FEC012                      SPI_RX_FIFO_DATA_COUNT_LSB  EQU SPIMASTER+$12
    152 = 00FEC014                      SPI_RX_FIFO_CTRL_REG		EQU	SPIMASTER+$14
    153 = 00FEC020                      SPI_TX_FIFO_DATA_REG	EQU	SPIMASTER+$20
    154 = 00FEC024                      SPI_TX_FIFO_CTRL_REG	EQU	SPIMASTER+$24
    155 = 00FEC030                      SPI_RESP_BYTE1			EQU	SPIMASTER+$30
    156 = 00FEC031                      SPI_RESP_BYTE2			EQU	SPIMASTER+$31
    157 = 00FEC032                      SPI_RESP_BYTE3			EQU	SPIMASTER+$32
    158 = 00FEC033                      SPI_RESP_BYTE4			EQU	SPIMASTER+$33
                                        
    160 = 0000000000000001                            SPI_INIT_SD			EQU		$01
    161 = 0000000000000001                            SPI_TRANS_START		EQU		$01
    162 = 0000000000000001                            SPI_TRANS_BUSY		EQU		$01
    163 = 0000000000000000                            SPI_INIT_NO_ERROR	EQU		$00
    164 = 0000000000000000                            SPI_READ_NO_ERROR	EQU		$00
    165 = 0000000000000000                            SPI_WRITE_NO_ERROR	EQU		$00
    166 = 0000000000000002                            SPI_RW_READ_SD_BLOCK	EQU		$02
    167 = 0000000000000003                            SPI_RW_WRITE_SD_BLOCK	EQU		$03
                                        
    169 = 0000000000FEC100                            I2C_MASTER		EQU		$00FEC100
    170 = 00FEC100                      I2C_PRESCALE_LO	EQU		I2C_MASTER+$00
    171 = 00FEC101                      I2C_PRESCALE_HI	EQU		I2C_MASTER+$01
    172 = 00FEC102                      I2C_CONTROL		EQU		I2C_MASTER+$02
    173 = 00FEC103                      I2C_TX			EQU		I2C_MASTER+$03
    174 = 00FEC103                      I2C_RX			EQU		I2C_MASTER+$03
    175 = 00FEC104                      I2C_CMD			EQU		I2C_MASTER+$04
    176 = 00FEC104                      I2C_STAT		EQU		I2C_MASTER+$04
                                        
    178 = 0000000000FEC200                            READY_FIFO		EQU		$00FEC200
    179 = 0000000000FEC210                            READY_FIFO_CNT	EQU		$00FEC210
    180 = 0000000000FEC300                            TIMEOUT_LIST	EQU		$00FEC300
                                        
    182 = 0000000000000010                            MAX_IRQ_HOOK	EQU		16
                                        
                                        ; Timeout list commands
    185 = 0000000000000000                            TOL_NOP			EQU		0
    186 = 0000000000000001                            TOL_DEC			EQU		1
    187 = 0000000000000002                            TOL_INS			EQU		2
    188 = 0000000000000003                            TOL_RMV			EQU		3
                                        
    190 = 00000000000EB000                            SID			EQU		$EB000		; FEB000
    191 = 0000000000000000                            SID_FREQ0		EQU		$00
    192 = 0000000000000004                            SID_PW0			EQU		$04
    193 = 0000000000000008                            SID_CTRL0		EQU		$08
    194 = 000000000000000C                            SID_ATTACK0		EQU		$0C
    195 = 0000000000000010                            SID_DECAY0		EQU		$10
    196 = 0000000000000014                            SID_SUSTAIN0	EQU		$14
    197 = 0000000000000018                            SID_RELEASE0	EQU		$18
    198 = 000000000000001C                            SID_WADR0		EQU		$1C
    199 = 00000000000000B0                            SID_VOLUME		EQU		$B0
                                        
    201 = 0000000000007868                            do_invaders			EQU		$7868
                                        
    203 = 0000000000000040                            NR_JCB			EQU		64
    204 = 0000000000000200                            NR_TCB			EQU		512
    205 = 0000000000000400                            NR_MBX			EQU		1024
    206 = 0000000000001000                            NR_MSG			EQU		4096
    207 = 0000000000000001                            TS_READY		EQU		1
    208 = 0000000000000002                            TS_PREEMPT		EQU		2
    209 = 0000000000000004                            TS_WAITMSG		EQU		4
    210 = 0000000000000008                            TS_TIMEOUT		EQU		8
    211 = 0000000000000000                            MQS_NEWEST		EQU		0		; message queue strategy
    212 = 0000000000000000                            MT_NONE			EQU		0
    213 = 0000000000000001                            MT_FREE			EQU		1
    214 = 0000000000000000                            MBT_DATA		EQU		0
    215 = 0000000000000000                            E_Ok			EQU		0
    216 = FFFFFFFFFFFFFFFF                            E_NotAlloc		EQU		-1
    217 = FFFFFFFFFFFFFFFE                            E_NoMsg			EQU		-2
    218 = FFFFFFFFFFFFFFFD                            E_NoMoreMsgBlks	EQU		-3
                                        
    220 = 0000000000000040                            TCB_SIZE		EQU		64
    221 = 0000000000020000                            tcbs			EQU		$20000
    222 = 0000000000000000                            TCB_Next		EQU		$00	; 2 byte handles
    223 = 0000000000000002                            TCB_Prev		EQU		$02	; 2 byte handles
    224 = 0000000000000004                            TCB_Timeout		EQU		$04	; 4 byte value
    225 = 0000000000000008                            TCB_mbq_next	EQU		$08	; 2 byte handles
    226 = 000000000000000A                            TCB_mbq_prev	EQU		$0A	; 2 byte handles
    227 = 000000000000000C                            TCB_msg_d1		EQU		$0C	; 4 byte value
    228 = 0000000000000010                            TCB_msg_d2		EQU		$10	; 4 byte value
    229 = 0000000000000014                            TCB_msg_d3		EQU		$14	; 4 byte value
    230 = 0000000000000018                            TCB_msg_tgtadr	EQU		$18	; 2 byte handle
    231 = 000000000000001A                            TCB_msg_retadr	EQU		$1A	; 2 byte handle
    232 = 000000000000001C                            TCB_msg_link	EQU		$1C	; 2 byte handle
    233 = 000000000000001E                            TCB_msg_type	EQU		$1E	; 2 byte value
    234 = 0000000000000020                            TCB_hMbx1		EQU		$20	; 2 byte handle
    235 = 0000000000000022                            TCB_hMbx2		EQU		$22	; 2 byte handle
    236 = 0000000000000024                            TCB_hMbx3		EQU		$24	; 2 byte handle
    237 = 0000000000000026                            TCB_hMbx4		EQU		$26	; 2 byte handle
    238 = 0000000000000028                            TCB_hWaitMbx	EQU		$28	; 2 byte handle
    239 = 000000000000002A                            TCB_number		EQU		$2A	; 2 byte value
    240 = 000000000000002C                            TCB_priority	EQU		$2C	; 1 byte value
    241 = 000000000000002D                            TCB_status		EQU		$2D	; 1 byte value
    242 = 000000000000002E                            TCB_affinity	EQU		$2E	; 1 byte value
    243 = 000000000000002F                            TCB_hJob		EQU		$2F	; 1 byte handle
    244 = 0000000000000030                            TCB_start_tick	EQU		$30	; 4 byte value
    245 = 0000000000000034                            TCB_end_tick	EQU		$34	; 4 byte value
    246 = 0000000000000038                            TCB_ticks		EQU		$38	; 4 byte value
    247 = 000000000000003C                            TCB_exception	EQU		$3C	; 4 byte value
                                        
    249 = 0000000000000400                            JCB_SIZE		EQU		1024
    250 = 00028000                      jcbs			EQU		tcbs + TCB_SIZE * NR_TCB
    251 = 0000000000000000                            JCB_iof_next	EQU		$000	; 1 byte value
    252 = 0000000000000001                            JCB_iof_prev	EQU		$001	; 1 byte value
    253 = 0000000000000002                            JCB_user_name	EQU		$002	; 32 byte value
    254 = 0000000000000022                            JCB_path		EQU		$022	; 256 byte value
    255 = 0000000000000122                            JCB_exit_runfile	EQU	$122	; 256 byte value
    256 = 0000000000000222                            JCB_command_line	EQU	$222	; 256 byte value
    257 = 0000000000000322                            JCB_pVidMem		EQU		$322	; 6 byte value
    258 = 0000000000000328                            JCB_pVirtVidMem	EQU		$328	; 6 byte value
    259 = 000000000000032E                            JCB_VideoCols	EQU		$32E	; 1 byte value
    260 = 000000000000032F                            JCB_VideoRows	EQU		$32F	; 1 byte value
    261 = 0000000000000330                            JCB_CursorRow	EQU		$330	; 1 byte value
    262 = 0000000000000331                            JCB_CursorCol	EQU		$331	; 1 byte value
    263 = 0000000000000332                            JCB_NormAttr	EQU		$332	; 2 byte value
    264 = 0000000000000334                            JCB_KeyState1	EQU		$334	; 2 byte value
    265 = 0000000000000336                            JCB_KeyState2	EQU		$336	; 2 byte value
    266 = 0000000000000338                            JCB_KeybdWaitFlag	EQU	$338	; 1 byte value
    267 = 0000000000000339                            JCB_KeybdHead	EQU		$339
    268 = 000000000000033A                            JCB_KeybdTail	EQU		$33A
    269 = 000000000000033B                            JCB_KeybdBuffer	EQU		$33B	; 32 byte value
    270 = 000000000000035B                            JCB_number		EQU		$35B	; 1 byte value
    271 = 000000000000035C                            JCB_tasks		EQU		$35C	; 2 byte value * 8
    272 = 000000000000035E                            JCB_next		EQU		$35E	; 1 byte value
                                        
                                        ; 1024 mailboxes
    275 = 00038000                      mailboxes		EQU		jcbs + JCB_SIZE * NR_JCB
    276 = 0000000000000018                            MBX_SIZE		EQU		24
    277 = 0000000000000000                            MBX_link		EQU		$00	; 1 byte value
    278 = 0000000000000001                            MBX_owner		EQU		$01	; 1 byte value
    279 = 0000000000000002                            MBX_tq_head		EQU		$02	; 2 byte value
    280 = 0000000000000004                            MBX_tq_tail		EQU		$04	; 2 byte value
    281 = 0000000000000006                            MBX_mq_head		EQU		$06	; 2 byte value
    282 = 0000000000000008                            MBX_mq_tail		EQU		$08	; 2 byte value
    283 = 000000000000000C                            MBX_tq_count	EQU		$0C	; 2 byte value
    284 = 000000000000000E                            MBX_mq_count	EQU		$0E	; 2 byte value
    285 = 0000000000000010                            MBX_mq_size		EQU		$10	; 2 byte value
    286 = 0000000000000012                            MBX_mq_missed	EQU		$12	; 2 byte value
    287 = 0000000000000014                            MBX_mq_strategy	EQU		$14	; 1 byte value
                                        
    289 = 0003E000                      messages	EQU		mailboxes + MBX_SIZE * NR_MBX
    290 = 0000000000000000                            MSG_d1		EQU		$00	; 4 byte value	( 4096 messages )
    291 = 0000000000000004                            MSG_d2		EQU		$04	; 4 byte value
    292 = 0000000000000008                            MSG_d3		EQU		$08	; 4 byte value
    293 = 000000000000000C                            MSG_tgtadr	EQU		$0C	; 2 byte handle
    294 = 000000000000000E                            MSG_retadr	EQU		$0E	; 2 byte handle
    295 = 0000000000000010                            MSG_link	EQU		$10	; 2 byte handle
    296 = 0000000000000012                            MSG_type	EQU		$12	; 2 byte value
    297 = 00000014                      MSG_SIZE	EQU		MSG_type + 2
                                        
    299 = 00052000                      running_task	EQU		messages + MSG_SIZE * NR_MSG
    300 = 00052002                      hTcbTmp		EQU		running_task + 2
    301 = 00052004                      hMbxTmp		EQU		hTcbTmp + 2
    302 = 00052006                      hMsgTmp		EQU		hMbxTmp + 2
    303 = 00052008                      freeMBX		EQU		hMsgTmp + 2
    304 = 0005200A                      freeMSG		EQU		freeMBX + 2
    305 = 0005200C                      nMsgBlk		EQU		freeMSG + 2
    306 = 0005200E                      nMailbox	EQU		nMsgBlk + 2
    307 = 00052010                      IRQ1Hook	EQU		nMailbox + 2
    308 = 00052050                      IRQ1HookEnd	EQU		IRQ1Hook + MAX_IRQ_HOOK * 4
                                        
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
supermon832.asm

                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;	.opt proc65c02,caseinsensitive
                                        	cpu	W65C02
                                        ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;*                                                                                 *
                                        ;*      SUPERMON 816 MACHINE LANGUAGE MONITOR FOR THE W65C816S MICROPROCESSOR      *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;*      Copyright ©1991-2014 by BCS Technology Limited.  All rights reserved.      *
                                        ;*                                                                                 *
                                        ;* Permission is hereby granted to use, copy, modify and distribute this software, *
                                        ;* provided this copyright notice remains in the source code and  proper  attribu- *
                                        ;* tion is given.  Redistribution, regardless of form, must be at no charge to the *
                                        ;* end  user.  This code or any part thereof, including any derivation, MAY NOT be *
                                        ;* incorporated into any package intended for sale,  unless written permission has * 
                                        ;* been given by the copyright holder.                                             *
                                        ;*                                                                                 *
                                        ;* THERE IS NO WARRANTY OF ANY KIND WITH THIS SOFTWARE.  The user assumes all risk *
                                        ;* in connection with the incorporation of this software into any system.          *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* Supermon 816 is a salute to Jim Butterfield, who passed away on June 29, 2007.  *
                                        ;*                                                                                 *
                                        ;* Jim, who was the unofficial  spokesman for  Commodore  International during the *  
                                        ;* heyday of the company's 8 bit supremacy, scratch-developed the Supermon machine *
                                        ;* language monitor for the PET & CBM computers.   When the best-selling Commodore *
                                        ;* 64 was introduced, Jim adapted his software to the new machine & gave the adap- *
                                        ;* tation the name Supermon 64.   Commodore  subsequently  integrated a customized *
                                        ;* version of Supermon 64 into the C-128 to act as the resident M/L monitor.       *
                                        ;*                                                                                 *
                                        ;* Although Supermon 816 is not an adaptation of Supermon 64,  it was  decided  to *
                                        ;* keep the Supermon name alive, since Supermon 816's general operation & user in- *
                                        ;* terface is similar to that of Supermon 64.   Supermon 816 is 100 percent native *
                                        ;* mode 65C816 code & was developed from a blank canvas.                           *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* This version customized for the RTF65002 test system                            *
                                        ;* Finitron.ca                                                                     *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* Supermon 816 is a full featured monitor and supports the following operations:  *
                                        ;*                                                                                 *
                                        ;*     A — Assemble code                                                           *
                                        ;*     C — Compare memory regions                                                  *
                                        ;*     D — Disassemble code                                                        *
                                        ;*     F — Fill memory region (cannot span banks)                                  *
                                        ;*     G — Execute code (stops at BRK)                                             *
                                        ;*     H — Search (hunt) memory region                                             *
                                        ;*     J — Execute code as a subroutine (stops at BRK or RTS)                      *
                                        ;*     M — Dump & display memory range                                             *
                                        ;*     R — Dump & display 65C816 registers                                         *
                                        ;*     T — Copy (transfer) memory region                                           *
                                        ;*     X — Exit Supermon 816 & return to operating environment                     *
                                        ;*     > — Modify up to 32 bytes of memory                                         *
                                        ;*     ; — Modify 65C816 registers                                                 *
                                        ;*                                                                                 *
                                        ;* Supermon 816 accepts binary (%), octal (@), decimal (+) and hexadecimal ($) as  *
                                        ;* input for numeric parameters.  Additionally, the H and > operations accept an   *
                                        ;* ASCII string in place of numeric values by preceding the string with ', e.g.:   *
                                        ;*                                                                                 *
                                        ;*     h 042000 042FFF 'BCS Technology Limited                                     *
                                        ;*                                                                                 *
                                        ;* If no radix symbol is entered hex is assumed.                                   *
                                        ;*                                                                                 *
                                        ;* Numeric conversion is also available.  For example, typing:                     *
                                        ;*                                                                                 *
                                        ;*     +1234567 <CR>                                                               *
                                        ;*                                                                                 *
                                        ;* will display:                                                                   *
                                        ;*                                                                                 *
                                        ;*         $12D687                                                                 *
                                        ;*         +1234567                                                                *
                                        ;*         @04553207                                                               *
                                        ;*         %100101101011010000111                                                  *
                                        ;*                                                                                 *
                                        ;* In the above example, <CR> means the console keyboard's return or enter key.    *
                                        ;*                                                                                 *
                                        ;* All numeric values are internally processed as 32 bit unsigned integers.  Addr- *
                                        ;* esses may be entered as 8, 16 or 24 bit values.  During instruction assembly,   *
                                        ;* immediate mode operands may be forced to 16 bits by preceding the operand with  *
                                        ;* an exclamation point if the instruction can accept a 16 bit operand, e.g.:      *
                                        ;*                                                                                 *
                                        ;*     a 1f2000 lda !#4                                                            *
                                        ;*                                                                                 *
                                        ;* The above will assemble as:                                                     *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A9 04 00     LDA #$0004                                           *
                                        ;*                                                                                 *
                                        ;* Entering:                                                                       *
                                        ;*                                                                                 *
                                        ;*     a 1f2000 ldx !#+157                                                         *
                                        ;*                                                                                 *
                                        ;* will assemble as:                                                               *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A2 9D 00     LDX #$009D                                           *
                                        ;*                                                                                 *
                                        ;* Absent the ! in the operand field, the above would have been assembled as:      *
                                        ;*                                                                                 *
                                        ;*     A 1F2000  A2 9D        LDX #$9D                                             *
                                        ;*                                                                                 *
                                        ;* If an immediate mode operand is greater than $FF assembly of a 16 bit operand   *
                                        ;* is implied.                                                                     *
                                        ;* ——————————————————————————————————————————————————————————————————————————————— *
                                        ;* A Note on the PEA & PEI Instructions                                            *
                                        ;* ————————————————————————————————————                                            *
                                        ;*                                                                                 *
                                        ;* The Eyes and Lichty programming manual uses the following syntax for the PEA    *
                                        ;* and PEI instructions:                                                           *
                                        ;*                                                                                 *
                                        ;*     PEA <operand>                                                               *
                                        ;*     PEI (<operand>)                                                             *
                                        ;*                                                                                 *
                                        ;* The WDC data sheet that was published at the time of the 65C816's release in    *
                                        ;* 1984 does not indicate a recommended or preferred syntax for any of the above   *
                                        ;* instructions.  PEA pushes its operand to the stack and hence operates like any  *
                                        ;* other immediate mode instruction, in that the operand is the data (however, PEA *
                                        ;* doesn't affect the status register).  Similarly, PEI pushes the 16 bit value    *
                                        ;* stored at <operand> and <operand>+1, and hence operates like any other direct   *
                                        ;* (zero) page instruction, again without affecting the status register.           *
                                        ;*                                                                                 *
                                        ;* BCS Technology Limited is of the opinion that the developer of the ORCA/M as-   *
                                        ;* sembler, which is the assembler referred to in the Eyes and Lichty manual, mis- *
                                        ;* understood how PEA and PEI behave during runtime, and hence chose an incorrect  *
                                        ;* syntax for these two instructions.  This error was subsequently carried forward *
                                        ;* by Eyes and Lichty.                                                             *
                                        ;*                                                                                 *
                                        ;* Supermon 816's assembler uses the following syntax for PEA and PEI:             *
                                        ;*                                                                                 *
                                        ;*     PEA #<operand>                                                              *
                                        ;*     PEI <operand>                                                               *
                                        ;*                                                                                 *
                                        ;* The operand for PEA is treated as a 16 bit value, even if entered as an 8 bit   *
                                        ;* value.  The operand for PEI must be 8 bits.                                     *
                                        ;*                                                                                 *
                                        ;* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;
                                        ;	* * * * * * * * * * * *
                                        ;	* VERSION INFORMATION *
                                        ;	* * * * * * * * * * * *
                                        ;
                                        softvers .macro                ;software version — change with each revision...
                                                 .byte "1"             ;major
                                                 .byte "."
                                                 .byte "0"             ;minor
                                                 .byte "."
                                                 .byte "0"             ;revision
                                                 .endm
                                        ;
                                        ;REVISION TABLE
                                        ;
                                        ;Ver  Rev Date    Description
                                        ;———————————————————————————————————————————————————————————————————————————————
                                        ;1.0  2013/11/01  A) Original derived from the POC V1.1 single-board computer
                                        ;                    firmware.
                                        ;     2013/11/04  A) Fixed a problem where the B-accumulator wasn't always being
                                        ;                    be copied to shadow storage after return from execution of
                                        ;                    a J command.
                                        ;———————————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	        COMMENT ABBREVIATIONS
                                        ;	————————————————————————————————————————————————————
                                        ;	  BCD   binary-coded decimal
                                        ;	   DP   direct page or page zero
                                        ;	  EOF   end-of-field
                                        ;	  EOI   end-of-input
                                        ;	  LSB   least significant byte/bit
                                        ;	  LSD   least significant digit
                                        ;	  LSN   least significant nybble
                                        ;	  LSW   least significant word
                                        ;	  MPU   microprocessor
                                        ;	  MSB   most significant byte/bit
                                        ;	  MSD   most significant digit
                                        ;	  MSN   most significant nybble
                                        ;	  MSW   most-significant word
                                        ;	  RAM   random access memory
                                        ;	   WS   whitespace, i.e., blanks & horizontal tabs
                                        ;	————————————————————————————————————————————————————
                                        ;	A word is defined as 16 bits.
                                        ;
                                        ;	   MPU REGISTER SYMBOLS
                                        ;	——————————————————————————
                                        ;	   .A   accumulator LSB
                                        ;	   .B   accumulator MSB
                                        ;	   .C   16 bit accumulator
                                        ;	   .X   X-index
                                        ;	   .Y   Y-index
                                        ;      DS   data segment
                                        ;	   DB   data bank
                                        ;	   DP   direct page
                                        ;      CS   code segment
                                        ;	   PB   program bank
                                        ;	   PC   program counter
                                        ;	   SP   stack pointer
                                        ;	   SR   MPU status
                                        ;      SRX  status extension
                                        ;	————————————————————————————
                                        ;
                                        ;	  MPU STATUS REGISTER SYMBOLS
                                        ;	———————————————————————————————
                                        ;	    C   carry
                                        ;	    D   decimal mode
                                        ;	    I   maskable interrupts
                                        ;	    m   accumulator/memory size
                                        ;	    N   result negative
                                        ;	    V   sign overflow
                                        ;	    x   index registers size
                                        ;	    Z   result zero
                                        ;
                                        ;      16   16 bit emulation flag
                                        ;      32   32 bit emulation flag
                                        ;	———————————————————————————————
                                        ;
                                        ;================================================================================
                                        ;
                                        ;SYSTEM INTERFACE DEFINITIONS
                                        ;
                                        ;	——————————————————————————————————————————————————————————————————
                                        ;	This section defines the interface between Supermon 816 & the host
                                        ;	system.   Change these definitions to suit your system, but do not
                                        ;	change any label names.  All definitions must have valid values in
                                        ;	order to assemble Supermon 816.
                                        ;	——————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————
    531 = 0000000000008000                            _origin_ =$008000              ;assembly address...
                                        ;
                                        ;	Set _ORIGIN_ to Supermon 816's desired assembly address.
                                        ;	————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    537 = 000000000000FE03                            vecexit  =$00FE03              ;exit to environment address...
                                        ;
                                        ;	Set VECEXIT to where Supermon 816 should go when it exits.  Supermon 816
                                        ;	will do a JML (long jump) to this address, which means VECEXIT must be a
                                        ;	24 bit address.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    545 = 0000000000000102                            vecbrki  =$0102                ;BRK handler indirect vector...
    546 = 0000000000000105                            vecbrkia =$0105                ;system indirect BRK vector
                                        ;
                                        ;	Supermon 816 will modify this vector so that execution of a BRK instruc-
                                        ;	tion is intercepted & the registers  are  captured.   Your BRK front end
                                        ;	should jump through this vector after pushing the registers as follows:
                                        ;
                                        ;	         phb                   ;save DB
                                        ;	         phd                   ;save DP
                                        ;	         rep #%00110000        ;16 bit registers
                                        ;	         pha
                                        ;	         phx
                                        ;	         phy
                                        ;	         jmp (vecbrki)         ;indirect vector
                                        ;
                                        ;	When a G or J command is issued, the above sequence will be reversed be-
                                        ;	fore a jump is made to the code to be executed.  Upon exit from Supermon
                                        ;	816, the original address at VECBRKI will be restored.
                                        ;
                                        ;	If your BRK front end doesn't conform to the above you will have to mod-
                                        ;	ify Supermon 816 to accommodate the differences.  The most likely needed
                                        ;	changes will be in the order in which registers are pushed to the stack.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    570 = 0000000000003FFF                            hwstack  =$3fff                ;top of hardware stack...
                                        ;
                                        ;	Supermon 816 initializes the stack pointer to this address when the cold
                                        ;	start at MONCOLD is called to enter the monitor.  The stack pointer will
                                        ;	be undisturbed when entry into Supermon 816 is through JMONBRK (see jump
                                        ;	table definitions).
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    579 = 0000000000000080                            zeropage =$80                  ;Supermon 816's direct page...
                                        ;
                                        ;	Supermon 816 uses direct page starting at this address.  Be sure that no
                                        ;	conflict occurs with other software.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
    585 = 00000000000000FC                            biosctx	 =$FC
                                        ;	————————————————————————————————————————————————————————————————————————
    587 = 000000000000FE00                            getcha   =$FE00                ;get keystroke from console...
                                        ;
                                        ;	GETCHA refers to an operating system API call that returns a keystroke
                                        ;	in the 8 bit accumulator.  Supermon 816  assumes that GETCHA is a non-
                                        ;	blocking subroutine & returns with carry clear to indicate that a key-
                                        ;	stroke is in .A, or with carry set to indicate that no keystroke was
                                        ;	available.  GETCHA will be called with a JSR instruction.
                                        ;
                                        ;	Supermon 816 expects .X & .Y to be preserved upon return from GETCHA.
                                        ;	You may have to modify Supermon 816 at all calls to GETCHA if your "get
                                        ;	keystroke" routine works differently than described.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    601 = 000000000000FE06                            putcha   =$FE06                ;print character on console...
                                        ;
                                        ;	PUTCHA refers to an operating system API call that prints a character to
                                        ;	the console screen.  The character to be printed will be in .A, which
                                        ;	will be set to 8-bit width.  Supermon 816 assumes that PUTCHA will block
                                        ;	until the character can be processed.  PUTCHA will be called with a JSR
                                        ;	instructions.
                                        ;
                                        ;	Supermon 816 expects .X & .Y to be preserved upon return from PUTCHA.
                                        ;	You may have to modify Supermon 816 at all calls to PUTCHA if your "put
                                        ;	character" routine works differently than described.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
    615 = 0000000000000003                            stopkey  =$03                  ;display abort key...
                                        ;
                                        ;	Supermon 816 will poll for a "stop key" during display operations, such
                                        ;	as code disassembly & memory dumps, so as to abort further processing &
                                        ;	return to the command prompt.  STOPKEY must be defined with the ASCII
                                        ;	value that the "stop key" will emit when typed.  The polling is via a
                                        ;	call to GETCHA (described above).  The default STOPKEY definition of $03
                                        ;	is for ASCII <ETX> or [Ctrl-C].
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
    625 = 0000000000000200                            ibuffer  =$000200               ;input buffer &...
    626 = 00000251                      auxbuf   =ibuffer+s_ibuf+1 ;auxiliary buffer...
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	Supermon 816 will use the above definitions for input buffers.  These
                                        ;	buffers may be located anywhere in RAM that is convenient.  The buffers
                                        ;	are stateless, which means that unless Supermon 816 has control of your
                                        ;	system, they may be overwritten without consequence.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;================================================================================
                                        ;
                                        ;W65C816S INSTRUCTION SYNTHESIS MACROS —— !!!!! DO NOT EDIT !!!!!
                                        ;
                                        _asm24_  .macro .ad
                                                 .byte <.ad,>.ad,.ad >> 16
                                                 .endm
                                        ;
                                        brl      .macro .ad
                                        .ba      =*+3
                                                 .byte $82
                                                 .word .ad-.ba
                                                 .endm
                                        ;
                                        ; jml is supported for the RTF65002 in 65c02 mode. And the opcode is supported
                                        ; by the assembler.
                                        ;jml      .macro .ad
                                        ; ;        .byte $5c
                                        ;         _asm24_ .ad
                                        ;         .endm
                                        ;
                                        mvn      .macro .s,.d
                                                 .byte $54,.d,.s
                                                 .endm
                                        ;
                                        mvp      .macro .s,.d
                                                 .byte $44,.d,.s
                                                 .endm
                                        ;
                                        pea      .macro .op
                                                 .byte $f4
                                                 .word .op
                                                 .endm
                                        ;
                                        phb      .macro
                                                 .byte $8b
                                                 .endm
                                        ;
                                        phk      .macro
                                                 .byte $4b
                                                 .endm
                                        ;
                                        plb      .macro
                                                 .byte $ab
                                                 .endm
                                        ;
                                        rep      .macro .op
                                                 .byte $c2,.op
                                                 .endm
                                        ;
                                        sep      .macro .op
                                                 .byte $e2,.op
                                                 .endm
                                        ;
                                        tcd      .macro
                                                 .byte $5b
                                                 .endm
                                        ;
                                        tcs      .macro
                                                 .byte $1b
                                                 .endm
                                        ;
                                        tdc      .macro
                                                 .byte $7b
                                                 .endm
                                        ;
                                        tsc      .macro
                                                 .byte $3b
                                                 .endm
                                        ;
                                        txy      .macro
                                                 .byte $9b
                                                 .endm
                                        ;
                                        tyx      .macro
                                                 .byte $bb
                                                 .endm
                                        ;
                                        wai      .macro
                                                 .byte $cb
                                                 .endm
                                        ;
                                        xba      .macro
                                                 .byte $eb
                                                 .endm
                                        ;
                                        adcw     .macro .op
                                                 adc #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        andw     .macro .op
                                                 and #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        bitw     .macro .op
                                                 bit #<.op
                                                 .byte >.op
                                                 .endm
                                        ;         
                                        cmpw     .macro .op
                                                 cmp #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        cpxw     .macro .op
                                                 cpx #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        cpyw     .macro .op
                                                 cpy #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        eorw     .macro .op
                                                 eor #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldaw     .macro .op
                                                 lda #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldxw     .macro .op
                                                 ldx #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldyw     .macro .op
                                                 ldy #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        oraw     .macro .op
                                                 ora #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        sbcw     .macro .op
                                                 sbc #<.op
                                                 .byte >.op
                                                 .endm
                                        ;
                                        ldalx    .macro .ad
                                                 .byte $+         .byte a_esc,"("
                                     +            .byte a_esc,"G4"
                                        
                                     +            .byte <.ad,>.ad,.ad >> 16
                                        
                                                 .endm
                                        ;
                                        adcil    .macro .ad
                                                 .byte $67,.ad
                                                 .endm
                                        ;
                                        adcily   .macro .ad
                                                 .byte $77,.ad
                                                 .endm
                                        ;
                                        andil    .macro .ad
                                                 .byte $27,.ad
                                                 .endm
                                        ;
                                        andily   .macro .ad
                                                 .byte $37,.ad
                                                 .endm
                                        ;
                                        cmpil    .macro .ad
                                                 .byte $c7,.ad
                                                 .endm
                                        ;
                                        cmpily   .macro .ad
                                                 .byte $d7,.ad
                                                 .endm
                                        ;
                                        eoril    .macro .ad
                                                 .byte $47,.ad
                                                 .endm
                                        ;
                                        eorily   .macro .ad
                                                 .byte $57,.ad
                                                 .endm
                                        ;
                                        ldail    .macro .ad
                                                 .byte $a7,.ad
                                                 .endm
                                        ;
                                        ldaily   .macro .ad
                                                 .byte $b7,.ad
                                                 .endm
                                        ;
                                        orail    .macro .ad
                                                 .byte $07,.ad
                                                 .endm
                                        ;
                                        oraily   .macro .ad
                                                 .byte $17,.ad
                                                 .endm
                                        ;
                                        sbcil    .macro .ad
                                                 .byte $e7,.ad
                                                 .endm
                                        ;
                                        sbcily   .macro .ad
                                                 .byte $f7,.ad
                                                 .endm
                                        ;
                                        stail    .macro .ad
                                                 .byte $87,.ad
                                                 .endm
                                        ;
                                        staily   .macro .ad
                                                 .byte $97,.ad
                                                 .endm
                                        ;
                                        adcs     .macro .of
                                                 .byte $63,.of
                                                 .endm
                                        ;
                                        adcsi    .macro .of
                                                 .byte $73,.of
                                                 .endm
                                        ;
                                        ands     .macro .of
                                                 .byte $23,.of
                                                 .endm
                                        ;
                                        andsi    .macro .of
                                                 .byte $33,.of
                                                 .endm
                                        ;
                                        cmps     .macro .of
                                                 .byte $c3,.of
                                                 .endm
                                        ;
                                        cmpsi    .macro .of
                                                 .byte $d3,.of
                                                 .endm
                                        ;
                                        eors     .macro .of
                                                 .byte $43,.of
                                                 .endm
                                        ;
                                        eorsi    .macro .of
                                                 .byte $53,.of
                                                 .endm
                                        ;
                                        ldas     .macro .of
                                                 .byte $a3,.of
                                                 .endm
                                        ;
                                        ldasi    .macro .of
                                                 .byte $b3,.of
                                                 .endm
                                        ;
                                        oras     .macro .of
                                                 .byte $03,.of
                                                 .endm
                                        ;
                                        orasi    .macro .of
                                                 .byte $13,.of
                                                 .endm
                                        ;
                                        sbcs     .macro .of
                                                 .byte $e3,.of
                                                 .endm
                                        ;
                                        sbcsi    .macro .of
                                                 .byte $f3,.of
                                                 .endm
                                        ;
                                        stas     .macro .of
                                                 .byte $83,.of
                                                 .endm
                                        ;
                                        stasi    .macro .of
                                                 .byte $93,.of
                                                 .endm
                                        ;
                                        longa    .macro
                                                 .byte $c2,$20
                                                 .endm
                                        ;
                                        longr    .macro
                                                 .byte $c2,$30
                                                 .endm
                                        ;
                                        longx    .macro
                                                 .byte $c2,$10
                                                 .endm
                                        ;
                                        shorta   .macro
                                                 .byte $e2,$20
                                                 .endm
                                        ;
                                        shorti   .macro
                                                 .byte $e2,$10
                                                 .endm
                                        ;
                                        shortr   .macro
                                                 .byte $e2,$30
                                                 .endm
                                        ;
                                        shortx   .macro
                                                 .byte $e2,$10
                                                 .endm
                                        ;
                                        ;================================================================================
                                        ;
                                        ;CONSOLE DISPLAY CONTROL MACROS
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	The following macros execute terminal  control procedures  that  perform
                                        ;	such tasks as clearing the screen,  switching  between  normal & reverse
                                        ;	video, etc.  These macros are for WYSE 60 & compatible displays, such as
                                        ;	the WYSE 150, WYSE 160, WYSE 325 & WYSE GPT.   Only the functions needed
                                        ;	by Supermon 816 are included.
                                        ;
                                        ;	If your console is not WYSE 60 compatible, you will need to  edit  these
                                        ;	macros as required to control your particular console or terminal.  Note
                                        ;	that in some cases one macro may call another.  Exercise caution in your
                                        ;	edits to avoid introducing display bugs.
                                        ;
                                        ;	If your console display cannot execute one of these procedures,  such as
                                        ;	'CL' (clear to end of line), you will have to develop an alternative.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	clearing data...
                                        ;
                                        bs       .macro                ;destructive backspace
                                                 .byte a_bs
                                     +            .byte a_esc,"W"
                                        
                                                 .endm
                                        ;
                                        cl       .macro                ;clear to end of line 
                                                 .byte a_esc,"T"
                                                 .endm
                                        ;
                                        ;
                                        ;	cursor control...
                                        ;
                                        cn       .macro                ;cursor on
                                                 .byte a_esc,"`1"
                                                 .endm
                                        ;
                                        co       .macro                ;cursor off
                                                 .byte a_esc,"`0"
                                                 .endm
                                        ;
                                        cr       .macro                ;carriage return
                                                 .byte a_cr
                                                 .endm
                                        ;
                                        lf       .macro                ;carriage return/line feed
                                     +            .byte a_cr
                                        
                                                 .byte a_lf
                                                 .endm
                                        ;
                                        ;
                                        ;	display attributes...
                                        ;
                                        bf       .macro                ;reverse foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G4"
                                                 .endm
                                        ;
                                        er       .macro                ;enable normal foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G0"
                                                 .endm
                                        ;
                                        sf       .macro                ;set foreground
                                                 .byte a_esc,"("
                                                 .byte a_esc,"G0"
                                                 .endm
                                        ;
                                        ;
                                        ;	display editing...
                                        ;
                                        dcuc     .macro                ;delete char under cursor
                                                 .byte a_esc,"W"
                                                 .endm
                                        ;
                                        ;
                                        ;	miscellaneous control...
                                        ;
                                        rb       .macro                ;ring "bell"
                                                 .byte a_bel
                                                 .endm
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASCII CONTROL DEFINITIONS (menmonic order)
                                        ;
   1035 = 0000000000000007                            a_bel    =$07                  ;<BEL> alert/ring bell
   1036 = 0000000000000008                            a_bs     =$08                  ;<BS>  backspace
   1037 = 000000000000000D                            a_cr     =$0d                  ;<CR>  carriage return
   1038 = 000000000000007F                            a_del    =$7f                  ;<DEL> delete
   1039 = 000000000000001B                            a_esc    =$1b                  ;<ESC> escape
   1040 = 0000000000000009                            a_ht     =$09                  ;<HT>  horizontal tabulation
   1041 = 000000000000000A                            a_lf     =$0a                  ;<LF>  linefeed
                                        ;
                                        ;
                                        ;	miscellaneous (description order)...
                                        ;
   1046 = 20                            a_blank  =' '                  ;blank (whitespace)
   1047 = 7A                            a_asclch ='z'                  ;end of lowercase ASCII
   1048 = 000000000000005F                            a_lctouc =$5f                  ;LC to UC conversion mask
   1049 = 61                            a_asclcl ='a'                  ;start of lowercase ASCII
   1050 = 3A                            a_colon  =':'
                                        ;
                                        ;================================================================================
                                        ;
                                        ;GLOBAL ATOMIC CONSTANTS
                                        ;
                                        ;
                                        ;	data type sizes...
                                        ;
   1059 = 0000000000000001                            s_byte   =1                    ;byte
   1060 = 0000000000000002                            s_word   =2                    ;word (16 bits)
   1061 = 0000000000000003                            s_xword  =3                    ;extended word (24 bits)
   1062 = 0000000000000004                            s_dword  =4                    ;double word (32 bits)
   1063 = 0000000000000100                            s_rampag =$0100                ;65xx RAM page
                                        ;
                                        ;
                                        ;	data type sizes in bits...
                                        ;
   1068 = 0000000000000008                            s_bibyte =8                    ;byte
   1069 = 0000000000000004                            s_bnybbl =4                    ;nybble
                                        ;
                                        ;
                                        ;	miscellaneous...
                                        ;
   1074 = 000000000000002C                            bitabs   =$2c                  ;absolute BIT opcode
   1075 = 0000000000000024                            bitzp    =$24                  ;zero page BIT opcode
                                        ;
                                        ;================================================================================
                                        ;
                                        ;W65C816S NATIVE MODE STATUS REGISTER DEFINITIONS
                                        ;
   1081 = 00000001                      s_mpudbx =s_byte               ;data bank size
   1082 = 00000002                      s_mpudpx =s_word               ;direct page size
   1083 = 00000001                      s_mpupbx =s_byte               ;program bank size
   1084 = 00000002                      s_mpupcx =s_word               ;program counter size
   1085 = 00000002                      s_mpuspx =s_word               ;stack pointer size
   1086 = 00000001                      s_mpusrx =s_byte               ;status size
                                        ;
                                        ;
                                        ;	status register flags...
                                        ;
   1091 = 0000000000000001                            sr_car   =%00000001            ;C
   1092 = 00000002                      sr_zer   =sr_car << 1          ;Z
   1093 = 00000004                      sr_irq   =sr_zer << 1          ;I
   1094 = 00000008                      sr_bdm   =sr_irq << 1          ;D
   1095 = 00000010                      sr_ixw   =sr_bdm << 1          ;x
   1096 = 00000020                      sr_amw   =sr_ixw << 1          ;m
   1097 = 00000040                      sr_ovl   =sr_amw << 1          ;V
   1098 = 00000080                      sr_neg   =sr_ovl << 1          ;N
   1099 = 00000100                      sr_16	 =sr_neg << 1
   1100 = 00000200                      sr_32    =sr_16 << 1
                                        ;
                                        ;	NVmxDIZC
                                        ;	xxxxxxxx
                                        ;	||||||||
                                        ;	|||||||+———> 1 = carry set/generated
                                        ;	||||||+————> 1 = result = zero
                                        ;	|||||+—————> 1 = IRQs ignored
                                        ;	||||+——————> 0 = binary arithmetic mode
                                        ;	||||         1 = decimal arithmetic mode
                                        ;	|||+———————> 0 = 16 bit index
                                        ;	|||          1 = 8 bit index
                                        ;	||+————————> 0 = 16 bit .A & memory
                                        ;	||           1 = 8 bit .A & memory
                                        ;	|+—————————> 1 = sign overflow
                                        ;	+——————————> 1 = result = negative
                                        ;
                                        ;================================================================================
                                        ;
                                        ;"SIZE-OF" CONSTANTS
                                        ;
   1121 = 00000003                      s_addr   =s_xword              ;24 bit address
   1122 = 0000000000000020                            s_auxbuf =32                   ;auxiliary buffer
   1123 = 0000000000000050                            s_ibuf   =80                   ;input buffer
   1124 = 0000000000000003                            s_mnemon =3                    ;MPU ASCII mnemonic
   1125 = 0000000000000002                            s_mnepck =2                    ;MPU encoded mnemonic
   1126 = 0000000000000003                            s_mvinst =3                    ;MVN/MVP instruction
   1127 = 00000001                      s_opcode =s_byte               ;MPU opcode
   1128 = 00000003                      s_oper   =s_xword              ;operand
   1129 = 00000004                      s_pfac   =s_dword              ;primary math accumulator
   1130 = 00000006                      s_sfac   =s_dword+s_word       ;secondary math accumulators
                                        ;
                                        ;================================================================================
                                        ;
                                        ;"NUMBER-OF" CONSTANTS
                                        ;
   1136 = 0000000000000015                            n_dbytes =21                   ;default disassembly bytes
   1137 = 0000000000000008                            n_dump   =8                    ;bytes per memory dump line
   1138 = 000000FF                      n_mbytes =s_rampag-1           ;default memory dump bytes
   1139 = 0000000000000008                            n_hccols =8                    ;compare/hunt display columns
   1140 = 00000009                      n_opcols =3*s_oper             ;disassembly operand columns
   1141 = 0000000000000004                            n_opslsr =4                    ;LSRs to extract instruction size
   1142 = 0000000000000005                            n_shfenc =5                    ;shifts to encode/decode mnemonic
                                        ;
                                        ;================================================================================
                                        ;
                                        ;NUMERIC CONVERSION CONSTANTS
                                        ;
   1148 = 0000000000000006                            a_hexdec ='A'-'9'-2            ;hex to decimal difference
   1149 = 25                            c_bin    ='%'                  ;binary prefix
   1150 = 2B                            c_dec    ='+'                  ;decimal prefix
   1151 = 24                            c_hex    ='$'                  ;hexadecimal prefix
   1152 = 40                            c_oct    ='@'                  ;octal prefix
   1153 = 66                            k_hex    ='f'                  ;hex ASCII conversion
   1154 = 00000020                      m_bits   =s_pfac*s_bibyte      ;operand bit size
   1155 = 00000030                      m_cbits  =s_sfac*s_bibyte      ;workspace bit size
   1156 = 000000000000000F                            bcdumask =%00001111            ;isolate BCD units mask
   1157 = 0000000000000030                            btoamask =%00110000            ;binary to ASCII mask
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASSEMBLER/DISASSEMBLER CONSTANTS
                                        ;
   1163 = 3F                            a_mnecvt ='?'                  ;encoded mnemonic conversion base
   1164 = 000000000000001F                            aimmaska =%00011111            ;.A immediate opcode test #1
   1165 = 0000000000000009                            aimmaskb =%00001001            ;.A immediate opcode test #2
   1166 = 41                            asmprfx  ='A'                  ;assemble code prefix
   1167 = 0000000000000009                            ascprmct =9                    ;assembler prompt "size-of"
   1168 = 2E                            disprfx  ='.'                  ;disassemble code prefix
   1169 = 00000000000000C0                            flimmask =%11000000            ;force long immediate flag
   1170 = 0000000000000054                            opc_mvn  =$54                  ;MVN opcode
   1171 = 0000000000000044                            opc_mvp  =$44                  ;MVP opcode
   1172 = 00000000000000C2                            opc_rep  =$c2                  ;REP opcode
   1173 = 00000000000000E2                            opc_sep  =$e2                  ;SEP opcode
   1174 = 00000030                      pfmxmask =sr_amw | sr_ixw      ;MPU m & x flag bits mask
                                        ;
                                        ;
                                        ;	assembler prompt buffer offsets...
                                        ;
   1179 = 00000002                      apadrbkh =s_word               ;instruction address bank MSN
   1180 = 00000003                      apadrbkl =apadrbkh+s_byte      ;instruction address bank LSN
   1181 = 00000004                      apadrmbh =apadrbkl+s_byte      ;instruction address MSB MSN
   1182 = 00000005                      apadrmbl =apadrmbh+s_byte      ;instruction address MSB LSN
   1183 = 00000006                      apadrlbh =apadrmbl+s_byte      ;instruction address LSB MSN
   1184 = 00000007                      apadrlbl =apadrlbh+s_byte      ;instruction address LSB LSN
                                        ;
                                        ;
                                        ;	addressing mode preamble symbols...
                                        ;
   1189 = 21                            amp_flim ='!'                  ;force long immediate
   1190 = 23                            amp_imm  ='#'                  ;immediate
   1191 = 28                            amp_ind  ='('                  ;indirect
   1192 = 5B                            amp_indl ='['                  ;indirect long
   1193 = 7B                            amp_indxl = '{'				   ;indirect extra long
                                        ;
                                        ;
                                        ;	addressing mode symbolic translation indices...
                                        ;
   1198 = 0000000000000000                            am_nam   =%0000                ;(0)  no symbol
   1199 = 0000000000000001                            am_imm   =%0001                ;(1)  #
   1200 = 0000000000000002                            am_adrx  =%0010                ;(2)  dp,X or addr,X
   1201 = 0000000000000003                            am_adry  =%0011                ;(3)  dp,Y or addr,Y
   1202 = 0000000000000004                            am_ind   =%0100                ;(4)  (dp) or (addr)
   1203 = 0000000000000005                            am_indl  =%0101                ;(5)  [dp] or [addr]
   1204 = 0000000000000006                            am_indly =%0110                ;(6)  [dp],Y
   1205 = 0000000000000007                            am_indx  =%0111                ;(7)  (dp,X) or (addr,X)
   1206 = 0000000000000008                            am_indy  =%1000                ;(8)  (dp),Y
   1207 = 0000000000000009                            am_stk   =%1001                ;(9)  offset,S
   1208 = 000000000000000A                            am_stky  =%1010                ;(10) (offset,S),Y
   1209 = 000000000000000B                            am_move  =%1011                ;(11) MVN/MVP sbnk,dbnk
   1210 = 000000000000000C                            am_indxly=%1100				   ;(12) {dp},Y
                                        ;
                                        ;
                                        ;	operand size translation indices...
                                        ;
   1215 = 0000000000000000                            ops0     =%0000 << 4           ;no operand
   1216 = 0000000000000010                            ops1     =%0001 << 4           ;8 bit operand
   1217 = 0000000000000020                            ops2     =%0010 << 4           ;16 bit operand
   1218 = 0000000000000030                            ops3     =%0011 << 4           ;24 bit operand
   1219 = 0000000000000050                            bop1     =%0101 << 4           ;8 bit relative branch
   1220 = 0000000000000060                            bop2     =%0110 << 4           ;16 bit relative branch
   1221 = 0000000000000090                            vops     =%1001 << 4           ;8, 16, or 32 bit operand
   1222 = 0000000000010100                            ops5	 =$1010 << 4		   ;32 bit operand
                                        ;
                                        ;
                                        ;	operand size & addressing mode extraction masks...
                                        ;
   1227 = 000000000000000F                            amodmask =%00001111            ;addressing mode index
   1228 = 0000000000000030                            opsmask  =%00110000            ;operand size
   1229 = 00000000000000C0                            vopsmask =%11000000            ;BOPx & VOPS flag bits
                                        ;
                                        ;
                                        ;	instruction mnemonic encoding...
                                        ;
   1234 = 0000000000002144                            mne_adc  =$2144                ;ADC
   1235 = 0000000000002BC4                            mne_and  =$2bc4                ;AND
   1236 = 0000000000006D04                            mne_asl  =$6d04                ;ASL
   1237 = 0000000000002106                            mne_bcc  =$2106                ;BCC
   1238 = 000000000000A106                            mne_bcs  =$a106                ;BCS
   1239 = 0000000000009186                            mne_beq  =$9186                ;BEQ
   1240 = 000000000000AA86                            mne_bit  =$aa86                ;BIT
   1241 = 0000000000005386                            mne_bmi  =$5386                ;BMI
   1242 = 00000000000033C6                            mne_bne  =$33c6                ;BNE
   1243 = 0000000000006C46                            mne_bpl  =$6c46                ;BPL
   1244 = 00000000000014C6                            mne_bra  =$14c6                ;BRA
   1245 = 00000000000064C6                            mne_brk  =$64c6                ;BRK
   1246 = 0000000000006CC6                            mne_brl  =$6cc6                ;BRL
   1247 = 00000000000025C6                            mne_bvc  =$25c6                ;BVC
   1248 = 000000000000A5C6                            mne_bvs  =$a5c6                ;BVS
   1249 = 0000000000002348                            mne_clc  =$2348                ;CLC
   1250 = 0000000000002B48                            mne_cld  =$2b48                ;CLD
   1251 = 0000000000005348                            mne_cli  =$5348                ;CLI
   1252 = 000000000000BB48                            mne_clv  =$bb48                ;CLV
   1253 = 0000000000008B88                            mne_cmp  =$8b88                ;CMP
   1254 = 0000000000008C08                            mne_cop  =$8c08                ;COP
   1255 = 000000000000CC48                            mne_cpx  =$cc48                ;CPX
   1256 = 000000000000D448                            mne_cpy  =$d448                ;CPY
   1257 = 000000000000218A                            mne_dec  =$218a                ;DEC
   1258 = 000000000000C98A                            mne_dex  =$c98a                ;DEX
   1259 = 000000000000D18A                            mne_dey  =$d18a                ;DEY
   1260 = 0000000000009C0C                            mne_eor  =$9c0c                ;EOR
   1261 = 00000000000023D4                            mne_inc  =$23d4                ;INC
   1262 = 000000000000CBD4                            mne_inx  =$cbd4                ;INX
   1263 = 000000000000D3D4                            mne_iny  =$d3d4                ;INY
   1264 = 0000000000006B96                            mne_jml  =$6b96                ;JML
   1265 = 0000000000008B96                            mne_jmp  =$8b96                ;JMP
   1266 = 0000000000006D16                            mne_jsl  =$6d16                ;JSL
   1267 = 0000000000009D16                            mne_jsr  =$9d16                ;JSR
   1268 = 000000000000115A                            mne_lda  =$115a                ;LDA
   1269 = 000000000000C95A                            mne_ldx  =$c95a                ;LDX
   1270 = 000000000000D15A                            mne_ldy  =$d15a                ;LDY
   1271 = 0000000000009D1A                            mne_lsr  =$9d1a                ;LSR
   1272 = 0000000000007DDC                            mne_mvn  =$7ddc                ;MVN
   1273 = 0000000000008DDC                            mne_mvp  =$8ddc                ;MVP
   1274 = 0000000000008C1E                            mne_nop  =$8c1e                ;NOP
   1275 = 00000000000014E0                            mne_ora  =$14e0                ;ORA
   1276 = 00000000000011A2                            mne_pea  =$11a2                ;PEA
   1277 = 00000000000051A2                            mne_pei  =$51a2                ;PEI
   1278 = 00000000000099A2                            mne_per  =$99a2                ;PER
   1279 = 0000000000001262                            mne_pha  =$1262                ;PHA
   1280 = 0000000000001A62                            mne_phb  =$1a62                ;PHB
   1281 = 0000000000002A62                            mne_phd  =$2a62                ;PHD
   1282 = 0000000000006262                            mne_phk  =$6262                ;PHK
   1283 = 0000000000008A62                            mne_php  =$8a62                ;PHP
   1284 = 000000000000CA62                            mne_phx  =$ca62                ;PHX
   1285 = 000000000000D262                            mne_phy  =$d262                ;PHY
   1286 = 0000000000001362                            mne_pla  =$1362                ;PLA
   1287 = 0000000000001B62                            mne_plb  =$1b62                ;PLB
   1288 = 0000000000002B62                            mne_pld  =$2b62                ;PLD
   1289 = 0000000000008B62                            mne_plp  =$8b62                ;PLP
   1290 = 000000000000CB62                            mne_plx  =$cb62                ;PLX
   1291 = 000000000000D362                            mne_ply  =$d362                ;PLY
   1292 = 00000000000089A6                            mne_rep  =$89a6                ;REP
   1293 = 0000000000006C26                            mne_rol  =$6c26                ;ROL
   1294 = 0000000000009C26                            mne_ror  =$9c26                ;ROR
   1295 = 0000000000005566                            mne_rti  =$5566                ;RTI
   1296 = 0000000000006D66                            mne_rtl  =$6d66                ;RTL
   1297 = 000000000000A566                            mne_rts  =$a566                ;RTS
   1298 = 00000000000020E8                            mne_sbc  =$20e8                ;SBC
   1299 = 00000000000021A8                            mne_sec  =$21a8                ;SEC
   1300 = 00000000000029A8                            mne_sed  =$29a8                ;SED
   1301 = 00000000000051A8                            mne_sei  =$51a8                ;SEI
   1302 = 00000000000089A8                            mne_sep  =$89a8                ;SEP
   1303 = 0000000000001568                            mne_sta  =$1568                ;STA
   1304 = 0000000000008D68                            mne_stp  =$8d68                ;STP
   1305 = 000000000000CD68                            mne_stx  =$cd68                ;STX
   1306 = 000000000000D568                            mne_sty  =$d568                ;STY
   1307 = 000000000000DD68                            mne_stz  =$dd68                ;STZ
   1308 = 000000000000C8AA                            mne_tax  =$c8aa                ;TAX
   1309 = 000000000000D0AA                            mne_tay  =$d0aa                ;TAY
   1310 = 000000000000292A                            mne_tcd  =$292a                ;TCD
   1311 = 000000000000A12A                            mne_tcs  =$a12a                ;TCS
   1312 = 000000000000216A                            mne_tdc  =$216a                ;TDC
   1313 = 0000000000001CEA                            mne_trb  =$1cea                ;TRB
   1314 = 0000000000001D2A                            mne_tsb  =$1d2a                ;TSB
   1315 = 000000000000252A                            mne_tsc  =$252a                ;TSC
   1316 = 000000000000CD2A                            mne_tsx  =$cd2a                ;TSX
   1317 = 000000000000166A                            mne_txa  =$166a                ;TXA
   1318 = 000000000000A66A                            mne_txs  =$a66a                ;TXS
   1319 = 000000000000D66A                            mne_txy  =$d66a                ;TXY
   1320 = 00000000000016AA                            mne_tya  =$16aa                ;TYA
   1321 = 000000000000CEAA                            mne_tyx  =$ceaa                ;TYX
   1322 = 00000000000050B0                            mne_wai  =$50b0                ;WAI
   1323 = 0000000000007170                            mne_wdm  =$7170                ;WDM
   1324 = 00000000000010F2                            mne_xba  =$10f2                ;XBA
   1325 = 0000000000003132                            mne_xce  =$3132                ;XCE
                                        ;
                                        ;
                                        ;	encoded instruction mnemonic indices...
                                        ;
   1330 = 0000000000000010                            mne_adcx =16                   ;ADC
   1331 = 000000000000001D                            mne_andx =29                   ;AND
   1332 = 000000000000002C                            mne_aslx =44                   ;ASL
   1333 = 000000000000000F                            mne_bccx =15                   ;BCC
   1334 = 0000000000000041                            mne_bcsx =65                   ;BCS
   1335 = 000000000000003B                            mne_beqx =59                   ;BEQ
   1336 = 0000000000000046                            mne_bitx =70                   ;BIT
   1337 = 0000000000000024                            mne_bmix =36                   ;BMI
   1338 = 000000000000001F                            mne_bnex =31                   ;BNE
   1339 = 000000000000002A                            mne_bplx =42                   ;BPL
   1340 = 0000000000000005                            mne_brax =5                    ;BRA
   1341 = 0000000000000027                            mne_brkx =39                   ;BRK
   1342 = 000000000000002B                            mne_brlx =43                   ;BRL
   1343 = 0000000000000017                            mne_bvcx =23                   ;BVC
   1344 = 0000000000000044                            mne_bvsx =68                   ;BVS
   1345 = 0000000000000014                            mne_clcx =20                   ;CLC
   1346 = 000000000000001B                            mne_cldx =27                   ;CLD
   1347 = 0000000000000023                            mne_clix =35                   ;CLI
   1348 = 0000000000000047                            mne_clvx =71                   ;CLV
   1349 = 0000000000000035                            mne_cmpx =53                   ;CMP
   1350 = 0000000000000037                            mne_copx =55                   ;COP
   1351 = 000000000000004E                            mne_cpxx =78                   ;CPX
   1352 = 0000000000000058                            mne_cpyx =88                   ;CPY
   1353 = 0000000000000012                            mne_decx =18                   ;DEC
   1354 = 000000000000004A                            mne_dexx =74                   ;DEX
   1355 = 0000000000000054                            mne_deyx =84                   ;DEY
   1356 = 000000000000003D                            mne_eorx =61                   ;EOR
   1357 = 0000000000000015                            mne_incx =21                   ;INC
   1358 = 000000000000004D                            mne_inxx =77                   ;INX
   1359 = 0000000000000057                            mne_inyx =87                   ;INY
   1360 = 0000000000000028                            mne_jmlx =40                   ;JML
   1361 = 0000000000000036                            mne_jmpx =54                   ;JMP
   1362 = 000000000000002D                            mne_jslx =45                   ;JSL
   1363 = 000000000000003F                            mne_jsrx =63                   ;JSR
   1364 = 0000000000000001                            mne_ldax =1                    ;LDA
   1365 = 0000000000000049                            mne_ldxx =73                   ;LDX
   1366 = 0000000000000053                            mne_ldyx =83                   ;LDY
   1367 = 0000000000000040                            mne_lsrx =64                   ;LSR
   1368 = 0000000000000030                            mne_mvnx =48                   ;MVN
   1369 = 000000000000003A                            mne_mvpx =58                   ;MVP
   1370 = 0000000000000038                            mne_nopx =56                   ;NOP
   1371 = 0000000000000006                            mne_orax =6                    ;ORA
   1372 = 0000000000000002                            mne_peax =2                    ;PEA
   1373 = 0000000000000021                            mne_peix =33                   ;PEI
   1374 = 000000000000003C                            mne_perx =60                   ;PER
   1375 = 0000000000000003                            mne_phax =3                    ;PHA
   1376 = 000000000000000A                            mne_phbx =10                   ;PHB
   1377 = 000000000000001A                            mne_phdx =26                   ;PHD
   1378 = 0000000000000026                            mne_phkx =38                   ;PHK
   1379 = 0000000000000033                            mne_phpx =51                   ;PHP
   1380 = 000000000000004B                            mne_phxx =75                   ;PHX
   1381 = 0000000000000055                            mne_phyx =85                   ;PHY
   1382 = 0000000000000004                            mne_plax =4                    ;PLA
   1383 = 000000000000000B                            mne_plbx =11                   ;PLB
   1384 = 000000000000001C                            mne_pldx =28                   ;PLD
   1385 = 0000000000000034                            mne_plpx =52                   ;PLP
   1386 = 000000000000004C                            mne_plxx =76                   ;PLX
   1387 = 0000000000000056                            mne_plyx =86                   ;PLY
   1388 = 0000000000000031                            mne_repx =49                   ;REP
   1389 = 0000000000000029                            mne_rolx =41                   ;ROL
   1390 = 000000000000003E                            mne_rorx =62                   ;ROR
   1391 = 0000000000000025                            mne_rtix =37                   ;RTI
   1392 = 000000000000002E                            mne_rtlx =46                   ;RTL
   1393 = 0000000000000043                            mne_rtsx =67                   ;RTS
   1394 = 000000000000000E                            mne_sbcx =14                   ;SBC
   1395 = 0000000000000013                            mne_secx =19                   ;SEC
   1396 = 0000000000000019                            mne_sedx =25                   ;SED
   1397 = 0000000000000022                            mne_seix =34                   ;SEI
   1398 = 0000000000000032                            mne_sepx =50                   ;SEP
   1399 = 0000000000000007                            mne_stax =7                    ;STA
   1400 = 0000000000000039                            mne_stpx =57                   ;STP
   1401 = 0000000000000050                            mne_stxx =80                   ;STX
   1402 = 0000000000000059                            mne_styx =89                   ;STY
   1403 = 000000000000005B                            mne_stzx =91                   ;STZ
   1404 = 0000000000000048                            mne_taxx =72                   ;TAX
   1405 = 0000000000000052                            mne_tayx =82                   ;TAY
   1406 = 0000000000000018                            mne_tcdx =24                   ;TCD
   1407 = 0000000000000042                            mne_tcsx =66                   ;TCS
   1408 = 0000000000000011                            mne_tdcx =17                   ;TDC
   1409 = 000000000000000C                            mne_trbx =12                   ;TRB
   1410 = 000000000000000D                            mne_tsbx =13                   ;TSB
   1411 = 0000000000000016                            mne_tscx =22                   ;TSC
   1412 = 000000000000004F                            mne_tsxx =79                   ;TSX
   1413 = 0000000000000008                            mne_txax =8                    ;TXA
   1414 = 0000000000000045                            mne_txsx =69                   ;TXS
   1415 = 000000000000005A                            mne_txyx =90                   ;TXY
   1416 = 0000000000000009                            mne_tyax =9                    ;TYA
   1417 = 0000000000000051                            mne_tyxx =81                   ;TYX
   1418 = 0000000000000020                            mne_waix =32                   ;WAI
   1419 = 000000000000002F                            mne_wdmx =47                   ;WDM
   1420 = 0000000000000000                            mne_xbax =0                    ;XBA
   1421 = 000000000000001E                            mne_xcex =30                   ;XCE
                                        ;
                                        ;================================================================================
                                        ;
                                        ;MISCELLANEOUS CONSTANTS
                                        ;
   1427 = 0000000000000004                            halftab  =4                    ;1/2 tabulation spacing
   1428 = 3E                            memprfx  ='>'                  ;memory dump prefix
   1429 = 3A                            memsepch =':'                  ;memory dump separator
   1430 = 2E                            memsubch ='.'                  ;memory dump non-print char
   1431 = 0000000000000030                            srinit   =%00110000            ;SR initialization value
                                        ;
                                        ;================================================================================
                                        ;
                                        ;DIRECT PAGE STORAGE
                                        ;
   1437 = 00000080                      reg_csx  =zeropage			;CS
   1438 = 00000082                      reg_dsx  =reg_csx + 2		;DS
   1439 = 00000084                      reg_ssx  =reg_dsx + 2		;SS
   1440 = 00000086                      reg_pcx  =reg_ssx + 2	    ;PC
   1441 = 00000088                      reg_pbx  =reg_pcx + 2       ;PB
   1442 = 00000089                      reg_ax   =reg_pbx + 1       ;.C
   1443 = 0000008D                      reg_xx   =reg_ax + 4        ;.X
   1444 = 00000091                      reg_yx   =reg_xx + 4        ;.Y
   1445 = 00000095                      reg_spx  =reg_yx + 4        ;SP
   1446 = 00000099                      reg_srx  =reg_spx + 4       ;SR
   1447 = 0000009A                      reg_srxx =reg_srx + 1       ;SRX
   1448 = 0000009B                      reg_dbx  =reg_srxx + 1      ;DB
   1449 = 0000009C                      reg_dpx  =reg_dbx + 1       ;DP
                                        ;
                                        ;
                                        ;	general workspace...
                                        ;
   1454 = 000000A0                      addra    =reg_dpx+4            ;address #1
   1455 = 000000A4                      addrb    =addra+4              ;address #2
   1456 = 000000A7                      faca     =addrb+s_addr         ;primary accumulator
   1457 = 000000AB                      facax    =faca+s_pfac          ;extended primary accumulator
   1458 = 000000AF                      facb     =facax+s_pfac         ;secondary accumulator
   1459 = 000000B5                      facc     =facb+s_sfac          ;tertiary accumulator
   1460 = 000000BB                      operand  =facc+s_sfac          ;instruction operand
   1461 = 000000BE                      auxbufix =operand+s_oper       ;auxiliary buffer index
   1462 = 000000BF                      ibufidx  =auxbufix+s_byte      ;input buffer index
   1463 = 000000C0                      bitsdig  =ibufidx+s_byte       ;bits per numeral
   1464 = 000000C1                      numeral  =bitsdig+s_byte       ;numeral buffer
   1465 = 000000C2                      radix    =numeral+s_byte       ;radix index
   1466 = 000000C3                      admodidx =radix+s_byte         ;addressing mode index
   1467 = 000000C4                      charcnt  =admodidx+s_byte      ;character counter
   1468 = 000000C6                      instsize =charcnt+s_word       ;instruction size
   1469 = 000000C8                      mnepck   =instsize+s_word      ;encoded mnemonic
   1470 = 000000CA                      opcode   =mnepck+s_mnepck      ;current opcode
   1471 = 000000CB                      status   =opcode+s_byte        ;I/O status flag
   1472 = 000000CC                      xrtemp   =status+s_byte        ;temp .X storage
   1473 = 000000CD                      eopsize  =xrtemp+s_byte        ;entered operand size
   1474 = 000000CE                      flimflag =eopsize+s_byte       ;forced long immediate...
                                        ;
                                        ;	xx000000
                                        ;	||
                                        ;	|+—————————> 0: .X/.Y = 8 bits
                                        ;	|            1: .X/.Y = 16 bits
                                        ;	+——————————> 0: .A = 8 bits
                                        ;	             1: .A = 16 bits
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	During assembly, FLIMFLAG indicates the operand size used with an immed-
                                        ;	iate mode instruction, thus causing the following disassembly to display
                                        ;	the assembled  operand size.   During disassembly,  FLIMFLAG will mirror
                                        ;	the effect of the most recent REP or SEP instruction.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1490 = 000000CF                      iopsize  =flimflag+s_byte      ;operand size
   1491 = 000000D0                      range    =iopsize+s_byte       ;allowable radix range
   1492 = 000000D1                      vopsflag =range+s_byte         ;VOPS & ROPS mode bits
                                        ;
                                        ;
                                        ;	copy/fill workspace (overlaps some of the above)...
                                        ;
   1497 = 000000D2                      mcftwork =vopsflag+s_byte	;faca                 ;start of copy/fill code
   1498 = 000000D3                      mcftopc  =mcftwork+s_byte      ;instruction opcode
   1499 = 000000D4                      mcftbnk  =mcftopc+s_byte       ;banks
                                        ;
                                        ;================================================================================
                                        ;
                                        ;SUPERMON 816 JUMP TABLE
                                        ;
                                                 org	_origin_
                                        ;
   1508 8000                            		 MEM	8
   1509 8000                            		 NDX	8
                                        		 CPU	W65C02
   1511 8000 80 02                      JMON     bra mon               ;cold start entry
   1512 8002 80 3E                      JMONBRK  bra monbrk            ;software interrupt intercept
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mon: SUPERMON 816 COLD START
                                        ;
   1518 8004 C2 20                      mon +         .byte $c2,$20
                                        
   1519 8006 AD 02 01                             lda vecbrki           ;BRK vector
   1520 8009 C9 42                    +            cmp #<monbrk
   1520 800B 80                       +            .byte >monbrk
                                        ;pointing at monitor?
   1521 800C D0 03                                bne .2            ;yes, ignore cold start
   1522 800E 4C 7F 80                             jmp	monreg			; got a branch out of range here when debugging code
                                        								; was included
   1524 8011                            .2
                                        ;
   1526 8011 8D 05 01                             sta vecbrkia          ;save vector for exit
   1527 8014 A9 42                    +            lda #<monbrk
   1527 8016 80                       +            .byte >monbrk
                                        ;Supermon 816 intercepts...
   1528 8017 8D 02 01                             sta vecbrki           ;BRK handler
   1529 801A E2 30                    +            .byte $e2,$30
                                                        ;8 bit registers
   1530 801C A2 49                                ldx #vopsflag-reg_pbx
                                        ;
   1532 801E 74 88                      .0000010 stz reg_pbx,x         ;clear DP storage
   1533 8020 CA                                   dex
   1534 8021 10 FB                                bpl .0000010
                                        ;
   1536 8023 A9 30                                lda #srinit
   1537 8025 85 99                                sta reg_srx           ;status register
   1538 8027 C2 20                    +            .byte $c2,$20
                                                         ;16 bit .A
   1539 8029 A9 FF                    +            lda #<hwstack
   1539 802B 3F                       +            .byte >hwstack
                                        ;top of hardware stack
   1540 802C 1B                       +            .byte $1b
                                                           ;set SP
   1541 802D 7B                       +            .byte $7b
                                                           ;get & save...
   1542 802E 85 9C                                sta reg_dpx           ;DP register
   1543 8030 A9 00                    +            lda #<0
   1543 8032 00                       +            .byte >0
                                        
   1544 8033 E2 20                    +            .byte $e2,$20
                                        
   1545 8035 4B                       +            .byte $4b
                                        
   1546 8036 68                                   pla                   ;capture PB &...
   1547 8037 85 88                                sta reg_pbx           ;set
   1548 8039 8B                       +            .byte $8b
                                        
   1549 803A 68                                   pla                   ;capture DB &...
   1550 803B 85 9B                                sta reg_dbx           ;set
   1551 803D F4                       +            .byte $f4
   1551 803E 34 90                    +            .word mm_entry
                                        ;"...ready..."
   1552 8040 80 30                                bra moncom
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monbrk: SOFTWARE INTERRUPT INTERCEPT
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	This is the entry point taken when a BRK instruction is executed.  It is
                                        ;	assumed that the BRK  handler has pushed the registers to the stack that
                                        ;	are not automatically pushed by the MPU in response to BRK.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1564 8042 58                         monbrk   cli                   ;reenable IRQs
   1565 8043                            		 phds
   1566 8043 68                          		 pla
   1567 8044 85 82                       		 sta reg_dsx
                                           		 CPU	FT832
   1569 008046 42 7A                        		 tssa
   1570 008048 85 84                        		 sta	reg_ssx
                                        		 CPU	W65C02
   1572 804A 7A                                   ply                   ;recover registers
   1573 804B FA                                   plx
   1574 804C 68                                   pla
   1575 804D C2 30                    +            .byte $c2,$30
                                                         ;store 16 bit registers
   1576 804F 85 89                                sta reg_ax            ;.A
   1577 8051 86 8D                                stx reg_xx            ;.X
   1578 8053 84 91                                sty reg_yx            ;.Y
   1579 8055 E2 10                    +            .byte $e2,$10
                                                        ;8 bit index registers
   1580 8057 68                                   pla                   ;get DP &...
   1581 8058 85 9C                                sta reg_dpx           ;store
   1582 805A FA                                   plx                   ;get DB &...
   1583 805B 86 9B                                stx reg_dbx           ;store
   1584 805D FA                                   plx                   ;get SR &...
   1585 805E 86 99                                stx reg_srx           ;store
   1586 8060 68                                   pla                   ;get PC &...
   1587 8061 85 86                                sta reg_pcx           ;store
   1588 8063 E2 20                    +            .byte $e2,$20
                                        
   1589 8065 68                                   pla                   ;get PB &...
   1590 8066 85 88                                sta reg_pbx           ;store
   1591 8068 C2 20                    +            .byte $c2,$20
                                        
   1592 806A 68                          		 pla				   ; get CS &...
   1593 806B 85 80                       		 sta	reg_csx		   ; store
   1594 806D E2 20                    +            .byte $e2,$20
                                        
   1595 806F F4                       +            .byte $f4
   1595 8070 29 90                    +            .word mm_brk
                                        ;"*BRK"
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncom: COMMON ENTRY POINT
                                        ;
                                        ;	——————————————————————————————————————
                                        ;	DO NOT directly call this entry point!
                                        ;	——————————————————————————————————————
                                        ;
   1605 8072                            moncom   
   1606 8072 20 1D 88                    		 jsr sprint            ;print heading
   1607 8075 C2 20                    +            .byte $c2,$20
                                        
   1608 8077 3B                       +            .byte $3b
                                                           ;get SP &...
   1609 8078 85 95                                sta reg_spx           ;store
   1610 807A C2 FF                    +            .byte $c2,%11111111
                                        ;clear SR &...
   1611 807C E2 30                    +            .byte $e2,srinit
                                        ;set default state
   1612 807E 38                                   sec                   ;see next
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monreg: DISPLAY MPU REGISTERS
                                        ;
                                        ;	—————————
                                        ;	syntax: R
                                        ;	—————————
                                        ;
   1622 807F B0 03                      monreg   bcs .0000010          ;okay to proceed
                                        ;
   1624 8081 4C 65 81                             jmp monerr            ;error if called with a parm
                                        ;
   1626 8084 F4                         .0000010 +         .byte $f4
   1626 8085 5F 90                    +            .word mm_regs
                                        
   1627 8087 20 1D 88                             jsr sprint            ;display heading
                                        ;
                                        ;
                                        ;	display code selector & program bank & counter...
                                        ;
   1632 808A C2 20                    +            .byte $c2,$20
                                        
   1633 808C A5 80                       		 lda	reg_csx
   1634 808E E2 20                    +            .byte $e2,$20
                                        
   1635 8090 20 D7 87                    		 jsr    dpyhexw
   1636 8093 E2 20                    +            .byte $e2,$20
                                        
   1637 8095 A9 3A                       		 lda #a_colon
   1638 8097 20 17 88                             jsr printcmn          ;':'
   1639 809A A5 88                                lda reg_pbx           ;PB
   1640 809C 20 E7 87                             jsr dpyhex            ;display as hex ASCII
   1641 809F 20 15 88                             jsr printspc          ;inter-field space
   1642 80A2 C2 20                    +            .byte $c2,$20
                                        
   1643 80A4 A5 86                                lda reg_pcx
   1644 80A6 E2 20                    +            .byte $e2,$20
                                        
   1645 80A8 20 D7 87                             jsr dpyhexw           ;display PC
   1646 80AB A2 02                                ldx #2
   1647 80AD 20 F6 87                             jsr multspc           ;inter-field spacing
                                        ;
                                        ;
                                        ;	display SR in bitwise fashion...
                                        ;
   1652 80B0 A5 9A                       		 lda reg_srxx
   1653 80B2 4A                          		 lsr
   1654 80B3 4A                          		 lsr
   1655 80B4 69 30                       		 adc #'0'
                                           		 cpu FT832
   1657 0080B6 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   1659 80BB A5 9A                       		 lda reg_srxx
   1660 80BD 4A                          		 lsr
   1661 80BE 69 30                       		 adc #'0'
                                           		 cpu FT832
   1663 0080C0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        
   1666 80C5 A6 99                                ldx reg_srx           ;SR
   1667 80C7 A0 08                                ldy #s_bibyte         ;bits in a byte
                                        ;
   1669 80C9 8A                         .0000020 txa                   ;remaining SR bits
   1670 80CA 0A                                   asl                   ;grab one of them
   1671 80CB AA                                   tax                   ;save remainder
   1672 80CC A9 30                                lda #'0'              ;a clear bit but...
   1673 80CE 69 00                                adc #0                ;adjust if set &...
                                           		 cpu FT832
   1675 0080D0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   1677 80D5 88                                   dey                   ;bit processed
   1678 80D6 D0 F1                                bne .0000020          ;do another
                                        ;
                                        ;
                                        ;	display .C, .X, .Y, SP & DP...
                                        ;
   1683 80D8 20 15 88                   .0000030 jsr printspc          ;spacing
   1684 80DB C2 20                    +            .byte $c2,$20
                                        
   1685 80DD B9 8B 00                             lda reg_ax+2,y        ;get register value
   1686 80E0 E2 20                    +            .byte $e2,$20
                                        
   1687 80E2 20 D7 87                             jsr dpyhexw           ;convert & display
   1688 80E5 C2 20                    +            .byte $c2,$20
                                        
   1689 80E7 B9 89 00                             lda reg_ax,y          ;get register value
   1690 80EA E2 20                    +            .byte $e2,$20
                                        
   1691 80EC 20 D7 87                             jsr dpyhexw           ;convert & display
                                        ;         .rept s_word
   1693 80EF C8                                     iny
   1694 80F0 C8                                     iny
                                        ;         .endr
                                        ;         .rept s_word
   1697 80F1 C8                                     iny
   1698 80F2 C8                                     iny
                                        ;         .endr
   1700 80F3 C0 0F                                cpy #reg_spx-reg_ax+3
   1701 80F5 90 E1                                bcc .0000030          ;next
                                        ;
                                        ;
                                        ;	display DS SS DB...
                                        ;
   1706 80F7 F4                       +            .byte $f4
   1706 80F8 BB 90                    +            .word mm_regs2
                                        
   1707 80FA 20 1D 88                    		 jsr sprint
   1708 80FD C2 20                    +            .byte $c2,$20
                                        
   1709 80FF A5 82                                lda reg_dsx          ;get DS &...
   1710 8101 E2 20                    +            .byte $e2,$20
                                        
   1711 8103 20 D7 87                             jsr dpyhexw           ;convert & display
   1712 8106 20 15 88                             jsr printspc          ;more spacing
   1713 8109 C2 20                    +            .byte $c2,$20
                                        
   1714 810B A5 84                                lda reg_ssx           ;get SS &...
   1715 810D E2 20                    +            .byte $e2,$20
                                        
   1716 810F 20 D7 87                             jsr dpyhexw           ;convert & display
   1717 8112 20 15 88                             jsr printspc          ;more spacing
   1718 8115 A5 9B                                lda reg_dbx           ;get DB &...
   1719 8117 20 E7 87                             jsr dpyhex            ;display it
   1720 811A 20 15 88                             jsr printspc          ;more spacing
   1721 811D C2 20                    +            .byte $c2,$20
                                        
   1722 811F A5 9C                                lda reg_dpx           ;get DPR &...
   1723 8121 E2 20                    +            .byte $e2,$20
                                        
   1724 8123 20 D7 87                             jsr dpyhexw           ;convert & display
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monce: COMMAND EXECUTIVE
                                        ;	
   1730 8126 E2 20                      monce +         .byte $e2,$20
                                        
   1731 8128 A9 00                                lda #0                ;default buffer index
                                        ;
   1733 812A E2 30                      moncea +         .byte $e2,$30
                                                        ;alternate entry point
   1734 812C 85 BF                                sta ibufidx           ;(re)set buffer index
   1735 812E F4                       +            .byte $f4
   1735 812F 56 90                    +            .word mm_prmpt
                                        
   1736 8131 20 1D 88                             jsr sprint            ;display input prompt
   1737 8134 20 3F 8C                             jsr input             ;await some input
                                        ;
   1739 8137                            .0000010:
   1740 8137 20 A1 8C                    		jsr getcharc          ;read from buffer
   1741 813A F0 EA                                beq monce             ;terminator, just loop
                                        ;
   1743 813C C9 20                                cmp #a_blank
   1744 813E F0 F7                                beq .0000010          ;strip leading blanks
                                        ;
   1746 8140 A2 0C                                ldx #n_mpctab-1       ;number of primary commands
                                        ;
   1748 8142 DD BB 8C                   .0000020 cmp mpctab,x          ;search primary command list
   1749 8145 D0 0E                                bne .0000030
                                        ;
   1751 8147 8A                                   txa                   ;get index
   1752 8148 0A                                   asl                   ;double for offset
   1753 8149 AA                                   tax
   1754 814A C2 20                    +            .byte $c2,$20
                                        
   1755 814C BD C8 8C                             lda mpcextab,x        ;command address -1
   1756 814F 48                                   pha                   ;prime the stack
   1757 8150 E2 20                    +            .byte $e2,$20
                                        
   1758 8152 4C E3 8A                             jmp getparm           ;evaluate parm & execute command
                                        ;
   1760 8155 CA                         .0000030 dex
   1761 8156 10 EA                                bpl .0000020          ;continue searching primary commands
                                        ;
   1763 8158 A2 03                                ldx #n_radix-1        ;number of radices
                                        ;
   1765 815A DD F6 8C                   .0000040 cmp radxtab,x         ;search conversion command list
   1766 815D D0 03                                bne .0000050
                                        ;
   1768 815F 4C AF 85                             jmp monenv            ;convert & display parameter
                                        ;
   1770 8162 CA                         .0000050 dex
   1771 8163 10 F5                                bpl .0000040
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monerr: COMMON ERROR HANDLER
                                        ;
   1777 8165 E2 30                      monerr +         .byte $e2,$30
                                                        ;8 bit registers
                                        ;
   1779 8167 20 BE 87                   monerraa jsr dpyerr            ;indicate an error &...
   1780 816A 80 BA                                bra monce             ;return to input loop
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monasc: ASSEMBLE CODE
                                        ;
                                        ;	———————————————————————————————————————————————————————————————————————
                                        ;	syntax: A <addr> <mnemonic> [<argument>]
                                        ;
                                        ;	After a line of code has been successfully assembled it will be disass-
                                        ;	embled & displayed,  & the monitor will prompt with the next address to
                                        ;	which code may be assembled.
                                        ;	———————————————————————————————————————————————————————————————————————
                                        ;
   1794 816C 90 03                      monasc   bcc .0000020          ;assembly address entered
                                        ;
   1796 816E 4C 65 81                   .0000010 jmp monerr            ;terminate w/error
                                        ;
                                        ;
                                        ;	evaluate assembly address...
                                        ;
   1801 8171 20 CF 8A                   .0000020 jsr facasize          ;check address...
   1802 8174 C9 04                                cmp #s_dword          ;range
   1803 8176 B0 F6                                bcs .0000010          ;out of range — error
                                        ;
   1805 8178 20 B1 8A                             jsr facaddra          ;store assembly address
                                        ;
                                        ;
                                        ;	initialize workspace...
                                        ;
   1810 817B A2 1F                                ldx #s_auxbuf-s_byte
                                        ;
   1812 817D 9E 51 02                   .0000030 stz auxbuf,x          ;clear addressing mode buffer
   1813 8180 CA                                   dex
   1814 8181 D0 FA                                bne .0000030
                                        ;
   1816 8183 A9 20                                lda #a_blank
   1817 8185 8D 51 02                             sta auxbuf            ;preamble placeholder
   1818 8188 20 1E 8A                             jsr clroper           ;clear operand
   1819 818B 64 BE                                stz auxbufix          ;reset addressing mode index
   1820 818D 64 CE                                stz flimflag          ;clear forced long immediate
   1821 818F 64 C8                                stz mnepck            ;clear encoded...
   1822 8191 64 C9                                stz mnepck+s_byte     ;mnemonic workspace
   1823 8193 64 D1                                stz vopsflag          ;clear 8/16 or relative flag
                                        ;
                                        ;
                                        ;	encode mnemonic...
                                        ;
   1828 8195 A0 03                                ldy #s_mnemon         ;expected mnemonic size
                                        ;
   1830 8197 20 30 8C                   .0000040 jsr getcharw          ;get from buffer wo/whitespace
   1831 819A D0 0A                                bne .0000060          ;gotten
                                        ;
   1833 819C C0 03                                cpy #s_mnemon         ;any input at all?
   1834 819E 90 03                                bcc .0000050          ;yes
                                        ;
   1836 81A0 4C 26 81                             jmp monce             ;no, abort further assembly
                                        ;
   1838 81A3 4C 45 83                   .0000050 jmp monasc10          ;incomplete mnemonic — error
                                        ;
   1840 81A6 38                         .0000060 sec
   1841 81A7 E9 3F                                sbc #a_mnecvt         ;ASCII to binary factor
   1842 81A9 A2 05                                ldx #n_shfenc         ;shifts required to encode
                                        ;
   1844 81AB 4A                         .0000070 lsr                   ;shift out a bit...
   1845 81AC 66 C9                                ror mnepck+s_byte     ;into...
   1846 81AE 66 C8                                ror mnepck            ;encoded mnemonic
   1847 81B0 CA                                   dex
   1848 81B1 D0 F8                                bne .0000070          ;next bit
                                        ;
   1850 81B3 88                                   dey
   1851 81B4 D0 E1                                bne .0000040          ;get next char
                                        ;
                                        ;
                                        ;	test for copy instruction...
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	The MVN & MVP instructions accept two operands & hence have an irregular
                                        ;	syntax.  Therefore, special handling is necessary to assemble either of
                                        ;	these instructions.
                                        ;
                                        ;	The official WDC syntax has the programmer entering a pair of 24 bit ad-
                                        ;	dresses as operands, with the assembler isolating bits 16-23 to	use as
                                        ;	operands.  This formality has been dispensed with in this monitor & the
                                        ;	operands are expected to be 8 bit bank values.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   1866 81B6 C2 20                    +            .byte $c2,$20
                                                         ;16 bit load
   1867 81B8 A5 C8                                lda mnepck            ;packed menmonic
   1868 81BA A2 54                                ldx #opc_mvn          ;MVN opcode
   1869 81BC C9 DC                    +            cmp #<mne_mvn
   1869 81BE 7D                       +            .byte >mne_mvn
                                        ;is it MVN?
   1870 81BF F0 07                                beq monasc01          ;yes
                                        ;
   1872 81C1 A2 44                                ldx #opc_mvp          ;MVP opcode
   1873 81C3 C9 DC                    +            cmp #<mne_mvp
   1873 81C5 8D                       +            .byte >mne_mvp
                                        ;is it MVP?
   1874 81C6 D0 30                                bne monasc02          ;no
                                        ;
                                        ;
                                        ;	assemble copy instruction...
                                        ;
   1879 81C8 86 CA                      monasc01 stx opcode            ;store relevant opcode
   1880 81CA E2 20                    +            .byte $e2,$20
                                        
   1881 81CC 20 3F 8B                             jsr instdata          ;get instruction data
   1882 81CF 86 CD                                stx eopsize           ;effective operand size
   1883 81D1 E8                                   inx
   1884 81D2 86 C6                                stx instsize          ;instruction size
   1885 81D4 A2 01                                ldx #s_oper-s_word    ;operand index
   1886 81D6 86 CC                                stx xrtemp            ;set it
                                        ;
   1888 81D8 20 38 88                   .0000010 jsr ascbin            ;evaluate bank number
   1889 81DB B0 50                                bcs monasc04          ;conversion error
                                        ;
   1891 81DD F0 4E                                beq monasc04          ;nothing returned — error
                                        ;
   1893 81DF 20 CF 8A                             jsr facasize          ;bank must be...
   1894 81E2 C9 02                                cmp #s_word           ;8 bits
   1895 81E4 B0 47                                bcs monasc04          ;it isn't — error
                                        ;
   1897 81E6 A5 A7                                lda faca              ;bank
   1898 81E8 A6 CC                                ldx xrtemp            ;operand index
   1899 81EA 95 BB                                sta operand,x         ;store
   1900 81EC C6 CC                                dec xrtemp            ;index=index-1
   1901 81EE 10 E8                                bpl .0000010          ;get destination bank
                                        ;
   1903 81F0 20 D0 8B                             jsr getcharr          ;should be no more input
   1904 81F3 D0 38                                bne monasc04          ;there is — error
                                        ;
   1906 81F5 4C F3 82                             jmp monasc08          ;finish MVN/MVP assembly 
                                        ;
                                        ;
                                        ;	continue with normal assembly...
                                        ;
   1911 81F8 E2 20                      monasc02 +         .byte $e2,$20
                                                        ;back to 8 bits
                                        ;
   1913 81FA 20 30 8C                   monasc03 jsr getcharw          ;get next char
   1914 81FD F0 3D                                beq monasc06          ;EOI, no argument
                                        ;
   1916 81FF C9 21                                cmp #amp_flim
   1917 8201 D0 0A                                bne .0000010          ;no forced long immediate
                                        ;
   1919 8203 A5 CE                                lda flimflag          ;FLIM already set?
   1920 8205 D0 26                                bne monasc04          ;yes — error
                                        ;
   1922 8207 A9 C0                                lda #flimmask
   1923 8209 85 CE                                sta flimflag          ;set flag &...
   1924 820B 80 ED                                bra monasc03          ;get next char
                                        ;
   1926 820D C9 23                      .0000010 cmp #amp_imm          ;immediate mode?
   1927 820F F0 08                                beq .0000020          ;yes
                                        ;
   1929 8211 C9 28                                cmp #amp_ind          ;indirect mode?
   1930 8213 F0 04                                beq .0000020          ;yes
                                        ;
   1932 8215 C9 5B                                cmp #amp_indl         ;indirect long mode?
   1933 8217 D0 07                                bne .0000030          ;no
                                        ;
   1935 8219 8D 51 02                   .0000020 sta auxbuf            ;set addressing mode preamble
   1936 821C E6 BE                                inc auxbufix          ;bump aux buffer index &...
   1937 821E 80 02                                bra .0000040          ;evaluate operand
                                        ;
   1939 8220 C6 BF                      .0000030 dec ibufidx           ;position back to char
                                        ;
   1941 8222 20 38 88                   .0000040 jsr ascbin            ;evaluate operand
   1942 8225 D0 09                                bne monasc05          ;evaluated
                                        ;
   1944 8227 B0 04                                bcs monasc04          ;conversion error
                                        ;
   1946 8229 A5 BE                                lda auxbufix          ;no operand...any preamble?
   1947 822B F0 0F                                beq monasc06          ;no, syntax is okay so far
                                        ;
   1949 822D 4C 45 83                   monasc04 jmp monasc10          ;abort w/error
                                        ;
   1951 8230 20 CF 8A                   monasc05 jsr facasize          ;size operand
   1952 8233 C9 04                                cmp #s_dword          ;max is 24 bits
   1953 8235 B0 F6                                bcs monasc04          ;too big
                                        ;
   1955 8237 85 CD                                sta eopsize           ;save operand size
   1956 8239 20 C5 8A                             jsr facaoper          ;store operand
                                        ;
   1958 823C C6 BF                      monasc06 dec ibufidx           ;back to last char
   1959 823E A6 BE                                ldx auxbufix          ;mode buffer index
   1960 8240 D0 01                                bne .0000010          ;preamble in buffer
                                        ;
   1962 8242 E8                                   inx                   ;step past preamble position
                                        ;
   1964 8243 20 A1 8C                   .0000010 jsr getcharc          ;get a char w/forced UC
   1965 8246 F0 0A                                beq .0000030          ;EOI
                                        ;
   1967 8248 E0 20                                cpx #s_auxbuf         ;mode buffer full?
   1968 824A B0 E1                                bcs monasc04          ;yes, too much input
                                        ;
   1970 824C 9D 51 02                   .0000020 sta auxbuf,x          ;store for comparison
   1971 824F E8                                   inx
   1972 8250 D0 F1                                bne .0000010
                                        ;
                                        ;
                                        ;	evaluate mnemonic...
                                        ;
   1977 8252 A2 5B                      .0000030 ldx #n_mnemon-1       ;starting mnemonic index
                                        ;
   1979 8254 8A                         monasc07 txa                   ;convert index...
   1980 8255 0A                                   asl                   ;to offset
   1981 8256 A8                                   tay                   ;now mnemonic table index
   1982 8257 C2 20                    +            .byte $c2,$20
                                                         ;16 bit compare
   1983 8259 B9 03 8D                             lda mnetab,y          ;get mnemonic from table
   1984 825C C5 C8                                cmp mnepck            ;compare to entered mnemonic
   1985 825E E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   1986 8260 F0 05                                beq .0000020          ;match
                                        ;
   1988 8262 CA                         .0000010 dex                   ;try next mnemonic
   1989 8263 30 C8                                bmi monasc04          ;unknown mnemonic — error
                                        ;
   1991 8265 80 ED                                bra monasc07          ;keep going
                                        ;
   1993 8267 86 C8                      .0000020 stx mnepck            ;save mnemonic index
   1994 8269 8A                                   txa
   1995 826A A2 00                                ldx #0                ;trial opcode
                                        ;
   1997 826C DD BB 8D                   .0000030 cmp mnetabix,x        ;search index table...
   1998 826F F0 05                                beq .0000050          ;for a match
                                        ;
   2000 8271 E8                         .0000040 inx                   ;keep going until we...
   2001 8272 D0 F8                                bne .0000030          ;search entire table
                                        ;
   2003 8274 80 B7                                bra monasc04          ;this shouldn't happen!
                                        ;
                                        ;	—————————————————————————————————————————————————————————————————————
                                        ;	If the mnemonic index table search fails then there is a coding error
                                        ;	somewhere, as every entry in the mnemonic table is supposed to have a
                                        ;	matching cardinal index.
                                        ;	—————————————————————————————————————————————————————————————————————
                                        ;
                                        ;
                                        ;	evaluate addressing mode...
                                        ;
   2014 8276 86 CA                      .0000050 stx opcode            ;save trial opcode
   2015 8278 20 3F 8B                             jsr instdata          ;get related instruction data
   2016 827B 85 D1                                sta vopsflag          ;save 8/16 or relative flag
   2017 827D 86 CF                                stx iopsize           ;operand size
   2018 827F E8                                   inx
   2019 8280 86 C6                                stx instsize          ;instruction size
   2020 8282 A6 CA                                ldx opcode            ;recover trial opcode
   2021 8284 98                                   tya                   ;addressing mode
   2022 8285 0A                                   asl                   ;create table index
   2023 8286 A8                                   tay
   2024 8287 C2 20                    +            .byte $c2,$20
                                        
   2025 8289 B9 BF 8F                             lda ms_lutab,y        ;mode lookup table
   2026 828C 85 A4                                sta addrb             ;set pointer
   2027 828E E2 20                    +            .byte $e2,$20
                                        
   2028 8290 A0 00                                ldy #0
                                        ;
   2030 8292 B1 A4                      .0000060 lda (addrb),y         ;table addressing mode
   2031 8294 D9 51 02                             cmp auxbuf,y          ;entered addressing mode
   2032 8297 F0 04                                beq .0000080          ;okay so far
                                        ;
   2034 8299 A5 C8                      .0000070 lda mnepck            ;reload mnemonic index        
   2035 829B 80 D4                                bra .0000040          ;wrong opcode for addresing mode
                                        ;
   2037 829D 09 00                      .0000080 ora #0                ;last char the terminator?
   2038 829F F0 03                                beq .0000090          ;yes, evaluate operand
                                        ;
   2040 82A1 C8                                   iny
   2041 82A2 80 EE                                bra .0000060          ;keep testing
                                        ;
                                        ;
                                        ;	evaluate operand...
                                        ;
   2046 82A4 A5 CD                      .0000090 lda eopsize           ;entered operand size
   2047 82A6 D0 06                                bne .0000100          ;non-zero
                                        ;
   2049 82A8 05 CF                                ora iopsize           ;instruction operand size
   2050 82AA D0 ED                                bne .0000070          ;wrong opcode — keep trying
                                        ;
   2052 82AC 80 45                                bra monasc08          ;assemble instruction
                                        ;
   2054 82AE 24 D1                      .0000100 bit vopsflag          ;is this a branch?
   2055 82B0 70 3A                                bvs .0000160          ;yes, evaluate
                                        ;
   2057 82B2 A5 CF                                lda iopsize           ;instruction operand size
   2058 82B4 24 D1                                bit vopsflag          ;variable size operand allowed?
   2059 82B6 30 15                                bmi .0000130          ;yes
                                        ;
   2061 82B8 24 CE                                bit flimflag          ;was forced immediate set?
   2062 82BA 10 03                                bpl .0000110          ;no
                                        ;         
   2064 82BC 4C 45 83                             jmp monasc10          ;yes — error
                                        ;
   2066 82BF C5 CD                      .0000110 cmp eopsize           ;entered operand size
   2067 82C1 90 D6                                bcc .0000070          ;operand too big
                                        ;
   2069 82C3 85 CD                                sta eopsize           ;new operand size
   2070 82C5 80 2C                                bra monasc08          ;assemble, otherwise...
                                        ;
   2072 82C7 C5 CD                      .0000120 cmp eopsize           ;exact size match required
   2073 82C9 D0 CE                                bne .0000070          ;mismatch — wrong opcode
                                        ;
   2075 82CB 80 26                                bra monasc08          ;assemble
                                        ;
                                        ;
                                        ;	process variable size immediate mode operand...
                                        ;
   2080 82CD A6 CD                      .0000130 ldx eopsize           ;entered operand size
   2081 82CF E0 03                                cpx #s_xword          ;check size
   2082 82D1 B0 72                                bcs monasc10          ;too big — error
                                        ;
   2084 82D3 24 CE                                bit flimflag          ;forced long immediate?
   2085 82D5 10 06                                bpl .0000140          ;no
                                        ;
   2087 82D7 A2 02                                ldx #s_word           ;promote operand size to...
   2088 82D9 86 CD                                stx eopsize           ;16 bits
   2089 82DB 80 08                                bra .0000150
                                        ;
   2091 82DD E0 02                      .0000140 cpx #s_word           ;16 bits?
   2092 82DF D0 04                                bne .0000150          ;no
                                        ;
   2094 82E1 A0 C0                                ldy #flimmask         ;yes so force long...
   2095 82E3 84 CE                                sty flimflag          ;immediate disassembly
                                        ;
   2097 82E5 1A                         .0000150 ina                   ;new instruction operand size
   2098 82E6 C5 CD                                cmp eopsize           ;compare against operand size
   2099 82E8 90 AF                                bcc .0000070          ;mismatch — can't assemble
                                        ;
   2101 82EA 80 07                                bra monasc08          ;okay, assemble
                                        ;
                                        ;
                                        ;	process relative branch...
                                        ;
   2106 82EC 20 8B 8B                   .0000160 jsr targoff           ;compute branch offset
   2107 82EF B0 54                                bcs monasc10          ;branch out of range
                                        ;
   2109 82F1 85 CD                                sta eopsize           ;effective operand size
                                        ;
                                        ;
                                        ;	assemble instruction...
                                        ;
   2114 82F3 A5 CA                      monasc08 lda opcode            ;opcode
   2115 82F5 87 A0                    +            .byte $87,addra
                                        ;store at assembly address
   2116 82F7 A6 CD                                ldx eopsize           ;any operand to process?
   2117 82F9 F0 09                                beq .0000020          ;no
                                        ;
   2119 82FB 9B                       +            .byte $9b
                                                           ;also storage offset
                                        ;
   2121 82FC CA                         .0000010 dex
   2122 82FD B5 BB                                lda operand,x         ;get operand byte &...
   2123 82FF 97 A0                    +            .byte $97,addra
                                        ;poke into memory
   2124 8301 88                                   dey
   2125 8302 D0 F8                                bne .0000010          ;next
                                        ;
   2127 8304 A9 0D                      .0000020 lda #a_cr
                                           		 cpu FT832
   2129 008306 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2131 830B A9 41                                lda #asmprfx          ;assembly prefix
   2132 830D 20 5B 86                             jsr dpycodaa          ;disassemble & display
                                        ;
                                        ;
                                        ;	prompt for next instruction...
                                        ;
   2137 8310 A9 20                      monasc09 lda #a_blank
   2138 8312 A2 08                                ldx #ascprmct-1
                                        ;
   2140 8314 9D 00 02                   .0000010 sta ibuffer,x         ;prepare buffer for...
   2141 8317 CA                                   dex                   ;next instruction
   2142 8318 10 FA                                bpl .0000010
                                        ;
   2144 831A A9 41                                lda #asmprfx          ;assemble code...
   2145 831C 8D 00 02                             sta ibuffer           ;prompt prefix
   2146 831F A5 A2                                lda addra+s_word      ;next instruction address bank
   2147 8321 20 8A 89                             jsr binhex            ;convert to ASCII
   2148 8324 8D 02 02                             sta ibuffer+apadrbkh  ;store MSN in buffer
   2149 8327 8E 03 02                             stx ibuffer+apadrbkl  ;store LSN in buffer
   2150 832A A5 A1                                lda addra+s_byte      ;next instruction address MSB
   2151 832C 20 8A 89                             jsr binhex
   2152 832F 8D 04 02                             sta ibuffer+apadrmbh
   2153 8332 8E 05 02                             stx ibuffer+apadrmbl
   2154 8335 A5 A0                                lda addra             ;next instruction address LSB
   2155 8337 20 8A 89                             jsr binhex
   2156 833A 8D 06 02                             sta ibuffer+apadrlbh
   2157 833D 8E 07 02                             stx ibuffer+apadrlbl
   2158 8340 A9 09                                lda #ascprmct         ;effective input count
   2159 8342 4C 2A 81                             jmp moncea            ;reenter input loop
                                        ;
                                        ;
                                        ;	process assembly error...
                                        ;
   2164 8345 20 BE 87                   monasc10 jsr dpyerr            ;indicate error &...
   2165 8348 80 C6                                bra monasc09          ;prompt w/same assembly address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mondsc: DISASSEMBLE CODE
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: D [<addr1> [<addr2>]]
                                        ;	—————————————————————————————
                                        ;
   2175 834A B0 11                      mondsc   bcs .0000010          ;no parameters
                                        ;
   2177 834C 64 CE                                stz flimflag          ;reset to 8 bit mode
   2178 834E 20 CF 8A                             jsr facasize          ;check starting...
   2179 8351 C9 04                                cmp #s_dword          ;address
   2180 8353 B0 46                                bcs .0000050          ;out of range — error
                                        ;
   2182 8355 20 B1 8A                             jsr facaddra          ;copy starting address
   2183 8358 20 E3 8A                             jsr getparm           ;get ending address
   2184 835B 90 17                                bcc .0000020          ;gotten
                                        ;
   2186 835D 20 9D 89                   .0000010 jsr clrfaca           ;clear accumulator
   2187 8360 C2 20                    +            .byte $c2,$20
                                        
   2188 8362 18                                   clc
   2189 8363 A5 A0                                lda addra             ;starting address
   2190 8365 69 15                    +            adc #<n_dbytes
   2190 8367 00                       +            .byte >n_dbytes
                                        ;default bytes
   2191 8368 85 A7                                sta faca              ;effective ending address
   2192 836A E2 20                    +            .byte $e2,$20
                                        
   2193 836C A5 A2                                lda addra+s_word      ;starting bank
   2194 836E 69 00                                adc #0
   2195 8370 85 A9                                sta faca+s_word       ;effective ending bank
   2196 8372 B0 27                                bcs .0000050          ;end address > $FFFFFF
                                        ;
   2198 8374 20 CF 8A                   .0000020 jsr facasize          ;check ending...
   2199 8377 C9 04                                cmp #s_dword          ;address
   2200 8379 B0 20                                bcs .0000050          ;out of range — error
                                        ;
   2202 837B 20 BB 8A                             jsr facaddrb          ;set ending address
   2203 837E 20 E3 8A                             jsr getparm           ;check for excess input
   2204 8381 90 18                                bcc .0000050          ;present — error
                                        ;
   2206 8383 20 09 8A                             jsr calccnt           ;calculate bytes
   2207 8386 90 13                                bcc .0000050          ;end < start
                                        ;
   2209 8388 20 B3 8C                   .0000030 jsr teststop          ;test for display stop
   2210 838B B0 0B                                bcs .0000040          ;stopped
                                        ;
   2212 838D 20 05 88                             jsr newline           ;next line
   2213 8390 20 59 86                             jsr dpycod            ;disassemble & display
   2214 8393 20 67 8A                             jsr decdcnt           ;decrement byte count
   2215 8396 90 F0                                bcc .0000030          ;not done
                                        ;
   2217 8398 4C 26 81                   .0000040 jmp monce             ;back to main loop
                                        ;
   2219 839B 4C 65 81                   .0000050 jmp monerr            ;address range error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monjmp: EXECUTE CODE
                                        ;
                                        ;	—————————————————————————————————————————————————————————————
                                        ;	syntax: G [<addr>]
                                        ;
                                        ;	If no address is specified, the current values in the PB & PC
                                        ;	shadow registers are used.
                                        ;	—————————————————————————————————————————————————————————————
                                        ;
   2232 839E 20 74 8B                   monjmp   jsr setxaddr          ;set execution address
   2233 83A1 B0 29                                bcs monjmpab          ;out of range — error
                                        ;
   2235 83A3 20 E3 8A                             jsr getparm           ;check for excess input
   2236 83A6 90 24                                bcc monjmpab          ;too much input — error
                                        ;
   2238 83A8 C2 20                    +            .byte $c2,$20
                                                         ;16 bit .A
   2239 83AA A5 95                                lda reg_spx
   2240 83AC 1B                       +            .byte $1b
                                                           ;restore SP
                                        ;
   2242 83AD E2 20                      monjmpaa +         .byte $e2,$20
                                        
   2243 83AF A5 88                                lda reg_pbx
   2244 83B1 48                                   pha                   ;restore PB
   2245 83B2 C2 20                    +            .byte $c2,$20
                                        
   2246 83B4 A5 86                                lda reg_pcx
   2247 83B6 48                                   pha                   ;restore PC
   2248 83B7 E2 20                    +            .byte $e2,$20
                                        
   2249 83B9 A5 99                                lda reg_srx
   2250 83BB 48                                   pha                   ;restore SR
   2251 83BC A5 9B                                lda reg_dbx
   2252 83BE 48                                   pha
   2253 83BF AB                       +            .byte $ab
                                                           ;restore DB
   2254 83C0 C2 30                    +            .byte $c2,$30
                                        
   2255 83C2 A5 9C                                lda reg_dpx
   2256 83C4 5B                       +            .byte $5b
                                                           ;restore DP
   2257 83C5 A5 89                                lda reg_ax            ;restore .C
   2258 83C7 A6 8D                                ldx reg_xx            ;restore .X
   2259 83C9 A4 91                                ldy reg_yx            ;restore .Y
   2260 83CB 40                                   rti                   ;execute code
                                        ;
   2262 83CC 4C 65 81                   monjmpab jmp monerr            ;error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monjsr: EXECUTE CODE AS SUBROUTINE
                                        ;
                                        ;	————————————————————————————————————————————————————————————
                                        ;	syntax: J [<addr>]
                                        ;
                                        ;	If no address is specified the current values in the PB & PC
                                        ;	shadow registers are used.   An RTS at the end of the called
                                        ;	subroutine will return control to the monitor  provided  the
                                        ;	stack remains in balance.
                                        ;	————————————————————————————————————————————————————————————
                                        ;
   2277 83CF 20 74 8B                   monjsr   jsr setxaddr          ;set execution address
   2278 83D2 B0 F8                                bcs monjmpab          ;out of range — error
                                        ;
   2280 83D4 20 E3 8A                             jsr getparm           ;check for excess input
   2281 83D7 90 F3                                bcc monjmpab          ;too much input — error
                                        ;
   2283 83D9 C2 20                    +            .byte $c2,$20
                                        
   2284 83DB A5 95                                lda reg_spx
   2285 83DD 1B                       +            .byte $1b
                                                           ;restore SP &...
   2286 83DE 20 AD 83                             jsr monjmpaa          ;call subroutine
   2287 83E1 08                                   php                   ;push SR
   2288 83E2 C2 30                    +            .byte $c2,$30
                                        
   2289 83E4 85 89                                sta reg_ax            ;save...
   2290 83E6 86 8D                                stx reg_xx            ;register...
   2291 83E8 84 91                                sty reg_yx            ;returns
   2292 83EA E2 10                    +            .byte $e2,$10
                                                        ;8 bit .X & .Y
   2293 83EC FA                                   plx                   ;get & save...
   2294 83ED 86 99                                stx reg_srx           ;return SR
   2295 83EF 3B                       +            .byte $3b
                                                           ;get & save...
   2296 83F0 85 95                                sta reg_spx           ;return SP
   2297 83F2 7B                       +            .byte $7b
                                                           ;get & save...
   2298 83F3 85 9C                                sta reg_dpx           ;DP pointer
   2299 83F5 E2 20                    +            .byte $e2,$20
                                                        ;8 bit .A
   2300 83F7 4B                       +            .byte $4b
                                                           ;get &...
   2301 83F8 68                                   pla                   ;save...
   2302 83F9 85 88                                sta reg_pbx           ;return PB
   2303 83FB 8B                       +            .byte $8b
                                                           ;get &...
   2304 83FC 68                                   pla                   ;save...
   2305 83FD 85 9B                                sta reg_dbx           ;return DB
   2306 83FF F4                       +            .byte $f4
   2306 8400 D4 90                    +            .word mm_rts
                                        ;"*RET"
   2307 8402 4C 72 80                             jmp moncom            ;return to monitor
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monchm: CHANGE and/or DUMP MEMORY
                                        ;
                                        ;	————————————————————————————————————————————
                                        ;	syntax: > [<addr> <operand> [<operand>]...]
                                        ;
                                        ;	> <addr> without operands will dump 16 bytes
                                        ;	of memory, starting at <addr>.
                                        ;	————————————————————————————————————————————
                                        ;
   2320 8405 B0 23                      monchm   bcs .0000030          ;no address given — quit
                                        ;
   2322 8407 20 CF 8A                             jsr facasize          ;size address
   2323 840A C9 04                                cmp #s_dword
   2324 840C B0 1F                                bcs .0000040          ;address out of range — error
                                        ;
   2326 840E 20 B1 8A                             jsr facaddra          ;set starting address
   2327 8411 20 E4 8B                             jsr getpat            ;evaluate change pattern
   2328 8414 90 04                                bcc .0000010          ;entered
                                        ;
   2330 8416 10 0C                                bpl .0000020          ;not entered
                                        ;
   2332 8418 80 13                                bra .0000040          ;evaluation error
                                        ;
   2334 841A 88                         .0000010 dey                   ;next byte
   2335 841B 30 07                                bmi .0000020          ;done
                                        ;
   2337 841D B9 51 02                             lda auxbuf,y          ;write pattern...
   2338 8420 97 A0                    +            .byte $97,addra
                                        ;to memory
   2339 8422 80 F6                                bra .0000010          ;next
                                        ;
   2341 8424 20 05 88                   .0000020 jsr newline           ;next line
   2342 8427 20 77 87                             jsr dpymem            ;regurgitate changes
                                        ;
   2344 842A 4C 26 81                   .0000030 jmp monce             ;back to command loop
                                        ;
   2346 842D 4C 65 81                   .0000040 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncmp: COMPARE MEMORY
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: C <start> <end> <ref>
                                        ;	—————————————————————————————
                                        ;
   2356 8430 B0 26                      moncmp   bcs .0000030          ;start not given — quit
                                        ;
   2358 8432 20 8B 8A                             jsr enddest           ;get end & reference addresses
   2359 8435 B0 24                                bcs .0000040          ;range or other error
                                        ;
   2361 8437 64 CC                                stz xrtemp            ;column counter
                                        ;
   2363 8439 20 B3 8C                   .0000010 jsr teststop          ;check for stop
   2364 843C B0 1A                                bcs .0000030          ;abort
                                        ;
   2366 843E A7 A0                    +            .byte $a7,addra
                                        ;get from reference location
   2367 8440 C7 BB                    +            .byte $c7,operand
                                        ;test against compare location
   2368 8442 F0 03                                beq .0000020          ;match, don't display address
                                        ;
   2370 8444 20 3F 86                             jsr dpycaddr          ;display current location
                                        ;
   2372 8447 20 0B 8B                   .0000020 jsr nxtaddra          ;next reference location
   2373 844A B0 0C                                bcs .0000030          ;done
                                        ;
   2375 844C C2 20                    +            .byte $c2,$20
                                        
   2376 844E E6 BB                                inc operand           ;bump bits 0-15
   2377 8450 E2 20                    +            .byte $e2,$20
                                        
   2378 8452 D0 E5                                bne .0000010
                                        ;
   2380 8454 E6 BD                                inc operand+s_word    ;bump bits 16-23
   2381 8456 80 E1                                bra .0000010
                                        ;
   2383 8458 4C 26 81                   .0000030 jmp monce             ;return to command exec
                                        ;
   2385 845B 4C 65 81                   .0000040 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;moncpy: COPY (transfer) MEMORY
                                        ;
                                        ;	————————————————————————————————
                                        ;	syntax: T <start> <end> <target>
                                        ;	————————————————————————————————
                                        ;
   2395 845E B0 49                      moncpy   bcs .0000040          ;start not given — quit
                                        ;
   2397 8460 20 8B 8A                             jsr enddest           ;get end & target addresses
   2398 8463 B0 47                                bcs .0000050          ;range or other error
                                        ;
   2400 8465 C2 20                    +            .byte $c2,$20
                                        
   2401 8467 38                                   sec
   2402 8468 A5 A4                                lda addrb             ;ending address
   2403 846A E5 A0                                sbc addra             ;starting address
   2404 846C 90 3E                                bcc .0000050          ;start > end — error
                                        ;
   2406 846E 85 AF                                sta facb              ;bytes to copy
   2407 8470 E2 20                    +            .byte $e2,$20
                                        
   2408 8472 C2 10                    +            .byte $c2,$10
                                        
   2409 8474 A5 BD                                lda operand+s_word    ;target bank
   2410 8476 A4 BB                                ldy operand           ;target address
   2411 8478 C5 A2                                cmp addra+s_word      ;source bank
   2412 847A C2 20                    +            .byte $c2,$20
                                        
   2413 847C D0 1C                                bne .0000020          ;can use forward copy
                                        ;
   2415 847E C4 A0                                cpy addra             ;source address
   2416 8480 90 18                                bcc .0000020          ;can use forward copy
                                        ;
   2418 8482 D0 02                                bne .0000010          ;must use reverse copy
                                        ;
   2420 8484 80 26                                bra .0000050          ;copy in place — error
                                        ;
   2422 8486 A5 AF                      .0000010 lda facb              ;get bytes to copy
   2423 8488 48                                   pha                   ;protect
   2424 8489 20 99 8C                             jsr lodbnk            ;load banks
   2425 848C 20 31 8A                             jsr cprvsup           ;do reverse copy setup
   2426 848F 68                                   pla                   ;get bytes to copy
   2427 8490 AA                                   tax                   ;save a copy
   2428 8491 18                                   clc
   2429 8492 65 BB                                adc operand           ;change target to...
   2430 8494 A8                                   tay                   ;target end
   2431 8495 8A                                   txa                   ;recover bytes to copy
   2432 8496 A6 A4                                ldx addrb             ;source end
   2433 8498 80 0C                                bra .0000030
                                        ;
   2435 849A A5 AF                      .0000020 lda facb              ;get bytes to copy
   2436 849C 48                                   pha                   ;protect
   2437 849D 20 99 8C                             jsr lodbnk            ;load banks
   2438 84A0 20 2A 8A                             jsr cpfwsup           ;do forward copy setup
   2439 84A3 68                                   pla                   ;get bytes to copy
   2440 84A4 A6 A0                                ldx addra             ;source start
                                        ;
   2442 84A6 4C D2 00                   .0000030 jmp mcftwork          ;copy memory
                                        ;
   2444 84A9 4C 26 81                   .0000040 jmp monce             ;back to executive
                                        ;
   2446 84AC 4C 65 81                   .0000050 jmp monerr            ;error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;mondmp: DISPLAY MEMORY RANGE
                                        ;
                                        ;	—————————————————————————————
                                        ;	syntax: M [<addr1> [<addr2>]]
                                        ;	—————————————————————————————
                                        ;
   2456 84AF B0 0F                      mondmp   bcs .0000010          ;no parameters
                                        ;
   2458 84B1 20 CF 8A                             jsr facasize          ;check address...
   2459 84B4 C9 04                                cmp #s_dword          ;range
   2460 84B6 B0 46                                bcs .0000050          ;address out of range
                                        ;
   2462 84B8 20 B1 8A                             jsr facaddra          ;copy starting address
   2463 84BB 20 E3 8A                             jsr getparm           ;get ending address
   2464 84BE 90 17                                bcc .0000020          ;gotten
                                        ;
   2466 84C0 20 9D 89                   .0000010 jsr clrfaca           ;clear accumulator
   2467 84C3 C2 20                    +            .byte $c2,$20
                                        
   2468 84C5 18                                   clc
   2469 84C6 A5 A0                                lda addra             ;starting address
   2470 84C8 69 FF                    +            adc #<n_mbytes
   2470 84CA 00                       +            .byte >n_mbytes
                                        ;default bytes
   2471 84CB 85 A7                                sta faca              ;effective ending address
   2472 84CD E2 20                    +            .byte $e2,$20
                                        
   2473 84CF A5 A2                                lda addra+s_word      ;starting bank
   2474 84D1 69 00                                adc #0
   2475 84D3 85 A9                                sta faca+s_word       ;effective ending bank
   2476 84D5 B0 27                                bcs .0000050          ;end address > $FFFFFF
                                        ;
   2478 84D7 20 CF 8A                   .0000020 jsr facasize          ;check ending address...
   2479 84DA C9 04                                cmp #s_dword          ;range
   2480 84DC B0 20                                bcs .0000050          ;out of range — error
                                        ;
   2482 84DE 20 BB 8A                             jsr facaddrb          ;copy ending address
   2483 84E1 20 E3 8A                             jsr getparm           ;check for excess input
   2484 84E4 90 18                                bcc .0000050          ;error
                                        ;
   2486 84E6 20 09 8A                             jsr calccnt           ;calculate bytes to dump
   2487 84E9 90 13                                bcc .0000050          ;end < start
                                        ;
   2489 84EB 20 B3 8C                   .0000030 jsr teststop          ;test for display stop
   2490 84EE B0 0B                                bcs .0000040          ;stopped
                                        ;
   2492 84F0 20 05 88                             jsr newline           ;next line
   2493 84F3 20 77 87                             jsr dpymem            ;display
   2494 84F6 20 67 8A                             jsr decdcnt           ;decrement byte count
   2495 84F9 90 F0                                bcc .0000030          ;not done
                                        ;
   2497 84FB 4C 26 81                   .0000040 jmp monce             ;back to main loop
                                        ;
   2499 84FE 4C 65 81                   .0000050 jmp monerr            ;address range error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monfil: FILL MEMORY
                                        ;
                                        ;	—————————————————————————————————————————
                                        ;	syntax: F <start> <end> <fill>
                                        ;
                                        ;	<start> & <end> must be in the same bank.
                                        ;	—————————————————————————————————————————
                                        ;
   2511 8501 B0 5E                      monfil   bcs .0000010          ;start not given — quit
                                        ;
   2513 8503 20 CF 8A                             jsr facasize          ;check size
   2514 8506 C9 04                                cmp #s_dword
   2515 8508 B0 5A                                bcs .0000020          ;out of range — error...
                                        ;
   2517 850A 20 B1 8A                             jsr facaddra          ;store start
   2518 850D 20 E3 8A                             jsr getparm           ;evaluate end
   2519 8510 B0 52                                bcs .0000020          ;not entered — error
                                        ;
   2521 8512 20 CF 8A                             jsr facasize          ;check size
   2522 8515 C9 04                                cmp #s_dword
   2523 8517 B0 4B                                bcs .0000020          ;out of range — error
                                        ;
   2525 8519 A5 A9                                lda faca+s_word       ;end bank
   2526 851B C5 A2                                cmp addra+s_word      ;start bank
   2527 851D D0 45                                bne .0000020          ;not same — error
                                        ;
   2529 851F 20 BB 8A                             jsr facaddrb          ;store <end>
   2530 8522 C2 20                    +            .byte $c2,$20
                                        
   2531 8524 38                                   sec
   2532 8525 A5 A4                                lda addrb             ;ending address
   2533 8527 E5 A0                                sbc addra             ;starting address
   2534 8529 90 39                                bcc .0000020          ;start > end — error
                                        ;
   2536 852B 85 AF                                sta facb              ;bytes to copy
   2537 852D E2 20                    +            .byte $e2,$20
                                        
   2538 852F 20 E3 8A                             jsr getparm           ;evaluate <fill>
   2539 8532 B0 30                                bcs .0000020          ;not entered — error
                                        ;
   2541 8534 20 CF 8A                             jsr facasize          ;<fill> should be...
   2542 8537 C9 02                                cmp #s_word           ;8 bits
   2543 8539 B0 29                                bcs .0000020          ;it isn't — error
                                        ;
   2545 853B 20 C5 8A                             jsr facaoper          ;store <fill>
   2546 853E 20 E3 8A                             jsr getparm           ;should be no more parameters
   2547 8541 90 21                                bcc .0000020          ;there are — error
                                        ;
   2549 8543 A5 BB                                lda operand           ;<fill>
   2550 8545 87 A0                    +            .byte $87,addra
                                        ;fill 1st location
   2551 8547 C2 30                    +            .byte $c2,$30
                                                         ;16 bit operations
   2552 8549 A5 AF                                lda facb              ;
   2553 854B F0 14                                beq .0000010          ;only 1 location — finished
                                        ;
   2555 854D 3A                                   dea                   ;zero align &...
   2556 854E 48                                   pha                   ;protect
   2557 854F E2 20                    +            .byte $e2,$20
                                        
   2558 8551 A5 A2                                lda addra+s_word      ;start bank
   2559 8553 EB                       +            .byte $eb
                                        
   2560 8554 A5 A6                                lda addrb+s_word      ;end bank
   2561 8556 20 2A 8A                             jsr cpfwsup           ;do forward copy setup
   2562 8559 68                                   pla                   ;recover fill count
   2563 855A A6 A0                                ldx addra             ;fill-from starting location
   2564 855C 9B                       +            .byte $9b
                                        
   2565 855D C8                                   iny                   ;fill-to starting location
   2566 855E 4C D2 00                             jmp mcftwork          ;fill memory
                                        ;
   2568 8561 4C 26 81                   .0000010 jmp monce             ;goto command executive
                                        ;
   2570 8564 4C 65 81                   .0000020 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monhnt: SEARCH (hunt) MEMORY
                                        ;
                                        ;	———————————————————————————————————
                                        ;	syntax: H <addr1> <addr2> <pattern>
                                        ;	———————————————————————————————————
                                        ;
   2580 8567 B0 40                      monhnt   bcs .0000050          ;no start address
                                        ;
   2582 8569 20 CF 8A                             jsr facasize          ;size starting address
   2583 856C C9 04                                cmp #s_dword
   2584 856E B0 3C                                bcs .0000060          ;address out of range — error
                                        ;
   2586 8570 20 B1 8A                             jsr facaddra          ;store starting address
   2587 8573 20 E3 8A                             jsr getparm           ;evaluate ending address
   2588 8576 B0 34                                bcs .0000060          ;no address — error
                                        ;
   2590 8578 20 CF 8A                             jsr facasize          ;size ending address
   2591 857B C9 04                                cmp #s_dword
   2592 857D B0 2D                                bcs .0000060          ;address out of range — error
                                        ;
   2594 857F 20 BB 8A                             jsr facaddrb          ;store ending address
   2595 8582 20 09 8A                             jsr calccnt           ;calculate byte range
   2596 8585 90 25                                bcc .0000060          ;end < start
                                        ;
   2598 8587 20 E4 8B                             jsr getpat            ;evaluate search pattern
   2599 858A B0 20                                bcs .0000060          ;error
                                        ;
   2601 858C 64 CC                                stz xrtemp            ;clear column counter
                                        ;
   2603 858E 20 B3 8C                   .0000010 jsr teststop          ;check for stop
   2604 8591 B0 16                                bcs .0000050          ;abort
                                        ;
   2606 8593 A4 BE                                ldy auxbufix          ;pattern index
                                        ;
   2608 8595 88                         .0000020 dey
   2609 8596 30 09                                bmi .0000030          ;pattern match
                                        ;
   2611 8598 B7 A0                    +            .byte $b7,addra
                                        ;get from memory
   2612 859A D9 51 02                             cmp auxbuf,y          ;test against pattern
   2613 859D D0 05                                bne .0000040          ;mismatch, next location
                                        ;
   2615 859F F0 F4                                beq .0000020          ;match, keep testing
                                        ;
   2617 85A1 20 3F 86                   .0000030 jsr dpycaddr          ;display current location
                                        ;
   2619 85A4 20 0B 8B                   .0000040 jsr nxtaddra          ;next location
   2620 85A7 90 E5                                bcc .0000010          ;not done
                                        ;
   2622 85A9 4C 26 81                   .0000050 jmp monce             ;back to executive
                                        ;
   2624 85AC 4C 65 81                   .0000060 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monenv: CONVERT NUMERIC VALUE
                                        ;
                                        ;	——————————————————————
                                        ;	syntax: <radix><value>
                                        ;	——————————————————————
                                        ;
   2634 85AF 20 E1 8A                   monenv   jsr getparmr          ;reread & evaluate parameter
   2635 85B2 B0 26                                bcs .0000020          ;none entered
                                        ;
   2637 85B4 A2 00                                ldx #0                ;radix index
   2638 85B6 A0 04                                ldy #n_radix          ;number of radices
                                        ;
   2640 85B8 5A                         .0000010 phy                   ;save counter
   2641 85B9 DA                                   phx                   ;save radix index
   2642 85BA 20 05 88                             jsr newline           ;next line &...
   2643 85BD 20 6D 87                             jsr clearlin          ;clear it
   2644 85C0 A9 20                                lda #a_blank
   2645 85C2 A2 04                                ldx #halftab
   2646 85C4 20 F6 87                             jsr multspc           ;indent 1/2 tab
   2647 85C7 FA                                   plx                   ;get radix index but...
   2648 85C8 DA                                   phx                   ;put it back
   2649 85C9 BD F6 8C                             lda radxtab,x         ;get radix
   2650 85CC 20 F6 88                             jsr binasc            ;convert to ASCII
   2651 85CF 5A                                   phy                   ;string address MSB
   2652 85D0 DA                                   phx                   ;string address LSB
   2653 85D1 20 1D 88                             jsr sprint            ;print
   2654 85D4 FA                                   plx                   ;get index again
   2655 85D5 7A                                   ply                   ;get counter
   2656 85D6 E8                                   inx
   2657 85D7 88                                   dey
   2658 85D8 D0 DE                                bne .0000010          ;no
                                        
   2660 85DA 4C 26 81                   .0000020 jmp monce             ;back to command exec
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monchr: CHANGE REGISTERS
                                        ;
                                        ;	——————————————————————————————————————————————————————
                                        ;	syntax: ; [PB [PC [.S [.C [.X [.Y [SP [DP [DB]]]]]]]]]
                                        ;
                                        ;	; with no parameters is the same as the R command.
                                        ;	——————————————————————————————————————————————————————
                                        ;
   2672 85DD B0 33                      monchr   bcs .0000040          ;dump registers & quit
                                        ;
   2674 85DF A0 00                                ldy #0                ;register counter
   2675 85E1 84 B5                                sty facc              ;initialize register index
                                        ;
   2677 85E3 20 CF 8A                   .0000010 jsr facasize          ;get parameter size
   2678 85E6 D9 FA 8C                             cmp rcvltab,y         ;check against size table
   2679 85E9 B0 2A                                bcs .0000050          ;out of range
                                        ;
   2681 85EB B9 FA 8C                             lda rcvltab,y         ;determine number of bytes...
   2682 85EE C9 03                                cmp #s_word+1         ;to store
   2683 85F0 66 B6                                ror facc+s_byte       ;condition flag
   2684 85F2 10 02                                bpl .0000020          ;8 bit register size
                                        ;
   2686 85F4 C2 20                    +            .byte $c2,$20
                                                         ;16 bit register size
                                        ;
   2688 85F6 A6 B5                      .0000020 ldx facc              ;get register index
   2689 85F8 A5 A7                                lda faca              ;get parm
   2690 85FA 95 88                                sta reg_pbx,x         ;put in shadow storage
   2691 85FC E2 20                    +            .byte $e2,$20
                                        
   2692 85FE 06 B6                                asl facc+s_byte       ;mode flag to carry
   2693 8600 8A                                   txa                   ;register index
   2694 8601 69 01                                adc #s_byte           ;at least 1 byte stored
   2695 8603 85 B5                                sta facc              ;save new index
   2696 8605 20 E3 8A                             jsr getparm           ;get a parameter
   2697 8608 B0 08                                bcs .0000040          ;EOI
                                        ;
   2699 860A C8                                   iny                   ;bump register count
   2700 860B C0 09                                cpy #n_regchv         ;all registers processed?
   2701 860D D0 D4                                bne .0000010          ;no, keep going
                                        ;
   2703 860F 20 11 88                   .0000030 jsr alert             ;excessive input
                                        ;
   2705 8612 4C 7F 80                   .0000040 jmp monreg            ;display changes
                                        ;
   2707 8615 4C 65 81                   .0000050 jmp monerr            ;goto error handler
                                        ;
                                        ;================================================================================
                                        ;
                                        ;monxit: EXIT TO OPERATING ENVIRONMENT
                                        ;
                                        ;	—————————
                                        ;	syntax: X
                                        ;	—————————
                                        ;
   2717 8618 90 22                      monxit   bcc .0000020          ;no parameters allowed
                                        ;
   2719 861A C2 20                    +            .byte $c2,$20
                                        
   2720 861C AD 02 01                             lda vecbrki           ;BRK indirect vector
   2721 861F C9 42                    +            cmp #<monbrk
   2721 8621 80                       +            .byte >monbrk
                                        ;we intercept it?
   2722 8622 D0 09                                bne .0000010          ;no, don't change it
                                        ;
   2724 8624 AD 05 01                             lda vecbrkia          ;old vector
   2725 8627 8D 02 01                             sta vecbrki           ;restore it
   2726 862A 9C 05 01                             stz vecbrkia          ;invalidate old vector
                                        ;         
   2728 862D E2 30                      .0000010 +         .byte $e2,$30
                                        
                                           		 CPU FT832
   2730 00862F 64 CE                        		 STZ	$CE
   2731 008631 64 CF                        		 STZ	$CF
   2732 008633 42 CB 42 A2 00 00            		 TSK	JMP:#0
   2733 008639 4C 00 C0                     		 JMP	$C000
                                        		 CPU	W65C02
                                        ;         jml vecexit           ;long jump to exit
                                        ;
   2737 863C 4C 65 81                   .0000020 jmp monerr            ;goto error handler
                                        ;
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * *                                         * *
                                        ; * * S T A R T   o f   S U B R O U T I N E S * *
                                        ; * *                                         * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ; * * * * * * * * * * * * * * * * * * * * * * * *
                                        ;
                                        ;dpycaddr: DISPLAY CURRENT ADDRESS IN COLUMNS
                                        ;
   2749 863F A6 CC                      dpycaddr ldx xrtemp            ;column count
   2750 8641 D0 05                                bne .0000010          ;not at right side
                                        ;
   2752 8643 20 05 88                             jsr newline           ;next row
   2753 8646 A2 08                                ldx #n_hccols         ;max columns
                                        ;
   2755 8648 E0 08                      .0000010 cpx #n_hccols         ;max columns
   2756 864A F0 07                                beq .0000020          ;at left margin
                                        ;
   2758 864C A9 09                                lda #a_ht
                                           		 cpu FT832
   2760 00864E 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        ;
   2763 8653 CA                         .0000020 dex                   ;one less column
   2764 8654 86 CC                                stx xrtemp            ;save column counter
   2765 8656 4C CA 87                             jmp prntladr          ;print reference address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpycod: DISASSEMBLE & DISPLAY CODE
                                        ;
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;	This function disassembles & displays the machine code at  the  location
                                        ;	pointed to by ADDRA.  Upon return, ADDRA will point to the opcode of the
                                        ;	next instruction.   The entry point at DPYCODAA  should be called with a
                                        ;	disassembly prefix character loaded in .A.   If entered  at  DPYCOD, the
                                        ;	default character will be display at the beginning of each  disassembled
                                        ;	instruction.
                                        ;
                                        ;	The disassembly of immediate mode instructions that can take an 8 or  16
                                        ;	bit operand is affected by the bit pattern that is  stored  in  FLIMFLAG
                                        ;	upon entry to this function:
                                        ;
                                        ;	    FLIMFLAG: xx000000
                                        ;	              ||
                                        ;	              |+—————————> 0:  8 bit .X or .Y operand
                                        ;	              |            1: 16 bit .X or .Y operand
                                        ;	              +——————————> 0:  8 bit .A or BIT # operand
                                        ;	                           1: 16 bit .A or BIT # operand
                                        ;
                                        ;	FLIMFLAG is conditioned according to the operand of  the  most  recently
                                        ;	disassembled REP or SEP instruction.   Hence repetitive  calls  to  this
                                        ;	subroutine will usually result in the correct disassembly of 16 bit imm-
                                        ;	ediate mode instructions.
                                        ;	————————————————————————————————————————————————————————————————————————
                                        ;
   2796 8659 A9 2E                       public dpycod   lda #disprfx          ;default prefix
                                        ;
                                        ;
                                        ;	alternate prefix display entry point...
                                        ;
   2801 865B                            dpycodaa 
                                           		 cpu FT832
   2803 00865B 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2805 8660 20 15 88                             jsr printspc          ;space
   2806 8663 20 CA 87                             jsr prntladr          ;print long address
   2807 8666 20 15 88                             jsr printspc          ;space to opcode field
   2808 8669 20 DD 8A                             jsr getbyte           ;get opcode
   2809 866C 85 CA                                sta opcode            ;save &...
   2810 866E 20 0A 88                             jsr printbyt          ;display as hex
                                        ;
                                        ;
                                        ;	decode menmonic & addressing info...
                                        ;
   2815 8671 A6 CA                                ldx opcode            ;current mnemonic
   2816 8673 BD BB 8D                             lda mnetabix,x        ;get mnemonic index
   2817 8676 0A                                   asl                   ;double for...
   2818 8677 A8                                   tay                   ;mnemonic table offset
   2819 8678 C2 20                    +            .byte $c2,$20
                                                         ;16 bit load
   2820 867A B9 03 8D                             lda mnetab,y          ;copy encoded mnemonic to...
   2821 867D 85 C8                                sta mnepck            ;working storage
   2822 867F E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   2823 8681 20 3F 8B                             jsr instdata          ;extract mode & size data
   2824 8684 85 D1                                sta vopsflag          ;save mode flags
   2825 8686 84 C3                                sty admodidx          ;save mode index
   2826 8688 0A                                   asl                   ;variable immediate instruction?
   2827 8689 90 1F                                bcc dpycod01          ;no, effective operand size in .X
                                        ;
                                        ;
                                        ;	determine immediate mode operand size...
                                        ;
   2832 868B A5 CA                                lda opcode            ;current opcode
   2833 868D 24 CE                                bit flimflag          ;operand display mode
   2834 868F 10 08                                bpl .0000010          ;8 bit .A & BIT immediate mode
                                        ;
   2836 8691 29 1F                                and #aimmaska         ;determine if...
   2837 8693 C9 09                                cmp #aimmaskb         ;.A or BIT immediate
   2838 8695 F0 10                                beq .0000030          ;display 16 bit operand
                                        ;
   2840 8697 A5 CA                                lda opcode            ;not .A or BIT immediate
                                        ;
   2842 8699 50 0F                      .0000010 bvc dpycod01          ;8 bit .X/.Y immediate mode
                                        ;
   2844 869B A0 03                                ldy #n_vopidx-1       ;opcodes to test
                                        ;
   2846 869D D9 BB 8F                   .0000020 cmp vopidx,y          ;looking for LDX #, CPY #, etc.
   2847 86A0 F0 07                                beq .0000040          ;disassemble a 16 bit operand
                                        ;
   2849 86A2 88                                   dey
   2850 86A3 10 F8                                bpl .0000020          ;keep trying
                                        ;
   2852 86A5 80 03                                bra dpycod01          ;not .X or .Y immediate
                                        ;
   2854 86A7 A5 CA                      .0000030 lda opcode            ;reload
                                        ;
   2856 86A9 E8                         .0000040 inx                   ;16 bit operand
                                        ;
                                        ;
                                        ;	get & display operand bytes...
                                        ;
   2861 86AA 86 CF                      dpycod01 stx iopsize           ;operand size...
   2862 86AC E8                                   inx                   ;plus opcode becomes...
   2863 86AD 86 C6                                stx instsize          ;instruction size
   2864 86AF 86 C4                                stx charcnt           ;total bytes to process
   2865 86B1 A9 0B                                lda #n_opcols+2       ;total operand columns plus WS
   2866 86B3 85 CC                                sta xrtemp            ;initialize counter
   2867 86B5 20 1E 8A                             jsr clroper           ;clear operand
   2868 86B8 A4 CF                                ldy iopsize           ;operand size
   2869 86BA F0 16                                beq .0000020          ;no operand
                                        ;
   2871 86BC A2 00                                ldx #0                ;operand index
                                        ;
   2873 86BE 20 DD 8A                   .0000010 jsr getbyte           ;get operand byte
   2874 86C1 95 BB                                sta operand,x         ;save
   2875 86C3 DA                                   phx                   ;protect operand index
   2876 86C4 20 0A 88                             jsr printbyt          ;print operand byte
   2877 86C7 C6 CC                                dec xrtemp            ;3 columns used, 2 for...
   2878 86C9 C6 CC                                dec xrtemp            ;operand nybbles &...
   2879 86CB C6 CC                                dec xrtemp            ;1 for whitespace
   2880 86CD FA                                   plx                   ;get operand index
   2881 86CE E8                                   inx                   ;bump it
   2882 86CF 88                                   dey
   2883 86D0 D0 EC                                bne .0000010          ;next
                                        ;
   2885 86D2 A6 CC                      .0000020 ldx xrtemp            ;operand columns remaining
   2886 86D4 20 F6 87                             jsr multspc           ;space to mnemonic field
                                        ;
                                        ;
                                        ;	display mnemonic...
                                        ;
   2891 86D7 A0 03                                ldy #s_mnemon         ;size of ASCII mnemonic
                                        ;
   2893 86D9 A9 00                      .0000030 lda #0                ;initialize char
   2894 86DB A2 05                                ldx #n_shfenc         ;shifts to execute
                                        ;
   2896 86DD 06 C8                      .0000040 asl mnepck            ;shift encoded mnemonic
   2897 86DF 26 C9                                rol mnepck+s_byte
   2898 86E1 2A                                   rol
   2899 86E2 CA                                   dex
   2900 86E3 D0 F8                                bne .0000040
                                        ;
   2902 86E5 69 3F                                adc #a_mnecvt         ;convert to ASCII &...
   2903 86E7 48                                   pha                   ;stash
   2904 86E8 88                                   dey
   2905 86E9 D0 EE                                bne .0000030          ;continue with mnemonic
                                        ;
   2907 86EB A0 03                                ldy #s_mnemon
                                        ;
   2909 86ED 68                         .0000050 pla                   ;get mnenmonic byte
                                           		 cpu FT832
   2911 0086EE 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2913 86F3 88                                   dey
   2914 86F4 D0 F7                                bne .0000050
                                        ;
                                        ;
                                        ;	display operand...
                                        ;
   2919 86F6 A5 CF                                lda iopsize           ;operand size
   2920 86F8 F0 73                                beq clearlin          ;zero, disassembly finished
                                        ;
   2922 86FA 20 15 88                             jsr printspc          ;space to operand field
   2923 86FD 24 D1                                bit vopsflag          ;check mode flags
   2924 86FF 50 08                                bvc dpycod02          ;not a branch
                                        ;
   2926 8701 20 55 8B                             jsr offtarg           ;compute branch target
   2927 8704 A6 C6                                ldx instsize          ;effective instruction size
   2928 8706 CA                                   dex
   2929 8707 86 CF                                stx iopsize           ;effective operand size
                                        ;
   2931 8709 64 D1                      dpycod02 stz vopsflag          ;clear
   2932 870B A5 C3                                lda admodidx          ;instruction addressing mode
   2933 870D C9 0B                                cmp #am_move          ;block move instruction?
   2934 870F D0 02                                bne .0000010          ;no
                                        ;
   2936 8711 66 D1                                ror vopsflag          ;yes
                                        ;
   2938 8713 0A                         .0000010 asl                   ;convert addressing mode to...
   2939 8714 AA                                   tax                   ;symbology table index
   2940 8715 C2 20                    +            .byte $c2,$20
                                                         ;do a 16 bit load
   2941 8717 BD BF 8F                             lda ms_lutab,x        ;addressing symbol pointer
   2942 871A 48                                   pha
   2943 871B E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bit loads
   2944 871D A0 00                                ldy #0
   2945 871F B3 01                    +            .byte $b3,1
                                        ;get 1st char
   2946 8721 C9 20                                cmp #a_blank
   2947 8723 F0 05                                beq .0000020          ;no addresing mode preamble
                                        ;
                                           		 cpu FT832
   2950 008725 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
                                        ;
   2953 872A A9 24                      .0000020 lda #c_hex
                                           		 cpu FT832
   2955 00872C 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   2957 8731 A4 CF                                ldy iopsize           ;operand size = index
                                        ;
   2959 8733 88                         .0000030 dey
   2960 8734 30 16                                bmi .0000040          ;done with operand
                                        ;
   2962 8736 B9 BB 00                             lda operand,y         ;get operand byte
   2963 8739 20 E7 87                             jsr dpyhex            ;print operand byte
   2964 873C 24 D1                                bit vopsflag          ;block move?
   2965 873E 10 F3                                bpl .0000030          ;no
                                        ;
   2967 8740 64 D1                                stz vopsflag          ;reset
   2968 8742 5A                                   phy                   ;protect operand index
   2969 8743 F4                       +            .byte $f4
   2969 8744 F8 8F                    +            .word ms_move
                                        
   2970 8746 20 1D 88                             jsr sprint            ;display MVN/MVP operand separator
   2971 8749 7A                                   ply                   ;recover operand index again
   2972 874A 80 E7                                bra .0000030          ;continue
                                        ;
   2974 874C FA                         .0000040 plx                   ;symbology LSB
   2975 874D 7A                                   ply                   ;symbology MSB
   2976 874E E8                                   inx                   ;move past preamble
   2977 874F D0 01                                bne .0000050
                                        ;
   2979 8751 C8                                   iny
                                        ;
   2981 8752 5A                         .0000050 phy
   2982 8753 DA                                   phx
   2983 8754 20 1D 88                             jsr sprint            ;print postamble, if any
                                        ;
                                        ;
                                        ;	condition immediate mode display format...
                                        ;
   2988 8757 A5 BB                      dpycod03 lda operand           ;operand LSB
   2989 8759 29 30                                and #pfmxmask         ;isolate M & X bits
   2990 875B 0A                                   asl                   ;shift to match...
   2991 875C 0A                                   asl                   ;FLIMFLAG alignment
   2992 875D A6 CA                                ldx opcode            ;current instruction
   2993 875F E0 C2                                cpx #opc_rep          ;was it REP?
   2994 8761 D0 04                                bne .0000010          ;no
                                        ;
   2996 8763 04 CE                                tsb flimflag          ;set flag bits as required
   2997 8765 80 06                                bra clearlin
                                        ;
   2999 8767 E0 E2                      .0000010 cpx #opc_sep          ;was it SEP?
   3000 8769 D0 02                                bne clearlin          ;no, just exit
                                        ;
   3002 876B 14 CE                                trb flimflag          ;clear flag bits as required
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clearlin: CLEAR DISPLAY LINE
                                        ;
   3008 876D F4                         clearlin +         .byte $f4
   3008 876E 15 90                    +            .word dc_cl
                                        
   3009 8770 80 4F                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyibuf: DISPLAY MONITOR INPUT BUFFER CONTENTS
                                        ;
   3015 8772 F4                         dpyibuf +         .byte $f4
   3015 8773 00 02                    +            .word ibuffer
                                        
   3016 8775 80 4A                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpymem: DISPLAY MEMORY
                                        ;
                                        ;	————————————————————————————————————————————————————————————
                                        ;	This function displays 16 bytes of memory as hex values & as
                                        ;	ASCII equivalents.  The starting address for the display is
                                        ;	in ADDRA & is expected to be a 24 bit address.  Upon return,
                                        ;	ADDRA will point to the start of the next 16 bytes.
                                        ;	————————————————————————————————————————————————————————————
                                        ;
   3029 8777 E2 30                      dpymem +         .byte $e2,$30
                                        
   3030 8779 64 C4                                stz charcnt           ;reset
   3031 877B A9 3E                                lda #memprfx
                                           		 cpu FT832
   3033 00877D 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3035 8782 20 CA 87                             jsr prntladr          ;print 24 bit address
   3036 8785 A2 00                                ldx #0                ;string buffer index
   3037 8787 A0 08                                ldy #n_dump           ;bytes per line
                                        ;
   3039 8789 20 DD 8A                   .0000010 jsr getbyte           ;get from RAM, also...
   3040 878C 48                                   pha                   ;save for decoding
   3041 878D DA                                   phx                   ;save string index
   3042 878E 20 0A 88                             jsr printbyt          ;display as hex ASCII
   3043 8791 E6 C4                                inc charcnt           ;bytes displayed +1
   3044 8793 FA                                   plx                   ;recover string index &...
   3045 8794 68                                   pla                   ;byte
   3046 8795 C9 20                                cmp #a_blank          ;printable?
   3047 8797 90 04                                bcc .0000020          ;no
                                        ;
   3049 8799 C9 7F                                cmp #a_del
   3050 879B 90 02                                bcc .0000030          ;is printable
                                        ;
   3052 879D A9 2E                      .0000020 lda #memsubch         ;substitute character
                                        ;
   3054 879F 9D 00 02                   .0000030 sta ibuffer,x         ;save char
   3055 87A2 E8                                   inx                   ;bump index
   3056 87A3 88                                   dey                   ;byte count -= 1
   3057 87A4 D0 E3                                bne .0000010          ;not done
                                        ;
   3059 87A6 9E 00 02                             stz ibuffer,x         ;terminate ASCII string
   3060 87A9 A9 3A                                lda #memsepch
                                           		 cpu FT832
   3062 0087AB 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3064 87B0 F4                       +            .byte $f4
   3064 87B1 0B 90                    +            .word dc_bf
                                        
   3065 87B3 20 1D 88                             jsr sprint            ;select reverse video
   3066 87B6 20 72 87                             jsr dpyibuf           ;display ASCII equivalents
   3067 87B9 F4                       +            .byte $f4
   3067 87BA 20 90                    +            .word dc_er
                                        ;normal video
   3068 87BC 80 03                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyerr: DISPLAY ERROR SIGNAL
                                        ;
   3074 87BE F4                         dpyerr +         .byte $f4
   3074 87BF 4D 90                    +            .word mm_err
                                        ;"*ERR"
                                        ;
   3076 87C1 20 1D 88                   dpyerraa jsr sprint
   3077 87C4 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;gendbs: GENERATE DESTRUCTIVE BACKSPACE
                                        ;
   3083 87C5 F4                         gendbs +         .byte $f4
   3083 87C6 11 90                    +            .word dc_bs
                                        ;destructive backspace
   3084 87C8 80 F7                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;prntladr: PRINT 24 BIT CURRENT ADDRESS
                                        ;
   3090 87CA 08                         prntladr php                   ;protect register sizes
   3091 87CB E2 20                    +            .byte $e2,$20
                                        
   3092 87CD A5 A2                                lda addra+s_word      ;get bank byte &...
   3093 87CF 20 E7 87                             jsr dpyhex            ;display it
   3094 87D2 C2 20                    +            .byte $c2,$20
                                        
   3095 87D4 A5 A0                                lda addra             ;get 16 bit address
   3096 87D6 28                                   plp                   ;restore register sizes
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyhexw: DISPLAY BINARY WORD AS HEX ASCII
                                        ;
                                        ;	————————————————————————————————————
                                        ;	Preparatory Ops: .C: word to display
                                        ;
                                        ;	Returned Values: .C: used
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————
                                        ;
   3110 87D7 08                         dpyhexw  php                   ;save register sizes
   3111 87D8 C2 20                    +            .byte $c2,$20
                                        
   3112 87DA 48                                   pha                   ;protect value
   3113 87DB E2 20                    +            .byte $e2,$20
                                        
   3114 87DD EB                       +            .byte $eb
                                                           ;get MSB &...
   3115 87DE 20 E7 87                             jsr dpyhex            ;display
   3116 87E1 C2 20                    +            .byte $c2,$20
                                        
   3117 87E3 68                                   pla                   ;recover value
   3118 87E4 E2 20                    +            .byte $e2,$20
                                                        ;only LSB visible
   3119 87E6 28                                   plp                   ;reset register sizes
                                        ;
                                        ;================================================================================
                                        ;
                                        ;dpyhex: DISPLAY BINARY BYTE AS HEX ASCII
                                        ;
                                        ;	————————————————————————————————————
                                        ;	Preparatory Ops: .A: byte to display
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————
                                        ;
   3133 87E7 20 8A 89                   dpyhex   jsr binhex            ;convert to hex ASCII
                                           		 cpu FT832
   3135 0087EA 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3137 87EF 8A                                   txa
                                           		 cpu FT832
   3139 0087F0 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3141 87F5 60                          		 rts
                                                 ;jmp putcha            ;print LSN
                                        ;
                                        ;================================================================================
                                        ;
                                        ;multspc: PRINT MULTIPLE BLANKS
                                        ;
                                        ;	————————————————————————————————————————————————
                                        ;	Preparatory Ops : .X: number of blanks to print
                                        ;
                                        ;	Register Returns: none
                                        ;
                                        ;	Calling Example : ldx #3
                                        ;	                  jsr multspc    ;print 3 spaces
                                        ;
                                        ;	Notes: This sub will print 1 blank if .X=0.
                                        ;	————————————————————————————————————————————————
                                        ;
   3159 87F6 8A                         multspc  txa
   3160 87F7 D0 01                                bne .0000010          ;blank count specified
                                        ;
   3162 87F9 E8                                   inx                   ;default to 1 blank
                                        ;
   3164 87FA A9 20                      .0000010 lda #a_blank
                                        ;
   3166 87FC                            .0000020 
                                           		 cpu FT832
   3168 0087FC 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3170 8801 CA                                   dex
   3171 8802 D0 F8                                bne .0000020
                                        ;
   3173 8804 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;newline: PRINT NEWLINE (CRLF)
                                        ;
   3179 8805 F4                         newline +         .byte $f4
   3179 8806 26 90                    +            .word dc_lf
                                        
   3180 8808 80 B7                                bra dpyerraa
                                        ;
                                        ;================================================================================
                                        ;
                                        ;printbyt: PRINT A BYTE WITH LEADING SPACE
                                        ;
   3186 880A 48                         printbyt pha                   ;protect byte
   3187 880B 20 15 88                             jsr printspc          ;print leading space
   3188 880E 68                                   pla                   ;restore &...
   3189 880F 80 D6                                bra dpyhex            ;print byte
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;alert: ALERT USER w/TERMINAL BELL
                                        ;
   3195 8811 A9 07                      alert    lda #a_bel
   3196 8813 80 02                                bra printcmn
                                        ;
                                        ;================================================================================
                                        ;
                                        ;printspc: PRINT A SPACE
                                        ;
   3202 8815 A9 20                      printspc lda #a_blank
                                        ;
   3204 8817                            printcmn 
                                           		 cpu FT832
   3206 008817 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3208 881C 60                          		 rts
                                        ;jmp putcha
                                        ;
                                        ;================================================================================
                                        ;
                                        ;sprint: PRINT NULL-TERMINATED CHARACTER STRING
                                        ;
                                        ;	—————————————————————————————————————————————————————————
                                        ;	Preparatory Ops : SP+1: string address LSB
                                        ;	                  SP+2: string address MSB
                                        ;
                                        ;	Register Returns: .A: used
                                        ;	                  .B: entry value
                                        ;	                  .X: used
                                        ;	                  .Y: used
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> 0: okay
                                        ;	           |||||||      1: string too long (1)
                                        ;	           ||||+++————> not defined
                                        ;	           |||+———————> 1
                                        ;	           ||+————————> 1
                                        ;	           ++—————————> not defined
                                        ;
                                        ;	Example: PER STRING
                                        ;	         JSR SPRINT
                                        ;	         BCS TOOLONG
                                        ;
                                        ;	Notes: 1) Maximum permissible string length including the
                                        ;	          terminator is 32,767 bytes.
                                        ;	       2) All registers are forced to 8 bits.
                                        ;	       3) DO NOT JUMP OR BRANCH INTO THIS FUNCTION!
                                        ;	—————————————————————————————————————————————————————————
                                        ;
   3243 881D E2 20                      sprint +         .byte $e2,$20
                                                        ;8 bit accumulator
   3244 881F C2 10                    +            .byte $c2,$10
                                                         ;16 bit index
                                        ;
                                        ;—————————————————————————————————————————————————————————
   3396 = 0000000000000001                            .reetaddr =1                    ;return address
                                        
   3398 = 00000003                      .src     =.reetaddr+s_word      ;string address stack offset
                                        
                                        ;—————————————————————————————————————————————————————————
                                        ;
   3253 8821 A0 00                    +            ldy #<0
   3253 8823 00                       +            .byte >0
                                        
   3254 8824 18                                   clc                   ;no initial error
                                        ;
   3256 8825 B3 03                      .0000010 +         .byte $b3,.src
                                        ;get a byte
   3257 8827 F0 09                                beq .0000020          ;done
                                        ;
                                           		 cpu FT832
   3260 008829 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   3262 882E C8                                   iny
   3263 882F 10 F4                                bpl .0000010          ;next
                                        ;
   3265 8831 38                                   sec                   ;string too long
                                        ;
   3267 8832 FA                         .0000020 plx                   ;pull RTS address
   3268 8833 7A                                   ply                   ;clear string pointer
   3269 8834 DA                                   phx                   ;replace RTS
   3270 8835 E2 10                    +            .byte $e2,$10
                                        
   3271 8837 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ascbin: CONVERT NULL-TERMINATED ASCII NUMBER STRING TO BINARY
                                        ;
                                        ;	———————————————————————————————————————————————————
                                        ;	Preparatory Ops: ASCII number string in IBUFFER
                                        ;
                                        ;	Returned Values: FACA: converted parameter
                                        ;	                   .A: used
                                        ;	                   .X: used
                                        ;	                   .Y: used
                                        ;	                   .C: 1 = conversion error
                                        ;	                   .Z: 1 = nothing to convert
                                        ;
                                        ;	Notes: 1) Conversion stops when a non-numeric char-
                                        ;	          acter is encountered.
                                        ;	       2) Radix symbols are as follows:
                                        ;
                                        ;	          % binary
                                        ;	          @ octal
                                        ;	          + decimal
                                        ;	          $ hexadecimal
                                        ;
                                        ;	          Hex is the default if no radix is speci-
                                        ;	          fied in the 1st character of the string.
                                        ;	———————————————————————————————————————————————————
                                        ;
   3300 8838 E2 30                      ascbin +         .byte $e2,$30
                                        
   3301 883A 20 9D 89                             jsr clrfaca           ;clear accumulator
   3302 883D 64 C4                                stz charcnt           ;zero char count
   3303 883F 64 C2                                stz radix             ;initialize
                                        ;
                                        ;
                                        ;	process radix if present...
                                        ;
   3308 8841 20 30 8C                             jsr getcharw          ;get next non-WS char
   3309 8844 D0 02                                bne .0000010          ;got something
                                        ;
   3311 8846 18                                   clc                   ;no more input
   3312 8847 60                                   rts
                                        ;
   3314 8848 A2 03                      .0000010 ldx #n_radix-1        ;number of radices
                                        ;
   3316 884A DD F6 8C                   .0000020 cmp radxtab,x         ;recognized radix?
   3317 884D F0 06                                beq .0000030          ;yes
                                        ;
   3319 884F CA                                   dex
   3320 8850 10 F8                                bpl .0000020          ;try next
                                        ;
   3322 8852 C6 BF                                dec ibufidx           ;reposition to previous char
   3323 8854 E8                                   inx                   ;not recognized, assume hex
                                        ;
   3325 8855 C9 2B                      .0000030 cmp #c_dec            ;decimal radix?
   3326 8857 D0 02                                bne .0000040          ;not decimal
                                        ;
   3328 8859 66 C2                                ror radix             ;flag decimal conversion
                                        ;
   3330 885B BD E2 8C                   .0000040 lda basetab,x         ;number bases table
   3331 885E 85 D0                                sta range             ;set valid numeral range
   3332 8860 BD E6 8C                             lda bitsdtab,x        ;get bits per digit
   3333 8863 85 C0                                sta bitsdig           ;store
                                        ;
                                        ;
                                        ;	process numerals...
                                        ;
   3338 8865 20 D2 8B                   ascbin01 jsr getchar           ;get next char
   3339 8868 F0 70                                beq ascbin03          ;EOI
                                        ;
   3341 886A C9 20                                cmp #' '
   3342 886C F0 6C                                beq ascbin03          ;blank — EOF
                                        ;
   3344 886E C9 2C                                cmp #','
   3345 8870 F0 68                                beq ascbin03          ;comma — EOF
                                        ;
   3347 8872 C9 09                                cmp #a_ht
   3348 8874 F0 64                                beq ascbin03          ;tab — EOF
                                        ;
   3350 8876 20 F7 89                             jsr nybtobin          ;change to binary
   3351 8879 B0 60                                bcs ascbin04          ;not a recognized numeral
                                        ;
   3353 887B C5 D0                                cmp range             ;check range
   3354 887D B0 5C                                bcs ascbin04          ;not valid for base
                                        ;
   3356 887F 85 C1                                sta numeral           ;save processed numeral
   3357 8881 E6 C4                                inc charcnt           ;bump numeral count
   3358 8883 24 C2                                bit radix             ;working in base 10?
   3359 8885 10 15                                bpl .0000030          ;no
                                        ;
                                        ;
                                        ;	compute N*2 for decimal conversion...
                                        ;
   3364 8887 A2 00                                ldx #0                ;accumulator index
   3365 8889 A0 02                                ldy #s_pfac/2         ;iterations
   3366 888B C2 20                    +            .byte $c2,$20
                                        
   3367 888D 18                                   clc
                                        ;
   3369 888E B5 A7                      .0000020 lda faca,x            ;N
   3370 8890 2A                                   rol                   ;N=N*2
   3371 8891 95 AF                                sta facb,x
   3372 8893 E8                                   inx
   3373 8894 E8                                   inx
   3374 8895 88                                   dey
   3375 8896 D0 F6                                bne .0000020
                                        ;
   3377 8898 B0 41                                bcs ascbin04          ;overflow — error
                                        ;
   3379 889A E2 20                    +            .byte $e2,$20
                                        
                                        ;
                                        ;
                                        ;	compute N*base for binary, octal or hex...
                                        ;	or N*8 for decimal...
                                        ;
   3385 889C A6 C0                      .0000030 ldx bitsdig           ;bits per digit
   3386 889E C2 20                    +            .byte $c2,$20
                                                         ;16 bit shifts
                                        ;
   3388 88A0 06 A7                      .0000040 asl faca
   3389 88A2 26 A9                                rol faca+s_word
   3390 88A4 B0 35                                bcs ascbin04          ;overflow — error
                                        ;
   3392 88A6 CA                                   dex
   3393 88A7 D0 F7                                bne .0000040          ;next shift
                                        ;
   3395 88A9 E2 20                    +            .byte $e2,$20
                                                        ;back to 8 bits
   3396 88AB 24 C2                                bit radix             ;check base
   3397 88AD 10 13                                bpl ascbin02          ;not decimal
                                        ;
                                        ;
                                        ;	compute N*10 for decimal (N*8 + N*2)...
                                        ;
   3402 88AF A0 04                                ldy #s_pfac
   3403 88B1 C2 20                    +            .byte $c2,$20
                                        
                                        ;
   3405 88B3 B5 A7                      .0000050 lda faca,x            ;N*8
   3406 88B5 75 AF                                adc facb,x            ;N*2
   3407 88B7 95 A7                                sta faca,x            ;now N*10
   3408 88B9 E8                                   inx
   3409 88BA E8                                   inx
   3410 88BB 88                                   dey
   3411 88BC D0 F5                                bne .0000050
                                        ;
   3413 88BE B0 1B                                bcs ascbin04          ;overflow — error
                                        ;
   3415 88C0 E2 20                    +            .byte $e2,$20
                                        
                                        ;
                                        ;
                                        ;	add current numeral to partial result...
                                        ;
   3420 88C2 A5 A7                      ascbin02 lda faca              ;N
   3421 88C4 65 C1                                adc numeral           ;N=N+D
   3422 88C6 85 A7                                sta faca
   3423 88C8 A2 01                                ldx #1
   3424 88CA A0 03                                ldy #s_pfac-1
                                        ;
   3426 88CC B5 A7                      .0000010 lda faca,x
   3427 88CE 69 00                                adc #0                ;account for carry
   3428 88D0 95 A7                                sta faca,x
   3429 88D2 E8                                   inx
   3430 88D3 88                                   dey
   3431 88D4 D0 F6                                bne .0000010
                                        ;
   3433 88D6 90 8D                                bcc ascbin01          ;next if no overflow
                                        ;
   3435 88D8 B0 01                                bcs ascbin04          ;overflow — error
                                        ;
                                        ;
                                        ;	finish up...
                                        ;
   3440 88DA 18                         ascbin03 clc                   ;no error
                                        ;
   3442 88DB E2 20                      ascbin04 +         .byte $e2,$20
                                                        ;reset if necessary
   3443 88DD A5 C4                                lda charcnt           ;load char count
   3444 88DF 60                                   rts                   ;done
                                        ;
                                        ;================================================================================
                                        ;
                                        ;bcdasc: CONVERT BCD DIGIT TO ASCII
                                        ;
                                        ;	———————————————————————————————————————
                                        ;	Preparatory Ops: .A: BCD digit, $00-$99
                                        ;
                                        ;	Returned Values: .A: ASCII MSD
                                        ;	                 .X: ASCII LSD
                                        ;	                 .Y: entry value
                                        ;	———————————————————————————————————————
                                        ;
   3458 88E0 20 EC 88                   bcdasc   jsr bintonyb          ;extract nybbles
   3459 88E3 48                                   pha                   ;save tens
   3460 88E4 8A                                   txa                 
   3461 88E5 09 30                                ora #btoamask         ;change units to ASCII
   3462 88E7 AA                                   tax                   ;store
   3463 88E8 68                                   pla                   ;get tens
   3464 88E9 09 30                                ora #btoamask         ;change to ASCII
   3465 88EB 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;bintonyb: EXTRACT BINARY NYBBLES
                                        ;
                                        ;	—————————————————————————————————
                                        ;	Preparatory Ops: .A: binary value
                                        ;
                                        ;	Returned Values: .A: MSN
                                        ;	                 .X: LSN
                                        ;	                 .Y: entry value
                                        ;	—————————————————————————————————
                                        ;
   3479 88EC 48                         bintonyb pha                   ;save
   3480 88ED 29 0F                                and #bcdumask         ;extract LSN
   3481 88EF AA                                   tax                   ;save it
   3482 88F0 68                                   pla
                                        ;         .rept s_bnybbl        ;extract MSN
   3484 88F1 4A                                     lsr
   3485 88F2 4A                                     lsr
   3486 88F3 4A                                     lsr
   3487 88F4 4A                                     lsr
                                        ;         .endr
   3489 88F5 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;binasc: CONVERT 32-BIT BINARY TO NULL-TERMINATED ASCII NUMBER STRING
                                        ;
                                        ;	——————————————————————————————————————————————————————
                                        ;	Preparatory Ops: FACA: 32-bit operand
                                        ;	                   .A: radix character, w/bit 7 set to
                                        ;	                       suppress radix symbol in the
                                        ;	                       conversion string
                                        ;
                                        ;	Returned Values: ibuffer: conversion string
                                        ;	                      .A: string length
                                        ;	                      .X: string address LSB
                                        ;	                      .Y: string address MSB
                                        ;
                                        ;	Execution Notes: ibufidx & instsize are overwritten.
                                        ;	——————————————————————————————————————————————————————
                                        ;
   3509 88F6 64 BF                      binasc   stz ibufidx           ;initialize string index
   3510 88F8 64 C6                                stz instsize          ;clear format flag
                                        ;
                                        ;
                                        ;	evaluate radix...
                                        ;
   3515 88FA 0A                                   asl                   ;extract format flag &...
   3516 88FB 66 C6                                ror instsize          ;save it
   3517 88FD 4A                                   lsr                   ;extract radix character
   3518 88FE A2 03                                ldx #n_radix-1        ;total radices
                                        ;
   3520 8900 DD F6 8C                   .0000010 cmp radxtab,x         ;recognized radix?
   3521 8903 F0 04                                beq .0000020          ;yes
                                        ;
   3523 8905 CA                                   dex
   3524 8906 10 F8                                bpl .0000010          ;try next
                                        ;
   3526 8908 E8                                   inx                   ;assume hex
                                        ;
   3528 8909 86 C2                      .0000020 stx radix             ;save radix index for later
   3529 890B 24 C6                                bit instsize
   3530 890D 30 08                                bmi .0000030          ;no radix symbol wanted
                                        ;
   3532 890F BD F6 8C                             lda radxtab,x         ;radix table
   3533 8912 8D 00 02                             sta ibuffer           ;prepend to string
   3534 8915 E6 BF                                inc ibufidx           ;bump string index
                                        ;
   3536 8917 C9 2B                      .0000030 cmp #c_dec            ;converting to decimal?
   3537 8919 D0 07                                bne .0000040          ;no
                                        ;
   3539 891B 20 AF 89                             jsr facabcd           ;convert operand to BCD
   3540 891E A9 00                                lda #0
   3541 8920 80 17                                bra .0000070          ;skip binary stuff
                                        ;
                                        ;
                                        ;	prepare for binary, octal or hex conversion...
                                        ;
   3546 8922 A2 00                      .0000040 ldx #0                ;operand index
   3547 8924 A0 05                                ldy #s_sfac-1         ;workspace index
                                        ;
   3549 8926 B5 A7                      .0000050 lda faca,x            ;copy operand to...
   3550 8928 99 AF 00                             sta facb,y            ;workspace in...
   3551 892B 88                                   dey                   ;big-endian order
   3552 892C E8                                   inx
   3553 892D E0 04                                cpx #s_pfac
   3554 892F D0 F5                                bne .0000050
                                        ;
   3556 8931 A9 00                                lda #0
   3557 8933 BB                       +            .byte $bb
                                        
                                        ;
   3559 8934 95 AF                      .0000060 sta facb,x            ;pad workspace
   3560 8936 CA                                   dex
   3561 8937 10 FB                                bpl .0000060
                                        ;
                                        ;
                                        ;	set up conversion parameters...
                                        ;
   3566 8939 85 B5                      .0000070 sta facc              ;initialize byte counter
   3567 893B A4 C2                                ldy radix             ;radix index
   3568 893D B9 F2 8C                             lda numstab,y         ;numerals in string
   3569 8940 85 B6                                sta facc+s_byte       ;set remaining numeral count
   3570 8942 B9 EA 8C                             lda bitsntab,y        ;bits per numeral
   3571 8945 85 B7                                sta facc+s_word       ;set
   3572 8947 B9 EE 8C                             lda lzsttab,y         ;leading zero threshold
   3573 894A 85 B8                                sta facc+s_xword      ;set
                                        ;
                                        ;
                                        ;	generate conversion string...
                                        ;
   3578 894C A9 00                      .0000080 lda #0
   3579 894E A4 B7                                ldy facc+s_word       ;bits per numeral
                                        ;
   3581 8950 A2 05                      .0000090 ldx #s_sfac-1         ;workspace size
   3582 8952 18                                   clc                   ;avoid starting carry
                                        ;
   3584 8953 36 AF                      .0000100 rol facb,x            ;shift out a bit...
   3585 8955 CA                                   dex                   ;from the operand or...
   3586 8956 10 FB                                bpl .0000100          ;BCD conversion result
                                        ;
   3588 8958 2A                                   rol                   ;bit to .A
   3589 8959 88                                   dey
   3590 895A D0 F4                                bne .0000090          ;more bits to grab
                                        ;
   3592 895C A8                                   tay                   ;if numeral isn't zero...
   3593 895D D0 0A                                bne .0000110          ;skip leading zero tests
                                        ;
   3595 895F A6 B6                                ldx facc+s_byte       ;remaining numerals
   3596 8961 E4 B8                                cpx facc+s_xword      ;leading zero threshold
   3597 8963 90 04                                bcc .0000110          ;below it, must convert
                                        ;
   3599 8965 A6 B5                                ldx facc              ;processed byte count
   3600 8967 F0 11                                beq .0000130          ;discard leading zero
                                        ;
   3602 8969 C9 0A                      .0000110 cmp #10               ;check range
   3603 896B 90 02                                bcc .0000120          ;is 0-9
                                        ;
   3605 896D 69 06                                adc #a_hexdec         ;apply hex adjust
                                        ;
   3607 896F 69 30                      .0000120 adc #'0'              ;change to ASCII
   3608 8971 A4 BF                                ldy ibufidx           ;string index
   3609 8973 99 00 02                             sta ibuffer,y         ;save numeral in buffer
   3610 8976 E6 BF                                inc ibufidx           ;next buffer position
   3611 8978 E6 B5                                inc facc              ;bytes=bytes+1
                                        ;
   3613 897A C6 B6                      .0000130 dec facc+s_byte       ;numerals=numerals-1
   3614 897C D0 CE                                bne .0000080          ;not done
                                        ;
                                        ;
                                        ;	terminate string & exit...
                                        ;
   3619 897E A6 BF                                ldx ibufidx           ;printable string length
   3620 8980 9E 00 02                             stz ibuffer,x         ;terminate string
   3621 8983 8A                                   txa
   3622 8984 A2 00                                ldx #<ibuffer         ;converted string
   3623 8986 A0 02                                ldy #>ibuffer
   3624 8988 18                                   clc                   ;all okay
   3625 8989 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;binhex: CONVERT BINARY BYTE TO HEX ASCII CHARS
                                        ;
                                        ;	————————————————————————————————————————————
                                        ;	Preparatory Ops: .A: byte to convert
                                        ;
                                        ;	Returned Values: .A: MSN ASCII char
                                        ;	                 .X: LSN ASCII char
                                        ;	                 .Y: entry value
                                        ;	————————————————————————————————————————————
                                        ;
   3639 898A 20 EC 88                   binhex   jsr bintonyb          ;generate binary values
   3640 898D 48                                   pha                   ;save MSN
   3641 898E 8A                                   txa
   3642 898F 20 94 89                             jsr .0000010          ;generate ASCII LSN
   3643 8992 AA                                   tax                   ;save
   3644 8993 68                                   pla                   ;get input
                                        ;
                                        ;
                                        ;	convert nybble to hex ASCII equivalent...
                                        ;
   3649 8994 C9 0A                      .0000010 cmp #10
   3650 8996 90 02                                bcc .0000020          ;in decimal range
                                        ;
   3652 8998 69 66                                adc #k_hex            ;hex compensate
                                        ;         
   3654 899A 49 30                      .0000020 eor #'0'              ;finalize nybble
   3655 899C 60                                   rts                   ;done
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clrfaca: CLEAR FLOATING ACCUMULATOR A
                                        ;
   3661 899D 08                         clrfaca  php
   3662 899E C2 20                    +            .byte $c2,$20
                                        
   3663 89A0 64 A7                                stz faca
   3664 89A2 64 A9                                stz faca+s_word
   3665 89A4 28                                   plp
   3666 89A5 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clrfacb: CLEAR FLOATING ACCUMULATOR B
                                        ;
   3672 89A6 08                         clrfacb  php
   3673 89A7 C2 20                    +            .byte $c2,$20
                                        
   3674 89A9 64 AF                                stz facb
   3675 89AB 64 B1                                stz facb+s_word
   3676 89AD 28                                   plp
   3677 89AE 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facabcd: CONVERT FACA INTO BCD
                                        ;
   3683 89AF A2 03                      facabcd  ldx #s_pfac-1         ;primary accumulator size -1
                                        ;
   3685 89B1 B5 A7                      .0000010 lda faca,x            ;value to be converted
   3686 89B3 48                                   pha                   ;preserve
   3687 89B4 CA                                   dex
   3688 89B5 10 FA                                bpl .0000010          ;next
                                        ;
   3690 89B7 A2 05                                ldx #s_sfac-1         ;workspace size
                                        ;
   3692 89B9 74 AF                      .0000020 stz facb,x            ;clear final result
   3693 89BB 74 B5                                stz facc,x            ;clear scratchpad
   3694 89BD CA                                   dex
   3695 89BE 10 F9                                bpl .0000020
                                        ;
   3697 89C0 E6 BA                                inc facc+s_sfac-s_byte
   3698 89C2 F8                                   sed                   ;select decimal mode
   3699 89C3 A0 1F                                ldy #m_bits-1         ;bits to convert -1
                                        ;
   3701 89C5 A2 03                      .0000030 ldx #s_pfac-1         ;operand size
   3702 89C7 18                                   clc                   ;no carry at start
                                        ;
   3704 89C8 76 A7                      .0000040 ror faca,x            ;grab LS bit in operand
   3705 89CA CA                                   dex
   3706 89CB 10 FB                                bpl .0000040
                                        ;
   3708 89CD 90 0D                                bcc .0000060          ;LS bit clear
                                        ;
   3710 89CF 18                                   clc
   3711 89D0 A2 05                                ldx #s_sfac-1
                                        ;
   3713 89D2 B5 AF                      .0000050 lda facb,x            ;partial result
   3714 89D4 75 B5                                adc facc,x            ;scratchpad
   3715 89D6 95 AF                                sta facb,x            ;new partial result
   3716 89D8 CA                                   dex
   3717 89D9 10 F7                                bpl .0000050
                                        ;
   3719 89DB 18                                   clc
                                        ;
   3721 89DC A2 05                      .0000060 ldx #s_sfac-1
                                        ;
   3723 89DE B5 B5                      .0000070 lda facc,x            ;scratchpad
   3724 89E0 75 B5                                adc facc,x            ;double &...
   3725 89E2 95 B5                                sta facc,x            ;save
   3726 89E4 CA                                   dex
   3727 89E5 10 F7                                bpl .0000070
                                        ;
   3729 89E7 88                                   dey
   3730 89E8 10 DB                                bpl .0000030          ;next operand bit
                                        ;
   3732 89EA D8                                   cld
   3733 89EB A2 00                                ldx #0
   3734 89ED A0 04                                ldy #s_pfac
                                        ;
   3736 89EF 68                         .0000080 pla                   ;operand
   3737 89F0 95 A7                                sta faca,x            ;restore
   3738 89F2 E8                                   inx
   3739 89F3 88                                   dey
   3740 89F4 D0 F9                                bne .0000080          ;next
                                        ;
   3742 89F6 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;nybtobin: CONVERT ASCII NYBBLE TO BINARY
                                        ;
   3748 89F7 20 A6 8C                   nybtobin jsr toupper           ;convert case if necessary
   3749 89FA 38                                   sec
   3750 89FB E9 30                                sbc #'0'              ;change to binary
   3751 89FD 90 08                                bcc .0000020          ;not a numeral — error
                                        ;
   3753 89FF C9 0A                                cmp #10
   3754 8A01 90 03                                bcc .0000010          ;numeral is 0-9
                                        ;
   3756 8A03 E9 07                                sbc #a_hexdec+1       ;10-15 ——> A-F
   3757 8A05 18                                   clc                   ;no conversion error
                                        ;
   3759 8A06 60                         .0000010 rts
                                        ;
   3761 8A07 38                         .0000020 sec                   ;conversion error
   3762 8A08 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;calccnt: COMPUTE BYTE COUNT FROM ADDRESS RANGE
                                        ;
   3768 8A09 20 A6 89                   calccnt  jsr clrfacb           ;clear accumulator
   3769 8A0C C2 20                    +            .byte $c2,$20
                                        
   3770 8A0E 38                                   sec
   3771 8A0F A5 A4                                lda addrb             ;ending address
   3772 8A11 E5 A0                                sbc addra             ;starting address
   3773 8A13 85 AF                                sta facb              ;byte count
   3774 8A15 E2 20                    +            .byte $e2,$20
                                        
   3775 8A17 A5 A6                                lda addrb+s_word      ;handle banks
   3776 8A19 E5 A2                                sbc addra+s_word
   3777 8A1B 85 B1                                sta facb+s_word
   3778 8A1D 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;clroper: CLEAR OPERAND
                                        ;
   3784 8A1E DA                         clroper  phx
   3785 8A1F A2 02                                ldx #s_oper-1
                                        ;
   3787 8A21 74 BB                      .0000010 stz operand,x
   3788 8A23 CA                                   dex
   3789 8A24 10 FB                                bpl .0000010
                                        ;
   3791 8A26 64 CD                                stz eopsize
   3792 8A28 FA                                   plx
   3793 8A29 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;cpfwsup: FOWARD COPY MEMORY SETUP
                                        ;
   3799 8A2A C2 30                      cpfwsup +         .byte $c2,$30
                                        
   3800 8A2C A2 54                    +            ldx #<opc_mvn
   3800 8A2E 00                       +            .byte >opc_mvn
                                        ;"move next" opcode
   3801 8A2F 80 05                                bra cpsup
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;cprvsup: REVERSE COPY MEMORY SETUP
                                        ;
   3807 8A31 C2 30                      cprvsup +         .byte $c2,$30
                                        
   3808 8A33 A2 44                    +            ldx #<opc_mvp
   3808 8A35 00                       +            .byte >opc_mvp
                                        ;"move previous" opcode
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;cpsup: COPY MEMORY SETUP
                                        ;
   3814 8A36 48                         cpsup    pha                   ;save banks
   3815 8A37 8A                                   txa                   ;protect...
   3816 8A38 EB                       +            .byte $eb
                                                           ;opcode
   3817 8A39 E2 20                    +            .byte $e2,$20
                                        
   3818 8A3B A2 08                    +            ldx #<(cpcodeee-cpcode-1)
   3818 8A3D 00                       +            .byte >(cpcodeee-cpcode-1)
                                        
                                        ;
   3820 8A3E BF                         .0000010 +         .byte $bf
   3820 8A3F 5E 8A 00                 +   +         .byte <cpcode,>cpcode,cpcode >> 16
                                     +   
                                        ;transfer copy code to...
   3821 8A42 95 D2                                sta mcftwork,x        ;to workspace
   3822 8A44 CA                                   dex
   3823 8A45 10 F7                                bpl .0000010
                                        ;
   3825 8A47 EB                       +            .byte $eb
                                                           ;recover opcode &...
   3826 8A48 85 D3                                sta mcftopc           ;set it
   3827 8A4A C2 20                    +            .byte $c2,$20
                                        
   3828 8A4C 68                                   pla                   ;get banks &...
   3829 8A4D 85 D4                                sta mcftbnk           ;set them
                                         
                                        ; We just dynamically created a routine, so the cache (if one is present) has
                                        ; to be invalidated. Otherwise the processor could execute dead code from the
                                        ; cache. Two lines are invalidated in case the code crosses a line boundary.
                                        ;
                                        ;	acc = 16 bit address to invalidate
                                        ;
                                        ; If there is no cache in the processor then these lines can be deleted.
                                        ;-------------------------------------------------------------------------------
                                           		 CPU	FT832
                                           		 MEM	16
   3841 008A4F 48                                    pha
   3842 008A50 A9 D2 00                              lda	#mcftwork
   3843 008A53 42 E0 01                     		 cache	#1				; 1= invalidate line identified by address in acc
   3844 008A56 A9 E2 00                              lda	#mcftwork+16
   3845 008A59 42 E0 01                     		 cache	#1
   3846 008A5C 68                                    pla
                                        		 CPU	W65C02
   3848 8A5D                            		 MEM	8
                                        ;---------------------------------------------
   3850 8A5D 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;cpcode: COPY MEMORY CODE
                                        ;
                                        ;	———————————————————————————————————————————
                                        ;	This code is transfered to workspace when a
                                        ;	copy or fill operation is to be performed.
                                        ;	———————————————————————————————————————————
                                        ;
   3861 8A5E 8B                         cpcode +         .byte $8b
                                                           ;must preserve data bank
                                        ;         .rept s_mvinst
   3863 8A5F EA                                     nop                 ;placeholder
   3864 8A60 EA                                     nop
   3865 8A61 EA                                     nop
                                        ;         .endr
   3867 8A62 AB                       +            .byte $ab
                                                           ;restore data bank
   3868 8A63 5C 26 81 00                          jml monce             ;return to command executive
   4052 = 00008A67                      cpcodeee =*                    ;placeholder — do not delete
                                        ;
                                        ;================================================================================
                                        ;
                                        ;decdcnt: DECREMENT DUMP COUNT
                                        ;
                                        ;	———————————————————————————————————————————
                                        ;	Preparatory Ops: bytes to process in FACB
                                        ;	                 bytes processed in CHARCNT
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .C: 1 = count = zero
                                        ;	———————————————————————————————————————————
                                        ;
   3885 8A67 E2 20                      decdcnt +         .byte $e2,$20
                                        
   3886 8A69 A9 00                                lda #0
   3887 8A6B EB                       +            .byte $eb
                                                           ;clear .B
   3888 8A6C A5 B1                                lda facb+s_word       ;count MSW
   3889 8A6E C2 20                    +            .byte $c2,$20
                                        
   3890 8A70 38                                   sec
   3891 8A71 05 AF                                ora facb              ;count LSW
   3892 8A73 F0 13                                beq .0000020          ;zero, just exit
                                        ;
   3894 8A75 A5 AF                                lda facb
   3895 8A77 E5 C4                                sbc charcnt           ;bytes processed
   3896 8A79 85 AF                                sta facb
   3897 8A7B E2 20                    +            .byte $e2,$20
                                        
   3898 8A7D A5 B1                                lda facb+s_word
   3899 8A7F E9 00                                sbc #0                ;handle borrow
   3900 8A81 90 04                                bcc .0000010          ;underflow
                                        ;
   3902 8A83 85 B1                                sta facb+s_word
   3903 8A85 18                                   clc                   ;count > 0
   3904 8A86 60                                   rts
                                        ;
   3906 8A87 38                         .0000010 sec
                                        ;
   3908 8A88 E2 20                      .0000020 +         .byte $e2,$20
                                        
   3909 8A8A 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;enddest: GET 2ND & 3RD ADDRESSES FOR COMPARE & TRANSFER
                                        ;
   3915 8A8B 20 CF 8A                   enddest  jsr facasize          ;check start...
   3916 8A8E C9 04                                cmp #s_dword          ;for range
   3917 8A90 B0 1E                                bcs .0000010          ;out of range — error
                                        ;
   3919 8A92 20 B1 8A                             jsr facaddra          ;store start
   3920 8A95 20 E3 8A                             jsr getparm           ;get end
   3921 8A98 B0 16                                bcs .0000010          ;not entered — error
                                        ;
   3923 8A9A 20 CF 8A                             jsr facasize          ;check end...
   3924 8A9D C9 04                                cmp #s_dword          ;for range
   3925 8A9F B0 0F                                bcs .0000010          ;out of range — error
                                        ;
   3927 8AA1 20 BB 8A                             jsr facaddrb          ;store end
   3928 8AA4 20 E3 8A                             jsr getparm           ;get destination
   3929 8AA7 B0 07                                bcs .0000010          ;not entered — error
                                        ;
   3931 8AA9 20 CF 8A                             jsr facasize          ;check destination...
   3932 8AAC C9 04                                cmp #s_dword          ;for range
   3933 8AAE 90 15                                bcc facaoper          ;store dest address
                                        ;
   3935 8AB0 60                         .0000010 rts                   ;exit w/error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaddra: COPY FACA TO ADDRA
                                        ;
   3941 8AB1 A2 02                      facaddra ldx #s_xword-1
                                        ;
   3943 8AB3 B5 A7                      .0000010 lda faca,x
   3944 8AB5 95 A0                                sta addra,x
   3945 8AB7 CA                                   dex
   3946 8AB8 10 F9                                bpl .0000010
                                        ;
   3948 8ABA 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaddrb: COPY FACA TO ADDRB
                                        ;
   3954 8ABB A2 02                      facaddrb ldx #s_xword-1
                                        ;
   3956 8ABD B5 A7                      .0000010 lda faca,x
   3957 8ABF 95 A4                                sta addrb,x
   3958 8AC1 CA                                   dex
   3959 8AC2 10 F9                                bpl .0000010
                                        ;
   3961 8AC4 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facaoper: COPY FACA TO OPERAND
                                        ;
   3967 8AC5 A2 02                      facaoper ldx #s_oper-1
                                        ;
   3969 8AC7 B5 A7                      .0000010 lda faca,x
   3970 8AC9 95 BB                                sta operand,x
   3971 8ACB CA                                   dex
   3972 8ACC 10 F9                                bpl .0000010
                                        ;
   3974 8ACE 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;facasize: REPORT OPERAND SIZE IN FACA
                                        ;
                                        ;	——————————————————————————————————————————
                                        ;	Preparatory Ops: operand in FACA
                                        ;
                                        ;	Returned Values: .A: s_byte  (1)
                                        ;	                     s_word  (2)
                                        ;	                     s_xword (3)
                                        ;	                     s_dword (4)
                                        ;
                                        ;	Notes: 1) This function will always report
                                        ;	          a non-zero result.
                                        ;	——————————————————————————————————————————
                                        ;
   3992 8ACF E2 30                      facasize +         .byte $e2,$30
                                        
   3993 8AD1 A2 03                                ldx #s_dword-1
                                        ;
   3995 8AD3 B5 A7                      .0000010 lda faca,x            ;get byte
   3996 8AD5 D0 03                                bne .0000020          ;done
                                        ;
   3998 8AD7 CA                                   dex
   3999 8AD8 D0 F9                                bne .0000010          ;next byte
                                        ;
   4001 8ADA E8                         .0000020 inx                   ;count=index+1
   4002 8ADB 8A                                   txa
   4003 8ADC 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getbyte: GET A BYTE FROM MEMORY
                                        ;
   4009 8ADD A7 A0                      getbyte +         .byte $a7,addra
                                        ;get a byte
   4010 8ADF 80 3F                                bra incaddra          ;bump address
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getparm: GET A PARAMETER
                                        ;
                                        ;	—————————————————————————————————————————————————
                                        ;	Preparatory Ops: null-terminated input in IBUFFER
                                        ;
                                        ;	Returned Values: .A: chars in converted parameter
                                        ;	                 .X: used
                                        ;	                 .Y: entry value
                                        ;	                 .C: 1 = no parameter entered
                                        ;	—————————————————————————————————————————————————
                                        ;
   4025 8AE1 C6 BF                      getparmr dec ibufidx           ;reread previous char
                                        ;
   4027 8AE3 5A                         getparm  phy                   ;preserve
   4028 8AE4 20 38 88                             jsr ascbin            ;convert parameter to binary
   4029 8AE7 B0 1C                                bcs .0000040          ;conversion error
                                        ;
   4031 8AE9 20 D0 8B                             jsr getcharr          ;reread last char
   4032 8AEC D0 08                                bne .0000010          ;not end-of-input
                                        ;
   4034 8AEE C6 BF                                dec ibufidx           ;reindex to terminator
   4035 8AF0 A5 C4                                lda charcnt           ;get chars processed so far
   4036 8AF2 F0 0C                                beq .0000030          ;none
                                        ;
   4038 8AF4 D0 08                                bne .0000020          ;some
                                        ;
   4040 8AF6 C9 20                      .0000010 cmp #a_blank          ;recognized delimiter
   4041 8AF8 F0 04                                beq .0000020          ;end of parameter
                                        ;
   4043 8AFA C9 2C                                cmp #','              ;recognized delimiter
   4044 8AFC D0 07                                bne .0000040          ;unknown delimter
                                        ;
   4046 8AFE 18                         .0000020 clc
   4047 8AFF 24                                   .byte bitzp           ;skip SEC below
                                        ;
   4049 8B00 38                         .0000030 sec
   4050 8B01 7A                                   ply                   ;restore
   4051 8B02 A5 C4                                lda charcnt           ;get count
   4052 8B04 60                                   rts                   ;done
                                        ;
   4054 8B05                            .0000040 
                                        ;.rept 3               ;clean up stack
   4056 8B05 68                          			pla
   4057 8B06 68                          			pla
   4058 8B07 68                                     pla
                                        ;        .endr
   4060 8B08 4C 65 81                             jmp monerr            ;abort w/error
                                        ;
                                        ;================================================================================
                                        ;
                                        ;nxtaddra: TEST & INCREMENT WORKING ADDRESS 'A'
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Calling syntax: JSR NXTADDRA
                                        ;
                                        ;	Exit registers: .A: used
                                        ;	                .B: used
                                        ;	                .X: entry value
                                        ;	                .Y: entry value
                                        ;	                DB: entry value
                                        ;	                DP: entry value
                                        ;	                PB: entry value
                                        ;	                SR: NVmxDIZC
                                        ;	                    ||||||||
                                        ;	                    |||||||+———> 0: ADDRA < ADDRB
                                        ;	                    |||||||      1: ADDRA >= ADDRB
                                        ;	                    ||||||+————> undefined
                                        ;	                    |||+++—————> entry value
                                        ;	                    ||+————————> 1
                                        ;	                    ++—————————> undefined
                                        ;	——————————————————————————————————————————————————
                                        ;
   4086 8B0B E2 20                      nxtaddra +         .byte $e2,$20
                                        
   4087 8B0D A5 A2                                lda addra+s_word      ;bits 16-23
   4088 8B0F C5 A6                                cmp addrb+s_word
   4089 8B11 90 0D                                bcc incaddra          ;increment
                                        ;
   4091 8B13 D0 0A                                bne .0000010          ;don't increment
                                        ;
   4093 8B15 C2 20                    +            .byte $c2,$20
                                        
   4094 8B17 A5 A0                                lda addra             ;bits 0-15
   4095 8B19 C5 A4                                cmp addrb             ;condition flags
   4096 8B1B E2 20                    +            .byte $e2,$20
                                        
   4097 8B1D 90 01                                bcc incaddra          ;increment
                                        ;
   4099 8B1F 60                         .0000010 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;incaddra: INCREMENT WORKING ADDRESS 'A'
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Calling syntax: JSR INCADDRA
                                        ;
                                        ;	Exit registers: .A: entry value
                                        ;	                .B: entry value
                                        ;	                .X: entry value
                                        ;	                .Y: entry value
                                        ;	                DB: entry value
                                        ;	                DP: entry value
                                        ;	                PB: entry value
                                        ;	                SR: NVmxDIZC
                                        ;	                    ||||||||
                                        ;	                    ++++++++———> entry value
                                        ;	——————————————————————————————————————————————————
                                        ;
   4120 8B20 08                         incaddra php
   4121 8B21 C2 20                    +            .byte $c2,$20
                                        
   4122 8B23 E6 A0                                inc addra             ;bump bits 0-15
   4123 8B25 D0 04                                bne .0000010
                                        ;
   4125 8B27 E2 20                    +            .byte $e2,$20
                                        
   4126 8B29 E6 A2                                inc addra+s_word      ;bump bits 16-23
                                        ;
   4128 8B2B 28                         .0000010 plp
   4129 8B2C 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;incoper: INCREMENT OPERAND ADDRESS
                                        ;
   4135 8B2D 18                         incoper  clc
   4136 8B2E 08                                   php
   4137 8B2F C2 30                    +            .byte $c2,$30
                                        
   4138 8B31 48                                   pha
   4139 8B32 E6 BB                                inc operand           ;handle base address
   4140 8B34 D0 06                                bne .0000010
                                        ;              
   4142 8B36 E2 20                    +            .byte $e2,$20
                                        
   4143 8B38 E6 BD                                inc operand+s_word    ;handle bank
   4144 8B3A C2 20                    +            .byte $c2,$20
                                        
                                        ;
   4146 8B3C 68                         .0000010 pla
   4147 8B3D 28                                   plp
   4148 8B3E 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;instdata: GET INSTRUCTION SIZE & ADDRESSING MODE DATA
                                        ;
                                        ;	——————————————————————————————————
                                        ;	Preparatory Ops: .X: 65C816 opcode
                                        ;
                                        ;	Returned Values: .A: mode flags
                                        ;	                 .X: operand size
                                        ;	                 .Y: mode index
                                        ;	——————————————————————————————————
                                        ;
   4162 8B3F E2 30                      instdata +         .byte $e2,$30
                                        
   4163 8B41 BD BB 8E                             lda mnetabam,x        ;addressing mode data
   4164 8B44 48                                   pha                   ;save mode flag bits
   4165 8B45 48                                   pha                   ;save size data
   4166 8B46 29 0F                                and #amodmask         ;extract mode index &...
   4167 8B48 A8                                   tay                   ;save
   4168 8B49 68                                   pla                   ;recover data
   4169 8B4A 29 30                                and #opsmask          ;mask mode fields &...
                                        ;         .rept n_opslsr        ;extract operand size
   4171 8B4C 4A                                     lsr
   4172 8B4D 4A                                     lsr
   4173 8B4E 4A                                     lsr
   4174 8B4F 4A                                     lsr
                                        ;         .endr
   4176 8B50 AA                                   tax                   ;operand size
   4177 8B51 68                                   pla                   ;recover mode flags
   4178 8B52 29 C0                                and #vopsmask         ;discard mode & size fields
   4179 8B54 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;offtarg: CONVERT BRANCH OFFSET TO TARGET ADDRESS
                                        ;
                                        ;	———————————————————————————————————————————————
                                        ;	Preparatory Ops:    ADDRA: base address
                                        ;	                 INSTSIZE: instruction size
                                        ;	                  OPERAND: offset
                                        ;
                                        ;	Returned Values:  OPERAND: target address (L/H)
                                        ;	                       .A: used
                                        ;	                       .X: entry value
                                        ;                              .Y: entry value
                                        ;	———————————————————————————————————————————————
                                        ;
   4196 8B55 C2 20                      offtarg +         .byte $c2,$20
                                        
   4197 8B57 A5 A0                                lda addra             ;base address
   4198 8B59 E2 20                    +            .byte $e2,$20
                                        
   4199 8B5B 46 C6                                lsr instsize          ;bit 0 will be set if...
   4200 8B5D B0 07                                bcs .0000010          ;a long branch
                                        ;
   4202 8B5F 24 BB                                bit operand           ;short forward or backward?
   4203 8B61 10 03                                bpl .0000010          ;forward
                                        ;
   4205 8B63 EB                       +            .byte $eb
                                                           ;expose address MSB
   4206 8B64 3A                                   dea                   ;back a page
   4207 8B65 EB                       +            .byte $eb
                                                           ;expose address LSB
                                        ;
   4209 8B66 C2 20                      .0000010 +         .byte $c2,$20
                                        
   4210 8B68 18                                   clc
   4211 8B69 65 BB                                adc operand           ;calculate target address
   4212 8B6B 85 BB                                sta operand           ;new operand
   4213 8B6D E2 20                    +            .byte $e2,$20
                                        
   4214 8B6F A9 03                                lda #s_xword
   4215 8B71 85 C6                                sta instsize          ;effective instruction size
   4216 8B73 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;setxaddr: SET EXECUTION ADDRESS
                                        ;
   4222 8B74 B0 13                      setxaddr bcs .0000010          ;no address given
                                        ;
   4224 8B76 20 CF 8A                             jsr facasize          ;check address...
   4225 8B79 C9 04                                cmp #s_dword          ;range
   4226 8B7B B0 0D                                bcs .0000020          ;out of range
                                        ;
   4228 8B7D C2 20                    +            .byte $c2,$20
                                        
   4229 8B7F A5 A7                                lda faca              ;execution address
   4230 8B81 85 86                                sta reg_pcx           ;set new PC value
   4231 8B83 E2 20                    +            .byte $e2,$20
                                        
   4232 8B85 A5 A9                                lda faca+s_word
   4233 8B87 85 88                                sta reg_pbx           ;set new PB value
                                        ;
   4235 8B89 18                         .0000010 clc                   ;no error
                                        ;
   4237 8B8A 60                         .0000020 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;targoff: CONVERT BRANCH TARGET ADDRESS TO BRANCH OFFSET                   
                                        ;
                                        ;	—————————————————————————————————————————————————
                                        ;	Preparatory Ops:   ADDRA: instruction address
                                        ;	                 OPERAND: target address
                                        ;
                                        ;	Returned Values: OPERAND: computed offset
                                        ;	                      .A: effective operand size
                                        ;	                      .X: entry value
                                        ;                             .Y: entry value
                                        ;	                      .C: 1 = branch out of range
                                        ;
                                        ;	Execution notes: ADDRB is set to the branch base
                                        ;	                 address.
                                        ;	—————————————————————————————————————————————————
                                        ;
   4257 8B8B 64 C7                      targoff  stz instsize+s_byte   ;always zero
   4258 8B8D A5 C6                                lda instsize          ;instruction size will tell...
   4259 8B8F 4A                                   lsr                   ;if long or short branch
                                        ;
                                        ;—————————————————————————————————————————————————
   4469 = 000000BA                      .btype   =facc+5               ;branch type flag
                                        ;—————————————————————————————————————————————————
                                        ;
   4265 8B90 66 BA                                ror .btype            ;set branch type...
                                        ;
                                        ;	x0000000
                                        ;	|
                                        ;	+——————————> 0: short
                                        ;	             1: long
                                        ;
   4272 8B92 C2 20                    +            .byte $c2,$20
                                        
   4273 8B94 18                                   clc
   4274 8B95 A5 A0                                lda addra             ;instruction address
   4275 8B97 65 C6                                adc instsize          ;instruction size
   4276 8B99 85 A4                                sta addrb             ;base address
   4277 8B9B 38                                   sec
   4278 8B9C A5 BB                                lda operand           ;target address
   4279 8B9E E5 A4                                sbc addrb             ;base address
   4280 8BA0 85 BB                                sta operand           ;offset
   4281 8BA2 E2 20                    +            .byte $e2,$20
                                        
   4282 8BA4 90 15                                bcc .0000040          ;backward branch
                                        ;
   4284 8BA6 24 BA                                bit .btype            ;check branch range
   4285 8BA8 30 0A                                bmi .0000020          ;long
                                        ;
                                        ;
                                        ;	process short forward branch...
                                        ;
   4290 8BAA EB                       +            .byte $eb
                                                           ;offset MSB should be zero
   4291 8BAB D0 21                                bne .0000060          ;it isn't — out of range
                                        ;
   4293 8BAD EB                       +            .byte $eb
                                                           ;offset LSB should be $00-$7F
   4294 8BAE 30 1E                                bmi .0000060          ;it isn't — out of range
                                        ;
   4296 8BB0 A9 01                      .0000010 lda #s_byte           ;final instruction size
   4297 8BB2 18                                   clc                   ;branch in range
   4298 8BB3 60                                   rts
                                        ;
                                        ;
                                        ;	process long forward branch...
                                        ;
   4303 8BB4 EB                         .0000020 +         .byte $eb
                                                           ;offset MSB should be positive
   4304 8BB5 30 17                                bmi .0000060          ;it isn't — branch out of range
                                        ;
   4306 8BB7 A9 02                      .0000030 lda #s_word
   4307 8BB9 18                                   clc
   4308 8BBA 60                                   rts
                                        ;
                                        ;
                                        ;	process backward branch...
                                        ;
   4313 8BBB 24 BA                      .0000040 bit .btype            ;long or short?
   4314 8BBD 30 0C                                bmi .0000050          ;long
                                        ;
                                        ;
                                        ;	process short backward branch...
                                        ;
   4319 8BBF EB                       +            .byte $eb
                                                           ;offset MSB should be negative
   4320 8BC0 10 0C                                bpl .0000060          ;it isn't — out of range
                                        ;
   4322 8BC2 49 FF                                eor #%11111111        ;complement offset MSB 2s 
   4323 8BC4 D0 08                                bne .0000060          ;out of range
                                        ;
   4325 8BC6 EB                       +            .byte $eb
                                                           ;offset LSB should be $80-$FF
   4326 8BC7 30 E7                                bmi .0000010          ;it is — branch in range
                                        ;
   4328 8BC9 80 03                                bra .0000060          ;branch out of range
                                        ;
                                        ;
                                        ;	process long backward branch...
                                        ;
   4333 8BCB EB                         .0000050 +         .byte $eb
                                                           ;offset MSB should be negative
   4334 8BCC 30 E9                                bmi .0000030          ;it is — branch in range
                                        ;
   4336 8BCE 38                         .0000060 sec                   ;range error
   4337 8BCF 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getcharr: GET PREVIOUS INPUT BUFFER CHARACTER
                                        ;
   4343 8BD0 C6 BF                      getcharr dec ibufidx           ;move back a char
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getchar: GET A CHARACTER FROM INPUT BUFFER
                                        ;
                                        ;	——————————————————————————————————————————————
                                        ;	Preparatory Ops : none
                                        ;
                                        ;	Register Returns: .A: character or <NUL>
                                        ;	                  .B: entry value
                                        ;	                  .X: entry value
                                        ;	                  .Y: entry value
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> entry value
                                        ;	           ||||||+————> 1: <NUL> gotten
                                        ;	           |||||+—————> entry value
                                        ;	           ||||+——————> entry value
                                        ;	           |||+———————> entry value
                                        ;	           ||+————————> entry value
                                        ;	           |+—————————> not defined
                                        ;	           +——————————> not defined
                                        ;	——————————————————————————————————————————————
                                        ;
   4369 8BD2 DA                         getchar  phx
   4370 8BD3 5A                                   phy
   4371 8BD4 08                                   php                   ;save register sizes
   4372 8BD5 E2 30                    +            .byte $e2,$30
                                                        ;force 8 bits
   4373 8BD7 A6 BF                                ldx ibufidx           ;buffer index
   4374 8BD9 BD 00 02                             lda ibuffer,x         ;get char
   4375 8BDC E6 BF                                inc ibufidx           ;bump index
   4376 8BDE 28                                   plp                   ;restore register widths
   4377 8BDF 7A                                   ply
   4378 8BE0 FA                                   plx
                                        ; Changed the following to XBA instruction which seems to work as well.
                                        ; XBA doesn't access the stack memory saving a data memory access,
                                        ; and hence is faster.
   4382 8BE1 EB                       +            .byte $eb
                                        		;	pha                   ;condition...
   4383 8BE2 EB                       +            .byte $eb
                                        		;   pla                   ;.Z
   4384 8BE3 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getpat: GET PATTERN FOR MEMORY CHANGE or SEARCH
                                        ;
                                        ;	—————————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated pattern in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: used
                                        ;	                 .Y: pattern length if entered
                                        ;	                 .C: 0 = pattern valid
                                        ;	                     1 = exception:
                                        ;	                 .N  0 = no pattern entered
                                        ;	                     1 = evaluation error
                                        ;
                                        ;	Notes: 1) If pattern is preceded by "'" the following
                                        ;	          characters are interpreted as ASCII.
                                        ;	       2) A maximum of 32 bytes or characters is
                                        ;	          accepted.  Excess input will be discarded.
                                        ;	—————————————————————————————————————————————————————
                                        ;
   4407 8BE4 64 CB                      getpat   stz status            ;clear pattern type indicator
   4408 8BE6 A0 00                                ldy #0                ;pattern index
   4409 8BE8 20 D0 8B                             jsr getcharr          ;get last char
   4410 8BEB F0 3C                                beq .0000070          ;EOS
                                        ;
   4412 8BED A6 BF                                ldx ibufidx           ;current buffer index
   4413 8BEF 20 30 8C                             jsr getcharw          ;get next
   4414 8BF2 F0 35                                beq .0000070          ;EOS
                                        ;
   4416 8BF4 C9 27                                cmp #''''			; *** watch syntax here, the following line of code was omitted when only ''' was present
   4417 8BF6 D0 04                                bne .0000010          ;not ASCII input
                                        ;
   4419 8BF8 66 CB                                ror status            ;condition flag
   4420 8BFA 80 12                                bra .0000030          ;balance of input is ASCII
                                        ;
   4422 8BFC 86 BF                      .0000010 stx ibufidx           ;restore buffer index
                                        ;
   4424 8BFE 20 E3 8A                   .0000020 jsr getparm           ;evaluate numeric pattern
   4425 8C01 B0 21                                bcs .0000060          ;done w/pattern
                                        ;
   4427 8C03 20 CF 8A                             jsr facasize          ;size
   4428 8C06 C9 02                                cmp #s_word
   4429 8C08 B0 1F                                bcs .0000070          ;not a byte — error
                                        ;
   4431 8C0A A5 A7                                lda faca              ;get byte &...
   4432 8C0C 80 05                                bra .0000040          ;store
                                        ;
   4434 8C0E 20 D2 8B                   .0000030 jsr getchar           ;get ASCII char
   4435 8C11 F0 11                                beq .0000060          ;done w/pattern
                                        ;
   4437 8C13 C0 20                      .0000040 cpy #s_auxbuf         ;pattern buffer full?
   4438 8C15 F0 0A                                beq .0000050          ;yes
                                        ;
   4440 8C17 99 51 02                             sta auxbuf,y          ;store pattern
   4441 8C1A C8                                   iny
   4442 8C1B 24 CB                                bit status
   4443 8C1D 10 DF                                bpl .0000020          ;get next numeric value
                                        ;
   4445 8C1F 80 ED                                bra .0000030          ;get next ASCII char
                                        ;
   4447 8C21 20 11 88                   .0000050 jsr alert             ;excess input
                                        ;
   4449 8C24 84 BE                      .0000060 sty auxbufix          ;save pattern size
   4450 8C26 98                                   tya                   ;condition .Z
   4451 8C27 18                                   clc                   ;pattern valid
   4452 8C28 60                                   rts
                                        ;
                                        ;
                                        ;	no pattern entered...
                                        ;
   4457 8C29 C2 80                      .0000070 +         .byte $c2,%10000000
                                        
   4458 8C2B 38                                   sec
   4459 8C2C 60                                   rts
                                        ;
                                        ;
                                        ;	evaluation error...
                                        ;
   4464 8C2D E2 81                      .0000080 +         .byte $e2,%10000001
                                        
   4465 8C2F 60                                   rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;getcharw: GET FROM INPUT BUFFER, DISCARDING WHITESPACE
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated input in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: char or null
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .Z: 1 = null terminator detected
                                        ;
                                        ;	Notes: Whitespace is defined as a blank ($20) or a
                                        ;	       horizontal tab ($09).
                                        ;	——————————————————————————————————————————————————
                                        ;
   4483 8C30 20 D2 8B                   getcharw jsr getchar           ;get from buffer
   4484 8C33 F0 08                                beq .0000010          ;EOI
                                        ;
   4486 8C35 C9 20                                cmp #' '
   4487 8C37 F0 F7                                beq getcharw          ;discard whitespace
                                        ;
   4489 8C39 C9 09                                cmp #a_ht             ;also whitespace
   4490 8C3B F0 F3                                beq getcharw
                                        ;
   4492 8C3D 18                         .0000010 clc
   4493 8C3E 60                                   rts  
                                        ;
                                        ;================================================================================
                                        ;
                                        ;input: INTERACTIVE INPUT FROM CONSOLE CHANNEL
                                        ;
                                        ;	———————————————————————————————————————————————————————————
                                        ;	Preparatory Ops: Zero IBUFIDX or load IBUFFER with default
                                        ;	                 input & set IBUFIDX to the number of chars
                                        ;	                 loaded into the buffer.
                                        ;
                                        ;	Returned Values: .A: used
                                        ;	                 .X: characters entered
                                        ;	                 .Y: used
                                        ;
                                        ;	Example: STZ IBUFIDX
                                        ;	         JSR INPUT
                                        ;
                                        ;	Notes: Input is collected in IBUFFER & is null-terminated.
                                        ;	       IBUFIDX is reset to zero upon exit.
                                        ;	———————————————————————————————————————————————————————————
                                        ;
   4515 8C3F                            input:
   4516 8C3F A6 BF                       	    ldx ibufidx
   4517 8C41 9E 00 02                             stz ibuffer,x         ;be sure buffer is terminated
   4518 8C44 20 72 87                             jsr dpyibuf           ;print default input if any
   4519 8C47 F4                       +            .byte $f4
   4519 8C48 18 90                    +            .word dc_cn
                                        
   4520 8C4A 20 1D 88                             jsr sprint            ;enable cursor
   4521 8C4D A6 BF                                ldx ibufidx           ;starting buffer index
                                        ;
                                        ;
                                        ;	main input loop...
                                        ;
   4526 8C4F                               .0000010 CPU FT832
   4527 008C4F 42 20 00 FE FC               		 jcr getcha,biosctx            ;poll for input
                                        		 CPU	W65C02
   4529 8C54 90 02                                bcc .0000020          ;got something
                                        ;
                                        ;         jsr	$F409          ;wait 'til any IRQ &... (Reschedule tasks)
   4532 8C56 80 F7                                bra .0000010          ;try again
                                        ;
   4534 8C58                            .0000020
   4535 8C58 C9 7F                       		cmp #a_del            ;above ASCII range?
   4536 8C5A B0 F3                                bcs .0000010          ;yes, ignore
                                        ;
   4538 8C5C C9 09                                cmp #a_ht             ;horizontal tab?
   4539 8C5E D0 02                                bne .0000030          ;no
                                        ;
   4541 8C60 A9 20                                lda #a_blank          ;replace <HT> w/blank
                                        ;
   4543 8C62 C9 20                      .0000030 cmp #a_blank          ;control char?
   4544 8C64 90 12                                bcc .0000050          ;yes
                                        ;
                                        ;
                                        ;	process QWERTY character...
                                        ;
   4549 8C66 E0 50                                cpx #s_ibuf           ;room in buffer?
   4550 8C68 B0 05                                bcs .0000040          ;no
                                        ;
   4552 8C6A 9D 00 02                             sta ibuffer,x         ;store char
   4553 8C6D E8                                   inx                   ;bump index
   4554 8C6E 2C                                   .byte bitabs          ;echo char
                                        ;
   4556 8C6F A9 07                      .0000040 lda #a_bel            ;alert user
                                           		 cpu FT832
   4558 008C71 42 20 06 FE FC               		 jcr putcha,biosctx
                                        		 cpu W65C02
   4560 8C76 80 D7                                bra .0000010          ;get some more
                                        ;
                                        ;
                                        ;	process carriage return...
                                        ;
   4565 8C78 C9 0D                      .0000050 cmp #a_cr             ;carriage return?
   4566 8C7A D0 0E                                bne .0000060          ;no
                                        ;
   4568 8C7C DA                                   phx                   ;protect input count
   4569 8C7D F4                       +            .byte $f4
   4569 8C7E 1C 90                    +            .word dc_co
                                        
   4570 8C80 20 1D 88                             jsr sprint            ;cursor off
   4571 8C83 FA                                   plx                   ;recover input count
   4572 8C84 9E 00 02                             stz ibuffer,x         ;terminate input &...
   4573 8C87 64 BF                                stz ibufidx           ;reset buffer index
   4574 8C89 60                                   rts                   ;done
                                        ;
                                        ;
                                        ;	process backspace...
                                        ;
   4579 8C8A C9 08                      .0000060 cmp #a_bs             ;backspace?
   4580 8C8C D0 C1                                bne .0000010          ;no
                                        ;
   4582 8C8E 8A                                   txa
   4583 8C8F F0 BE                                beq .0000010          ;no input, ignore <BS>
                                        ;
   4585 8C91 CA                                   dex                   ;1 less char
   4586 8C92 DA                                   phx                   ;preserve count
   4587 8C93 20 C5 87                             jsr gendbs            ;destructive backspace
   4588 8C96 FA                                   plx                   ;restore count
   4589 8C97 80 B6                                bra .0000010          ;get more input
                                        ;
                                        ;================================================================================
                                        ;
                                        ;lodbnk: LOAD SOURCE & DESTINATION BANKS
                                        ;
   4595 8C99 E2 20                      lodbnk +         .byte $e2,$20
                                        
   4596 8C9B A5 BD                                lda operand+s_word    ;destination bank
   4597 8C9D EB                       +            .byte $eb
                                                           ;make it MSB
   4598 8C9E A5 A2                                lda addra+s_word      ;source bank is LSB
   4599 8CA0 60                                   rts
                                        ;         
                                        ;================================================================================
                                        ;
                                        ;getcharc: GET A CHARACTER FROM INPUT BUFFER & CONVERT CASE
                                        ;
                                        ;	——————————————————————————————————————————————————
                                        ;	Preparatory Ops: Null-terminated input in IBUFFER.
                                        ;
                                        ;	Returned Values: .A: char or null
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;	                 .Z: 1 = null terminator detected
                                        ;	——————————————————————————————————————————————————
                                        ;
   4614 8CA1 20 D2 8B                   getcharc jsr getchar           ;get from buffer
   4615 8CA4 F0 0C                                beq touppera          ;just return
                                        ;
                                        ;================================================================================
                                        ;
                                        ;toupper: FORCE CHARACTER TO UPPER CASE
                                        ;
                                        ;	————————————————————————————————————————————————
                                        ;	Preparatory Ops : .A: character to convert
                                        ;
                                        ;	Register Returns: .A: converted character
                                        ;	                  .B: entry value
                                        ;	                  .X: entry value
                                        ;	                  .Y: entry value
                                        ;
                                        ;	MPU Flags: no change
                                        ;
                                        ;	Notes: 1) This subroutine has no effect on char-
                                        ;	          acters that are not alpha.
                                        ;	————————————————————————————————————————————————
                                        ;
   4635 8CA6 08                         toupper  php                   ;protect flags
   4636 8CA7 C9 61                                cmp #a_asclcl         ;check char range
   4637 8CA9 90 06                                bcc .0000010          ;not LC alpha
                                        ;
   4639 8CAB C9 7B                                cmp #a_asclch+s_byte
   4640 8CAD B0 02                                bcs .0000010          ;not LC alpha
                                        ;
   4642 8CAF 29 5F                                and #a_lctouc         ;force to UC
                                        ;
   4644 8CB1 28                         .0000010 plp                   ;restore flags
                                        ;
   4646 8CB2 60                         touppera rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;teststop: TEST FOR STOP KEY
                                        ;
                                        ;	——————————————————————————————————————————————
                                        ;	Preparatory Ops: none
                                        ;
                                        ;	Returned Values: .A: detected keypress, if any
                                        ;	                 .X: entry value
                                        ;	                 .Y: entry value
                                        ;
                                        ;	MPU Flags: NVmxDIZC
                                        ;	           ||||||||
                                        ;	           |||||||+———> 0: normal key detected
                                        ;	           |||||||      1: <STOP> detected
                                        ;	           +++++++————> not defined
                                        ;
                                        ;	Example: jsr teststop
                                        ;	         bcs stopped
                                        ;
                                        ;	Notes: The symbol STOPKEY defines the ASCII
                                        ;	       value of the "stop key."
                                        ;	——————————————————————————————————————————————
                                        ;
   4672 8CB3                            teststop 
                                            		CPU	TF832
   4674 000008CB3                           		jcr getcha,biosctx            ;poll console
                                        		CPU	W65C02
   4676 8CB3 B0 04                                bcs .0000010          ;no input
                                        ;
   4678 8CB5 C9 03                                cmp #stopkey          ;stop key pressed?
   4679 8CB7 F0 01                                beq .0000020          ;yes
                                        ;
   4681 8CB9 18                         .0000010 clc
                                        ;
   4683 8CBA 60                         .0000020 rts
                                        ;
                                        ;================================================================================
                                        ;
                                        ;COMMAND PROCESSING DATA TABLES
                                        ;
                                        ;
                                        ;	monitor commands...
                                        ;
   4692 8CBB 41                         mpctab   .byte "A"             ;assemble code
   4693 8CBC 43                                   .byte "C"             ;compare memory ranges
   4694 8CBD 44                                   .byte "D"             ;disassemble code
   4695 8CBE 46                                   .byte "F"             ;fill memory
   4696 8CBF 47                                   .byte "G"             ;execute code
   4697 8CC0 48                                   .byte "H"             ;search memory
   4698 8CC1 4A                                   .byte "J"             ;execute code as subroutine
   4699 8CC2 4D                                   .byte "M"             ;dump memory range
   4700 8CC3 52                                   .byte "R"             ;dump registers
   4701 8CC4 54                                   .byte "T"             ;copy memory range
   4702 8CC5 58                                   .byte "X"             ;exit from monitor
   4703 8CC6 3E                                   .byte ">"             ;change memory
   4704 8CC7 3B                                   .byte ";"             ;change registers
   4931 = 0000000D                      n_mpctab =*-mpctab             ;entries in above table
                                        ;
                                        ;
                                        ;	monitor command jump table...
                                        ;
   4710 8CC8 6B 81                      mpcextab .word monasc-s_byte   ; A  assemble code
   4711 8CCA 2F 84                                .word moncmp-s_byte   ; C  compare memory ranges
   4712 8CCC 49 83                                .word mondsc-s_byte   ; D  disassemble code
   4713 8CCE 00 85                                .word monfil-s_byte   ; F  fill memory
   4714 8CD0 9D 83                                .word monjmp-s_byte   ; G  execute code
   4715 8CD2 66 85                                .word monhnt-s_byte   ; H  search memory
   4716 8CD4 CE 83                                .word monjsr-s_byte   ; J  execute code as subroutine
   4717 8CD6 AE 84                                .word mondmp-s_byte   ; M  dump memory range
   4718 8CD8 7E 80                                .word monreg-s_byte   ; R  dump registers
   4719 8CDA 5D 84                                .word moncpy-s_byte   ; T  copy memory range
   4720 8CDC 17 86                                .word monxit-s_byte   ; X  exit from monitor
   4721 8CDE 04 84                                .word monchm-s_byte   ; >  change memory
   4722 8CE0 DC 85                                .word monchr-s_byte   ; ;  change registers
                                        ;
                                        ;
                                        ;	number conversion...
                                        ;        
   4727 8CE2 10 0A 08 02                basetab  .byte 16,10,8,2       ;supported number bases
   4728 8CE6 04 03 03 01                bitsdtab .byte 4,3,3,1         ;bits per binary digit
   4729 8CEA 04 04 03 01                bitsntab .byte 4,4,3,1         ;bits per ASCII character
   4730 8CEE 03 02 09 02                lzsttab  .byte 3,2,9,2         ;leading zero suppression thresholds
   4731 8CF2 0C 0C 10 30                numstab  .byte 12,12,16,48     ;bin to ASCII conversion numerals
   4732 8CF6 24                         radxtab  .byte c_hex           ;hexadecimal radix
   4733 8CF7 2B                                   .byte c_dec           ;decimal radix
   4734 8CF8 40                                   .byte c_oct           ;octal radix
   4735 8CF9 25                                   .byte c_bin           ;binary radix
   4962 = 00000004                      n_radix  =*-radxtab            ;number of recognized radices
                                        ;
                                        ;
                                        ;	shadow MPU register sizes...
                                        ;
   4741 8CFA 02                         rcvltab  .byte s_mpupbx+s_byte ; PB
   4742 8CFB 03                                   .byte s_mpupcx+s_byte ; PC
   4743 8CFC 02                                   .byte s_mpusrx+s_byte ; SR
   4744 8CFD 03                                   .byte s_word+s_byte   ; .C
   4745 8CFE 03                                   .byte s_word+s_byte   ; .X
   4746 8CFF 03                                   .byte s_word+s_byte   ; .Y
   4747 8D00 03                                   .byte s_mpuspx+s_byte ; SP
   4748 8D01 03                                   .byte s_mpudpx+s_byte ; DP
   4749 8D02 02                                   .byte s_mpudbx+s_byte ; DB
   4976 = 00000009                      n_regchv =*-rcvltab            ;total shadow registers
                                        ;
                                        ;================================================================================
                                        ;
                                        ;ASSEMBLER/DISASSEMBLER DATA TABLES
                                        ;
                                        ;
                                        ;	numerically sorted & encoded W65C816S mnemonics...
                                        ;
   4759 8D03 F2 10                      mnetab   .word mne_xba         ;  0 — XBA
   4760 8D05 5A 11                                .word mne_lda         ;  1 — LDA
   4761 8D07 A2 11                                .word mne_pea         ;  2 — PEA
   4762 8D09 62 12                                .word mne_pha         ;  3 — PHA
   4763 8D0B 62 13                                .word mne_pla         ;  4 — PLA
   4764 8D0D C6 14                                .word mne_bra         ;  5 — BRA
   4765 8D0F E0 14                                .word mne_ora         ;  6 — ORA
   4766 8D11 68 15                                .word mne_sta         ;  7 — STA
   4767 8D13 6A 16                                .word mne_txa         ;  8 — TXA
   4768 8D15 AA 16                                .word mne_tya         ;  9 — TYA
   4769 8D17 62 1A                                .word mne_phb         ; 10 — PHB
   4770 8D19 62 1B                                .word mne_plb         ; 11 — PLB
   4771 8D1B EA 1C                                .word mne_trb         ; 12 — TRB
   4772 8D1D 2A 1D                                .word mne_tsb         ; 13 — TSB
   4773 8D1F E8 20                                .word mne_sbc         ; 14 — SBC
   4774 8D21 06 21                                .word mne_bcc         ; 15 — BCC
   4775 8D23 44 21                                .word mne_adc         ; 16 — ADC
   4776 8D25 6A 21                                .word mne_tdc         ; 17 — TDC
   4777 8D27 8A 21                                .word mne_dec         ; 18 — DEC
   4778 8D29 A8 21                                .word mne_sec         ; 19 — SEC
   4779 8D2B 48 23                                .word mne_clc         ; 20 — CLC
   4780 8D2D D4 23                                .word mne_inc         ; 21 — INC
   4781 8D2F 2A 25                                .word mne_tsc         ; 22 — TSC
   4782 8D31 C6 25                                .word mne_bvc         ; 23 — BVC
   4783 8D33 2A 29                                .word mne_tcd         ; 24 — TCD
   4784 8D35 A8 29                                .word mne_sed         ; 25 — SED
   4785 8D37 62 2A                                .word mne_phd         ; 26 — PHD
   4786 8D39 48 2B                                .word mne_cld         ; 27 — CLD
   4787 8D3B 62 2B                                .word mne_pld         ; 28 — PLD
   4788 8D3D C4 2B                                .word mne_and         ; 29 — AND
   4789 8D3F 32 31                                .word mne_xce         ; 30 — XCE
   4790 8D41 C6 33                                .word mne_bne         ; 31 — BNE
   4791 8D43 B0 50                                .word mne_wai         ; 32 — WAI
   4792 8D45 A2 51                                .word mne_pei         ; 33 — PEI
   4793 8D47 A8 51                                .word mne_sei         ; 34 — SEI
   4794 8D49 48 53                                .word mne_cli         ; 35 — CLI
   4795 8D4B 86 53                                .word mne_bmi         ; 36 — BMI
   4796 8D4D 66 55                                .word mne_rti         ; 37 — RTI
   4797 8D4F 62 62                                .word mne_phk         ; 38 — PHK
   4798 8D51 C6 64                                .word mne_brk         ; 39 — BRK
   4799 8D53 96 6B                                .word mne_jml         ; 40 — JML
   4800 8D55 26 6C                                .word mne_rol         ; 41 — ROL
   4801 8D57 46 6C                                .word mne_bpl         ; 42 — BPL
   4802 8D59 C6 6C                                .word mne_brl         ; 43 — BRL
   4803 8D5B 04 6D                                .word mne_asl         ; 44 — ASL
   4804 8D5D 16 6D                                .word mne_jsl         ; 45 — JSL
   4805 8D5F 66 6D                                .word mne_rtl         ; 46 — RTL
   4806 8D61 70 71                                .word mne_wdm         ; 47 — WDM
   4807 8D63 DC 7D                                .word mne_mvn         ; 48 — MVN
   4808 8D65 A6 89                                .word mne_rep         ; 49 — REP
   4809 8D67 A8 89                                .word mne_sep         ; 50 — SEP
   4810 8D69 62 8A                                .word mne_php         ; 51 — PHP
   4811 8D6B 62 8B                                .word mne_plp         ; 52 — PLP
   4812 8D6D 88 8B                                .word mne_cmp         ; 53 — CMP
   4813 8D6F 96 8B                                .word mne_jmp         ; 54 — JMP
   4814 8D71 08 8C                                .word mne_cop         ; 55 — COP
   4815 8D73 1E 8C                                .word mne_nop         ; 56 — NOP
   4816 8D75 68 8D                                .word mne_stp         ; 57 — STP
   4817 8D77 DC 8D                                .word mne_mvp         ; 58 — MVP
   4818 8D79 86 91                                .word mne_beq         ; 59 — BEQ
   4819 8D7B A2 99                                .word mne_per         ; 60 — PER
   4820 8D7D 0C 9C                                .word mne_eor         ; 61 — EOR
   4821 8D7F 26 9C                                .word mne_ror         ; 62 — ROR
   4822 8D81 16 9D                                .word mne_jsr         ; 63 — JSR
   4823 8D83 1A 9D                                .word mne_lsr         ; 64 — LSR
   4824 8D85 06 A1                                .word mne_bcs         ; 65 — BCS
   4825 8D87 2A A1                                .word mne_tcs         ; 66 — TCS
   4826 8D89 66 A5                                .word mne_rts         ; 67 — RTS
   4827 8D8B C6 A5                                .word mne_bvs         ; 68 — BVS
   4828 8D8D 6A A6                                .word mne_txs         ; 69 — TXS
   4829 8D8F 86 AA                                .word mne_bit         ; 70 — BIT
   4830 8D91 48 BB                                .word mne_clv         ; 71 — CLV
   4831 8D93 AA C8                                .word mne_tax         ; 72 — TAX
   4832 8D95 5A C9                                .word mne_ldx         ; 73 — LDX
   4833 8D97 8A C9                                .word mne_dex         ; 74 — DEX
   4834 8D99 62 CA                                .word mne_phx         ; 75 — PHX
   4835 8D9B 62 CB                                .word mne_plx         ; 76 — PLX
   4836 8D9D D4 CB                                .word mne_inx         ; 77 — INX
   4837 8D9F 48 CC                                .word mne_cpx         ; 78 — CPX
   4838 8DA1 2A CD                                .word mne_tsx         ; 79 — TSX
   4839 8DA3 68 CD                                .word mne_stx         ; 80 — STX
   4840 8DA5 AA CE                                .word mne_tyx         ; 81 — TYX
   4841 8DA7 AA D0                                .word mne_tay         ; 82 — TAY
   4842 8DA9 5A D1                                .word mne_ldy         ; 83 — LDY
   4843 8DAB 8A D1                                .word mne_dey         ; 84 — DEY
   4844 8DAD 62 D2                                .word mne_phy         ; 85 — PHY
   4845 8DAF 62 D3                                .word mne_ply         ; 86 — PLY
   4846 8DB1 D4 D3                                .word mne_iny         ; 87 — INY
   4847 8DB3 48 D4                                .word mne_cpy         ; 88 — CPY
   4848 8DB5 68 D5                                .word mne_sty         ; 89 — STY
   4849 8DB7 6A D6                                .word mne_txy         ; 90 — TXY
   4850 8DB9 68 DD                                .word mne_stz         ; 91 — STZ
                                        ;
   5078 = 000000B8                      s_mnetab =*-mnetab             ;mnemonic table size
   5079 = 0000005C                      n_mnemon =s_mnetab/s_word      ;total mnemonics
                                        ;
                                        ;
                                        ;	mnemonic lookup indices in opcode order...
                                        ;
   4858 8DBB 27                         mnetabix .byte mne_brkx        ; $00  BRK
   4859 8DBC 06                                   .byte mne_orax        ; $01  ORA (dp,X)
   4860 8DBD 37                                   .byte mne_copx        ; $02  COP
   4861 8DBE 06                                   .byte mne_orax        ; $03  ORA offset,S
   4862 8DBF 0D                                   .byte mne_tsbx        ; $04  TSB dp
   4863 8DC0 06                                   .byte mne_orax        ; $05  ORA dp
   4864 8DC1 2C                                   .byte mne_aslx        ; $06  ASL dp
   4865 8DC2 06                                   .byte mne_orax        ; $07  ORA [dp]
   4866 8DC3 33                                   .byte mne_phpx        ; $08  PHP
   4867 8DC4 06                                   .byte mne_orax        ; $09  ORA #
   4868 8DC5 2C                                   .byte mne_aslx        ; $0A  ASL A
   4869 8DC6 1A                                   .byte mne_phdx        ; $0B  PHD
   4870 8DC7 0D                                   .byte mne_tsbx        ; $0C  TSB abs
   4871 8DC8 06                                   .byte mne_orax        ; $0D  ORA abs
   4872 8DC9 2C                                   .byte mne_aslx        ; $0E  ASL abs
   4873 8DCA 06                                   .byte mne_orax        ; $0F  ORA absl
                                        ;
   4875 8DCB 2A                                   .byte mne_bplx        ; $10  BPL abs
   4876 8DCC 06                                   .byte mne_orax        ; $11  ORA (dp),Y
   4877 8DCD 06                                   .byte mne_orax        ; $12  ORA (dp)
   4878 8DCE 06                                   .byte mne_orax        ; $13  ORA (offset,S),Y
   4879 8DCF 0C                                   .byte mne_trbx        ; $14  TRB dp
   4880 8DD0 06                                   .byte mne_orax        ; $15  ORA dp,X
   4881 8DD1 2C                                   .byte mne_aslx        ; $16  ASL dp,X
   4882 8DD2 06                                   .byte mne_orax        ; $17  ORA [dp],Y
   4883 8DD3 14                                   .byte mne_clcx        ; $18  CLC
   4884 8DD4 06                                   .byte mne_orax        ; $19  ORA abs
   4885 8DD5 15                                   .byte mne_incx        ; $1A  INC A
   4886 8DD6 42                                   .byte mne_tcsx        ; $1B  TCS
   4887 8DD7 0C                                   .byte mne_trbx        ; $1C  TRB abs
   4888 8DD8 06                                   .byte mne_orax        ; $1D  ORA abs,X
   4889 8DD9 2C                                   .byte mne_aslx        ; $1E  ASL abs,X
   4890 8DDA 06                                   .byte mne_orax        ; $1F  ORA absl,X
                                        ;
   4892 8DDB 3F                                   .byte mne_jsrx        ; $20  JSR abs
   4893 8DDC 1D                                   .byte mne_andx        ; $21  AND (dp,X)
   4894 8DDD 2D                                   .byte mne_jslx        ; $22  JSL absl
   4895 8DDE 1D                                   .byte mne_andx        ; $23  AND offset,S
   4896 8DDF 46                                   .byte mne_bitx        ; $24  BIT dp
   4897 8DE0 1D                                   .byte mne_andx        ; $25  AND dp
   4898 8DE1 29                                   .byte mne_rolx        ; $26  ROL dp
   4899 8DE2 1D                                   .byte mne_andx        ; $27  AND [dp]
   4900 8DE3 34                                   .byte mne_plpx        ; $28  PLP
   4901 8DE4 1D                                   .byte mne_andx        ; $29  AND #
   4902 8DE5 29                                   .byte mne_rolx        ; $2A  ROL A
   4903 8DE6 1C                                   .byte mne_pldx        ; $2B  PLD
   4904 8DE7 46                                   .byte mne_bitx        ; $2C  BIT abs
   4905 8DE8 1D                                   .byte mne_andx        ; $2D  AND abs
   4906 8DE9 29                                   .byte mne_rolx        ; $2E  ROL abs
   4907 8DEA 1D                                   .byte mne_andx        ; $2F  AND absl
                                        ;
   4909 8DEB 24                                   .byte mne_bmix        ; $30  BMI abs
   4910 8DEC 1D                                   .byte mne_andx        ; $31  AND (dp),Y
   4911 8DED 1D                                   .byte mne_andx        ; $32  AND (dp)
   4912 8DEE 1D                                   .byte mne_andx        ; $33  AND (offset,S),Y
   4913 8DEF 46                                   .byte mne_bitx        ; $34  BIT dp,X
   4914 8DF0 1D                                   .byte mne_andx        ; $35  AND dp,X
   4915 8DF1 29                                   .byte mne_rolx        ; $36  ROL dp,X
   4916 8DF2 1D                                   .byte mne_andx        ; $37  AND [dp],Y
   4917 8DF3 13                                   .byte mne_secx        ; $38  SEC
   4918 8DF4 1D                                   .byte mne_andx        ; $39  AND abs,Y
   4919 8DF5 12                                   .byte mne_decx        ; $3A  DEC A
   4920 8DF6 16                                   .byte mne_tscx        ; $3B  TSC
   4921 8DF7 46                                   .byte mne_bitx        ; $3C  BIT abs,X
   4922 8DF8 1D                                   .byte mne_andx        ; $3D  AND abs,X
   4923 8DF9 29                                   .byte mne_rolx        ; $3E  ROL abs,X
   4924 8DFA 1D                                   .byte mne_andx        ; $3F  AND absl,X
                                        ;
   4926 8DFB 25                                   .byte mne_rtix        ; $40  RTI
   4927 8DFC 3D                                   .byte mne_eorx        ; $41  EOR (dp,X)
   4928 8DFD 2F                                   .byte mne_wdmx        ; $42  WDM
   4929 8DFE 3D                                   .byte mne_eorx        ; $43  EOR offset,S
   4930 8DFF 3A                                   .byte mne_mvpx        ; $44  MVP sb,db
   4931 8E00 3D                                   .byte mne_eorx        ; $45  EOR dp
   4932 8E01 40                                   .byte mne_lsrx        ; $46  LSR dp
   4933 8E02 3D                                   .byte mne_eorx        ; $47  EOR [dp]
   4934 8E03 03                                   .byte mne_phax        ; $48  PHA
   4935 8E04 3D                                   .byte mne_eorx        ; $49  EOR #
   4936 8E05 40                                   .byte mne_lsrx        ; $4A  LSR A
   4937 8E06 26                                   .byte mne_phkx        ; $4B  PHK
   4938 8E07 36                                   .byte mne_jmpx        ; $4C  JMP abs
   4939 8E08 3D                                   .byte mne_eorx        ; $4D  EOR abs
   4940 8E09 40                                   .byte mne_lsrx        ; $4E  LSR abs
   4941 8E0A 3D                                   .byte mne_eorx        ; $4F  EOR absl
                                        ;
   4943 8E0B 17                                   .byte mne_bvcx        ; $50  BVC abs
   4944 8E0C 3D                                   .byte mne_eorx        ; $51  EOR (dp),Y
   4945 8E0D 3D                                   .byte mne_eorx        ; $52  EOR (dp)
   4946 8E0E 3D                                   .byte mne_eorx        ; $53  EOR (offset,S),Y
   4947 8E0F 30                                   .byte mne_mvnx        ; $54  MVN sb,db
   4948 8E10 3D                                   .byte mne_eorx        ; $55  EOR dp,X
   4949 8E11 40                                   .byte mne_lsrx        ; $56  LSR dp,X
   4950 8E12 3D                                   .byte mne_eorx        ; $57  EOR [dp],Y
   4951 8E13 23                                   .byte mne_clix        ; $58  CLI
   4952 8E14 3D                                   .byte mne_eorx        ; $59  EOR abs,Y
   4953 8E15 55                                   .byte mne_phyx        ; $5A  PHY
   4954 8E16 18                                   .byte mne_tcdx        ; $5B  TCD
   4955 8E17 28                                   .byte mne_jmlx        ; $5C  JML absl
   4956 8E18 3D                                   .byte mne_eorx        ; $5D  EOR abs,X
   4957 8E19 40                                   .byte mne_lsrx        ; $5E  LSR abs,X
   4958 8E1A 3D                                   .byte mne_eorx        ; $5F  EOR absl,X
                                        ;
   4960 8E1B 43                                   .byte mne_rtsx        ; $60  RTS
   4961 8E1C 10                                   .byte mne_adcx        ; $61  ADC (dp,X)
   4962 8E1D 3C                                   .byte mne_perx        ; $62  PER
   4963 8E1E 10                                   .byte mne_adcx        ; $63  ADC offset,S
   4964 8E1F 5B                                   .byte mne_stzx        ; $64  STZ dp
   4965 8E20 10                                   .byte mne_adcx        ; $65  ADC dp
   4966 8E21 3E                                   .byte mne_rorx        ; $66  ROR dp
   4967 8E22 10                                   .byte mne_adcx        ; $67  ADC [dp]
   4968 8E23 04                                   .byte mne_plax        ; $68  PLA
   4969 8E24 10                                   .byte mne_adcx        ; $69  ADC #
   4970 8E25 3E                                   .byte mne_rorx        ; $6A  ROR A
   4971 8E26 2E                                   .byte mne_rtlx        ; $6B  RTL
   4972 8E27 36                                   .byte mne_jmpx        ; $6C  JMP (abs)
   4973 8E28 10                                   .byte mne_adcx        ; $6D  ADC abs
   4974 8E29 3E                                   .byte mne_rorx        ; $6E  ROR abs
   4975 8E2A 10                                   .byte mne_adcx        ; $6F  ADC absl
                                        ;
   4977 8E2B 44                                   .byte mne_bvsx        ; $70  BVS abs
   4978 8E2C 10                                   .byte mne_adcx        ; $71  ADC (dp),Y
   4979 8E2D 10                                   .byte mne_adcx        ; $72  ADC (dp)
   4980 8E2E 10                                   .byte mne_adcx        ; $73  ADC (offset,S),Y
   4981 8E2F 5B                                   .byte mne_stzx        ; $74  STZ dp,X
   4982 8E30 10                                   .byte mne_adcx        ; $75  ADC dp,X
   4983 8E31 3E                                   .byte mne_rorx        ; $76  ROR dp,X
   4984 8E32 10                                   .byte mne_adcx        ; $77  ADC [dp],Y
   4985 8E33 22                                   .byte mne_seix        ; $78  SEI
   4986 8E34 10                                   .byte mne_adcx        ; $79  ADC abs,Y
   4987 8E35 56                                   .byte mne_plyx        ; $7A  PLY
   4988 8E36 11                                   .byte mne_tdcx        ; $7B  TDC
   4989 8E37 36                                   .byte mne_jmpx        ; $7C  JMP (abs,X)
   4990 8E38 10                                   .byte mne_adcx        ; $7D  ADC abs,X
   4991 8E39 3E                                   .byte mne_rorx        ; $7E  ROR abs,X
   4992 8E3A 10                                   .byte mne_adcx        ; $7F  ADC absl,X
                                        ;
   4994 8E3B 05                                   .byte mne_brax        ; $80  BRA abs
   4995 8E3C 07                                   .byte mne_stax        ; $81  STA (dp,X)
   4996 8E3D 2B                                   .byte mne_brlx        ; $82  BRL abs
   4997 8E3E 07                                   .byte mne_stax        ; $83  STA offset,S
   4998 8E3F 59                                   .byte mne_styx        ; $84  STY dp
   4999 8E40 07                                   .byte mne_stax        ; $85  STA dp
   5000 8E41 50                                   .byte mne_stxx        ; $86  STX dp
   5001 8E42 07                                   .byte mne_stax        ; $87  STA [dp]
   5002 8E43 54                                   .byte mne_deyx        ; $88  DEY
   5003 8E44 46                                   .byte mne_bitx        ; $89  BIT #
   5004 8E45 08                                   .byte mne_txax        ; $8A  TXA
   5005 8E46 0A                                   .byte mne_phbx        ; $8B  PHB
   5006 8E47 59                                   .byte mne_styx        ; $8C  STY abs
   5007 8E48 07                                   .byte mne_stax        ; $8D  STA abs
   5008 8E49 50                                   .byte mne_stxx        ; $8E  STX abs
   5009 8E4A 07                                   .byte mne_stax        ; $8F  STA absl
                                        ;
   5011 8E4B 0F                                   .byte mne_bccx        ; $90  BCC abs
   5012 8E4C 07                                   .byte mne_stax        ; $91  STA (dp),Y
   5013 8E4D 07                                   .byte mne_stax        ; $92  STA (dp)
   5014 8E4E 07                                   .byte mne_stax        ; $93  STA (offset,S),Y
   5015 8E4F 59                                   .byte mne_styx        ; $94  STY dp,X
   5016 8E50 07                                   .byte mne_stax        ; $95  STA dp,X
   5017 8E51 50                                   .byte mne_stxx        ; $96  STX dp,Y
   5018 8E52 07                                   .byte mne_stax        ; $97  STA [dp],Y
   5019 8E53 09                                   .byte mne_tyax        ; $98  TYA
   5020 8E54 07                                   .byte mne_stax        ; $99  STA abs,Y
   5021 8E55 45                                   .byte mne_txsx        ; $9A  TXS
   5022 8E56 5A                                   .byte mne_txyx        ; $9B  TXY
   5023 8E57 5B                                   .byte mne_stzx        ; $9C  STZ abs
   5024 8E58 07                                   .byte mne_stax        ; $9D  STA abs,X
   5025 8E59 5B                                   .byte mne_stzx        ; $9E  STZ abs,X
   5026 8E5A 07                                   .byte mne_stax        ; $9F  STA absl,X
                                        ;
   5028 8E5B 53                                   .byte mne_ldyx        ; $A0  LDY #
   5029 8E5C 01                                   .byte mne_ldax        ; $A1  LDA (dp,X)
   5030 8E5D 49                                   .byte mne_ldxx        ; $A2  LDX #
   5031 8E5E 01                                   .byte mne_ldax        ; $A3  LDA offset,S
   5032 8E5F 53                                   .byte mne_ldyx        ; $A4  LDY dp
   5033 8E60 01                                   .byte mne_ldax        ; $A5  LDA dp
   5034 8E61 49                                   .byte mne_ldxx        ; $A6  LDX dp
   5035 8E62 01                                   .byte mne_ldax        ; $A7  LDA [dp]
   5036 8E63 52                                   .byte mne_tayx        ; $A8  TAY
   5037 8E64 01                                   .byte mne_ldax        ; $A9  LDA #
   5038 8E65 48                                   .byte mne_taxx        ; $AA  TAX
   5039 8E66 0B                                   .byte mne_plbx        ; $AB  PLB
   5040 8E67 53                                   .byte mne_ldyx        ; $AC  LDY abs
   5041 8E68 01                                   .byte mne_ldax        ; $AD  LDA abs
   5042 8E69 49                                   .byte mne_ldxx        ; $AE  LDX abs
   5043 8E6A 01                                   .byte mne_ldax        ; $AF  LDA absl
                                        ;
   5045 8E6B 41                                   .byte mne_bcsx        ; $B0  BCS abs
   5046 8E6C 01                                   .byte mne_ldax        ; $B1  LDA (dp),Y
   5047 8E6D 01                                   .byte mne_ldax        ; $B2  LDA (dp)
   5048 8E6E 01                                   .byte mne_ldax        ; $B3  LDA (offset,S),Y
   5049 8E6F 53                                   .byte mne_ldyx        ; $B4  LDY dp,X
   5050 8E70 01                                   .byte mne_ldax        ; $B5  LDA dp,X
   5051 8E71 49                                   .byte mne_ldxx        ; $B6  LDX dp,Y
   5052 8E72 01                                   .byte mne_ldax        ; $B7  LDA [dp],Y
   5053 8E73 47                                   .byte mne_clvx        ; $B8  CLV
   5054 8E74 01                                   .byte mne_ldax        ; $B9  LDA abs,Y
   5055 8E75 4F                                   .byte mne_tsxx        ; $BA  TSX
   5056 8E76 51                                   .byte mne_tyxx        ; $BB  TYX
   5057 8E77 53                                   .byte mne_ldyx        ; $BC  LDY abs,X
   5058 8E78 01                                   .byte mne_ldax        ; $BD  LDA abs,X
   5059 8E79 49                                   .byte mne_ldxx        ; $BE  LDX abs,Y
   5060 8E7A 01                                   .byte mne_ldax        ; $BF  LDA absl,X
                                        ;
   5062 8E7B 58                                   .byte mne_cpyx        ; $C0  CPY #
   5063 8E7C 35                                   .byte mne_cmpx        ; $C1  CMP (dp,X)
   5064 8E7D 31                                   .byte mne_repx        ; $C2  REP #
   5065 8E7E 35                                   .byte mne_cmpx        ; $C3  CMP offset,S
   5066 8E7F 58                                   .byte mne_cpyx        ; $C4  CPY dp
   5067 8E80 35                                   .byte mne_cmpx        ; $C5  CMP dp
   5068 8E81 12                                   .byte mne_decx        ; $C6  DEC dp
   5069 8E82 35                                   .byte mne_cmpx        ; $C7  CMP [dp]
   5070 8E83 57                                   .byte mne_inyx        ; $C8  INY
   5071 8E84 35                                   .byte mne_cmpx        ; $C9  CMP #
   5072 8E85 4A                                   .byte mne_dexx        ; $CA  DEX
   5073 8E86 20                                   .byte mne_waix        ; $CB  WAI
   5074 8E87 58                                   .byte mne_cpyx        ; $CC  CPY abs
   5075 8E88 35                                   .byte mne_cmpx        ; $CD  CMP abs
   5076 8E89 12                                   .byte mne_decx        ; $CE  DEC abs
   5077 8E8A 35                                   .byte mne_cmpx        ; $CF  CMP absl
                                        ;
   5079 8E8B 1F                                   .byte mne_bnex        ; $D0  BNE abs
   5080 8E8C 35                                   .byte mne_cmpx        ; $D1  CMP (dp),Y
   5081 8E8D 35                                   .byte mne_cmpx        ; $D2  CMP (dp)
   5082 8E8E 35                                   .byte mne_cmpx        ; $D3  CMP (offset,S),Y
   5083 8E8F 21                                   .byte mne_peix        ; $D4  PEI dp
   5084 8E90 35                                   .byte mne_cmpx        ; $D5  CMP dp,X
   5085 8E91 12                                   .byte mne_decx        ; $D6  DEC dp,X
   5086 8E92 35                                   .byte mne_cmpx        ; $D7  CMP [dp],Y
   5087 8E93 1B                                   .byte mne_cldx        ; $D8  CLD
   5088 8E94 35                                   .byte mne_cmpx        ; $D9  CMP abs,Y
   5089 8E95 4B                                   .byte mne_phxx        ; $DA  PHX
   5090 8E96 39                                   .byte mne_stpx        ; $DB  STP
   5091 8E97 36                                   .byte mne_jmpx        ; $DC  JMP [abs]
   5092 8E98 35                                   .byte mne_cmpx        ; $DD  CMP abs,X
   5093 8E99 12                                   .byte mne_decx        ; $DE  DEC abs,X
   5094 8E9A 35                                   .byte mne_cmpx        ; $DF  CMP absl,X
                                        ;
   5096 8E9B 4E                                   .byte mne_cpxx        ; $E0  CPX #
   5097 8E9C 0E                                   .byte mne_sbcx        ; $E1  SBC (dp,X)
   5098 8E9D 32                                   .byte mne_sepx        ; $E2  SEP #
   5099 8E9E 0E                                   .byte mne_sbcx        ; $E3  SBC offset,S
   5100 8E9F 4E                                   .byte mne_cpxx        ; $E4  CPX dp
   5101 8EA0 0E                                   .byte mne_sbcx        ; $E5  SBC dp
   5102 8EA1 15                                   .byte mne_incx        ; $E6  INC dp
   5103 8EA2 0E                                   .byte mne_sbcx        ; $E7  SBC [dp]
   5104 8EA3 4D                                   .byte mne_inxx        ; $E8  INX
   5105 8EA4 0E                                   .byte mne_sbcx        ; $E9  SBC #
   5106 8EA5 38                                   .byte mne_nopx        ; $EA  NOP
   5107 8EA6 00                                   .byte mne_xbax        ; $EB  XBA
   5108 8EA7 4E                                   .byte mne_cpxx        ; $EC  CPX abs
   5109 8EA8 0E                                   .byte mne_sbcx        ; $ED  SBC abs
   5110 8EA9 15                                   .byte mne_incx        ; $EE  INC abs
   5111 8EAA 0E                                   .byte mne_sbcx        ; $EF  SBC absl
                                        ;
   5113 8EAB 3B                                   .byte mne_beqx        ; $F0  BEQ abs
   5114 8EAC 0E                                   .byte mne_sbcx        ; $F1  SBC (dp),Y
   5115 8EAD 0E                                   .byte mne_sbcx        ; $F2  SBC (dp)
   5116 8EAE 0E                                   .byte mne_sbcx        ; $F3  SBC (offset,S),Y
   5117 8EAF 02                                   .byte mne_peax        ; $F4  PEA #
   5118 8EB0 0E                                   .byte mne_sbcx        ; $F5  SBC dp,X
   5119 8EB1 15                                   .byte mne_incx        ; $F6  INC dp,X
   5120 8EB2 0E                                   .byte mne_sbcx        ; $F7  SBC [dp],Y
   5121 8EB3 19                                   .byte mne_sedx        ; $F8  SED
   5122 8EB4 0E                                   .byte mne_sbcx        ; $F9  SBC abs,Y
   5123 8EB5 4C                                   .byte mne_plxx        ; $FA  PLX
   5124 8EB6 1E                                   .byte mne_xcex        ; $FB  XCE
   5125 8EB7 3F                                   .byte mne_jsrx        ; $FC  JSR (abs,X)
   5126 8EB8 0E                                   .byte mne_sbcx        ; $FD  SBC abs,X
   5127 8EB9 15                                   .byte mne_incx        ; $FE  INC abs,X
   5128 8EBA 0E                                   .byte mne_sbcx        ; $FF  SBC absl,X
                                        ;
                                        ;
                                        ;	instruction addressing modes & sizes in opcode order...
                                        ;
                                        ;	    xxxxxxxx
                                        ;	    ||||||||
                                        ;	    ||||++++———> Addressing Mode
                                        ;	    ||||         ——————————————————————————————————
                                        ;	    ||||          0000  dp, abs, absl, implied or A
                                        ;	    ||||          0001  #
                                        ;	    ||||          0010  dp,X, abs,X or absl,X
                                        ;	    ||||          0011  dp,Y or abs,Y
                                        ;	    ||||          0100  (dp) or (abs)
                                        ;	    ||||          0101  [dp] or [abs]
                                        ;	    ||||          0110  [dp],Y
                                        ;	    ||||          0111  (dp,X) or (abs,X)
                                        ;	    ||||          1000  (dp),Y
                                        ;	    ||||          1001  offset,S
                                        ;	    ||||          1010  (offset,S),Y
                                        ;	    ||||          1011  sbnk,dbnk (MVN or MVP)
                                        ;	    ||||          —-—-—-—-—-—-—-—-—-—-—-—-—-—-—-—-—
                                        ;	    ||||           #    = immediate
                                        ;	    ||||           A    = accumulator
                                        ;	    ||||           abs  = absolute
                                        ;	    ||||           absl = absolute long
                                        ;	    ||||           dbnk = destination bank
                                        ;	    ||||           dp   = direct (zero) page
                                        ;	    ||||           S    = stack relative
                                        ;	    ||||           sbnk = source bank
                                        ;	    ||||         ——————————————————————————————————
                                        ;	    ||||
                                        ;	    ||++———————> binary-encoded operand size
                                        ;	    |+—————————> 1: relative branch instruction
                                        ;	    +——————————> 1: variable operand size...
                                        ;
                                        ;	    —————————————————————————————————————————————————————————————
                                        ;	    Variable operand size refers to an immediate mode instruction
                                        ;	    that can accept either an 8 or 16 bit operand.  During instr-
                                        ;	    uction assembly, an 8 bit operand can be forced to 16 bits by
                                        ;	    preceding the operand field with !,  e.g.,  LDA !#$01,  which
                                        ;	    will assemble as $A9 $01 $00.
                                        ;	    —————————————————————————————————————————————————————————————
                                        ;
   5172 8EBB 00                         mnetabam .byte ops0 | am_nam   ; $00  BRK
   5173 8EBC 17                                   .byte ops1 | am_indx  ; $01  ORA (dp,X)
   5174 8EBD 10                                   .byte ops1 | am_nam   ; $02  COP
   5175 8EBE 19                                   .byte ops1 | am_stk   ; $03  ORA offset,S
   5176 8EBF 10                                   .byte ops1 | am_nam   ; $04  TSB dp
   5177 8EC0 10                                   .byte ops1 | am_nam   ; $05  ORA dp
   5178 8EC1 10                                   .byte ops1 | am_nam   ; $06  ASL dp
   5179 8EC2 15                                   .byte ops1 | am_indl  ; $07  ORA [dp]
   5180 8EC3 00                                   .byte ops0 | am_nam   ; $08  PHP
   5181 8EC4 91                                   .byte vops | am_imm   ; $09  ORA #
   5182 8EC5 00                                   .byte ops0 | am_nam   ; $0A  ASL A
   5183 8EC6 00                                   .byte ops0 | am_nam   ; $0B  PHD
   5184 8EC7 20                                   .byte ops2 | am_nam   ; $0C  TSB abs
   5185 8EC8 20                                   .byte ops2 | am_nam   ; $0D  ORA abs
   5186 8EC9 20                                   .byte ops2 | am_nam   ; $0E  ASL abs
   5187 8ECA 30                                   .byte ops3 | am_nam   ; $0F  ORA absl
                                        ;
   5189 8ECB 50                                   .byte bop1 | am_nam   ; $10  BPL abs
   5190 8ECC 18                                   .byte ops1 | am_indy  ; $11  ORA (dp),Y
   5191 8ECD 14                                   .byte ops1 | am_ind   ; $12  ORA (dp)
   5192 8ECE 1A                                   .byte ops1 | am_stky  ; $13  ORA (offset,S),Y
   5193 8ECF 10                                   .byte ops1 | am_nam   ; $14  TRB dp
   5194 8ED0 12                                   .byte ops1 | am_adrx  ; $15  ORA dp,X
   5195 8ED1 12                                   .byte ops1 | am_adrx  ; $16  ASL dp,X
   5196 8ED2 16                                   .byte ops1 | am_indly ; $17  ORA [dp],Y
   5197 8ED3 00                                   .byte ops0 | am_nam   ; $18  CLC
   5198 8ED4 20                                   .byte ops2 | am_nam   ; $19  ORA abs
   5199 8ED5 00                                   .byte ops0 | am_nam   ; $1A  INC A
   5200 8ED6 00                                   .byte ops0 | am_nam   ; $1B  TCS
   5201 8ED7 20                                   .byte ops2 | am_nam   ; $1C  TRB abs
   5202 8ED8 22                                   .byte ops2 | am_adrx  ; $1D  ORA abs,X
   5203 8ED9 22                                   .byte ops2 | am_adrx  ; $1E  ASL abs,X
   5204 8EDA 32                                   .byte ops3 | am_adrx  ; $1F  ORA absl,X
                                        ;
   5206 8EDB 20                                   .byte ops2 | am_nam   ; $20  JSR abs
   5207 8EDC 17                                   .byte ops1 | am_indx  ; $21  AND (dp,X)
   5208 8EDD 30                                   .byte ops3 | am_nam   ; $22  JSL absl
   5209 8EDE 19                                   .byte ops1 | am_stk   ; $23  AND offset,S
   5210 8EDF 10                                   .byte ops1 | am_nam   ; $24  BIT dp
   5211 8EE0 10                                   .byte ops1 | am_nam   ; $25  AND dp
   5212 8EE1 10                                   .byte ops1 | am_nam   ; $26  ROL dp
   5213 8EE2 15                                   .byte ops1 | am_indl  ; $27  AND [dp]
   5214 8EE3 00                                   .byte ops0 | am_nam   ; $28  PLP
   5215 8EE4 91                                   .byte vops | am_imm   ; $29  AND #
   5216 8EE5 00                                   .byte ops0 | am_nam   ; $2A  ROL A
   5217 8EE6 00                                   .byte ops0 | am_nam   ; $2B  PLD
   5218 8EE7 20                                   .byte ops2 | am_nam   ; $2C  BIT abs
   5219 8EE8 20                                   .byte ops2 | am_nam   ; $2D  AND abs
   5220 8EE9 20                                   .byte ops2 | am_nam   ; $2E  ROL abs
   5221 8EEA 30                                   .byte ops3 | am_nam   ; $2F  AND absl
                                        ;
   5223 8EEB 50                                   .byte bop1 | am_nam   ; $30  BMI abs
   5224 8EEC 18                                   .byte ops1 | am_indy  ; $31  AND (dp),Y
   5225 8EED 14                                   .byte ops1 | am_ind   ; $32  AND (dp)
   5226 8EEE 1A                                   .byte ops1 | am_stky  ; $33  AND (offset,S),Y
   5227 8EEF 12                                   .byte ops1 | am_adrx  ; $34  BIT dp,X
   5228 8EF0 12                                   .byte ops1 | am_adrx  ; $35  AND dp,X
   5229 8EF1 12                                   .byte ops1 | am_adrx  ; $36  ROL dp,X
   5230 8EF2 16                                   .byte ops1 | am_indly ; $37  AND [dp],Y
   5231 8EF3 00                                   .byte ops0 | am_nam   ; $38  SEC
   5232 8EF4 23                                   .byte ops2 | am_adry  ; $39  AND abs,Y
   5233 8EF5 00                                   .byte ops0 | am_nam   ; $3A  DEC A
   5234 8EF6 00                                   .byte ops0 | am_nam   ; $3B  TSC
   5235 8EF7 22                                   .byte ops2 | am_adrx  ; $3C  BIT abs,X
   5236 8EF8 22                                   .byte ops2 | am_adrx  ; $3D  AND abs,X
   5237 8EF9 22                                   .byte ops2 | am_adrx  ; $3E  ROL abs,X
   5238 8EFA 32                                   .byte ops3 | am_adrx  ; $3F  AND absl,X
                                        ;
   5240 8EFB 00                                   .byte ops0 | am_nam   ; $40  RTI
   5241 8EFC 17                                   .byte ops1 | am_indx  ; $41  EOR (dp,X)
   5242 8EFD 00                                   .byte ops0 | am_nam   ; $42  WDM
   5243 8EFE 19                                   .byte ops1 | am_stk   ; $43  EOR offset,S
   5244 8EFF 2B                                   .byte ops2 | am_move  ; $44  MVP sb,db
   5245 8F00 10                                   .byte ops1 | am_nam   ; $45  EOR dp
   5246 8F01 10                                   .byte ops1 | am_nam   ; $46  LSR dp
   5247 8F02 15                                   .byte ops1 | am_indl  ; $47  EOR [dp]
   5248 8F03 00                                   .byte ops0 | am_nam   ; $48  PHA
   5249 8F04 91                                   .byte vops | am_imm   ; $49  EOR #
   5250 8F05 00                                   .byte ops0 | am_nam   ; $4A  LSR A
   5251 8F06 00                                   .byte ops0 | am_nam   ; $4B  PHK
   5252 8F07 20                                   .byte ops2 | am_nam   ; $4C  JMP abs
   5253 8F08 20                                   .byte ops2 | am_nam   ; $4D  EOR abs
   5254 8F09 20                                   .byte ops2 | am_nam   ; $4E  LSR abs
   5255 8F0A 30                                   .byte ops3 | am_nam   ; $4F  EOR absl
                                        ;
   5257 8F0B 50                                   .byte bop1 | am_nam   ; $50  BVC abs
   5258 8F0C 18                                   .byte ops1 | am_indy  ; $51  EOR (dp),Y
   5259 8F0D 14                                   .byte ops1 | am_ind   ; $52  EOR (dp)
   5260 8F0E 1A                                   .byte ops1 | am_stky  ; $53  EOR (offset,S),Y
   5261 8F0F 2B                                   .byte ops2 | am_move  ; $54  MVN sb,db
   5262 8F10 12                                   .byte ops1 | am_adrx  ; $55  EOR dp,X
   5263 8F11 12                                   .byte ops1 | am_adrx  ; $56  LSR dp,X
   5264 8F12 16                                   .byte ops1 | am_indly ; $57  EOR [dp],Y
   5265 8F13 00                                   .byte ops0 | am_nam   ; $58  CLI
   5266 8F14 23                                   .byte ops2 | am_adry  ; $59  EOR abs,Y
   5267 8F15 00                                   .byte ops0 | am_nam   ; $5A  PHY
   5268 8F16 00                                   .byte ops0 | am_nam   ; $5B  TCD
   5269 8F17 30                                   .byte ops3 | am_nam   ; $5C  JML absl
   5270 8F18 22                                   .byte ops2 | am_adrx  ; $5D  EOR abs,X
   5271 8F19 22                                   .byte ops2 | am_adrx  ; $5E  LSR abs,X
   5272 8F1A 32                                   .byte ops3 | am_adrx  ; $5F  EOR absl,X
                                        ;
   5274 8F1B 00                                   .byte ops0 | am_nam   ; $60  RTS
   5275 8F1C 17                                   .byte ops1 | am_indx  ; $61  ADC (dp,X)
   5276 8F1D 60                                   .byte bop2 | am_nam   ; $62  PER
   5277 8F1E 19                                   .byte ops1 | am_stk   ; $63  ADC offset,S
   5278 8F1F 10                                   .byte ops1 | am_nam   ; $64  STZ dp
   5279 8F20 10                                   .byte ops1 | am_nam   ; $65  ADC dp
   5280 8F21 10                                   .byte ops1 | am_nam   ; $66  ROR dp
   5281 8F22 15                                   .byte ops1 | am_indl  ; $67  ADC [dp]
   5282 8F23 00                                   .byte ops0 | am_nam   ; $68  PLA
   5283 8F24 91                                   .byte vops | am_imm   ; $69  ADC #
   5284 8F25 00                                   .byte ops0 | am_nam   ; $6A  ROR A
   5285 8F26 00                                   .byte ops0 | am_nam   ; $6B  RTL
   5286 8F27 24                                   .byte ops2 | am_ind   ; $6C  JMP (abs)
   5287 8F28 20                                   .byte ops2 | am_nam   ; $6D  ADC abs
   5288 8F29 20                                   .byte ops2 | am_nam   ; $6E  ROR abs
   5289 8F2A 30                                   .byte ops3 | am_nam   ; $6F  ADC absl
                                        ;
   5291 8F2B 50                                   .byte bop1 | am_nam   ; $70  BVS abs
   5292 8F2C 18                                   .byte ops1 | am_indy  ; $71  ADC (dp),Y
   5293 8F2D 14                                   .byte ops1 | am_ind   ; $72  ADC (dp)
   5294 8F2E 1A                                   .byte ops1 | am_stky  ; $73  ADC (offset,S),Y
   5295 8F2F 12                                   .byte ops1 | am_adrx  ; $74  STZ dp,X
   5296 8F30 12                                   .byte ops1 | am_adrx  ; $75  ADC dp,X
   5297 8F31 12                                   .byte ops1 | am_adrx  ; $76  ROR dp,X
   5298 8F32 16                                   .byte ops1 | am_indly ; $77  ADC [dp],Y
   5299 8F33 00                                   .byte ops0 | am_nam   ; $78  SEI
   5300 8F34 23                                   .byte ops2 | am_adry  ; $79  ADC abs,Y
   5301 8F35 00                                   .byte ops0 | am_nam   ; $7A  PLY
   5302 8F36 00                                   .byte ops0 | am_nam   ; $7B  TDC
   5303 8F37 27                                   .byte ops2 | am_indx  ; $7C  JMP (abs,X)
   5304 8F38 22                                   .byte ops2 | am_adrx  ; $7D  ADC abs,X
   5305 8F39 22                                   .byte ops2 | am_adrx  ; $7E  ROR abs,X
   5306 8F3A 32                                   .byte ops3 | am_adrx  ; $7F  ADC absl,X
                                        ;
   5308 8F3B 50                                   .byte bop1 | am_nam   ; $80  BRA abs
   5309 8F3C 17                                   .byte ops1 | am_indx  ; $81  STA (dp,X)
   5310 8F3D 60                                   .byte bop2 | am_nam   ; $82  BRL abs
   5311 8F3E 19                                   .byte ops1 | am_stk   ; $83  STA offset,S
   5312 8F3F 10                                   .byte ops1 | am_nam   ; $84  STY dp
   5313 8F40 10                                   .byte ops1 | am_nam   ; $85  STA dp
   5314 8F41 10                                   .byte ops1 | am_nam   ; $86  STX dp
   5315 8F42 15                                   .byte ops1 | am_indl  ; $87  STA [dp]
   5316 8F43 00                                   .byte ops0 | am_nam   ; $88  DEY
   5317 8F44 91                                   .byte vops | am_imm   ; $89  BIT #
   5318 8F45 00                                   .byte ops0 | am_nam   ; $8A  TXA
   5319 8F46 00                                   .byte ops0 | am_nam   ; $8B  PHB
   5320 8F47 20                                   .byte ops2 | am_nam   ; $8C  STY abs
   5321 8F48 20                                   .byte ops2 | am_nam   ; $8D  STA abs
   5322 8F49 20                                   .byte ops2 | am_nam   ; $8E  STX abs
   5323 8F4A 30                                   .byte ops3 | am_nam   ; $8F  STA absl
                                        ;
   5325 8F4B 50                                   .byte bop1 | am_nam   ; $90  BCC abs
   5326 8F4C 18                                   .byte ops1 | am_indy  ; $91  STA (dp),Y
   5327 8F4D 14                                   .byte ops1 | am_ind   ; $92  STA (dp)
   5328 8F4E 1A                                   .byte ops1 | am_stky  ; $93  STA (offset,S),Y
   5329 8F4F 12                                   .byte ops1 | am_adrx  ; $94  STY dp,X
   5330 8F50 12                                   .byte ops1 | am_adrx  ; $95  STA dp,X
   5331 8F51 13                                   .byte ops1 | am_adry  ; $96  STX dp,Y
   5332 8F52 16                                   .byte ops1 | am_indly ; $97  STA [dp],Y
   5333 8F53 00                                   .byte ops0 | am_nam   ; $98  TYA
   5334 8F54 23                                   .byte ops2 | am_adry  ; $99  STA abs,Y
   5335 8F55 00                                   .byte ops0 | am_nam   ; $9A  TXS
   5336 8F56 00                                   .byte ops0 | am_nam   ; $9B  TXY
   5337 8F57 20                                   .byte ops2 | am_nam   ; $9C  STZ abs
   5338 8F58 22                                   .byte ops2 | am_adrx  ; $9D  STA abs,X
   5339 8F59 22                                   .byte ops2 | am_adrx  ; $9E  STZ abs,X
   5340 8F5A 32                                   .byte ops3 | am_adrx  ; $9F  STA absl,X
                                        ;
   5342 8F5B 91                                   .byte vops | am_imm   ; $A0  LDY #
   5343 8F5C 17                                   .byte ops1 | am_indx  ; $A1  LDA (dp,X)
   5344 8F5D 91                                   .byte vops | am_imm   ; $A2  LDX #
   5345 8F5E 19                                   .byte ops1 | am_stk   ; $A3  LDA offset,S
   5346 8F5F 10                                   .byte ops1 | am_nam   ; $A4  LDY dp
   5347 8F60 10                                   .byte ops1 | am_nam   ; $A5  LDA dp
   5348 8F61 10                                   .byte ops1 | am_nam   ; $A6  LDX dp
   5349 8F62 15                                   .byte ops1 | am_indl  ; $A7  LDA [dp]
   5350 8F63 00                                   .byte ops0 | am_nam   ; $A8  TAY
   5351 8F64 91                                   .byte vops | am_imm   ; $A9  LDA #
   5352 8F65 00                                   .byte ops0 | am_nam   ; $AA  TAX
   5353 8F66 00                                   .byte ops0 | am_nam   ; $AB  PLB
   5354 8F67 20                                   .byte ops2 | am_nam   ; $AC  LDY abs
   5355 8F68 20                                   .byte ops2 | am_nam   ; $AD  LDA abs
   5356 8F69 20                                   .byte ops2 | am_nam   ; $AE  LDX abs
   5357 8F6A 30                                   .byte ops3 | am_nam   ; $AF  LDA absl
                                        ;
   5359 8F6B 50                                   .byte bop1 | am_nam   ; $B0  BCS abs
   5360 8F6C 18                                   .byte ops1 | am_indy  ; $B1  LDA (dp),Y
   5361 8F6D 14                                   .byte ops1 | am_ind   ; $B2  LDA (dp)
   5362 8F6E 1A                                   .byte ops1 | am_stky  ; $B3  LDA (offset,S),Y
   5363 8F6F 12                                   .byte ops1 | am_adrx  ; $B4  LDY dp,X
   5364 8F70 12                                   .byte ops1 | am_adrx  ; $B5  LDA dp,X
   5365 8F71 13                                   .byte ops1 | am_adry  ; $B6  LDX dp,Y
   5366 8F72 16                                   .byte ops1 | am_indly ; $B7  LDA [dp],Y
   5367 8F73 00                                   .byte ops0 | am_nam   ; $B8  CLV
   5368 8F74 23                                   .byte ops2 | am_adry  ; $B9  LDA abs,Y
   5369 8F75 00                                   .byte ops0 | am_nam   ; $BA  TSX
   5370 8F76 00                                   .byte ops0 | am_nam   ; $BB  TYX
   5371 8F77 22                                   .byte ops2 | am_adrx  ; $BC  LDY abs,X
   5372 8F78 22                                   .byte ops2 | am_adrx  ; $BD  LDA abs,X
   5373 8F79 23                                   .byte ops2 | am_adry  ; $BE  LDX abs,Y
   5374 8F7A 32                                   .byte ops3 | am_adrx  ; $BF  LDA absl,X
                                        ;
   5376 8F7B 91                                   .byte vops | am_imm   ; $C0  CPY #
   5377 8F7C 17                                   .byte ops1 | am_indx  ; $C1  CMP (dp,X)
   5378 8F7D 11                                   .byte ops1 | am_imm   ; $C2  REP #
   5379 8F7E 19                                   .byte ops1 | am_stk   ; $C3  CMP offset,S
   5380 8F7F 10                                   .byte ops1 | am_nam   ; $C4  CPY dp
   5381 8F80 10                                   .byte ops1 | am_nam   ; $C5  CMP dp
   5382 8F81 10                                   .byte ops1 | am_nam   ; $C6  DEC dp
   5383 8F82 15                                   .byte ops1 | am_indl  ; $C7  CMP [dp]
   5384 8F83 00                                   .byte ops0 | am_nam   ; $C8  INY
   5385 8F84 91                                   .byte vops | am_imm   ; $C9  CMP #
   5386 8F85 00                                   .byte ops0 | am_nam   ; $CA  DEX
   5387 8F86 00                                   .byte ops0 | am_nam   ; $CB  WAI
   5388 8F87 20                                   .byte ops2 | am_nam   ; $CC  CPY abs
   5389 8F88 20                                   .byte ops2 | am_nam   ; $CD  CMP abs
   5390 8F89 20                                   .byte ops2 | am_nam   ; $CE  DEC abs
   5391 8F8A 30                                   .byte ops3 | am_nam   ; $CF  CMP absl
                                        ;
   5393 8F8B 50                                   .byte bop1 | am_nam   ; $D0  BNE abs
   5394 8F8C 18                                   .byte ops1 | am_indy  ; $D1  CMP (dp),Y
   5395 8F8D 14                                   .byte ops1 | am_ind   ; $D2  CMP (dp)
   5396 8F8E 1A                                   .byte ops1 | am_stky  ; $D3  CMP (offset,S),Y
   5397 8F8F 10                                   .byte ops1 | am_nam   ; $D4  PEI dp
   5398 8F90 12                                   .byte ops1 | am_adrx  ; $D5  CMP dp,X
   5399 8F91 12                                   .byte ops1 | am_adrx  ; $D6  DEC dp,X
   5400 8F92 16                                   .byte ops1 | am_indly ; $D7  CMP [dp],Y
   5401 8F93 00                                   .byte ops0 | am_nam   ; $D8  CLD
   5402 8F94 23                                   .byte ops2 | am_adry  ; $D9  CMP abs,Y
   5403 8F95 00                                   .byte ops0 | am_nam   ; $DA  PHX
   5404 8F96 00                                   .byte ops0 | am_nam   ; $DB  STP
   5405 8F97 25                                   .byte ops2 | am_indl  ; $DC  JMP [abs]
   5406 8F98 22                                   .byte ops2 | am_adrx  ; $DD  CMP abs,X
   5407 8F99 22                                   .byte ops2 | am_adrx  ; $DE  DEC abs,X
   5408 8F9A 32                                   .byte ops3 | am_adrx  ; $DF  CMP absl,X
                                        ;
   5410 8F9B 91                                   .byte vops | am_imm   ; $E0  CPX #
   5411 8F9C 17                                   .byte ops1 | am_indx  ; $E1  SBC (dp,X)
   5412 8F9D 11                                   .byte ops1 | am_imm   ; $E2  SEP #
   5413 8F9E 19                                   .byte ops1 | am_stk   ; $E3  SBC offset,S
   5414 8F9F 10                                   .byte ops1 | am_nam   ; $E4  CPX dp
   5415 8FA0 10                                   .byte ops1 | am_nam   ; $E5  SBC dp
   5416 8FA1 10                                   .byte ops1 | am_nam   ; $E6  INC dp
   5417 8FA2 15                                   .byte ops1 | am_indl  ; $E7  SBC [dp]
   5418 8FA3 00                                   .byte ops0 | am_nam   ; $E8  INX
   5419 8FA4 91                                   .byte vops | am_imm   ; $E9  SBC #
   5420 8FA5 00                                   .byte ops0 | am_nam   ; $EA  NOP
   5421 8FA6 00                                   .byte ops0 | am_nam   ; $EB  XBA
   5422 8FA7 20                                   .byte ops2 | am_nam   ; $EC  CPX abs
   5423 8FA8 20                                   .byte ops2 | am_nam   ; $ED  SBC abs
   5424 8FA9 20                                   .byte ops2 | am_nam   ; $EE  INC abs
   5425 8FAA 30                                   .byte ops3 | am_nam   ; $EF  SBC absl
                                        ;
   5427 8FAB 50                                   .byte bop1 | am_nam   ; $F0  BEQ abs
   5428 8FAC 18                                   .byte ops1 | am_indy  ; $F1  SBC (dp),Y
   5429 8FAD 14                                   .byte ops1 | am_ind   ; $F2  SBC (dp)
   5430 8FAE 1A                                   .byte ops1 | am_stky  ; $F3  SBC (offset,S),Y
   5431 8FAF 21                                   .byte ops2 | am_imm   ; $F4  PEA #
   5432 8FB0 12                                   .byte ops1 | am_adrx  ; $F5  SBC dp,X
   5433 8FB1 12                                   .byte ops1 | am_adrx  ; $F6  INC dp,X
   5434 8FB2 16                                   .byte ops1 | am_indly ; $F7  SBC [dp],Y
   5435 8FB3 00                                   .byte ops0 | am_nam   ; $F8  SED
   5436 8FB4 23                                   .byte ops2 | am_adry  ; $F9  SBC abs,Y
   5437 8FB5 00                                   .byte ops0 | am_nam   ; $FA  PLX
   5438 8FB6 00                                   .byte ops0 | am_nam   ; $FB  XCE
   5439 8FB7 27                                   .byte ops2 | am_indx  ; $FC  JSR (abs,X)
   5440 8FB8 22                                   .byte ops2 | am_adrx  ; $FD  SBC abs,X
   5441 8FB9 22                                   .byte ops2 | am_adrx  ; $FE  INC abs,X
   5442 8FBA 32                                   .byte ops3 | am_adrx  ; $FF  SBC absl,X
                                        ;
                                        ;
                                        ;	.X & .Y immediate mode opcodes...
                                        ;
   5447 8FBB A0                         vopidx   .byte $a0             ;LDY #
   5448 8FBC A2                                   .byte $a2             ;LDX #
   5449 8FBD C0                                   .byte $c0             ;CPY #
   5450 8FBE E0                                   .byte $e0             ;CPX #
   5677 = 00000004                      n_vopidx =*-vopidx             ;number of opcodes
                                        ;
                                        ;
                                        ;	addressing mode symbology lookup...
                                        ;
   5456 8FBF D7 8F                      ms_lutab .word ms_nam          ;(0000)  no symbol
   5457 8FC1 E1 8F                                .word ms_imm          ;(0001)  #
   5458 8FC3 D9 8F                                .word ms_addrx        ;(0010)  dp,X or abs,X
   5459 8FC5 DD 8F                                .word ms_addry        ;(0011)  dp,Y or abs,Y
   5460 8FC7 E3 8F                                .word ms_ind          ;(0100)  (dp) or (abs)
   5461 8FC9 E6 8F                                .word ms_indl         ;(0101)  [dp] or [abs]
   5462 8FCB E9 8F                                .word ms_indly        ;(0110)  [dp],Y
   5463 8FCD EE 8F                                .word ms_indx         ;(0111)  (dp,X) or (abs,X)
   5464 8FCF F3 8F                                .word ms_indy         ;(1000)  (dp),Y
   5465 8FD1 FB 8F                                .word ms_stk          ;(1001)  offset,S
   5466 8FD3 FF 8F                                .word ms_stky         ;(1010) (offset,S),Y
   5467 8FD5 D7 8F                                .word ms_nam          ;(1011) sbnk,dbnk
                                        ;
                                        ;
                                        ;	addressing mode symbology strings...
                                        ;
   5472 8FD7 20 00                      ms_nam   .byte " ",0           ;no symbol
   5473 8FD9 20 2C 58 00                ms_addrx .byte " ,X",0         ;dp,X or addr,X
   5474 8FDD 20 2C 59 00                ms_addry .byte " ,Y",0         ;dp,Y or addr,Y
   5475 8FE1 23 00                      ms_imm   .byte "#",0           ;immediate
   5476 8FE3 28 29 00                   ms_ind   .byte "()",0          ;(dp) or (abs)
   5477 8FE6 5B 5D 00                   ms_indl  .byte "[]",0          ;[dp] or [abs]
   5478 8FE9 5B 5D 2C 59 00             ms_indly .byte "[],Y",0        ;[dp],Y
   5479 8FEE 28 2C 58 29 00             ms_indx  .byte "(,X)",0        ;(dp,X) or (abs,X)
   5480 8FF3 28 29 2C 59 00             ms_indy  .byte "(),Y",0        ;(dp),Y
   5481 8FF8 2C 24 00                   ms_move  .byte ",$",0          ;MVN/MVP sbnk,dbnk
   5482 8FFB 20 2C 53 00                ms_stk   .byte " ,S",0         ;offset,S
   5483 8FFF 28 2C 53 29 2C 59 00       ms_stky  .byte "(,S),Y",0      ;(offset,S),Y
   5484 9006 7B 7D 2C 59 00             ms_indxly	.byte "{},Y",0     ;{dp},Y
                                        ;
                                        ;================================================================================
                                        ;
                                        ;CONSOLE DISPLAY CONTROL STRINGS
                                        ;
   5490 900B 1B 28                      dc_bf +         .byte a_esc,"("
   5490 900D 1B 47 34                 +            .byte a_esc,"G4"
                                                            ;enable reverse foreground
   5491 9010 00                                   .byte 0
                                        ;
   5493 9011 08                         dc_bs +         .byte a_bs
   5493 9012 1B 57                    +   +         .byte a_esc,"W"
                                        
                                                            ;destructive backspace
   5495 9014 00                                   .byte 0
                                        ;
   5497 9015 1B 54                      dc_cl +         .byte a_esc,"T"
                                                            ;clear to end of line 
   5498 9017 00                                   .byte 0
                                        ;
   5500 9018 1B 60 31                   dc_cn +         .byte a_esc,"`1"
                                                            ;cursor on
   5501 901B 00                                   .byte 0
                                        ;
   5503 901C 1B 60 30                   dc_co +         .byte a_esc,"`0"
                                                            ;cursor off
   5504 901F 00                                   .byte 0
                                        ;
   5506 9020 1B 28                      dc_er +         .byte a_esc,"("
   5506 9022 1B 47 30                 +            .byte a_esc,"G0"
                                                            ;enable normal foreground
   5507 9025 00                                   .byte 0
                                        ;
   5509 9026 0D                         dc_lf ++         .byte a_cr
                                     +   
   5509 9027 0A                       +            .byte a_lf
                                                            ;newline
   5510 9028 00                                   .byte 0
                                        ;
                                        ;================================================================================
                                        ;
                                        ;TEXT STRINGS
                                        ;
   5516 9029 07                         mm_brk +         .byte a_bel
                                        
   5517 902A 0D                       +   +         .byte a_cr
                                     +   
   5517 902B 0A                       +            .byte a_lf
                                        
   5518 902C 2A 2A 42 52 4B                       .byte "**BRK"
   5519 9031 0D                       +   +         .byte a_cr
                                     +   
   5519 9032 0A                       +            .byte a_lf
                                        
   5520 9033 00                                   .byte 0
                                        ;
   5522 9034 0D                         mm_entry ++         .byte a_cr
                                     +   
   5522 9035 0A                       +            .byte a_lf
                                        
   5523 9036 0A 53 75 70 65 72 6D 6F              .byte a_lf,"Supermon 832 "
   5523 903E 6E 20 38 33 32 20         
   5524 9044 31                       +            .byte "1"
   5524 9045 2E                       +            .byte "."
   5524 9046 30                       +            .byte "0"
   5524 9047 2E                       +            .byte "."
   5524 9048 30                       +            .byte "0"
                                        
   5525 9049 20                                   .byte " "
   5526 904A 0D                       +   +         .byte a_cr
                                     +   
   5526 904B 0A                       +            .byte a_lf
                                        
   5527 904C 00                                   .byte 0
                                        ;
   5529 904D 20 2A 2A 45 52 52 20 20    mm_err   .byte " **ERR  ",0
   5529 9055 00                        
                                        ;
   5531 9056 0D                         mm_prmpt ++         .byte a_cr
                                     +   
   5531 9057 0A                       +            .byte a_lf
                                        
   5532 9058 1B 28                    +            .byte a_esc,"("
   5532 905A 1B 47 30                 +            .byte a_esc,"G0"
                                        
   5533 905D 2E 00                                .byte ".",0
                                        ;
   5535 905F 0D                         mm_regs ++         .byte a_cr
                                     +   
   5535 9060 0A                       +            .byte a_lf
                                        
   5536 9061 20 20 20 20 20 20 20 20              .byte "                    31"
   5536 9069 20 20 20 20 20 20 20 20   
   5536 9071 20 20 20 20 33 31         
   5537 9077 0D                       +   +         .byte a_cr
                                     +   
   5537 9078 0A                       +            .byte a_lf
                                        
   5538 9079 20 20 20 43 53 20 20 50              .byte "   CS  PB  PC   26NVmxDIZC    .A       .X       .Y       SP  "
   5538 9081 42 20 20 50 43 20 20 20   
   5538 9089 32 36 4E 56 6D 78 44 49   
   5538 9091 5A 43 20 20 20 20 2E 41   
   5538 9099 20 20 20 20 20 20 20 2E   
   5538 90A1 58 20 20 20 20 20 20 20   
   5538 90A9 2E 59 20 20 20 20 20 20   
   5538 90B1 20 53 50 20 20            
   5539 90B6 0D                       +   +         .byte a_cr
                                     +   
   5539 90B7 0A                       +            .byte a_lf
                                        
   5540 90B8 3B 20 00                             .byte "; ",0
   5541 90BB 0D                         mm_regs2 ++         .byte a_cr
                                     +   
   5541 90BC 0A                       +            .byte a_lf
                                        
   5542 90BD 20 20 20 44 53 20 20 20              .byte "   DS   SS  DP  DB"
   5542 90C5 53 53 20 20 44 50 20 20   
   5542 90CD 44 42                     
   5543 90CF 0D                       +   +         .byte a_cr
                                     +   
   5543 90D0 0A                       +            .byte a_lf
                                        
   5544 90D1 3B 20 00                             .byte "; ",0
                                        ;
   5546 90D4 07                         mm_rts +         .byte a_bel
                                        
   5547 90D5 0D                       +   +         .byte a_cr
                                     +   
   5547 90D6 0A                       +            .byte a_lf
                                        
   5548 90D7 2A 2A 52 54 53                       .byte "**RTS"
   5549 90DC 0D                       +   +         .byte a_cr
                                     +   
   5549 90DD 0A                       +            .byte a_lf
                                        
   5550 90DE 00                                   .byte 0
                                        ;
                                        ;================================================================================
                                        ;
                                        ;VECTOR STORAGE
                                        ;
                                        ;
   5853 = 000090DF                      _txtend_ =*                     ;end of program text
                                        ;
                                        ;================================================================================
                                        	;.end
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FTBios816.asm


                                        .include "supermon832.asm"
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FAC1ToString.asm

                                        ; ============================================================================
                                        ; FAC1ToString.asm
                                        ;        __
                                        ;   \\__/ o\    (C) 2014  Robert Finch, Stratford
                                        ;    \  __ /    All rights reserved.
                                        ;     \/_//     robfinch<remove>@finitron.ca
                                        ;       ||
                                        ;  
                                        ;
                                        ; This source file is free software: you can redistribute it and/or modify 
                                        ; it under the terms of the GNU Lesser General Public License as published 
                                        ; by the Free Software Foundation, either version 3 of the License, or     
                                        ; (at your option) any later version.                                      
                                        ;                                                                          
                                        ; This source file is distributed in the hope that it will be useful,      
                                        ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                        ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                        ; GNU General Public License for more details.                             
                                        ;                                                                          
                                        ; You should have received a copy of the GNU General Public License        
                                        ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                        ;                                                                          
                                        ; ============================================================================
                                        ;
                                        ; This code is a heavily modified version of the floating point to string
                                        ; conversion routine which is a part of Lee Davison's EhBASIC.
                                        ;
   5885 = 00000000000000C6                            Cvaral		= $C6		; current var address low byte
   5886 = 000000C7                      Cvarah		= Cvaral+1	; current var address high byte
   5887 = 00000000000000C0                            numexp		= $C0		; string to float number exponent count
   5888 = 00000000000000C2                            expcnt		= $C2		; string to float exponent count
   5889 = 00000000000000C4                            Sendl			= $C4	; BASIC pointer temp low byte
   5890 = 00000000000000C5                            Sendh			= $C5	; BASIC pointer temp low byte
                                        
   5892 = 00000000000003A0                            Decss		= $3A0		; number to decimal string start
   5893 = 000003A1                      Decssp1		= Decss+1	; number to decimal string start
   5894 = 0000000000000001                            FP_ADD		EQU		1
   5895 = 0000000000000002                            FP_SUB		EQU		2
   5896 = 0000000000000003                            FP_MUL		EQU		3
   5897 = 0000000000000004                            FP_DIV		EQU		4
   5898 = 0000000000000005                            FP_FIX2FLT	EQU		5
   5899 = 0000000000000006                            FP_FLT2FIX	EQU		6
   5900 = 0000000000000007                            FP_ABS		EQU		7
   5901 = 0000000000000010                            FP_NEG		EQU		16
   5902 = 0000000000000011                            FP_SWAP		EQU		17
   5903 = 0000000000000083                            FIXED_MUL	EQU		$83
   5904 = 0000000000000081                            FIXED_ADD	EQU		$81
   5905 = 0000000000000082                            FIXED_SUB	EQU		$82
                                        ;parameter FIXED_DIV = 8'h84;
                                        ;parameter FIXED_ABS = 8'h87;
                                        ;parameter FIXED_NEG = 8'h90;
   5909 = 0000000000FEA20E                            FP_CMDREG	EQU		$FEA20E
   5910 = 0000000000FEA20E                            FP_STATREG	EQU		$FEA20E
   5911 = 0000000000FEA200                            FAC1		EQU		$FEA200
   5912 = 0000000000FEA200                            FAC1_5		EQU		$FEA200
   5913 = 0000000000FEA202                            FAC1_4		EQU		$FEA202
   5914 = 0000000000FEA204                            FAC1_3		EQU		$FEA204
   5915 = 0000000000FEA206                            FAC1_2		EQU		$FEA206
   5916 = 0000000000FEA208                            FAC1_1		EQU		$FEA208
   5917 = 0000000000FEA208                            FAC1_msw	EQU		$FEA208
   5918 = 0000000000FEA20A                            FAC1_e		EQU		$FEA20A
   5919 = 0000000000FEA210                            FAC2		EQU		$FEA210
                                        
                                           	CPU		W65C816S
                                           	NDX		16
                                           	MEM		16
                                           	
                                           public FAC1ToString:
                                           
                                           ; The first chunk of code determines if the number is positive or negative
                                           ; and spits out the appropriate sign. Next it takes the absolute value of
                                           ; the accumulator so following code only has to deal with positive numbers.
                                           
   5635 0090DF A0 00 00                     	LDY	#$00			; set index = 1
   5636 0090E2 AF 08 A2 FE                  	LDA	FAC1_msw		; test FAC1 sign (b15) (Can't use BIT)
   5637 0090E6 10 0E                        	BPL	.0002		; branch if +ve
   5638 0090E8 A9 2D 00                     	LDA	#'-'			; else character = "-"
   5639 0090EB 99 A0 03                     	STA	Decss,Y		; save leading character (" " or "-")
   5640 0090EE A9 10 00                     	LDA	#FP_NEG		; make the FAC positive
   5641 0090F1 20 18 93                     	JSR	FPCommandWait
   5642 0090F4 80 06                        	BRA	.0001
   5643 0090F6                             .0002:
   5644 0090F6 A9 20 00                     	LDA	#$20			; character = " " (assume +ve)
   5645 0090F9 99 A0 03                     	STA	Decss,Y
   5646 0090FC                             .0001:
   5647 0090FC 84 C4                        	STY	Sendl			; save index
                                           
                                           ; This little bit of code check for a zero exponent which indicates a
                                           ; value of zero.
                                           
   5652 0090FE AF 0A A2 FE                  	LDA	FAC1_e		; get FAC1 exponent
   5653 009102 AA                           	TAX
   5654 009103 D0 06                        	BNE	LAB_2989		; branch if FAC1<>0
                                           					; exponent was $00 so FAC1 is 0
   5656 009105 A9 30 00                     	LDA	#'0'			; set character = "0"
   5657 009108 82 93 01                     	BRL	LAB_2A89		; save last character, [EOT] and exit
                                           
                                           ; This loop attempts to make small values more significant, so that there are
                                           ; fewer leading zeros in the value. (The exponent is decremented so that it
                                           ; corresponds). Because of the potential for extremely small values looping is
                                           ; limited. The problem is the 16 bit exponent can allow for much smaller
                                           ; values than an 8 bit exponent would and we don't want to loop for thousands
                                           ; of iterations in order to display a value that's almost zero.
                                           
                                           					; FAC1 is some non zero value
   5667 00910B                             LAB_2989
   5668 00910B 84 C4                        	STY	Sendl			; save off .Y
   5669 00910D A0 67 06                     	LDY #1639			; max number of retries
   5670 009110 A9 00 00                     	LDA	#$00			; clear (number exponent count)
   5671 009113 85 C0                        	STA numexp
   5672 009115                             LOOP_MBMILLION:
   5673 009115 E0 00 80                     	CPX	#$8000			; compare FAC1 exponent with $8000 (>1.00000)
   5674 009118 B0 1A                        	BCS	LAB_299A		; branch if FAC1=>1
                                           					; FAC1<1
   5676 00911A F4 67 93                     	PEA	A_MILLION		; multiply FAC * 1,000,000
   5677 00911D 20 CD 92                     	JSR	LOAD_FAC2		; 
   5678 009120 68                           	PLA					; get rid of parameter
   5679 009121 20 C7 92                     	JSR	FMUL
   5680 009124 A5 C0                        	LDA numexp
   5681 009126 38                           	SEC
   5682 009127 E9 06 00                     	SBC	#6				; set number exponent count (-6)
   5683 00912A 85 C0                        	STA numexp
   5684 00912C AF 0A A2 FE                  	LDA FAC1_e
   5685 009130 AA                           	TAX
   5686 009131 88                           	DEY
   5687 009132 10 E1                        	BPL	LOOP_MBMILLION
                                           
   5689 009134                             LAB_299A
   5690 009134 A4 C4                        	LDY	Sendl		; get back .Y
                                           
                                           ; These two loops coerce the value of the FAC to be between 100,000 and
                                           ; 1,000,000. This gives a maximum of six digits before the decimal point
                                           ; in scientific notation.
                                           
                                           ; This loop divides by 10 until the value in the FAC is less than 1,000,000
                                           ;
   5698 009136                             LOOP_DB10:
   5699 009136 F4 7F 93                     	PEA	MAX_BEFORE_SCI	; set pointer low byte to 999999.4375 (max before sci note)
   5700 009139 20 CD 92                     	JSR	LOAD_FAC2		; compare FAC1 with (AY)
   5701 00913C 68                           	PLA					; get rid of parameter
   5702 00913D AF 0E A2 FE                  	LDA FP_CMDREG
   5703 009141 89 08 00                     	BIT	#$08			; test equals bit
   5704 009144 D0 28                        	BNE	LAB_29C3		; exit if FAC1 = (AY)
   5705 009146 89 04 00                     	BIT	#$04			; test greater than bit
   5706 009149 F0 07                        	BEQ	LOOP_MB10		; go do *10 if FAC1 < (AY)
                                           
   5708 00914B                             LAB_29B9
   5709 00914B 20 05 93                     	JSR	DivideByTen		; divide by 10
   5710 00914E E6 C0                        	INC	numexp			; increment number exponent count
   5711 009150 80 E4                        	BRA	LOOP_DB10		; go test again (branch always)
                                           
                                           ; This loop multiplies the value by 10 until it's greater than
                                           ; 100,000.
                                           					; FAC1 < (AY)
   5716 009152                             LOOP_MB10
   5717 009152 F4 97 93                     	PEA CONST_9375		; set pointer to 99999.9375
   5718 009155 20 CD 92                     	JSR	LOAD_FAC2		; compare FAC1 with (AY)
   5719 009158 68                           	PLA					; get rid of parameter
   5720 009159 AF 0E A2 FE                  	LDA FP_CMDREG
   5721 00915D 89 08 00                     	BIT #$08
   5722 009160 D0 05                        	BNE	LAB_29B2		; branch if FAC1 = (AY) (allow decimal places)
   5723 009162 89 04 00                     	BIT #$04
   5724 009165 D0 07                        	BNE	LAB_29C0		; branch if FAC1 > (AY) (no decimal places)
                                           					; FAC1 <= (AY)
   5726 009167                             LAB_29B2
   5727 009167 20 F8 92                     	JSR	MultiplyByTen	; multiply by 10
   5728 00916A C6 C0                        	DEC	numexp		; decrement number exponent count
   5729 00916C 80 E4                        	BRA	LOOP_MB10		; go test again (branch always)
                                           
                                           ; now we have just the digits to do
                                           
   5733 00916E                             LAB_29C0
                                           ;	JSR	AddPoint5		; add 0.5 to FAC1 (round FAC1)
   5735 00916E                             LAB_29C3
                                           ;	JSR	FloatToFixed	; convert FAC1 floating-to-fixed
   5737 00916E A2 01 00                     	LDX	#$01			; set default digits before dp = 1
   5738 009171 A5 C0                        	LDA	numexp		; get number exponent count
   5739 009173 18                           	CLC				; clear carry for add
   5740 009174 69 07 00                     	ADC	#$07			; up to 6 digits before point
   5741 009177 30 0A                        	BMI	LAB_29D8		; if -ve then 1 digit before dp
                                           
   5743 009179 C9 08 00                     	CMP	#$08			; A>=8 if n>=1E6
   5744 00917C B0 06                        	BCS	LAB_29D9		; branch if >= $08
                                           
                                           					; carry is clear
   5747 00917E AA                           	TAX				; copy to A
   5748 00917F CA                           	DEX				; take 1 from digit count
   5749 009180 A9 02 00                     	LDA	#$02			;.set exponent adjust
                                           
   5751 009183                             LAB_29D8
   5752 009183 38                           	SEC				; set carry for subtract
   5753 009184                             LAB_29D9
   5754 009184 E9 02 00                     	SBC	#$02			; -2
   5755 009187 85 C2                        	STA	expcnt		;.save exponent adjust
   5756 009189 86 C0                        	STX	numexp		; save digits before dp count
   5757 00918B 8A                           	TXA				; copy to A
   5758 00918C F0 02                        	BEQ	LAB_29E4		; branch if no digits before dp
                                           
   5760 00918E 10 15                        	BPL	LAB_29F7		; branch if digits before dp
                                           
   5762 009190                             LAB_29E4
   5763 009190 A4 C4                        	LDY	Sendl			; get output string index
   5764 009192 A9 2E 00                     	LDA	#'.'			; character "."
   5765 009195 C8                           	INY				; increment index
   5766 009196 99 A0 03                     	STA	Decss,Y		; save to output string
   5767 009199 8A                           	TXA				;.
   5768 00919A F0 07                        	BEQ	LAB_29F5		;.
                                           
   5770 00919C A9 30 00                     	LDA	#'0'			; character "0"
   5771 00919F C8                           	INY				; increment index
   5772 0091A0 99 A0 03                     	STA	Decss,Y		; save to output string
   5773 0091A3                             LAB_29F5
   5774 0091A3 84 C4                        	STY	Sendl			; save output string index
                                           
   5776 0091A5                             LAB_29F7
   5777 0091A5 A2 30 00                     	LDX	#'0'			; holds onto the digit value
                                           
                                           ; Now loop subtracting 100,000 as many times as we can. The value was coerced
                                           ; to be between 100,000 and 1,000,000. Count the number of times subtraction
                                           ; can be done successfully.
                                           ;
   5783 0091A8                             LAB_29FB
   5784 0091A8 F4 73 93                     	PEA CONST_100000
   5785 0091AB 20 CD 92                     	JSR LOAD_FAC2	; load FAC2 with 100,000
   5786 0091AE 68                           	PLA				; get rid of parameter
   5787 0091AF AF 0E A2 FE                  	LDA FP_STATREG
   5788 0091B3 89 04 00                     	BIT #$04		; Is FAC1 > 100,000 ?
   5789 0091B6 F0 0F                        	BEQ	.0005		; branch if not
   5790 0091B8 A9 11 00                     	LDA #FP_SWAP	; subtract is FAC2-FAC1!
   5791 0091BB 20 18 93                     	JSR FPCommandWait;
   5792 0091BE A9 02 00                     	LDA #FP_SUB		; subtract 100,000 from the mantissa.
   5793 0091C1 20 18 93                     	JSR FPCommandWait
   5794 0091C4 E8                           	INX				; increment the value of the digit
   5795 0091C5 80 E1                        	BRA	LAB_29FB	; try again
   5796 0091C7                             .0005:
   5797 0091C7 8A                           	TXA
   5798 0091C8 A4 C4                        	LDY	Sendl			; get output string index
   5799 0091CA C8                           	INY				; increment output string index
   5800 0091CB 8A                           	TXA
   5801 0091CC 99 A0 03                     	STA	Decss,Y		; save to output string
   5802 0091CF C6 C0                        	DEC	numexp		; decrement # of characters before the dp
   5803 0091D1 D0 07                        	BNE	LAB_2A3B		; branch if still characters to do
                                           				; else output the point
   5805 0091D3 A9 2E 00                     	LDA	#'.'			; character "."
   5806 0091D6 C8                           	INY				; increment output string index
   5807 0091D7 99 A0 03                     	STA	Decss,Y		; save to output string
   5808 0091DA                             LAB_2A3B
   5809 0091DA 84 C4                        	STY	Sendl		; save output string index
                                           	; We subtracted until the value was < 100,000 so multiply the
                                           	; remainder upwards to get the next digit.
   5812 0091DC 20 F8 92                     	JSR	MultiplyByTen	; If not, multiply by 10
   5813 0091DF C0 1B 00                     	CPY #27			; converted (+/- . incl)
   5814 0091E2 90 C1                        	BCC	LAB_29F7
                                           					; now remove trailing zeroes
   5816 0091E4                             .RemoveTrailingZeros
   5817 0091E4 B9 A0 03                     	LDA	Decss,Y		; get character from output string
   5818 0091E7 29 FF 00                     	AND	#$FF		; mask to a byte
   5819 0091EA 88                           	DEY				; decrement output string index
   5820 0091EB C9 30 00                     	CMP	#'0'			; compare with "0"
   5821 0091EE F0 F4                        	BEQ	.RemoveTrailingZeros	; loop until non "0" character found
                                           
   5823 0091F0 C9 2E 00                     	CMP	#'.'			; compare with "."
   5824 0091F3 F0 01                        	BEQ	LAB_2A58		; branch if was dp
                                           
                                           					; restore last character
   5827 0091F5 C8                           	INY				; increment output string index
   5828 0091F6                             LAB_2A58
   5829 0091F6 A9 2B 00                     	LDA	#'+'			; character "+"
   5830 0091F9 A6 C2                        	LDX	expcnt		; get exponent count
   5831 0091FB F0 FF A2 00                  	LBEQ	LAB_2A8C		; if zero go set null terminator and exit
                                           
                                           					; exponent isn't zero so write exponent
   5834 0091FF 10 0A                        	BPL	LAB_2A68		; branch if exponent count +ve
                                           
   5836 009201 A9 00 00                     	LDA	#$00			; clear A
   5837 009204 38                           	SEC				; set carry for subtract
   5838 009205 E5 C2                        	SBC	expcnt		; subtract exponent count adjust (convert -ve to +ve)
   5839 009207 AA                           	TAX				; copy exponent count to X
   5840 009208 A9 2D 00                     	LDA	#'-'			; character "-"
                                           
                                           ; We must keep moving forwards through the string because the acc is storing
                                           ; two bytes.
                                           
   5845 00920B                             LAB_2A68
   5846 00920B 48                           	PHA
   5847 00920C A9 45 00                     	LDA	#'E'			; character "E"
   5848 00920F 99 A1 03                     	STA	Decss+1,Y		; save exponent sign to output string
   5849 009212 68                           	PLA
   5850 009213 99 A2 03                     	STA	Decss+2,Y		; save to output string
   5851 009216 8A                           	TXA				; get exponent count back
                                           
                                           ; do highest exponent digit
   5854 009217 64 C4                        	STZ Sendl
   5855 009219 A2 2F 00                     	LDX	#'0'-1		; one less than "0" character
   5856 00921C 38                           	SEC				; set carry for subtract
   5857 00921D E8                          .0001:				
   5858 00921E E9 10 27                     	SBC	#10000
   5859 009221 B0 FA                        	BCS .0001
   5860 009223 69 10 27                     	ADC #10000
   5861 009226 E0 30 00                     	CPX #'0'
   5862 009229 F0 09                        	BEQ .0005
   5863 00922B E6 C4                        	INC Sendl
   5864 00922D 48                           	PHA
   5865 00922E 8A                           	TXA
   5866 00922F 99 A3 03                     	STA Decss+3,Y
   5867 009232 68                           	PLA
   5868 009233 C8                           	INY
                                           ; do the next exponent digit
   5870 009234                             .0005:
   5871 009234 A2 2F 00                     	LDX #'0'-1
   5872 009237 38                           	SEC
   5873 009238                             .0002:
   5874 009238 E8                           	INX
   5875 009239 E9 E8 03                     	SBC #1000
   5876 00923C B0 FA                        	BCS .0002
   5877 00923E 69 E8 03                     	ADC #1000
   5878 009241 46 C4                        	LSR Sendl
   5879 009243 B0 05                        	BCS .00010
   5880 009245 E0 30 00                     	CPX #'0'
   5881 009248 F0 09                        	BEQ .0006
   5882 00924A                             .00010:
   5883 00924A E6 C4                        	INC Sendl
   5884 00924C 48                           	PHA
   5885 00924D 8A                           	TXA
   5886 00924E 99 A3 03                     	STA Decss+3,Y
   5887 009251 68                           	PLA
   5888 009252 C8                           	INY
                                           ; and the next
   5890 009253                             .0006:
   5891 009253 A2 2F 00                     	LDX	#'0'-1
   5892 009256 38                           	SEC
   5893 009257                             .0003:
   5894 009257 E8                           	INX
   5895 009258 E9 64 00                     	SBC #100
   5896 00925B B0 FA                        	BCS .0003
   5897 00925D 69 64 00                     	ADC #100
   5898 009260 46 C4                        	LSR Sendl
   5899 009262 B0 05                        	BCS .00011
   5900 009264 E0 30 00                     	CPX #'0'
   5901 009267 F0 09                        	BEQ .0007
   5902 009269                             .00011:
   5903 009269 E6 C4                        	INC Sendl
   5904 00926B 48                           	PHA
   5905 00926C 8A                           	TXA
   5906 00926D 99 A3 03                     	STA Decss+3,Y
   5907 009270 68                           	PLA
   5908 009271 C8                           	INY
                                           
   5910 009272                             .0007:
   5911 009272 A2 2F 00                     	LDX #'0'-1
   5912 009275 38                           	SEC
   5913 009276                             .0004:
   5914 009276 E8                           	INX
   5915 009277 E9 0A 00                     	SBC #10
   5916 00927A B0 FA                        	BCS .0004
   5917 00927C 69 0A 00                     	ADC #10
   5918 00927F 46 C4                        	LSR Sendl
   5919 009281 B0 05                        	BCS .00012
   5920 009283 E0 30 00                     	CPX #'0'
   5921 009286 F0 09                        	BEQ .0008
   5922 009288                             .00012:
   5923 009288 E6 C4                        	INC Sendl
   5924 00928A 48                           	PHA
   5925 00928B 8A                           	TXA
   5926 00928C 99 A3 03                     	STA Decss+3,Y
   5927 00928F 68                           	PLA
   5928 009290 C8                           	INY
                                           
   5930 009291                             .0008:
   5931 009291 69 30 00                     	ADC #'0'
   5932 009294 99 A3 03                     	STA Decss+3,Y
   5933 009297 A9 00 00                     	LDA	#$00			; set null terminator
   5934 00929A 99 A4 03                     	STA	Decss+4,Y		; save to output string
   5935 00929D 60                           	RTS					; go set string pointer (AY) and exit (branch always)
                                           
   5937 00929E                             LAB_2A89
   5938 00929E 99 A0 03                     	STA	Decss,Y		; save last character to output string
                                           					; set null terminator and exit
   5940 0092A1                             LAB_2A8C
   5941 0092A1 A9 00 00                     	LDA	#$00			; set null terminator
   5942 0092A4 99 A1 03                     	STA	Decss+1,Y		; save after last character
                                           
   5944 0092A7                             LAB_2A91
                                           ;	LDA	#<Decssp1		; set result string low pointer
                                           ;	LDY	#>Decssp1		; set result string high pointer
   5947 0092A7 60                           	RTS
                                           
   5949 0092A8                             LAB_25FB:
   5950 0092A8 A9 11 00                     	LDA		#FP_SWAP
   5951 0092AB 20 18 93                     	JSR		FPCommandWait
   5952 0092AE A0 00 00                     	LDY		#0
   5953 0092B1 BB                           	TYX
   5954 0092B2                             .0002:
   5955 0092B2 B3 03                        	LDA		(3,S),Y
   5956 0092B4 9F 00 A2 FE                  	STA		FAC1,X
   5957 0092B8 C8                           	INY
   5958 0092B9 C8                           	INY
   5959 0092BA E8                           	INX
   5960 0092BB E8                           	INX
   5961 0092BC E0 0C 00                     	CPX		#12
   5962 0092BF D0 F1                        	BNE		.0002
   5963 0092C1 A9 05 00                     	LDA		#FP_FIX2FLT
   5964 0092C4 20 18 93                     	JSR		FPCommandWait
   5965 0092C7                             FMUL:
   5966 0092C7 A9 03 00                     	LDA		#FP_MUL
   5967 0092CA 4C 18 93                     	JMP		FPCommandWait
   5968 0092CD                             	
   5969 0092CD DA                           	PHX
   5970 0092CE 5A                           	PHY
   5971 0092CF A0 00 00                     	LDY		#0
   5972 0092D2 BB                           	TYX
   5973 0092D3                             .0002:
   5974 0092D3 B3 07                        	LDA		(7,s),Y
   5975 0092D5 9F 10 A2 FE                  	STA		FAC2,X
   5976 0092D9 C8                           	INY
   5977 0092DA C8                           	INY
   5978 0092DB E8                           	INX
   5979 0092DC E8                           	INX
   5980 0092DD E0 0C 00                     	CPX		#12
   5981 0092E0 D0 F1                        	BNE		.0002
   5982 0092E2 7A                           	PLY
   5983 0092E3 FA                           	PLX
   5984 0092E4 60                           	RTS
   5985 0092E5                             	
   5986 0092E5 A9 06 00                     	LDA		#FP_FLT2FIX
   5987 0092E8 4C 18 93                     	JMP		FPCommandWait
   5988 0092EB                             	
   5989 0092EB F4 A3 93                     	PEA		CONST_POINT5
   5990 0092EE 20 CD 92                     	JSR		LOAD_FAC2
   5991 0092F1 68                           	PLA
   5992 0092F2 A9 01 00                     	LDA		#FP_ADD
   5993 0092F5 4C 18 93                     	JMP		FPCommandWait
   5994 0092F8                             	
   5995 0092F8 F4 8B 93                     	PEA		TEN_AS_FLOAT
   5996 0092FB 20 CD 92                     	JSR		LOAD_FAC2
   5997 0092FE 68                           	PLA
   5998 0092FF A9 03 00                     	LDA		#FP_MUL
   5999 009302 4C 18 93                     	JMP		FPCommandWait
                                           	
   6001 009305 F4 8B 93                     	PEA		TEN_AS_FLOAT
   6002 009308 20 CD 92                     	JSR		LOAD_FAC2
   6003 00930B 68                           	PLA
   6004 00930C 20 15 93                     	JSR		SwapFACs
   6005 00930F A9 04 00                     	LDA		#FP_DIV
   6006 009312 4C 18 93                     	JMP		FPCommandWait
   6007 009315                             	
   6008 009315 A9 11 00                     	LDA		#FP_SWAP
                                           
                                           ; Issue a command to the FP unit and wait for it to complete
                                           ;
                                           public FPCommandWait:
   6013 009318 48                           	PHA
   6014 009319 A9 06 00                     	LDA		#6
   6015 00931C 8D 00 70                     	STA		$7000
   6016 00931F                             .0001:
   6017 00931F AF 0E A2 FE                  	LDA		FP_STATREG	; get the status register
   6018 009323 89 80 00                     	BIT		#$80		; check for busy bit
   6019 009326 D0 F7                        	BNE		.0001		; if busy go back
   6020 009328 68                           	PLA					; to pop acc
   6021 009329 8F 0E A2 FE                  	STA		FP_CMDREG	; store the command
   6022 00932D 48                           	PHA
   6023 00932E A9 07 00                     	LDA		#7
   6024 009331 8D 00 70                     	STA		$7000
   6025 009334 68                           	PLA
   6026 009335 60                           	RTS
                                           
                                           ; Display the FAC1 as a hex number
                                           ;
                                           public DispFAC1:
   6031 009336 AF 0A A2 FE                  	LDA FAC1_e
   6032 00933A 20 CA CD                     	JSR DispWord
   6033 00933D AF 08 A2 FE                  	LDA	FAC1_1
   6034 009341 20 CA CD                     	JSR	DispWord
   6035 009344 AF 06 A2 FE                  	LDA FAC1_2
   6036 009348 20 CA CD                     	JSR	DispWord
   6037 00934B AF 04 A2 FE                  	LDA FAC1_3
   6038 00934F 20 CA CD                     	JSR DispWord
   6039 009352 AF 02 A2 FE                  	LDA FAC1_4
   6040 009356 20 CA CD                     	JSR DispWord
   6041 009359 AF 00 A2 FE                  	LDA FAC1_5
   6042 00935D 20 CA CD                     	JSR DispWord
   6043 009360 A9 20 00                     	LDA #' '
   6044 009363 20 EA CC                     	JSR OutChar
   6045 009366 60                           	RTS
                                           ;
                                           ; 1,000,000 as a floating point number
                                           ;
   6049 009367                             A_MILLION:	; $F4240
   6050 009367 00 00                        	dw		$0000
   6051 009369 00 00                        	dw		$0000
   6052 00936B 00 00                        	dw		$0000
   6053 00936D 00 00                        	dW		$0000
   6054 00936F 12 7A                        	dw		$7A12
   6055 009371 13 80                        	dw		$8013
                                           
   6057 009373                             CONST_100000:
                                           	;186A0
   6059 009373 00 00                        	dw		$0000
   6060 009375 00 00                        	dw		$0000
   6061 009377 00 00                        	dw		$0000
   6062 009379 00 00                        	dw		$0000
   6063 00937B A8 61                        	dw		$61A8
   6064 00937D 10 80                        	dw		$8010
                                           ; The constant 999999.4375 as hex
                                           ; 01.11_1010_0001_0001_1111_1011_1000_00000000000000000000000000
   6067 00937F                             MAX_BEFORE_SCI:
   6068 00937F 00 00                        	dw  $0000
   6069 009381 00 00                        	dw  $0000
   6070 009383 00 00                        	dw	$0000
   6071 009385 80 FB                        	dw	$FB80
   6072 009387 11 7A                        	dw	$7A11
   6073 009389 13 80                        	dw	$8013
                                           
   6075 00938B                             TEN_AS_FLOAT:
   6076 00938B 00 00                        	dw	$0000
   6077 00938D 00 00                        	dw	$0000
   6078 00938F 00 00                        	dw	$0000
   6079 009391 00 00                        	dw	$0000
   6080 009393 00 50                        	dw	$5000
   6081 009395 03 80                        	dw	$8003
                                           
                                           ; 99999.9375
                                           ; 01.10_0001_1010_0111_1111_1100_000000000000000000000000000000
                                           ;
   6086 009397                             CONST_9375:
   6087 009397 00 00                        	dw	$0000
   6088 009399 00 00                        	dw	$0000
   6089 00939B 00 00                        	dw	$0000
   6090 00939D 00 FC                        	dw	$FC00
   6091 00939F A7 61                        	dw	$61A7
   6092 0093A1 10 80                        	dw	$8010
                                           
                                           ; 0.5
   6095 0093A3                             CONST_POINT5:
   6096 0093A3 00 00                        	dw	$0000
   6097 0093A5 00 00                        	dw	$0000
   6098 0093A7 00 00                        	dw	$0000
   6099 0093A9 00 00                        	dw	$0000
   6100 0093AB 00 40                        	dw	$4000
   6101 0093AD FF 7F                        	dw	$7FFF
                                           
                                           ; This table is used in converting numbers to ASCII.
                                           
   6105 0093AF                             LAB_2A9A
   6402 = 000093B0                         LAB_2A9B = LAB_2A9A+1
   6403 = 000093B1                         LAB_2A9C = LAB_2A9B+1
                                           ;	.word	$FFFF,$F21F,$494C,$589C,$0000
                                           ;	.word	$0000,$0163,$4578,$5D8A,$0000
                                           ;	.word	$FFFF,$FFDC,$790D,$903F,$0000
                                           ;	.word	$0000,$0003,$8D7E,$A4C6,$8000
                                           ;	.word	$FFFF,$FFFF,$A50C,$EF85,$C000
                                           ;	.word	$0000,$0000,$0918,$4E72,$A000
                                           ;	.word	$FFFF,$FFFF,$FF17,$2B5A,$F000
                                           ;	.word	$0000,$0000,$0017,$4876,$E800
                                           ;	.word	$FFFF,$FFFF,$FFFD,$ABF4,$1C00
                                           ;	.word	$0000,$0000,$0000,$3B9A,$CA00
                                           ;	.word	$FFFF,$FFFF,$FFFF,$FF67,$6980
                                           ;	.word	$0000,$0000,$0000,$05F5,$E100		; 100000000
                                           ;	.word	$0000,$0000,$0098,$9680		; 10000000
                                           ;	.word   $4240,$000F,$0000,$0000,$0000,$804E		; 1000000
   6122 0093AF A0 86 01 00 00 00 00 00      	.word	$86A0,$0001,$0000,$0000,$0000,$804E		; 100000
   6122 0093B7 00 00 4E 80                
   6123 0093BB 10 27 00 00 00 00 00 00      	.word	$2710,$0000,$0000,$0000,$0000,$804E		; 10000
   6123 0093C3 00 00 4E 80                
   6124 0093C7 E8 03 00 00 00 00 00 00      	.word	$03E8,$0000,$0000,$0000,$0000,$804E		; 1000
   6124 0093CF 00 00 4E 80                
   6125 0093D3 64 00 00 00 00 00 00 00      	.word	$0064,$0000,$0000,$0000,$0000,$804E		; 100
   6125 0093DB 00 00 4E 80                
   6126 0093DF                             FIXED10:
   6127 0093DF 0A 00 00 00 00 00 00 00      	.word	$000A,$0000,$0000,$0000,$0000,$804E		; 10
   6127 0093E7 00 00 4E 80                
   6128 0093EB 01 00 00 00 00 00 00 00      	.word	$0001,$0000,$0000,$0000,$0000,$804E		; 1
   6128 0093F3 00 00 4E 80                
                                           
                                           		 MEM	16
                                           		 NDX	16
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FTBios816.asm


                                           .include "FAC1ToString.asm"
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
invaders.asm

                                           	CPU		FT832
                                           
   6437 = 0000000000FEA100                               PRNG		EQU		$FEA100
   6438 = 0000000000FEA108                               PRNG_NUM	EQU		$FEA108
   6439 = 0000000000FEA10E                               PRNG_ADV	EQU		$FEA10E
   6440 = 0000000000000001                               MAN_EXPLODING	EQU		1
                                           
                                           ; which invaders are still active (not destroyed)
                                           ; These var addresses are segment offsets into seg $7800
   6444 = 0000000000000000                               active				EQU		$00
   6445 = 000000000000005E                               left_right			EQU		$5E
   6446 = 0000000000000060                               rightmost_column	EQU		$60
   6447 = 0000000000000062                               leftmost_column		EQU		$62
   6448 = 0000000000000064                               bottom_row			EQU		$64
   6449 = 0000000000000066                               top_row				EQU		$66
   6450 = 000000000000006A                               inv_tick			EQU		$6A
   6451 = 000000000000006C                               inv_tick2			EQU		$6C
   6452 = 000000000000006E                               manX				EQU		$6E
   6453 = 0000000000000070                               manY				EQU		$70
   6454 = 0000000000000072                               manState			EQU		$72
   6455 = 0000000000000100                               InvadersX			EQU		$100
   6456 = 0000000000000200                               InvadersY			EQU		$200
   6457 = 0000000000000300                               min_right			EQU		$300
   6458 = 0000000000000310                               max_left			EQU		$310
   6459 = 0000000000000320                               bombX				EQU		$320
   6460 = 0000000000000330                               bombY				EQU		$330
   6461 = 0000000000000400                               inv_state			EQU		$400
                                           
                                           ; This var is shared, must be referenced ZS:
   6464 = 0000000000007868                               do_invaders			EQU		$7868
                                           
                                           	; minimum right +         .byte a_esc,"`0"
                                           -ordinate for each column of invaders
   6166 0093F7                             st_min_right:
   6167 0093F7 01 00                        	.word	1
   6168 0093F9 05 00                        	.word	5
   6169 0093FB 09 00                        	.word	9
   6170 0093FD 0D 00                        	.word	13
   6171 0093FF 11 00                        	.word	17
   6172 009401 15 00                        	.word	21
   6173 009403 19 00                        	.word	25
   6174 009405 1D 00                        	.word	29
                                           
                                           	; maximum left +         .byte a_esc,"`0"
                                           -ordinate for each column of invaders
   6178 009407 34 00                        	.word	52
   6179 009409 38 00                        	.word	56
   6180 00940B 3C 00                        	.word	60
   6181 00940D 40 00                        	.word	64
   6182 00940F 44 00                        	.word	68
   6183 009411 48 00                        	.word	72
   6184 009413 4C 00                        	.word	76
   6185 009415 50 00                        	.word	80
                                           
   6187 009417 00 00                        	.word	0		; rightmost column
   6188 009419 07 00                        	.word	7		; lefmost column
   6189 00941B 01 00                        	.word	1		; dx
                                           
                                           	MEM		16
                                           	NDX		16
                                           
                                           	code
                                           
   6196 00941D                             InvBomb:
   6197 00941D A2 00 00                     	LDX		#0
   6198 009420                             .0001:
   6199 009420 B5 00                        	LDA		active,X
   6200 009422 F0 27                        	BEQ		.0002
   6201 009424 20 FC 94                     	JSR		CanDropBomb
   6202 009427 F0 22                        	BEQ		.0002
   6203 009429 42 5B AF 08 A1 FE            	LDA		ZS:PRNG_NUM
   6204 00942F 42 5B 8F 0E A1 FE            	STA		ZS:PRNG_ADV
   6205 009435 29 63 00                     	AND		#$63
   6206 009438 D0 11                        	BNE		.0002
   6207 00943A 20 53 94                     	JSR		FindEmptyBomb
   6208 00943D 30 13                        	BMI		.0003
   6209 00943F BD 00 01                     	LDA		InvadersX,X
   6210 009442 99 20 03                     	STA		bombX,Y
   6211 009445 BD 00 02                     	LDA		InvadersY,X
   6212 009448 99 30 03                     	STA		bombY,Y
   6213 00944B                             .0002:
   6214 00944B E8                           	INX
   6215 00944C E8                           	INX
   6216 00944D E0 50 00                     	CPX		#80
   6217 009450 30 CE                        	BMI		.0001
   6218 009452                             .0003:
   6219 009452 60                           	RTS
                                           
   6221 009453                             FindEmptyBomb:
   6222 009453 A0 00 00                     	LDY		#0
   6223 009456                             .0001:
   6224 009456 B9 20 03                     	LDA		bombX,Y
   6225 009459 F0 0A                        	BEQ		.0002
   6226 00945B C8                           	INY
   6227 00945C C8                           	INY
   6228 00945D C0 10 00                     	CPY		#16
   6229 009460 30 F4                        	BMI		.0001
   6230 009462 A0 FF FF                     	LDY		#-1
   6231 009465                             .0002:
   6232 009465 60                           	RTS
                                           
   6234 009466                             MoveBombs:
   6235 009466 A2 00 00                     	LDX		#0
   6236 009469                             .0002:
   6237 009469 BD 20 03                     	LDA		bombX,X
   6238 00946C F0 14                        	BEQ		.0001
   6239 00946E BD 30 03                     	LDA		bombY,X
   6240 009471 C9 1E 00                     	CMP		#30			; has the bomb fallen all the way to the ground ?
   6241 009474 10 06                        	BPL		.0003		; if yes, reset bomb
   6242 009476 1A                           	INA
   6243 009477 9D 30 03                     	STA		bombY,X
   6244 00947A 80 06                        	BRA		.0001
   6245 00947C                             .0003:
   6246 00947C 9E 20 03                     	STZ		bombX,X
   6247 00947F 9E 30 03                     	STZ		bombY,X
   6248 009482                             .0001:
   6249 009482 E8                           	INX
   6250 009483 E8                           	INX
   6251 009484 E0 10 00                     	CPX		#16
   6252 009487 30 E0                        	BMI		.0002
   6253 009489 60                           	RTS
                                           
   6255 00948A                             GetBombOffset:
   6256 00948A B9 30 03                     	LDA		bombY,Y
   6257 00948D 0A                           	ASL
   6258 00948E AA                           	TAX
   6259 00948F 42 5B BD DC E0               	LDA		ZS:LineTbl,X
   6260 009494 18                           	CLC
   6261 009495 79 20 03                     	ADC		bombX,Y
   6262 009498 79 20 03                     	ADC		bombX,Y
   6263 00949B AA                           	TAX
   6264 00949C 60                           	RTS
                                           
   6266 00949D                             RenderBombs:
   6267 00949D A0 00 00                     	LDY		#0
   6268 0094A0                             .0001:
   6269 0094A0 B9 30 03                     	LDA		bombY,Y
   6270 0094A3 F0 0C                        	BEQ		.0002
   6271 0094A5 20 8A 94                     	JSR		GetBombOffset
   6272 0094A8 A9 24 00                     	LDA		#'$'
   6273 0094AB 42 5B 9F 00 00 0D            	STA		ZS:VIDBUF,X
   6274 0094B1                             .0002:
   6275 0094B1 C8                           	INY
   6276 0094B2 C8                           	INY
   6277 0094B3 C0 10 00                     	CPY		#16
   6278 0094B6 30 E8                        	BMI		.0001
   6279 0094B8 60                           	RTS
                                           
   6281 0094B9                             TestBombsIntercept:
   6282 0094B9 A0 00 00                     	LDY		#0
   6283 0094BC                             .0001:
   6284 0094BC 20 C7 94                     	JSR		TestBombIntercept
   6285 0094BF C8                           	INY
   6286 0094C0 C8                           	INY
   6287 0094C1 C0 10 00                     	CPY		#16
   6288 0094C4 30 F6                        	BMI		.0001
   6289 0094C6 60                           	RTS
                                           
   6291 0094C7                             TestBombIntercept:
   6292 0094C7 20 8A 94                     	JSR		GetBombOffset
   6293 0094CA 42 5B BF 00 00 0D            	LDA		ZS:VIDBUF,X
   6294 0094D0 C9 20 00                     	CMP		#' '
   6295 0094D3 F0 1D                        	BEQ		.0001
   6296 0094D5 B9 30 03                     	LDA		bombY,Y
   6297 0094D8 C9 1D 00                     	CMP		#29
   6298 0094DB D0 16                        	BNE		.0002
   6299 0094DD B9 20 03                     	LDA		bombX,Y
   6300 0094E0 D9 6E 00                     	CMP		manX,Y
   6301 0094E3 D0 05                        	BNE		.0003
   6302 0094E5 A9 01 00                     	LDA		#MAN_EXPLODING
   6303 0094E8 85 72                        	STA		manState
   6304 0094EA                             .0003:
   6305 0094EA BB                           	TYX
   6306 0094EB 9E 30 03                     	STZ		bombY,X
   6307 0094EE 9E 20 03                     	STZ		bombX,X
   6308 0094F1 60                           	RTS
   6309 0094F2                             .0001:
   6310 0094F2 60                           	RTS
   6311 0094F3                             .0002:
   6312 0094F3 A9 20 00                     	LDA		#' '
   6313 0094F6 9F 00 00 0D                  	STA		VIDBUF,X
   6314 0094FA 80 EE                        	BRA		.0003
                                           
                                           ; An invader can drop a bomb only if there are no invaders underneath it.
                                           
   6318 0094FC                             CanDropBomb:
   6319 0094FC E0 0F 00                     	CPX		#15
   6320 0094FF 10 0C                        	BGE		.0001
   6321 009501 B5 10                        	LDA		active+16,X
   6322 009503 15 20                        	ORA		active+32,X
   6323 009505 15 30                        	ORA		active+48,X
   6324 009507 15 40                        	ORA		active+64,X
   6325 009509 49 01 00                     	EOR		#1
   6326 00950C 60                           	RTS
   6327 00950D                             .0001:
   6328 00950D E0 1F 00                     	CPX		#31
   6329 009510 10 0A                        	BGE		.0002
   6330 009512 B5 10                        	LDA		active+16,X
   6331 009514 15 20                        	ORA		active+32,X
   6332 009516 15 30                        	ORA		active+48,X
   6333 009518 49 01 00                     	EOR		#1
   6334 00951B 60                           	RTS
   6335 00951C                             .0002:
   6336 00951C E0 2F 00                     	CPX		#47
   6337 00951F 10 08                        	BGE		.0003
   6338 009521 B5 10                        	LDA		active+16,X
   6339 009523 15 20                        	ORA		active+32,X
   6340 009525 49 01 00                     	EOR		#1
   6341 009528 60                           	RTS
   6342 009529                             .0003:
   6343 009529 E0 3F 00                     	CPX		#63
   6344 00952C 10 06                        	BGE		.0004
   6345 00952E B5 10                        	LDA		active+16,X
   6346 009530 49 01 00                     	EOR		#1
   6347 009533 60                           	RTS
   6348 009534                             .0004:
   6349 009534 A9 01 00                     	LDA		#1
   6350 009537 60                           	RTS
                                           
                                           
                                           ; Test if it's possible to move to the left anymore.
                                           ;
   6355 009538                             CanMoveLeft:
   6356 009538 A5 62                        	LDA		leftmost_column
   6357 00953A 0A                           	ASL
   6358 00953B AA                           	TAX
   6359 00953C BD 10 03                     	LDA		max_left,X
   6360 00953F DD 00 01                     	CMP		InvadersX,X
   6361 009542 30 04                        	BMI		.0001
   6362 009544 A9 00 00                     	LDA		#0
   6363 009547 60                           	RTS
   6364 009548                             .0001:
   6365 009548 A9 01 00                     	LDA		#1
   6366 00954B 60                           	RTS
                                           
                                           ; Test if it's possible to move to the right anymore.
                                           ;
   6370 00954C                             CanMoveRight:
   6371 00954C A5 60                        	LDA		rightmost_column
   6372 00954E 0A                           	ASL
   6373 00954F AA                           	TAX
   6374 009550 BD 00 03                     	LDA		min_right,X
   6375 009553 DD 00 01                     	CMP		InvadersX,X
   6376 009556 10 04                        	BPL		.0001
   6377 009558 A9 00 00                     	LDA		#0
   6378 00955B 60                           	RTS
   6379 00955C                             .0001:
   6380 00955C A9 01 00                     	LDA		#1
   6381 00955F 60                           	RTS
                                           
                                           ; Test if it's possible to move down anymore
                                           ;
   6385 009560                             CanMoveDown:
   6386 009560 A5 64                        	LDA		bottom_row
   6387 009562 0A                           	ASL
   6388 009563 0A                           	ASL
   6389 009564 0A                           	ASL
   6390 009565 0A                           	ASL
   6391 009566 AA                           	TAX
   6392 009567 BD 00 02                     	LDA		InvadersY,X
   6393 00956A C9 1E 00                     	CMP		#30
   6394 00956D 30 04                        	BMI		.0001
   6395 00956F A9 00 00                     	LDA		#0
   6396 009572 60                           	RTS
   6397 009573                             .0001:
   6398 009573 A9 01 00                     	LDA		#1
   6399 009576 60                           	RTS
                                           
                                           ; Move all the invaders to the left
                                           ; Means incrementing the X co-ordinate
                                           ;
   6404 009577                             MoveLeft:
   6405 009577 A2 00 00                     	LDX		#00
   6406 00957A                             .0002:
   6407 00957A FE 00 01                     	INC		InvadersX,X
   6408 00957D E8                           	INX
   6409 00957E E8                           	INX
   6410 00957F E0 50 00                     	CPX		#80
   6411 009582 D0 F6                        	BNE		.0002
   6412 009584 60                           	RTS
                                           
                                           ; Move all the invaders to the right.
                                           ; means decrementing the X co-ordinate
                                           ;
   6417 009585                             MoveRight:
   6418 009585 A2 00 00                     	LDX		#0
   6419 009588                             .0002:
   6420 009588 DE 00 01                     	DEC		InvadersX,X
   6421 00958B E8                           	INX
   6422 00958C E8                           	INX
   6423 00958D E0 50 00                     	CPX		#80
   6424 009590 D0 F6                        	BNE		.0002
   6425 009592 60                           	RTS
                                           
                                           ; Move all the invaders down a row.
                                           ; Means incrementing the Y co-ordinate
                                           ;
   6430 009593                             MoveDown:
   6431 009593 A2 00 00                     	LDX		#00
   6432 009596                             .0002:
   6433 009596 FE 00 02                     	INC		InvadersY,X
   6434 009599 E8                           	INX
   6435 00959A E8                           	INX
   6436 00959B E0 50 00                     	CPX		#80
   6437 00959E D0 F6                        	BNE		.0002
   6438 0095A0 60                           	RTS
                                           
                                           ; Move the invaders
                                           ; Retuns
                                           ; .A = 1 if it was possible to do a move, 0 otherwise
                                           ;
   6444 0095A1                             Move:
   6445 0095A1 24 5E                        	BIT		left_right
   6446 0095A3 30 0A                        	BMI		.0002
   6447 0095A5 20 38 95                     	JSR		CanMoveLeft
   6448 0095A8 F0 0F                        	BEQ		.0001
   6449 0095AA 20 77 95                     	JSR		MoveLeft
   6450 0095AD 80 19                        	BRA		.0003
   6451 0095AF                             .0002:
   6452 0095AF 20 4C 95                     	JSR		CanMoveRight
   6453 0095B2 F0 05                        	BEQ		.0001
   6454 0095B4 20 85 95                     	JSR		MoveRight
   6455 0095B7 80 0F                        	BRA		.0003
   6456 0095B9                             .0001:
   6457 0095B9 20 60 95                     	JSR		CanMoveDown
   6458 0095BC F0 0E                        	BEQ		.0004
   6459 0095BE A5 5E                        	LDA		left_right
   6460 0095C0 49 FF FF                     	EOR		#$FFFF
   6461 0095C3 85 5E                        	STA		left_right
   6462 0095C5 20 93 95                     	JSR		MoveDown
   6463 0095C8                             .0003:
   6464 0095C8 A9 01 00                     	LDA		#1
   6465 0095CB 60                           	RTS
   6466 0095CC                             .0004:
   6467 0095CC A9 00 00                     	LDA		#0
   6468 0095CF 60                           	RTS
                                           
   6470 0095D0                             Initialize:
   6471 0095D0 64 60                        	STZ		rightmost_column
   6472 0095D2 A9 07 00                     	LDA		#7
   6473 0095D5 85 62                        	STA		leftmost_column
   6474 0095D7 64 66                        	STZ		top_row
   6475 0095D9 A9 04 00                     	LDA		#4
   6476 0095DC 85 64                        	STA		bottom_row
   6477 0095DE 64 5E                        	STZ		left_right
   6478 0095E0 20 28 96                     	JSR		ActivateAllInvaders
   6479 0095E3 A2 00 00                     	LDX		#0
   6480 0095E6                             .0001:
   6481 0095E6 42 1B BD 3B 9A               	LDA		CS:StartX,X
   6482 0095EB 9D 00 01                     	STA		InvadersX,X
   6483 0095EE 42 1B BD EB 99               	LDA		CS:StartY,X
   6484 0095F3 9D 00 02                     	STA		InvadersY,X
   6485 0095F6 E8                           	INX
   6486 0095F7 E8                           	INX
   6487 0095F8 E0 50 00                     	CPX		#80
   6488 0095FB 30 E9                        	BMI		.0001
   6489 0095FD A2 00 00                     	LDX		#0
   6490 009600                             .0002:
   6491 009600 42 1B BD F7 93               	LDA		CS:st_min_right,X
   6492 009605 9D 00 03                     	STA		min_right,X
   6493 009608 E8                           	INX
   6494 009609 E8                           	INX
   6495 00960A E0 20 00                     	CPX		#32
   6496 00960D 30 F1                        	BMI		.0002
                                           	; Initialize Bombs
   6498 00960F A2 00 00                     	LDX		#0
   6499 009612                             .0003:
   6500 009612 9E 20 03                     	STZ		bombX,X
   6501 009615 9E 30 03                     	STZ		bombY,X
   6502 009618 E8                           	INX
   6503 009619 E8                           	INX
   6504 00961A E0 10 00                     	CPX		#16
   6505 00961D 30 F3                        	BMI		.0003
   6506 00961F A9 FE FF                     	LDA		#$FFFE
   6507 009622 42 5B 8D 68 78               	STA		ZS:do_invaders
   6508 009627 60                           	RTS
                                           
   6510 009628                             ActivateAllInvaders:
   6511 009628 A2 00 00                     	LDX		#0
   6512 00962B A9 01 00                     	LDA		#1
   6513 00962E                             .0001:
   6514 00962E 95 00                        	STA		active,X
   6515 009630 E8                           	INX
   6516 009631 E8                           	INX
   6517 009632 E0 50 00                     	CPX		#80
   6518 009635 D0 F7                        	BNE		.0001
   6519 009637 60                           	RTS
                                           
   6521 009638                             IsAllDestroyed:
   6522 009638 20 C0 96                     	JSR		IsRightmostColumnDestroyed
   6523 00963B F0 2C                        	BEQ		.0001
   6524 00963D E6 60                        	INC		rightmost_column
   6525 00963F AD 0C 03                     	LDA		min_right+12
   6526 009642 8D 0E 03                     	STA		min_right+14
   6527 009645 AD 0A 03                     	LDA		min_right+10
   6528 009648 8D 0C 03                     	STA		min_right+12
   6529 00964B AD 08 03                     	LDA		min_right+8
   6530 00964E 8D 0A 03                     	STA		min_right+10
   6531 009651 AD 06 03                     	LDA		min_right+6
   6532 009654 8D 08 03                     	STA		min_right+8
   6533 009657 AD 04 03                     	LDA		min_right+4
   6534 00965A 8D 06 03                     	STA		min_right+6
   6535 00965D AD 02 03                     	LDA		min_right+2
   6536 009660 8D 04 03                     	STA		min_right+4
   6537 009663 AD 00 03                     	LDA		min_right
   6538 009666 8D 02 03                     	STA		min_right+2
   6539 009669                             .0001:
   6540 009669 20 BC 96                     	JSR		IsLeftmostColumnDestroyed
   6541 00966C F0 2C                        	BEQ		.0002
   6542 00966E C6 62                        	DEC		leftmost_column
   6543 009670 AD 12 03                     	LDA		max_left+2
   6544 009673 8D 10 03                     	STA		max_left
   6545 009676 AD 14 03                     	LDA		max_left+4
   6546 009679 8D 12 03                     	STA		max_left+2
   6547 00967C AD 16 03                     	LDA		max_left+6
   6548 00967F 8D 14 03                     	STA		max_left+4
   6549 009682 AD 18 03                     	LDA		max_left+8
   6550 009685 8D 16 03                     	STA		max_left+6
   6551 009688 AD 1A 03                     	LDA		max_left+10
   6552 00968B 8D 18 03                     	STA		max_left+8
   6553 00968E AD 1C 03                     	LDA		max_left+12
   6554 009691 8D 1A 03                     	STA		max_left+10
   6555 009694 AD 1E 03                     	LDA		max_left+14
   6556 009697 8D 1C 03                     	STA		max_left+12
   6557 00969A                             .0002:
   6558 00969A A5 62                        	LDA		leftmost_column
   6559 00969C C5 60                        	CMP		rightmost_column
   6560 00969E 30 18                        	BMI		.allDestroyed
   6561 0096A0 20 DC 96                     	JSR		IsBottomRowDestroyed
   6562 0096A3 F0 02                        	BEQ		.0003
   6563 0096A5 C6 64                        	DEC		bottom_row
   6564 0096A7                             .0003:
   6565 0096A7 20 D8 96                     	JSR		IsTopRowDestroyed
   6566 0096AA F0 02                        	BEQ		.0004
   6567 0096AC E6 66                        	INC		top_row
   6568 0096AE                             .0004:
   6569 0096AE A5 64                        	LDA		bottom_row
   6570 0096B0 C5 66                        	CMP		top_row
   6571 0096B2 30 04                        	BMI		.allDestroyed
   6572 0096B4 A9 00 00                     	LDA		#0
   6573 0096B7 60                           	RTS
   6574 0096B8                             .allDestroyed:
   6575 0096B8 A9 01 00                     	LDA		#1
   6576 0096BB 60                           	RTS
                                           
                                           
   6579 0096BC                             IsLeftmostColumnDestroyed:
   6580 0096BC A5 62                        	LDA		leftmost_column
   6581 0096BE 80 02                        	BRA		IsColumnDestroyed
   6582 0096C0                             IsRightmostColumnDestroyed:
   6583 0096C0 A5 60                        	LDA		rightmost_column
   6584 0096C2                             IsColumnDestroyed:
   6585 0096C2 0A                           	ASL
   6586 0096C3 AA                           	TAX
   6587 0096C4 B5 00                        	LDA		active,X
   6588 0096C6 15 10                        	ORA		active+16,X
   6589 0096C8 15 20                        	ORA		active+32,X
   6590 0096CA 15 30                        	ORA		active+48,X
   6591 0096CC 15 40                        	ORA		active+64,X
   6592 0096CE 15 50                        	ORA		active+80,X
   6593 0096D0 15 60                        	ORA		active+96,X
   6594 0096D2 15 70                        	ORA		active+112,X
   6595 0096D4 49 01 00                     	EOR		#1
   6596 0096D7 60                           	RTS
                                           
   6598 0096D8                             IsTopRowDestroyed:
   6599 0096D8 A5 66                        	LDA		top_row
   6600 0096DA 80 02                        	BRA		IsRowDestroyed
   6601 0096DC                             IsBottomRowDestroyed:
   6602 0096DC A5 64                        	LDA		bottom_row
   6603 0096DE                             IsRowDestroyed:
   6604 0096DE 0A                           	ASL
   6605 0096DF 0A                           	ASL
   6606 0096E0 0A                           	ASL
   6607 0096E1 0A                           	ASL
   6608 0096E2 B5 00                        	LDA		active,X
   6609 0096E4 15 02                        	ORA		active+2,X
   6610 0096E6 15 04                        	ORA		active+4,X
   6611 0096E8 15 06                        	ORA		active+6,X
   6612 0096EA 15 08                        	ORA		active+8,X
   6613 0096EC 15 0A                        	ORA		active+10,X
   6614 0096EE 15 0C                        	ORA		active+12,X
   6615 0096F0 15 0E                        	ORA		active+14,X
   6616 0096F2 49 01 00                     	EOR		#1
   6617 0096F5 60                           	RTS
                                           
                                           ; TickCount counts 1/100 of a second. We want to animate the graphics at a much
                                           ; slower rate, so we use bit 6 of the tick count to indicate when to animate.
                                           ;
   6622 0096F6                             ShiftTick:
   6623 0096F6 42 5B A5 04                  	LDA		ZS:TickCount
   6624 0096FA 4A                           	LSR
   6625 0096FB 4A                           	LSR
   6626 0096FC 4A                           	LSR
   6627 0096FD 4A                           	LSR
   6628 0096FE 4A                           	LSR
   6629 0096FF 4A                           	LSR
   6630 009700 60                           	RTS
                                           
   6632 009701                             RenderInvaders:
                                           	; First, clear the screen
   6634 009701 A2 00 00                     	LDX		#0
   6635 009704 A9 20 00                     	LDA		#' '
   6636 009707 09 00 BF                     	ORA		#$BF00
   6637 00970A                             .0003:
   6638 00970A 42 5B 9F 00 00 0D            	STA		ZS:VIDBUF,X
   6639 009710 E8                           	INX
   6640 009711 E8                           	INX
   6641 009712 E0 58 14                     	CPX		#84*31*2
   6642 009715 30 F3                        	BMI		.0003
   6643 009717 A2 00 00                     	LDX		#0
   6644 00971A                             .0002:
   6645 00971A C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   6648 00971C B5 00                        	LDA		active,X
   6649 00971E F0 FF BD 01                  	LBEQ	.0001
   6650 009722 BD 00 04                     	LDA		inv_state,X
   6651 009725 BD 00 02                     	LDA		InvadersY,X
   6652 009728 0A                           	ASL
   6653 009729 A8                           	TAY
   6654 00972A 42 5B B9 DC E0               	LDA		ZS:LineTbl,Y
   6655 00972F 18                           	CLC
   6656 009730 7D 00 01                     	ADC		InvadersX,X
   6657 009733 18                           	CLC
   6658 009734 7D 00 01                     	ADC		InvadersX,X
   6659 009737 A8                           	TAY
   6660 009738 E2 20                        	SEP		#$20			; eight bit acc
                                           	MEM		8
   6662 00973A 42 1B BD 8B 9A               	LDA		CS:InvaderType,X
   6663 00973F C9 01                        	CMP		#1
   6664 009741 D0 46                        	BNE		.0004
   6665 009743 A9 E9                        	LDA		#233
   6666 009745 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6667 00974D A9 F2                        	LDA		#242
   6668 00974F 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6669 009757 A9 DF                        	LDA		#223
   6670 009759 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6671 009761 20 F6 96                     	JSR		ShiftTick
   6672 009764 90 04                        	BCC		.0005
   6673 009766 A9 58                        	LDA		#'X'
   6674 009768 80 02                        	BRA		.0006
   6675 00976A                             .0005:
   6676 00976A A9 56                        	LDA		#'V'
   6677 00976C                             .0006:
   6678 00976C 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6679 009774 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6680 00977C A9 20                        	LDA		#' '
   6681 00977E 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6682 009786 82 E4 00                     	BRL		.0007
   6683 009789                             .0004:
   6684 009789 C9 02                        	CMP		#2
   6685 00978B D0 FF 83 00                  	LBNE	.0008
   6686 00978F 20 F6 96                     	JSR		ShiftTick
   6687 009792 90 3F                        	BCC		.0009
   6688 009794 A9 FC                        	LDA		#252
   6689 009796 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6690 00979E A9 99                        	LDA		#153
   6691 0097A0 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6692 0097A8 A9 FE                        	LDA		#254
   6693 0097AA 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6694 0097B2 A9 E2                        	LDA		#226
   6695 0097B4 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6696 0097BC A9 62                        	LDA		#98
   6697 0097BE 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6698 0097C6 A9 E2                        	LDA		#226
   6699 0097C8 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6700 0097D0 82 9A 00                     	BRL		.0007
   6701 0097D3                             .0009:
   6702 0097D3 A9 62                        	LDA		#98
   6703 0097D5 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6704 0097DD A9 99                        	LDA		#153
   6705 0097DF 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6706 0097E7 A9 62                        	LDA		#98
   6707 0097E9 42 5B 42 99 04 00 0D 00      	STA		ZS:VIDBUF+4,Y
                                         
   6708 0097F1 A9 EC                        	LDA		#236
   6709 0097F3 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6710 0097FB A9 62                        	LDA		#98
   6711 0097FD 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6712 009805 A9 FB                        	LDA		#251
   6713 009807 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6714 00980F 82 5B 00                     	BRL		.0007
   6715 009812                             .0008:
   6716 009812 A9 FF                        	LDA		#255
   6717 009814 42 5B 42 99 00 00 0D 00      	STA		ZS:VIDBUF,Y
                                         
   6718 00981C A9 F8                        	LDA		#248
   6719 00981E 42 5B 42 99 02 00 0D 00      	STA		ZS:VIDBUF+2,Y
                                         
   6720 009826 A9 7F                        	LDA		#127
   6721 009828 42 5B 99 21 98               	STA		ZS:VIDBUf+4,Y
   6722 00982D 20 F6 96                     	JSR		ShiftTick
   6723 009830 90 20                        	BCC		.0010
   6724 009832 A9 FF                        	LDA		#255
   6725 009834 42 5B 42 99 54 00 0D 00      	STA		ZS:VIDBUF+84,Y
                                         
   6726 00983C A9 F9                        	LDA		#249
   6727 00983E 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6728 009846 A9 7F                        	LDA		#127
   6729 009848 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6730 009850 80 1B                        	BRA		.0007
   6731 009852                             .0010:
   6732 009852 A9 E1                        	LDA		#225
   6733 009854 42 5B 99 71 98               	STA		ZS:VIDBUf+84,Y
   6734 009859 A9 F9                        	LDA		#249
   6735 00985B 42 5B 42 99 56 00 0D 00      	STA		ZS:VIDBUF+86,Y
                                         
   6736 009863 A9 60                        	LDA		#96
   6737 009865 42 5B 42 99 58 00 0D 00      	STA		ZS:VIDBUF+88,Y
                                         
   6738 00986D                             .0007:
                                           	; Surround the alien with spaces
   6740 00986D A9 20                        	LDA		#' '
   6741 00986F 42 5B 42 99 AA FF 0C 00      	STA		ZS:VIDBUF-86,Y
                                         
   6742 009877 42 5B 42 99 AC FF 0C 00      	STA		ZS:VIDBUF-84,Y
                                         
   6743 00987F 42 5B 42 99 AE FF 0C 00      	STA		ZS:VIDBUF-82,Y
                                         
   6744 009887 42 5B 42 99 B0 FF 0C 00      	STA		ZS:VIDBUF-80,Y
                                         
   6745 00988F 42 5B 42 99 B2 FF 0C 00      	STA		ZS:VIDBUF-78,Y
                                         
   6746 009897 42 5B 42 99 FE FF 0C 00      	STA		ZS:VIDBUF-2,Y
                                         
   6747 00989F 42 5B 42 99 06 00 0D 00      	STA		ZS:VIDBUF+6,Y
                                         
   6748 0098A7 42 5B 42 99 52 00 0D 00      	STA		ZS:VIDBUF+82,Y
                                         
   6749 0098AF 42 5B 42 99 5A 00 0D 00      	STA		ZS:VIDBUF+90,Y
                                         
   6750 0098B7 42 5B 42 99 A6 00 0D 00      	STA		ZS:VIDBUF+166,Y
                                         
   6751 0098BF 42 5B 42 99 A8 00 0D 00      	STA		ZS:VIDBUF+168,Y
                                         
   6752 0098C7 42 5B 42 99 AA 00 0D 00      	STA		ZS:VIDBUF+170,Y
                                         
   6753 0098CF 42 5B 42 99 AC 00 0D 00      	STA		ZS:VIDBUF+172,Y
                                         
   6754 0098D7 42 5B 42 99 AE 00 0D 00      	STA		ZS:VIDBUF+174,Y
                                         
   6755 0098DF                             .0001:
   6756 0098DF E8                           	INX
   6757 0098E0 E8                           	INX
   6758 0098E1 E0 50 00                     	CPX		#80
   6759 0098E4 D0 FF 32 FE                  	LBNE	.0002
   6760 0098E8 C2 20                        	REP		#$20
                                           	MEM		16
   6762 0098EA 60                           	RTS
                                           
                                           public InvadersTask:
   6765 0098EB                             .0001:
   6766 0098EB F4 00 00                     	PEA		0				; set data segment to $7800
   6767 0098EE F4 00 78                     	PEA		$7800
   6768 0098F1 42 2B                        	PLDS
   6769 0098F3 A9 FF 2B                     	LDA		#$2BFF			; set stack to $2BFF
   6770 0098F6 1B                           	TAS
   6771 0098F7 20 D0 95                     	JSR		Initialize
   6772 0098FA 42 E2 00 10                  	SEP		#$1000			; turn on single step mode
   6773 0098FE 20 01 97                     	JSR		RenderInvaders
   6774 009901                             .0002:
   6775 009901 42 20 3E D0 07               	JCR 	KeybdGetCharNoWaitCtx,7	; check for char at keyboard
   6776 009906                             .0004:
   6777 009906 A2 00 00                     	LDX		#0
   6778 009909                             .0006:
   6779 009909 E8                           	INX
   6780 00990A E0 D0 07                     	CPX		#2000
   6781 00990D D0 FA                        	BNE		.0006
   6782 00990F 42 5B A5 04                  	LDA		ZS:TickCount
   6783 009913 29 03 00                     	AND		#$3
   6784 009916 D0 E9                        	BNE		.0002
   6785 009918 20 1D 94                     	JSR		InvBomb
   6786 00991B 20 01 97                     	JSR		RenderInvaders
   6787 00991E 20 9D 94                     	JSR		RenderBombs
   6788 009921 20 66 94                     	JSR		MoveBombs
   6789 009924 42 5B A5 04                  	LDA		ZS:TickCount
   6790 009928 29 0F 00                     	AND		#$F
   6791 00992B D0 D4                        	BNE		.0002
   6792 00992D 20 38 96                     	JSR		IsAllDestroyed
   6793 009930 D0 B9                        	BNE		.0001
   6794 009932 20 A1 95                     	JSR		Move
   6795 009935 F0 B4                        	BEQ		.0001				; Can't move, re-initialize
   6796 009937 80 C8                        	BRA		.0002
   6797 009939                             .0005:
   6798 009939 85 6A                        	STA		inv_tick
   6799 00993B 80 C4                        	BRA		.0002
   6800 00993D                             .0003:
   6801 00993D C9 03 00                     	CMP		#3
   6802 009940 D0 C4                        	BNE		.0004
   6803 009942 42 5B 9C 68 78               	STZ		ZS:do_invaders
   6804 009947 42 60                        	RTT
   6805 009949 80 A0                        	BRA		.0001
                                           
   6807 00994B                             InvaderRow:
   6808 00994B 00 00                        	.word	0
   6809 00994D 00 00                        	.word	0
   6810 00994F 00 00                        	.word	0
   6811 009951 00 00                        	.word	0
   6812 009953 00 00                        	.word	0
   6813 009955 00 00                        	.word	0
   6814 009957 00 00                        	.word	0
   6815 009959 00 00                        	.word	0
                                           
   6817 00995B 01 00                        	.word	1
   6818 00995D 01 00                        	.word	1
   6819 00995F 01 00                        	.word	1
   6820 009961 01 00                        	.word	1
   6821 009963 01 00                        	.word	1
   6822 009965 01 00                        	.word	1
   6823 009967 01 00                        	.word	1
   6824 009969 01 00                        	.word	1
                                           
   6826 00996B 02 00                        	.word	2
   6827 00996D 02 00                        	.word	2
   6828 00996F 02 00                        	.word	2
   6829 009971 02 00                        	.word	2
   6830 009973 02 00                        	.word	2
   6831 009975 02 00                        	.word	2
   6832 009977 02 00                        	.word	2
   6833 009979 02 00                        	.word	2
                                           
   6835 00997B 03 00                        	.word	3
   6836 00997D 03 00                        	.word	3
   6837 00997F 03 00                        	.word	3
   6838 009981 03 00                        	.word	3
   6839 009983 03 00                        	.word	3
   6840 009985 03 00                        	.word	3
   6841 009987 03 00                        	.word	3
   6842 009989 03 00                        	.word	3
                                           
   6844 00998B 04 00                        	.word	4
   6845 00998D 04 00                        	.word	4
   6846 00998F 04 00                        	.word	4
   6847 009991 04 00                        	.word	4
   6848 009993 04 00                        	.word	4
   6849 009995 04 00                        	.word	4
   6850 009997 04 00                        	.word	4
   6851 009999 04 00                        	.word	4
                                           
   6853 00999B                             InvaderCol:
   6854 00999B 00 00                        	.word	0
   6855 00999D 01 00                        	.word	1
   6856 00999F 02 00                        	.word	2
   6857 0099A1 03 00                        	.word	3
   6858 0099A3 04 00                        	.word	4
   6859 0099A5 05 00                        	.word	5
   6860 0099A7 06 00                        	.word	6
   6861 0099A9 07 00                        	.word	7
                                           
   6863 0099AB 00 00                        	.word	0
   6864 0099AD 01 00                        	.word	1
   6865 0099AF 02 00                        	.word	2
   6866 0099B1 03 00                        	.word	3
   6867 0099B3 04 00                        	.word	4
   6868 0099B5 05 00                        	.word	5
   6869 0099B7 06 00                        	.word	6
   6870 0099B9 07 00                        	.word	7
                                           
   6872 0099BB 00 00                        	.word	0
   6873 0099BD 01 00                        	.word	1
   6874 0099BF 02 00                        	.word	2
   6875 0099C1 03 00                        	.word	3
   6876 0099C3 04 00                        	.word	4
   6877 0099C5 05 00                        	.word	5
   6878 0099C7 06 00                        	.word	6
   6879 0099C9 07 00                        	.word	7
                                           
   6881 0099CB 00 00                        	.word	0
   6882 0099CD 01 00                        	.word	1
   6883 0099CF 02 00                        	.word	2
   6884 0099D1 03 00                        	.word	3
   6885 0099D3 04 00                        	.word	4
   6886 0099D5 05 00                        	.word	5
   6887 0099D7 06 00                        	.word	6
   6888 0099D9 07 00                        	.word	7
                                           
   6890 0099DB 00 00                        	.word	0
   6891 0099DD 01 00                        	.word	1
   6892 0099DF 02 00                        	.word	2
   6893 0099E1 03 00                        	.word	3
   6894 0099E3 04 00                        	.word	4
   6895 0099E5 05 00                        	.word	5
   6896 0099E7 06 00                        	.word	6
   6897 0099E9 07 00                        	.word	7
                                           
                                           ; Starting Y co-ordinate for each invader
                                           
   6901 0099EB                             StartY:
   6902 0099EB 03 00                        	.word	3
   6903 0099ED 03 00                        	.word	3
   6904 0099EF 03 00                        	.word	3
   6905 0099F1 03 00                        	.word	3
   6906 0099F3 03 00                        	.word	3
   6907 0099F5 03 00                        	.word	3
   6908 0099F7 03 00                        	.word	3
   6909 0099F9 03 00                        	.word	3
                                           
   6911 0099FB 06 00                        	.word	6
   6912 0099FD 06 00                        	.word	6
   6913 0099FF 06 00                        	.word	6
   6914 009A01 06 00                        	.word	6
   6915 009A03 06 00                        	.word	6
   6916 009A05 06 00                        	.word	6
   6917 009A07 06 00                        	.word	6
   6918 009A09 06 00                        	.word	6
                                           
   6920 009A0B 09 00                        	.word	9
   6921 009A0D 09 00                        	.word	9
   6922 009A0F 09 00                        	.word	9
   6923 009A11 09 00                        	.word	9
   6924 009A13 09 00                        	.word	9
   6925 009A15 09 00                        	.word	9
   6926 009A17 09 00                        	.word	9
   6927 009A19 09 00                        	.word	9
                                           
   6929 009A1B 0C 00                        	.word	12
   6930 009A1D 0C 00                        	.word	12
   6931 009A1F 0C 00                        	.word	12
   6932 009A21 0C 00                        	.word	12
   6933 009A23 0C 00                        	.word	12
   6934 009A25 0C 00                        	.word	12
   6935 009A27 0C 00                        	.word	12
   6936 009A29 0C 00                        	.word	12
                                           
   6938 009A2B 0F 00                        	.word	15
   6939 009A2D 0F 00                        	.word	15
   6940 009A2F 0F 00                        	.word	15
   6941 009A31 0F 00                        	.word	15
   6942 009A33 0F 00                        	.word	15
   6943 009A35 0F 00                        	.word	15
   6944 009A37 0F 00                        	.word	15
   6945 009A39 0F 00                        	.word	15
                                           
                                           ; Starting X co-ordinate for each invader
                                           
   6949 009A3B                             StartX:
   6950 009A3B 01 00                        	.word	1
   6951 009A3D 05 00                        	.word	5
   6952 009A3F 09 00                        	.word	9
   6953 009A41 0D 00                        	.word	13
   6954 009A43 11 00                        	.word	17
   6955 009A45 15 00                        	.word	21
   6956 009A47 19 00                        	.word	25
   6957 009A49 1D 00                        	.word	29
                                           
   6959 009A4B 01 00                        	.word	1
   6960 009A4D 05 00                        	.word	5
   6961 009A4F 09 00                        	.word	9
   6962 009A51 0D 00                        	.word	13
   6963 009A53 11 00                        	.word	17
   6964 009A55 15 00                        	.word	21
   6965 009A57 19 00                        	.word	25
   6966 009A59 1D 00                        	.word	29
                                           
   6968 009A5B 01 00                        	.word	1
   6969 009A5D 05 00                        	.word	5
   6970 009A5F 09 00                        	.word	9
   6971 009A61 0D 00                        	.word	13
   6972 009A63 11 00                        	.word	17
   6973 009A65 15 00                        	.word	21
   6974 009A67 19 00                        	.word	25
   6975 009A69 1D 00                        	.word	29
                                           
   6977 009A6B 01 00                        	.word	1
   6978 009A6D 05 00                        	.word	5
   6979 009A6F 09 00                        	.word	9
   6980 009A71 0D 00                        	.word	13
   6981 009A73 11 00                        	.word	17
   6982 009A75 15 00                        	.word	21
   6983 009A77 19 00                        	.word	25
   6984 009A79 1D 00                        	.word	29
                                           
   6986 009A7B 01 00                        	.word	1
   6987 009A7D 05 00                        	.word	5
   6988 009A7F 09 00                        	.word	9
   6989 009A81 0D 00                        	.word	13
   6990 009A83 11 00                        	.word	17
   6991 009A85 15 00                        	.word	21
   6992 009A87 19 00                        	.word	25
   6993 009A89 1D 00                        	.word	29
                                           
   6995 009A8B                             InvaderType:
   6996 009A8B 01 00                        	.word	1
   6997 009A8D 01 00                        	.word	1
   6998 009A8F 01 00                        	.word	1
   6999 009A91 01 00                        	.word	1
   7000 009A93 01 00                        	.word	1
   7001 009A95 01 00                        	.word	1
   7002 009A97 01 00                        	.word	1
   7003 009A99 01 00                        	.word	1
                                           
   7005 009A9B 02 00                        	.word	2
   7006 009A9D 02 00                        	.word	2
   7007 009A9F 02 00                        	.word	2
   7008 009AA1 02 00                        	.word	2
   7009 009AA3 02 00                        	.word	2
   7010 009AA5 02 00                        	.word	2
   7011 009AA7 02 00                        	.word	2
   7012 009AA9 02 00                        	.word	2
                                           
   7014 009AAB 02 00                        	.word	2
   7015 009AAD 02 00                        	.word	2
   7016 009AAF 02 00                        	.word	2
   7017 009AB1 02 00                        	.word	2
   7018 009AB3 02 00                        	.word	2
   7019 009AB5 02 00                        	.word	2
   7020 009AB7 02 00                        	.word	2
   7021 009AB9 02 00                        	.word	2
                                           
   7023 009ABB 03 00                        	.word	3
   7024 009ABD 03 00                        	.word	3
   7025 009ABF 03 00                        	.word	3
   7026 009AC1 03 00                        	.word	3
   7027 009AC3 03 00                        	.word	3
   7028 009AC5 03 00                        	.word	3
   7029 009AC7 03 00                        	.word	3
   7030 009AC9 03 00                        	.word	3
                                           
   7032 009ACB 03 00                        	.word	3
   7033 009ACD 03 00                        	.word	3
   7034 009ACF 03 00                        	.word	3
   7035 009AD1 03 00                        	.word	3
   7036 009AD3 03 00                        	.word	3
   7037 009AD5 03 00                        	.word	3
   7038 009AD7 03 00                        	.word	3
   7039 009AD9 03 00                        	.word	3
                                           			
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FTBios816.asm


                                           .include "invaders.asm"
                                           
                                           ;	cpu		W65C816S
                                           	cpu		FT832
   7044 009ADB FF FF FF FF FF FF FF FF      	.org	$C000
   7044 009AE3 FF FF FF FF FF FF FF FF    
   7044 009AEB FF FF FF FF FF FF FF FF    
   7044 009AF3 FF FF FF FF FF FF FF FF    
   7044 009AFB FF FF FF FF FF FF FF FF    
   7044 009B03 FF FF FF FF FF FF FF FF    
   7044 009B0B FF FF FF FF FF FF FF FF    
   7044 009B13 FF FF FF FF FF FF FF FF    
   7044 009B1B FF FF FF FF FF FF FF FF    
   7044 009B23 FF FF FF FF FF FF FF FF    
   7044 009B2B FF FF FF FF FF FF FF FF    
   7044 009B33 FF FF FF FF FF FF FF FF    
   7044 009B3B FF FF FF FF FF FF FF FF    
   7044 009B43 FF FF FF FF FF FF FF FF    
   7044 009B4B FF FF FF FF FF FF FF FF    
   7044 009B53 FF FF FF FF FF FF FF FF    
   7044 009B5B FF FF FF FF FF FF FF FF    
   7044 009B63 FF FF FF FF FF FF FF FF    
   7044 009B6B FF FF FF FF FF FF FF FF    
   7044 009B73 FF FF FF FF FF FF FF FF    
   7044 009B7B FF FF FF FF FF FF FF FF    
   7044 009B83 FF FF FF FF FF FF FF FF    
   7044 009B8B FF FF FF FF FF FF FF FF    
   7044 009B93 FF FF FF FF FF FF FF FF    
   7044 009B9B FF FF FF FF FF FF FF FF    
   7044 009BA3 FF FF FF FF FF FF FF FF    
   7044 009BAB FF FF FF FF FF FF FF FF    
   7044 009BB3 FF FF FF FF FF FF FF FF    
   7044 009BBB FF FF FF FF FF FF FF FF    
   7044 009BC3 FF FF FF FF FF FF FF FF    
   7044 009BCB FF FF FF FF FF FF FF FF    
   7044 009BD3 FF FF FF FF FF FF FF FF    
   7044 009BDB FF FF FF FF FF FF FF FF    
   7044 009BE3 FF FF FF FF FF FF FF FF    
   7044 009BEB FF FF FF FF FF FF FF FF    
   7044 009BF3 FF FF FF FF FF FF FF FF    
   7044 009BFB FF FF FF FF FF FF FF FF    
   7044 009C03 FF FF FF FF FF FF FF FF    
   7044 009C0B FF FF FF FF FF FF FF FF    
   7044 009C13 FF FF FF FF FF FF FF FF    
   7044 009C1B FF FF FF FF FF FF FF FF    
   7044 009C23 FF FF FF FF FF FF FF FF    
   7044 009C2B FF FF FF FF FF FF FF FF    
   7044 009C33 FF FF FF FF FF FF FF FF    
   7044 009C3B FF FF FF FF FF FF FF FF    
   7044 009C43 FF FF FF FF FF FF FF FF    
   7044 009C4B FF FF FF FF FF FF FF FF    
   7044 009C53 FF FF FF FF FF FF FF FF    
   7044 009C5B FF FF FF FF FF FF FF FF    
   7044 009C63 FF FF FF FF FF FF FF FF    
   7044 009C6B FF FF FF FF FF FF FF FF    
   7044 009C73 FF FF FF FF FF FF FF FF    
   7044 009C7B FF FF FF FF FF FF FF FF    
   7044 009C83 FF FF FF FF FF FF FF FF    
   7044 009C8B FF FF FF FF FF FF FF FF    
   7044 009C93 FF FF FF FF FF FF FF FF    
   7044 009C9B FF FF FF FF FF FF FF FF    
   7044 009CA3 FF FF FF FF FF FF FF FF    
   7044 009CAB FF FF FF FF FF FF FF FF    
   7044 009CB3 FF FF FF FF FF FF FF FF    
   7044 009CBB FF FF FF FF FF FF FF FF    
   7044 009CC3 FF FF FF FF FF FF FF FF    
   7044 009CCB FF FF FF FF FF FF FF FF    
   7044 009CD3 FF FF FF FF FF FF FF FF    
   7044 009CDB FF FF FF FF FF FF FF FF    
   7044 009CE3 FF FF FF FF FF FF FF FF    
   7044 009CEB FF FF FF FF FF FF FF FF    
   7044 009CF3 FF FF FF FF FF FF FF FF    
   7044 009CFB FF FF FF FF FF FF FF FF    
   7044 009D03 FF FF FF FF FF FF FF FF    
   7044 009D0B FF FF FF FF FF FF FF FF    
   7044 009D13 FF FF FF FF FF FF FF FF    
   7044 009D1B FF FF FF FF FF FF FF FF    
   7044 009D23 FF FF FF FF FF FF FF FF    
   7044 009D2B FF FF FF FF FF FF FF FF    
   7044 009D33 FF FF FF FF FF FF FF FF    
   7044 009D3B FF FF FF FF FF FF FF FF    
   7044 009D43 FF FF FF FF FF FF FF FF    
   7044 009D4B FF FF FF FF FF FF FF FF    
   7044 009D53 FF FF FF FF FF FF FF FF    
   7044 009D5B FF FF FF FF FF FF FF FF    
   7044 009D63 FF FF FF FF FF FF FF FF    
   7044 009D6B FF FF FF FF FF FF FF FF    
   7044 009D73 FF FF FF FF FF FF FF FF    
   7044 009D7B FF FF FF FF FF FF FF FF    
   7044 009D83 FF FF FF FF FF FF FF FF    
   7044 009D8B FF FF FF FF FF FF FF FF    
   7044 009D93 FF FF FF FF FF FF FF FF    
   7044 009D9B FF FF FF FF FF FF FF FF    
   7044 009DA3 FF FF FF FF FF FF FF FF    
   7044 009DAB FF FF FF FF FF FF FF FF    
   7044 009DB3 FF FF FF FF FF FF FF FF    
   7044 009DBB FF FF FF FF FF FF FF FF    
   7044 009DC3 FF FF FF FF FF FF FF FF    
   7044 009DCB FF FF FF FF FF FF FF FF    
   7044 009DD3 FF FF FF FF FF FF FF FF    
   7044 009DDB FF FF FF FF FF FF FF FF    
   7044 009DE3 FF FF FF FF FF FF FF FF    
   7044 009DEB FF FF FF FF FF FF FF FF    
   7044 009DF3 FF FF FF FF FF FF FF FF    
   7044 009DFB FF FF FF FF FF FF FF FF    
   7044 009E03 FF FF FF FF FF FF FF FF    
   7044 009E0B FF FF FF FF FF FF FF FF    
   7044 009E13 FF FF FF FF FF FF FF FF    
   7044 009E1B FF FF FF FF FF FF FF FF    
   7044 009E23 FF FF FF FF FF FF FF FF    
   7044 009E2B FF FF FF FF FF FF FF FF    
   7044 009E33 FF FF FF FF FF FF FF FF    
   7044 009E3B FF FF FF FF FF FF FF FF    
   7044 009E43 FF FF FF FF FF FF FF FF    
   7044 009E4B FF FF FF FF FF FF FF FF    
   7044 009E53 FF FF FF FF FF FF FF FF    
   7044 009E5B FF FF FF FF FF FF FF FF    
   7044 009E63 FF FF FF FF FF FF FF FF    
   7044 009E6B FF FF FF FF FF FF FF FF    
   7044 009E73 FF FF FF FF FF FF FF FF    
   7044 009E7B FF FF FF FF FF FF FF FF    
   7044 009E83 FF FF FF FF FF FF FF FF    
   7044 009E8B FF FF FF FF FF FF FF FF    
   7044 009E93 FF FF FF FF FF FF FF FF    
   7044 009E9B FF FF FF FF FF FF FF FF    
   7044 009EA3 FF FF FF FF FF FF FF FF    
   7044 009EAB FF FF FF FF FF FF FF FF    
   7044 009EB3 FF FF FF FF FF FF FF FF    
   7044 009EBB FF FF FF FF FF FF FF FF    
   7044 009EC3 FF FF FF FF FF FF FF FF    
   7044 009ECB FF FF FF FF FF FF FF FF    
   7044 009ED3 FF FF FF FF FF FF FF FF    
   7044 009EDB FF FF FF FF FF FF FF FF    
   7044 009EE3 FF FF FF FF FF FF FF FF    
   7044 009EEB FF FF FF FF FF FF FF FF    
   7044 009EF3 FF FF FF FF FF FF FF FF    
   7044 009EFB FF FF FF FF FF FF FF FF    
   7044 009F03 FF FF FF FF FF FF FF FF    
   7044 009F0B FF FF FF FF FF FF FF FF    
   7044 009F13 FF FF FF FF FF FF FF FF    
   7044 009F1B FF FF FF FF FF FF FF FF    
   7044 009F23 FF FF FF FF FF FF FF FF    
   7044 009F2B FF FF FF FF FF FF FF FF    
   7044 009F33 FF FF FF FF FF FF FF FF    
   7044 009F3B FF FF FF FF FF FF FF FF    
   7044 009F43 FF FF FF FF FF FF FF FF    
   7044 009F4B FF FF FF FF FF FF FF FF    
   7044 009F53 FF FF FF FF FF FF FF FF    
   7044 009F5B FF FF FF FF FF FF FF FF    
   7044 009F63 FF FF FF FF FF FF FF FF    
   7044 009F6B FF FF FF FF FF FF FF FF    
   7044 009F73 FF FF FF FF FF FF FF FF    
   7044 009F7B FF FF FF FF FF FF FF FF    
   7044 009F83 FF FF FF FF FF FF FF FF    
   7044 009F8B FF FF FF FF FF FF FF FF    
   7044 009F93 FF FF FF FF FF FF FF FF    
   7044 009F9B FF FF FF FF FF FF FF FF    
   7044 009FA3 FF FF FF FF FF FF FF FF    
   7044 009FAB FF FF FF FF FF FF FF FF    
   7044 009FB3 FF FF FF FF FF FF FF FF    
   7044 009FBB FF FF FF FF FF FF FF FF    
   7044 009FC3 FF FF FF FF FF FF FF FF    
   7044 009FCB FF FF FF FF FF FF FF FF    
   7044 009FD3 FF FF FF FF FF FF FF FF    
   7044 009FDB FF FF FF FF FF FF FF FF    
   7044 009FE3 FF FF FF FF FF FF FF FF    
   7044 009FEB FF FF FF FF FF FF FF FF    
   7044 009FF3 FF FF FF FF FF FF FF FF    
   7044 009FFB FF FF FF FF FF FF FF FF    
   7044 00A003 FF FF FF FF FF FF FF FF    
   7044 00A00B FF FF FF FF FF FF FF FF    
   7044 00A013 FF FF FF FF FF FF FF FF    
   7044 00A01B FF FF FF FF FF FF FF FF    
   7044 00A023 FF FF FF FF FF FF FF FF    
   7044 00A02B FF FF FF FF FF FF FF FF    
   7044 00A033 FF FF FF FF FF FF FF FF    
   7044 00A03B FF FF FF FF FF FF FF FF    
   7044 00A043 FF FF FF FF FF FF FF FF    
   7044 00A04B FF FF FF FF FF FF FF FF    
   7044 00A053 FF FF FF FF FF FF FF FF    
   7044 00A05B FF FF FF FF FF FF FF FF    
   7044 00A063 FF FF FF FF FF FF FF FF    
   7044 00A06B FF FF FF FF FF FF FF FF    
   7044 00A073 FF FF FF FF FF FF FF FF    
   7044 00A07B FF FF FF FF FF FF FF FF    
   7044 00A083 FF FF FF FF FF FF FF FF    
   7044 00A08B FF FF FF FF FF FF FF FF    
   7044 00A093 FF FF FF FF FF FF FF FF    
   7044 00A09B FF FF FF FF FF FF FF FF    
   7044 00A0A3 FF FF FF FF FF FF FF FF    
   7044 00A0AB FF FF FF FF FF FF FF FF    
   7044 00A0B3 FF FF FF FF FF FF FF FF    
   7044 00A0BB FF FF FF FF FF FF FF FF    
   7044 00A0C3 FF FF FF FF FF FF FF FF    
   7044 00A0CB FF FF FF FF FF FF FF FF    
   7044 00A0D3 FF FF FF FF FF FF FF FF    
   7044 00A0DB FF FF FF FF FF FF FF FF    
   7044 00A0E3 FF FF FF FF FF FF FF FF    
   7044 00A0EB FF FF FF FF FF FF FF FF    
   7044 00A0F3 FF FF FF FF FF FF FF FF    
   7044 00A0FB FF FF FF FF FF FF FF FF    
   7044 00A103 FF FF FF FF FF FF FF FF    
   7044 00A10B FF FF FF FF FF FF FF FF    
   7044 00A113 FF FF FF FF FF FF FF FF    
   7044 00A11B FF FF FF FF FF FF FF FF    
   7044 00A123 FF FF FF FF FF FF FF FF    
   7044 00A12B FF FF FF FF FF FF FF FF    
   7044 00A133 FF FF FF FF FF FF FF FF    
   7044 00A13B FF FF FF FF FF FF FF FF    
   7044 00A143 FF FF FF FF FF FF FF FF    
   7044 00A14B FF FF FF FF FF FF FF FF    
   7044 00A153 FF FF FF FF FF FF FF FF    
   7044 00A15B FF FF FF FF FF FF FF FF    
   7044 00A163 FF FF FF FF FF FF FF FF    
   7044 00A16B FF FF FF FF FF FF FF FF    
   7044 00A173 FF FF FF FF FF FF FF FF    
   7044 00A17B FF FF FF FF FF FF FF FF    
   7044 00A183 FF FF FF FF FF FF FF FF    
   7044 00A18B FF FF FF FF FF FF FF FF    
   7044 00A193 FF FF FF FF FF FF FF FF    
   7044 00A19B FF FF FF FF FF FF FF FF    
   7044 00A1A3 FF FF FF FF FF FF FF FF    
   7044 00A1AB FF FF FF FF FF FF FF FF    
   7044 00A1B3 FF FF FF FF FF FF FF FF    
   7044 00A1BB FF FF FF FF FF FF FF FF    
   7044 00A1C3 FF FF FF FF FF FF FF FF    
   7044 00A1CB FF FF FF FF FF FF FF FF    
   7044 00A1D3 FF FF FF FF FF FF FF FF    
   7044 00A1DB FF FF FF FF FF FF FF FF    
   7044 00A1E3 FF FF FF FF FF FF FF FF    
   7044 00A1EB FF FF FF FF FF FF FF FF    
   7044 00A1F3 FF FF FF FF FF FF FF FF    
   7044 00A1FB FF FF FF FF FF FF FF FF    
   7044 00A203 FF FF FF FF FF FF FF FF    
   7044 00A20B FF FF FF FF FF FF FF FF    
   7044 00A213 FF FF FF FF FF FF FF FF    
   7044 00A21B FF FF FF FF FF FF FF FF    
   7044 00A223 FF FF FF FF FF FF FF FF    
   7044 00A22B FF FF FF FF FF FF FF FF    
   7044 00A233 FF FF FF FF FF FF FF FF    
   7044 00A23B FF FF FF FF FF FF FF FF    
   7044 00A243 FF FF FF FF FF FF FF FF    
   7044 00A24B FF FF FF FF FF FF FF FF    
   7044 00A253 FF FF FF FF FF FF FF FF    
   7044 00A25B FF FF FF FF FF FF FF FF    
   7044 00A263 FF FF FF FF FF FF FF FF    
   7044 00A26B FF FF FF FF FF FF FF FF    
   7044 00A273 FF FF FF FF FF FF FF FF    
   7044 00A27B FF FF FF FF FF FF FF FF    
   7044 00A283 FF FF FF FF FF FF FF FF    
   7044 00A28B FF FF FF FF FF FF FF FF    
   7044 00A293 FF FF FF FF FF FF FF FF    
   7044 00A29B FF FF FF FF FF FF FF FF    
   7044 00A2A3 FF FF FF FF FF FF FF FF    
   7044 00A2AB FF FF FF FF FF FF FF FF    
   7044 00A2B3 FF FF FF FF FF FF FF FF    
   7044 00A2BB FF FF FF FF FF FF FF FF    
   7044 00A2C3 FF FF FF FF FF FF FF FF    
   7044 00A2CB FF FF FF FF FF FF FF FF    
   7044 00A2D3 FF FF FF FF FF FF FF FF    
   7044 00A2DB FF FF FF FF FF FF FF FF    
   7044 00A2E3 FF FF FF FF FF FF FF FF    
   7044 00A2EB FF FF FF FF FF FF FF FF    
   7044 00A2F3 FF FF FF FF FF FF FF FF    
   7044 00A2FB FF FF FF FF FF FF FF FF    
   7044 00A303 FF FF FF FF FF FF FF FF    
   7044 00A30B FF FF FF FF FF FF FF FF    
   7044 00A313 FF FF FF FF FF FF FF FF    
   7044 00A31B FF FF FF FF FF FF FF FF    
   7044 00A323 FF FF FF FF FF FF FF FF    
   7044 00A32B FF FF FF FF FF FF FF FF    
   7044 00A333 FF FF FF FF FF FF FF FF    
   7044 00A33B FF FF FF FF FF FF FF FF    
   7044 00A343 FF FF FF FF FF FF FF FF    
   7044 00A34B FF FF FF FF FF FF FF FF    
   7044 00A353 FF FF FF FF FF FF FF FF    
   7044 00A35B FF FF FF FF FF FF FF FF    
   7044 00A363 FF FF FF FF FF FF FF FF    
   7044 00A36B FF FF FF FF FF FF FF FF    
   7044 00A373 FF FF FF FF FF FF FF FF    
   7044 00A37B FF FF FF FF FF FF FF FF    
   7044 00A383 FF FF FF FF FF FF FF FF    
   7044 00A38B FF FF FF FF FF FF FF FF    
   7044 00A393 FF FF FF FF FF FF FF FF    
   7044 00A39B FF FF FF FF FF FF FF FF    
   7044 00A3A3 FF FF FF FF FF FF FF FF    
   7044 00A3AB FF FF FF FF FF FF FF FF    
   7044 00A3B3 FF FF FF FF FF FF FF FF    
   7044 00A3BB FF FF FF FF FF FF FF FF    
   7044 00A3C3 FF FF FF FF FF FF FF FF    
   7044 00A3CB FF FF FF FF FF FF FF FF    
   7044 00A3D3 FF FF FF FF FF FF FF FF    
   7044 00A3DB FF FF FF FF FF FF FF FF    
   7044 00A3E3 FF FF FF FF FF FF FF FF    
   7044 00A3EB FF FF FF FF FF FF FF FF    
   7044 00A3F3 FF FF FF FF FF FF FF FF    
   7044 00A3FB FF FF FF FF FF FF FF FF    
   7044 00A403 FF FF FF FF FF FF FF FF    
   7044 00A40B FF FF FF FF FF FF FF FF    
   7044 00A413 FF FF FF FF FF FF FF FF    
   7044 00A41B FF FF FF FF FF FF FF FF    
   7044 00A423 FF FF FF FF FF FF FF FF    
   7044 00A42B FF FF FF FF FF FF FF FF    
   7044 00A433 FF FF FF FF FF FF FF FF    
   7044 00A43B FF FF FF FF FF FF FF FF    
   7044 00A443 FF FF FF FF FF FF FF FF    
   7044 00A44B FF FF FF FF FF FF FF FF    
   7044 00A453 FF FF FF FF FF FF FF FF    
   7044 00A45B FF FF FF FF FF FF FF FF    
   7044 00A463 FF FF FF FF FF FF FF FF    
   7044 00A46B FF FF FF FF FF FF FF FF    
   7044 00A473 FF FF FF FF FF FF FF FF    
   7044 00A47B FF FF FF FF FF FF FF FF    
   7044 00A483 FF FF FF FF FF FF FF FF    
   7044 00A48B FF FF FF FF FF FF FF FF    
   7044 00A493 FF FF FF FF FF FF FF FF    
   7044 00A49B FF FF FF FF FF FF FF FF    
   7044 00A4A3 FF FF FF FF FF FF FF FF    
   7044 00A4AB FF FF FF FF FF FF FF FF    
   7044 00A4B3 FF FF FF FF FF FF FF FF    
   7044 00A4BB FF FF FF FF FF FF FF FF    
   7044 00A4C3 FF FF FF FF FF FF FF FF    
   7044 00A4CB FF FF FF FF FF FF FF FF    
   7044 00A4D3 FF FF FF FF FF FF FF FF    
   7044 00A4DB FF FF FF FF FF FF FF FF    
   7044 00A4E3 FF FF FF FF FF FF FF FF    
   7044 00A4EB FF FF FF FF FF FF FF FF    
   7044 00A4F3 FF FF FF FF FF FF FF FF    
   7044 00A4FB FF FF FF FF FF FF FF FF    
   7044 00A503 FF FF FF FF FF FF FF FF    
   7044 00A50B FF FF FF FF FF FF FF FF    
   7044 00A513 FF FF FF FF FF FF FF FF    
   7044 00A51B FF FF FF FF FF FF FF FF    
   7044 00A523 FF FF FF FF FF FF FF FF    
   7044 00A52B FF FF FF FF FF FF FF FF    
   7044 00A533 FF FF FF FF FF FF FF FF    
   7044 00A53B FF FF FF FF FF FF FF FF    
   7044 00A543 FF FF FF FF FF FF FF FF    
   7044 00A54B FF FF FF FF FF FF FF FF    
   7044 00A553 FF FF FF FF FF FF FF FF    
   7044 00A55B FF FF FF FF FF FF FF FF    
   7044 00A563 FF FF FF FF FF FF FF FF    
   7044 00A56B FF FF FF FF FF FF FF FF    
   7044 00A573 FF FF FF FF FF FF FF FF    
   7044 00A57B FF FF FF FF FF FF FF FF    
   7044 00A583 FF FF FF FF FF FF FF FF    
   7044 00A58B FF FF FF FF FF FF FF FF    
   7044 00A593 FF FF FF FF FF FF FF FF    
   7044 00A59B FF FF FF FF FF FF FF FF    
   7044 00A5A3 FF FF FF FF FF FF FF FF    
   7044 00A5AB FF FF FF FF FF FF FF FF    
   7044 00A5B3 FF FF FF FF FF FF FF FF    
   7044 00A5BB FF FF FF FF FF FF FF FF    
   7044 00A5C3 FF FF FF FF FF FF FF FF    
   7044 00A5CB FF FF FF FF FF FF FF FF    
   7044 00A5D3 FF FF FF FF FF FF FF FF    
   7044 00A5DB FF FF FF FF FF FF FF FF    
   7044 00A5E3 FF FF FF FF FF FF FF FF    
   7044 00A5EB FF FF FF FF FF FF FF FF    
   7044 00A5F3 FF FF FF FF FF FF FF FF    
   7044 00A5FB FF FF FF FF FF FF FF FF    
   7044 00A603 FF FF FF FF FF FF FF FF    
   7044 00A60B FF FF FF FF FF FF FF FF    
   7044 00A613 FF FF FF FF FF FF FF FF    
   7044 00A61B FF FF FF FF FF FF FF FF    
   7044 00A623 FF FF FF FF FF FF FF FF    
   7044 00A62B FF FF FF FF FF FF FF FF    
   7044 00A633 FF FF FF FF FF FF FF FF    
   7044 00A63B FF FF FF FF FF FF FF FF    
   7044 00A643 FF FF FF FF FF FF FF FF    
   7044 00A64B FF FF FF FF FF FF FF FF    
   7044 00A653 FF FF FF FF FF FF FF FF    
   7044 00A65B FF FF FF FF FF FF FF FF    
   7044 00A663 FF FF FF FF FF FF FF FF    
   7044 00A66B FF FF FF FF FF FF FF FF    
   7044 00A673 FF FF FF FF FF FF FF FF    
   7044 00A67B FF FF FF FF FF FF FF FF    
   7044 00A683 FF FF FF FF FF FF FF FF    
   7044 00A68B FF FF FF FF FF FF FF FF    
   7044 00A693 FF FF FF FF FF FF FF FF    
   7044 00A69B FF FF FF FF FF FF FF FF    
   7044 00A6A3 FF FF FF FF FF FF FF FF    
   7044 00A6AB FF FF FF FF FF FF FF FF    
   7044 00A6B3 FF FF FF FF FF FF FF FF    
   7044 00A6BB FF FF FF FF FF FF FF FF    
   7044 00A6C3 FF FF FF FF FF FF FF FF    
   7044 00A6CB FF FF FF FF FF FF FF FF    
   7044 00A6D3 FF FF FF FF FF FF FF FF    
   7044 00A6DB FF FF FF FF FF FF FF FF    
   7044 00A6E3 FF FF FF FF FF FF FF FF    
   7044 00A6EB FF FF FF FF FF FF FF FF    
   7044 00A6F3 FF FF FF FF FF FF FF FF    
   7044 00A6FB FF FF FF FF FF FF FF FF    
   7044 00A703 FF FF FF FF FF FF FF FF    
   7044 00A70B FF FF FF FF FF FF FF FF    
   7044 00A713 FF FF FF FF FF FF FF FF    
   7044 00A71B FF FF FF FF FF FF FF FF    
   7044 00A723 FF FF FF FF FF FF FF FF    
   7044 00A72B FF FF FF FF FF FF FF FF    
   7044 00A733 FF FF FF FF FF FF FF FF    
   7044 00A73B FF FF FF FF FF FF FF FF    
   7044 00A743 FF FF FF FF FF FF FF FF    
   7044 00A74B FF FF FF FF FF FF FF FF    
   7044 00A753 FF FF FF FF FF FF FF FF    
   7044 00A75B FF FF FF FF FF FF FF FF    
   7044 00A763 FF FF FF FF FF FF FF FF    
   7044 00A76B FF FF FF FF FF FF FF FF    
   7044 00A773 FF FF FF FF FF FF FF FF    
   7044 00A77B FF FF FF FF FF FF FF FF    
   7044 00A783 FF FF FF FF FF FF FF FF    
   7044 00A78B FF FF FF FF FF FF FF FF    
   7044 00A793 FF FF FF FF FF FF FF FF    
   7044 00A79B FF FF FF FF FF FF FF FF    
   7044 00A7A3 FF FF FF FF FF FF FF FF    
   7044 00A7AB FF FF FF FF FF FF FF FF    
   7044 00A7B3 FF FF FF FF FF FF FF FF    
   7044 00A7BB FF FF FF FF FF FF FF FF    
   7044 00A7C3 FF FF FF FF FF FF FF FF    
   7044 00A7CB FF FF FF FF FF FF FF FF    
   7044 00A7D3 FF FF FF FF FF FF FF FF    
   7044 00A7DB FF FF FF FF FF FF FF FF    
   7044 00A7E3 FF FF FF FF FF FF FF FF    
   7044 00A7EB FF FF FF FF FF FF FF FF    
   7044 00A7F3 FF FF FF FF FF FF FF FF    
   7044 00A7FB FF FF FF FF FF FF FF FF    
   7044 00A803 FF FF FF FF FF FF FF FF    
   7044 00A80B FF FF FF FF FF FF FF FF    
   7044 00A813 FF FF FF FF FF FF FF FF    
   7044 00A81B FF FF FF FF FF FF FF FF    
   7044 00A823 FF FF FF FF FF FF FF FF    
   7044 00A82B FF FF FF FF FF FF FF FF    
   7044 00A833 FF FF FF FF FF FF FF FF    
   7044 00A83B FF FF FF FF FF FF FF FF    
   7044 00A843 FF FF FF FF FF FF FF FF    
   7044 00A84B FF FF FF FF FF FF FF FF    
   7044 00A853 FF FF FF FF FF FF FF FF    
   7044 00A85B FF FF FF FF FF FF FF FF    
   7044 00A863 FF FF FF FF FF FF FF FF    
   7044 00A86B FF FF FF FF FF FF FF FF    
   7044 00A873 FF FF FF FF FF FF FF FF    
   7044 00A87B FF FF FF FF FF FF FF FF    
   7044 00A883 FF FF FF FF FF FF FF FF    
   7044 00A88B FF FF FF FF FF FF FF FF    
   7044 00A893 FF FF FF FF FF FF FF FF    
   7044 00A89B FF FF FF FF FF FF FF FF    
   7044 00A8A3 FF FF FF FF FF FF FF FF    
   7044 00A8AB FF FF FF FF FF FF FF FF    
   7044 00A8B3 FF FF FF FF FF FF FF FF    
   7044 00A8BB FF FF FF FF FF FF FF FF    
   7044 00A8C3 FF FF FF FF FF FF FF FF    
   7044 00A8CB FF FF FF FF FF FF FF FF    
   7044 00A8D3 FF FF FF FF FF FF FF FF    
   7044 00A8DB FF FF FF FF FF FF FF FF    
   7044 00A8E3 FF FF FF FF FF FF FF FF    
   7044 00A8EB FF FF FF FF FF FF FF FF    
   7044 00A8F3 FF FF FF FF FF FF FF FF    
   7044 00A8FB FF FF FF FF FF FF FF FF    
   7044 00A903 FF FF FF FF FF FF FF FF    
   7044 00A90B FF FF FF FF FF FF FF FF    
   7044 00A913 FF FF FF FF FF FF FF FF    
   7044 00A91B FF FF FF FF FF FF FF FF    
   7044 00A923 FF FF FF FF FF FF FF FF    
   7044 00A92B FF FF FF FF FF FF FF FF    
   7044 00A933 FF FF FF FF FF FF FF FF    
   7044 00A93B FF FF FF FF FF FF FF FF    
   7044 00A943 FF FF FF FF FF FF FF FF    
   7044 00A94B FF FF FF FF FF FF FF FF    
   7044 00A953 FF FF FF FF FF FF FF FF    
   7044 00A95B FF FF FF FF FF FF FF FF    
   7044 00A963 FF FF FF FF FF FF FF FF    
   7044 00A96B FF FF FF FF FF FF FF FF    
   7044 00A973 FF FF FF FF FF FF FF FF    
   7044 00A97B FF FF FF FF FF FF FF FF    
   7044 00A983 FF FF FF FF FF FF FF FF    
   7044 00A98B FF FF FF FF FF FF FF FF    
   7044 00A993 FF FF FF FF FF FF FF FF    
   7044 00A99B FF FF FF FF FF FF FF FF    
   7044 00A9A3 FF FF FF FF FF FF FF FF    
   7044 00A9AB FF FF FF FF FF FF FF FF    
   7044 00A9B3 FF FF FF FF FF FF FF FF    
   7044 00A9BB FF FF FF FF FF FF FF FF    
   7044 00A9C3 FF FF FF FF FF FF FF FF    
   7044 00A9CB FF FF FF FF FF FF FF FF    
   7044 00A9D3 FF FF FF FF FF FF FF FF    
   7044 00A9DB FF FF FF FF FF FF FF FF    
   7044 00A9E3 FF FF FF FF FF FF FF FF    
   7044 00A9EB FF FF FF FF FF FF FF FF    
   7044 00A9F3 FF FF FF FF FF FF FF FF    
   7044 00A9FB FF FF FF FF FF FF FF FF    
   7044 00AA03 FF FF FF FF FF FF FF FF    
   7044 00AA0B FF FF FF FF FF FF FF FF    
   7044 00AA13 FF FF FF FF FF FF FF FF    
   7044 00AA1B FF FF FF FF FF FF FF FF    
   7044 00AA23 FF FF FF FF FF FF FF FF    
   7044 00AA2B FF FF FF FF FF FF FF FF    
   7044 00AA33 FF FF FF FF FF FF FF FF    
   7044 00AA3B FF FF FF FF FF FF FF FF    
   7044 00AA43 FF FF FF FF FF FF FF FF    
   7044 00AA4B FF FF FF FF FF FF FF FF    
   7044 00AA53 FF FF FF FF FF FF FF FF    
   7044 00AA5B FF FF FF FF FF FF FF FF    
   7044 00AA63 FF FF FF FF FF FF FF FF    
   7044 00AA6B FF FF FF FF FF FF FF FF    
   7044 00AA73 FF FF FF FF FF FF FF FF    
   7044 00AA7B FF FF FF FF FF FF FF FF    
   7044 00AA83 FF FF FF FF FF FF FF FF    
   7044 00AA8B FF FF FF FF FF FF FF FF    
   7044 00AA93 FF FF FF FF FF FF FF FF    
   7044 00AA9B FF FF FF FF FF FF FF FF    
   7044 00AAA3 FF FF FF FF FF FF FF FF    
   7044 00AAAB FF FF FF FF FF FF FF FF    
   7044 00AAB3 FF FF FF FF FF FF FF FF    
   7044 00AABB FF FF FF FF FF FF FF FF    
   7044 00AAC3 FF FF FF FF FF FF FF FF    
   7044 00AACB FF FF FF FF FF FF FF FF    
   7044 00AAD3 FF FF FF FF FF FF FF FF    
   7044 00AADB FF FF FF FF FF FF FF FF    
   7044 00AAE3 FF FF FF FF FF FF FF FF    
   7044 00AAEB FF FF FF FF FF FF FF FF    
   7044 00AAF3 FF FF FF FF FF FF FF FF    
   7044 00AAFB FF FF FF FF FF FF FF FF    
   7044 00AB03 FF FF FF FF FF FF FF FF    
   7044 00AB0B FF FF FF FF FF FF FF FF    
   7044 00AB13 FF FF FF FF FF FF FF FF    
   7044 00AB1B FF FF FF FF FF FF FF FF    
   7044 00AB23 FF FF FF FF FF FF FF FF    
   7044 00AB2B FF FF FF FF FF FF FF FF    
   7044 00AB33 FF FF FF FF FF FF FF FF    
   7044 00AB3B FF FF FF FF FF FF FF FF    
   7044 00AB43 FF FF FF FF FF FF FF FF    
   7044 00AB4B FF FF FF FF FF FF FF FF    
   7044 00AB53 FF FF FF FF FF FF FF FF    
   7044 00AB5B FF FF FF FF FF FF FF FF    
   7044 00AB63 FF FF FF FF FF FF FF FF    
   7044 00AB6B FF FF FF FF FF FF FF FF    
   7044 00AB73 FF FF FF FF FF FF FF FF    
   7044 00AB7B FF FF FF FF FF FF FF FF    
   7044 00AB83 FF FF FF FF FF FF FF FF    
   7044 00AB8B FF FF FF FF FF FF FF FF    
   7044 00AB93 FF FF FF FF FF FF FF FF    
   7044 00AB9B FF FF FF FF FF FF FF FF    
   7044 00ABA3 FF FF FF FF FF FF FF FF    
   7044 00ABAB FF FF FF FF FF FF FF FF    
   7044 00ABB3 FF FF FF FF FF FF FF FF    
   7044 00ABBB FF FF FF FF FF FF FF FF    
   7044 00ABC3 FF FF FF FF FF FF FF FF    
   7044 00ABCB FF FF FF FF FF FF FF FF    
   7044 00ABD3 FF FF FF FF FF FF FF FF    
   7044 00ABDB FF FF FF FF FF FF FF FF    
   7044 00ABE3 FF FF FF FF FF FF FF FF    
   7044 00ABEB FF FF FF FF FF FF FF FF    
   7044 00ABF3 FF FF FF FF FF FF FF FF    
   7044 00ABFB FF FF FF FF FF FF FF FF    
   7044 00AC03 FF FF FF FF FF FF FF FF    
   7044 00AC0B FF FF FF FF FF FF FF FF    
   7044 00AC13 FF FF FF FF FF FF FF FF    
   7044 00AC1B FF FF FF FF FF FF FF FF    
   7044 00AC23 FF FF FF FF FF FF FF FF    
   7044 00AC2B FF FF FF FF FF FF FF FF    
   7044 00AC33 FF FF FF FF FF FF FF FF    
   7044 00AC3B FF FF FF FF FF FF FF FF    
   7044 00AC43 FF FF FF FF FF FF FF FF    
   7044 00AC4B FF FF FF FF FF FF FF FF    
   7044 00AC53 FF FF FF FF FF FF FF FF    
   7044 00AC5B FF FF FF FF FF FF FF FF    
   7044 00AC63 FF FF FF FF FF FF FF FF    
   7044 00AC6B FF FF FF FF FF FF FF FF    
   7044 00AC73 FF FF FF FF FF FF FF FF    
   7044 00AC7B FF FF FF FF FF FF FF FF    
   7044 00AC83 FF FF FF FF FF FF FF FF    
   7044 00AC8B FF FF FF FF FF FF FF FF    
   7044 00AC93 FF FF FF FF FF FF FF FF    
   7044 00AC9B FF FF FF FF FF FF FF FF    
   7044 00ACA3 FF FF FF FF FF FF FF FF    
   7044 00ACAB FF FF FF FF FF FF FF FF    
   7044 00ACB3 FF FF FF FF FF FF FF FF    
   7044 00ACBB FF FF FF FF FF FF FF FF    
   7044 00ACC3 FF FF FF FF FF FF FF FF    
   7044 00ACCB FF FF FF FF FF FF FF FF    
   7044 00ACD3 FF FF FF FF FF FF FF FF    
   7044 00ACDB FF FF FF FF FF FF FF FF    
   7044 00ACE3 FF FF FF FF FF FF FF FF    
   7044 00ACEB FF FF FF FF FF FF FF FF    
   7044 00ACF3 FF FF FF FF FF FF FF FF    
   7044 00ACFB FF FF FF FF FF FF FF FF    
   7044 00AD03 FF FF FF FF FF FF FF FF    
   7044 00AD0B FF FF FF FF FF FF FF FF    
   7044 00AD13 FF FF FF FF FF FF FF FF    
   7044 00AD1B FF FF FF FF FF FF FF FF    
   7044 00AD23 FF FF FF FF FF FF FF FF    
   7044 00AD2B FF FF FF FF FF FF FF FF    
   7044 00AD33 FF FF FF FF FF FF FF FF    
   7044 00AD3B FF FF FF FF FF FF FF FF    
   7044 00AD43 FF FF FF FF FF FF FF FF    
   7044 00AD4B FF FF FF FF FF FF FF FF    
   7044 00AD53 FF FF FF FF FF FF FF FF    
   7044 00AD5B FF FF FF FF FF FF FF FF    
   7044 00AD63 FF FF FF FF FF FF FF FF    
   7044 00AD6B FF FF FF FF FF FF FF FF    
   7044 00AD73 FF FF FF FF FF FF FF FF    
   7044 00AD7B FF FF FF FF FF FF FF FF    
   7044 00AD83 FF FF FF FF FF FF FF FF    
   7044 00AD8B FF FF FF FF FF FF FF FF    
   7044 00AD93 FF FF FF FF FF FF FF FF    
   7044 00AD9B FF FF FF FF FF FF FF FF    
   7044 00ADA3 FF FF FF FF FF FF FF FF    
   7044 00ADAB FF FF FF FF FF FF FF FF    
   7044 00ADB3 FF FF FF FF FF FF FF FF    
   7044 00ADBB FF FF FF FF FF FF FF FF    
   7044 00ADC3 FF FF FF FF FF FF FF FF    
   7044 00ADCB FF FF FF FF FF FF FF FF    
   7044 00ADD3 FF FF FF FF FF FF FF FF    
   7044 00ADDB FF FF FF FF FF FF FF FF    
   7044 00ADE3 FF FF FF FF FF FF FF FF    
   7044 00ADEB FF FF FF FF FF FF FF FF    
   7044 00ADF3 FF FF FF FF FF FF FF FF    
   7044 00ADFB FF FF FF FF FF FF FF FF    
   7044 00AE03 FF FF FF FF FF FF FF FF    
   7044 00AE0B FF FF FF FF FF FF FF FF    
   7044 00AE13 FF FF FF FF FF FF FF FF    
   7044 00AE1B FF FF FF FF FF FF FF FF    
   7044 00AE23 FF FF FF FF FF FF FF FF    
   7044 00AE2B FF FF FF FF FF FF FF FF    
   7044 00AE33 FF FF FF FF FF FF FF FF    
   7044 00AE3B FF FF FF FF FF FF FF FF    
   7044 00AE43 FF FF FF FF FF FF FF FF    
   7044 00AE4B FF FF FF FF FF FF FF FF    
   7044 00AE53 FF FF FF FF FF FF FF FF    
   7044 00AE5B FF FF FF FF FF FF FF FF    
   7044 00AE63 FF FF FF FF FF FF FF FF    
   7044 00AE6B FF FF FF FF FF FF FF FF    
   7044 00AE73 FF FF FF FF FF FF FF FF    
   7044 00AE7B FF FF FF FF FF FF FF FF    
   7044 00AE83 FF FF FF FF FF FF FF FF    
   7044 00AE8B FF FF FF FF FF FF FF FF    
   7044 00AE93 FF FF FF FF FF FF FF FF    
   7044 00AE9B FF FF FF FF FF FF FF FF    
   7044 00AEA3 FF FF FF FF FF FF FF FF    
   7044 00AEAB FF FF FF FF FF FF FF FF    
   7044 00AEB3 FF FF FF FF FF FF FF FF    
   7044 00AEBB FF FF FF FF FF FF FF FF    
   7044 00AEC3 FF FF FF FF FF FF FF FF    
   7044 00AECB FF FF FF FF FF FF FF FF    
   7044 00AED3 FF FF FF FF FF FF FF FF    
   7044 00AEDB FF FF FF FF FF FF FF FF    
   7044 00AEE3 FF FF FF FF FF FF FF FF    
   7044 00AEEB FF FF FF FF FF FF FF FF    
   7044 00AEF3 FF FF FF FF FF FF FF FF    
   7044 00AEFB FF FF FF FF FF FF FF FF    
   7044 00AF03 FF FF FF FF FF FF FF FF    
   7044 00AF0B FF FF FF FF FF FF FF FF    
   7044 00AF13 FF FF FF FF FF FF FF FF    
   7044 00AF1B FF FF FF FF FF FF FF FF    
   7044 00AF23 FF FF FF FF FF FF FF FF    
   7044 00AF2B FF FF FF FF FF FF FF FF    
   7044 00AF33 FF FF FF FF FF FF FF FF    
   7044 00AF3B FF FF FF FF FF FF FF FF    
   7044 00AF43 FF FF FF FF FF FF FF FF    
   7044 00AF4B FF FF FF FF FF FF FF FF    
   7044 00AF53 FF FF FF FF FF FF FF FF    
   7044 00AF5B FF FF FF FF FF FF FF FF    
   7044 00AF63 FF FF FF FF FF FF FF FF    
   7044 00AF6B FF FF FF FF FF FF FF FF    
   7044 00AF73 FF FF FF FF FF FF FF FF    
   7044 00AF7B FF FF FF FF FF FF FF FF    
   7044 00AF83 FF FF FF FF FF FF FF FF    
   7044 00AF8B FF FF FF FF FF FF FF FF    
   7044 00AF93 FF FF FF FF FF FF FF FF    
   7044 00AF9B FF FF FF FF FF FF FF FF    
   7044 00AFA3 FF FF FF FF FF FF FF FF    
   7044 00AFAB FF FF FF FF FF FF FF FF    
   7044 00AFB3 FF FF FF FF FF FF FF FF    
   7044 00AFBB FF FF FF FF FF FF FF FF    
   7044 00AFC3 FF FF FF FF FF FF FF FF    
   7044 00AFCB FF FF FF FF FF FF FF FF    
   7044 00AFD3 FF FF FF FF FF FF FF FF    
   7044 00AFDB FF FF FF FF FF FF FF FF    
   7044 00AFE3 FF FF FF FF FF FF FF FF    
   7044 00AFEB FF FF FF FF FF FF FF FF    
   7044 00AFF3 FF FF FF FF FF FF FF FF    
   7044 00AFFB FF FF FF FF FF FF FF FF    
   7044 00B003 FF FF FF FF FF FF FF FF    
   7044 00B00B FF FF FF FF FF FF FF FF    
   7044 00B013 FF FF FF FF FF FF FF FF    
   7044 00B01B FF FF FF FF FF FF FF FF    
   7044 00B023 FF FF FF FF FF FF FF FF    
   7044 00B02B FF FF FF FF FF FF FF FF    
   7044 00B033 FF FF FF FF FF FF FF FF    
   7044 00B03B FF FF FF FF FF FF FF FF    
   7044 00B043 FF FF FF FF FF FF FF FF    
   7044 00B04B FF FF FF FF FF FF FF FF    
   7044 00B053 FF FF FF FF FF FF FF FF    
   7044 00B05B FF FF FF FF FF FF FF FF    
   7044 00B063 FF FF FF FF FF FF FF FF    
   7044 00B06B FF FF FF FF FF FF FF FF    
   7044 00B073 FF FF FF FF FF FF FF FF    
   7044 00B07B FF FF FF FF FF FF FF FF    
   7044 00B083 FF FF FF FF FF FF FF FF    
   7044 00B08B FF FF FF FF FF FF FF FF    
   7044 00B093 FF FF FF FF FF FF FF FF    
   7044 00B09B FF FF FF FF FF FF FF FF    
   7044 00B0A3 FF FF FF FF FF FF FF FF    
   7044 00B0AB FF FF FF FF FF FF FF FF    
   7044 00B0B3 FF FF FF FF FF FF FF FF    
   7044 00B0BB FF FF FF FF FF FF FF FF    
   7044 00B0C3 FF FF FF FF FF FF FF FF    
   7044 00B0CB FF FF FF FF FF FF FF FF    
   7044 00B0D3 FF FF FF FF FF FF FF FF    
   7044 00B0DB FF FF FF FF FF FF FF FF    
   7044 00B0E3 FF FF FF FF FF FF FF FF    
   7044 00B0EB FF FF FF FF FF FF FF FF    
   7044 00B0F3 FF FF FF FF FF FF FF FF    
   7044 00B0FB FF FF FF FF FF FF FF FF    
   7044 00B103 FF FF FF FF FF FF FF FF    
   7044 00B10B FF FF FF FF FF FF FF FF    
   7044 00B113 FF FF FF FF FF FF FF FF    
   7044 00B11B FF FF FF FF FF FF FF FF    
   7044 00B123 FF FF FF FF FF FF FF FF    
   7044 00B12B FF FF FF FF FF FF FF FF    
   7044 00B133 FF FF FF FF FF FF FF FF    
   7044 00B13B FF FF FF FF FF FF FF FF    
   7044 00B143 FF FF FF FF FF FF FF FF    
   7044 00B14B FF FF FF FF FF FF FF FF    
   7044 00B153 FF FF FF FF FF FF FF FF    
   7044 00B15B FF FF FF FF FF FF FF FF    
   7044 00B163 FF FF FF FF FF FF FF FF    
   7044 00B16B FF FF FF FF FF FF FF FF    
   7044 00B173 FF FF FF FF FF FF FF FF    
   7044 00B17B FF FF FF FF FF FF FF FF    
   7044 00B183 FF FF FF FF FF FF FF FF    
   7044 00B18B FF FF FF FF FF FF FF FF    
   7044 00B193 FF FF FF FF FF FF FF FF    
   7044 00B19B FF FF FF FF FF FF FF FF    
   7044 00B1A3 FF FF FF FF FF FF FF FF    
   7044 00B1AB FF FF FF FF FF FF FF FF    
   7044 00B1B3 FF FF FF FF FF FF FF FF    
   7044 00B1BB FF FF FF FF FF FF FF FF    
   7044 00B1C3 FF FF FF FF FF FF FF FF    
   7044 00B1CB FF FF FF FF FF FF FF FF    
   7044 00B1D3 FF FF FF FF FF FF FF FF    
   7044 00B1DB FF FF FF FF FF FF FF FF    
   7044 00B1E3 FF FF FF FF FF FF FF FF    
   7044 00B1EB FF FF FF FF FF FF FF FF    
   7044 00B1F3 FF FF FF FF FF FF FF FF    
   7044 00B1FB FF FF FF FF FF FF FF FF    
   7044 00B203 FF FF FF FF FF FF FF FF    
   7044 00B20B FF FF FF FF FF FF FF FF    
   7044 00B213 FF FF FF FF FF FF FF FF    
   7044 00B21B FF FF FF FF FF FF FF FF    
   7044 00B223 FF FF FF FF FF FF FF FF    
   7044 00B22B FF FF FF FF FF FF FF FF    
   7044 00B233 FF FF FF FF FF FF FF FF    
   7044 00B23B FF FF FF FF FF FF FF FF    
   7044 00B243 FF FF FF FF FF FF FF FF    
   7044 00B24B FF FF FF FF FF FF FF FF    
   7044 00B253 FF FF FF FF FF FF FF FF    
   7044 00B25B FF FF FF FF FF FF FF FF    
   7044 00B263 FF FF FF FF FF FF FF FF    
   7044 00B26B FF FF FF FF FF FF FF FF    
   7044 00B273 FF FF FF FF FF FF FF FF    
   7044 00B27B FF FF FF FF FF FF FF FF    
   7044 00B283 FF FF FF FF FF FF FF FF    
   7044 00B28B FF FF FF FF FF FF FF FF    
   7044 00B293 FF FF FF FF FF FF FF FF    
   7044 00B29B FF FF FF FF FF FF FF FF    
   7044 00B2A3 FF FF FF FF FF FF FF FF    
   7044 00B2AB FF FF FF FF FF FF FF FF    
   7044 00B2B3 FF FF FF FF FF FF FF FF    
   7044 00B2BB FF FF FF FF FF FF FF FF    
   7044 00B2C3 FF FF FF FF FF FF FF FF    
   7044 00B2CB FF FF FF FF FF FF FF FF    
   7044 00B2D3 FF FF FF FF FF FF FF FF    
   7044 00B2DB FF FF FF FF FF FF FF FF    
   7044 00B2E3 FF FF FF FF FF FF FF FF    
   7044 00B2EB FF FF FF FF FF FF FF FF    
   7044 00B2F3 FF FF FF FF FF FF FF FF    
   7044 00B2FB FF FF FF FF FF FF FF FF    
   7044 00B303 FF FF FF FF FF FF FF FF    
   7044 00B30B FF FF FF FF FF FF FF FF    
   7044 00B313 FF FF FF FF FF FF FF FF    
   7044 00B31B FF FF FF FF FF FF FF FF    
   7044 00B323 FF FF FF FF FF FF FF FF    
   7044 00B32B FF FF FF FF FF FF FF FF    
   7044 00B333 FF FF FF FF FF FF FF FF    
   7044 00B33B FF FF FF FF FF FF FF FF    
   7044 00B343 FF FF FF FF FF FF FF FF    
   7044 00B34B FF FF FF FF FF FF FF FF    
   7044 00B353 FF FF FF FF FF FF FF FF    
   7044 00B35B FF FF FF FF FF FF FF FF    
   7044 00B363 FF FF FF FF FF FF FF FF    
   7044 00B36B FF FF FF FF FF FF FF FF    
   7044 00B373 FF FF FF FF FF FF FF FF    
   7044 00B37B FF FF FF FF FF FF FF FF    
   7044 00B383 FF FF FF FF FF FF FF FF    
   7044 00B38B FF FF FF FF FF FF FF FF    
   7044 00B393 FF FF FF FF FF FF FF FF    
   7044 00B39B FF FF FF FF FF FF FF FF    
   7044 00B3A3 FF FF FF FF FF FF FF FF    
   7044 00B3AB FF FF FF FF FF FF FF FF    
   7044 00B3B3 FF FF FF FF FF FF FF FF    
   7044 00B3BB FF FF FF FF FF FF FF FF    
   7044 00B3C3 FF FF FF FF FF FF FF FF    
   7044 00B3CB FF FF FF FF FF FF FF FF    
   7044 00B3D3 FF FF FF FF FF FF FF FF    
   7044 00B3DB FF FF FF FF FF FF FF FF    
   7044 00B3E3 FF FF FF FF FF FF FF FF    
   7044 00B3EB FF FF FF FF FF FF FF FF    
   7044 00B3F3 FF FF FF FF FF FF FF FF    
   7044 00B3FB FF FF FF FF FF FF FF FF    
   7044 00B403 FF FF FF FF FF FF FF FF    
   7044 00B40B FF FF FF FF FF FF FF FF    
   7044 00B413 FF FF FF FF FF FF FF FF    
   7044 00B41B FF FF FF FF FF FF FF FF    
   7044 00B423 FF FF FF FF FF FF FF FF    
   7044 00B42B FF FF FF FF FF FF FF FF    
   7044 00B433 FF FF FF FF FF FF FF FF    
   7044 00B43B FF FF FF FF FF FF FF FF    
   7044 00B443 FF FF FF FF FF FF FF FF    
   7044 00B44B FF FF FF FF FF FF FF FF    
   7044 00B453 FF FF FF FF FF FF FF FF    
   7044 00B45B FF FF FF FF FF FF FF FF    
   7044 00B463 FF FF FF FF FF FF FF FF    
   7044 00B46B FF FF FF FF FF FF FF FF    
   7044 00B473 FF FF FF FF FF FF FF FF    
   7044 00B47B FF FF FF FF FF FF FF FF    
   7044 00B483 FF FF FF FF FF FF FF FF    
   7044 00B48B FF FF FF FF FF FF FF FF    
   7044 00B493 FF FF FF FF FF FF FF FF    
   7044 00B49B FF FF FF FF FF FF FF FF    
   7044 00B4A3 FF FF FF FF FF FF FF FF    
   7044 00B4AB FF FF FF FF FF FF FF FF    
   7044 00B4B3 FF FF FF FF FF FF FF FF    
   7044 00B4BB FF FF FF FF FF FF FF FF    
   7044 00B4C3 FF FF FF FF FF FF FF FF    
   7044 00B4CB FF FF FF FF FF FF FF FF    
   7044 00B4D3 FF FF FF FF FF FF FF FF    
   7044 00B4DB FF FF FF FF FF FF FF FF    
   7044 00B4E3 FF FF FF FF FF FF FF FF    
   7044 00B4EB FF FF FF FF FF FF FF FF    
   7044 00B4F3 FF FF FF FF FF FF FF FF    
   7044 00B4FB FF FF FF FF FF FF FF FF    
   7044 00B503 FF FF FF FF FF FF FF FF    
   7044 00B50B FF FF FF FF FF FF FF FF    
   7044 00B513 FF FF FF FF FF FF FF FF    
   7044 00B51B FF FF FF FF FF FF FF FF    
   7044 00B523 FF FF FF FF FF FF FF FF    
   7044 00B52B FF FF FF FF FF FF FF FF    
   7044 00B533 FF FF FF FF FF FF FF FF    
   7044 00B53B FF FF FF FF FF FF FF FF    
   7044 00B543 FF FF FF FF FF FF FF FF    
   7044 00B54B FF FF FF FF FF FF FF FF    
   7044 00B553 FF FF FF FF FF FF FF FF    
   7044 00B55B FF FF FF FF FF FF FF FF    
   7044 00B563 FF FF FF FF FF FF FF FF    
   7044 00B56B FF FF FF FF FF FF FF FF    
   7044 00B573 FF FF FF FF FF FF FF FF    
   7044 00B57B FF FF FF FF FF FF FF FF    
   7044 00B583 FF FF FF FF FF FF FF FF    
   7044 00B58B FF FF FF FF FF FF FF FF    
   7044 00B593 FF FF FF FF FF FF FF FF    
   7044 00B59B FF FF FF FF FF FF FF FF    
   7044 00B5A3 FF FF FF FF FF FF FF FF    
   7044 00B5AB FF FF FF FF FF FF FF FF    
   7044 00B5B3 FF FF FF FF FF FF FF FF    
   7044 00B5BB FF FF FF FF FF FF FF FF    
   7044 00B5C3 FF FF FF FF FF FF FF FF    
   7044 00B5CB FF FF FF FF FF FF FF FF    
   7044 00B5D3 FF FF FF FF FF FF FF FF    
   7044 00B5DB FF FF FF FF FF FF FF FF    
   7044 00B5E3 FF FF FF FF FF FF FF FF    
   7044 00B5EB FF FF FF FF FF FF FF FF    
   7044 00B5F3 FF FF FF FF FF FF FF FF    
   7044 00B5FB FF FF FF FF FF FF FF FF    
   7044 00B603 FF FF FF FF FF FF FF FF    
   7044 00B60B FF FF FF FF FF FF FF FF    
   7044 00B613 FF FF FF FF FF FF FF FF    
   7044 00B61B FF FF FF FF FF FF FF FF    
   7044 00B623 FF FF FF FF FF FF FF FF    
   7044 00B62B FF FF FF FF FF FF FF FF    
   7044 00B633 FF FF FF FF FF FF FF FF    
   7044 00B63B FF FF FF FF FF FF FF FF    
   7044 00B643 FF FF FF FF FF FF FF FF    
   7044 00B64B FF FF FF FF FF FF FF FF    
   7044 00B653 FF FF FF FF FF FF FF FF    
   7044 00B65B FF FF FF FF FF FF FF FF    
   7044 00B663 FF FF FF FF FF FF FF FF    
   7044 00B66B FF FF FF FF FF FF FF FF    
   7044 00B673 FF FF FF FF FF FF FF FF    
   7044 00B67B FF FF FF FF FF FF FF FF    
   7044 00B683 FF FF FF FF FF FF FF FF    
   7044 00B68B FF FF FF FF FF FF FF FF    
   7044 00B693 FF FF FF FF FF FF FF FF    
   7044 00B69B FF FF FF FF FF FF FF FF    
   7044 00B6A3 FF FF FF FF FF FF FF FF    
   7044 00B6AB FF FF FF FF FF FF FF FF    
   7044 00B6B3 FF FF FF FF FF FF FF FF    
   7044 00B6BB FF FF FF FF FF FF FF FF    
   7044 00B6C3 FF FF FF FF FF FF FF FF    
   7044 00B6CB FF FF FF FF FF FF FF FF    
   7044 00B6D3 FF FF FF FF FF FF FF FF    
   7044 00B6DB FF FF FF FF FF FF FF FF    
   7044 00B6E3 FF FF FF FF FF FF FF FF    
   7044 00B6EB FF FF FF FF FF FF FF FF    
   7044 00B6F3 FF FF FF FF FF FF FF FF    
   7044 00B6FB FF FF FF FF FF FF FF FF    
   7044 00B703 FF FF FF FF FF FF FF FF    
   7044 00B70B FF FF FF FF FF FF FF FF    
   7044 00B713 FF FF FF FF FF FF FF FF    
   7044 00B71B FF FF FF FF FF FF FF FF    
   7044 00B723 FF FF FF FF FF FF FF FF    
   7044 00B72B FF FF FF FF FF FF FF FF    
   7044 00B733 FF FF FF FF FF FF FF FF    
   7044 00B73B FF FF FF FF FF FF FF FF    
   7044 00B743 FF FF FF FF FF FF FF FF    
   7044 00B74B FF FF FF FF FF FF FF FF    
   7044 00B753 FF FF FF FF FF FF FF FF    
   7044 00B75B FF FF FF FF FF FF FF FF    
   7044 00B763 FF FF FF FF FF FF FF FF    
   7044 00B76B FF FF FF FF FF FF FF FF    
   7044 00B773 FF FF FF FF FF FF FF FF    
   7044 00B77B FF FF FF FF FF FF FF FF    
   7044 00B783 FF FF FF FF FF FF FF FF    
   7044 00B78B FF FF FF FF FF FF FF FF    
   7044 00B793 FF FF FF FF FF FF FF FF    
   7044 00B79B FF FF FF FF FF FF FF FF    
   7044 00B7A3 FF FF FF FF FF FF FF FF    
   7044 00B7AB FF FF FF FF FF FF FF FF    
   7044 00B7B3 FF FF FF FF FF FF FF FF    
   7044 00B7BB FF FF FF FF FF FF FF FF    
   7044 00B7C3 FF FF FF FF FF FF FF FF    
   7044 00B7CB FF FF FF FF FF FF FF FF    
   7044 00B7D3 FF FF FF FF FF FF FF FF    
   7044 00B7DB FF FF FF FF FF FF FF FF    
   7044 00B7E3 FF FF FF FF FF FF FF FF    
   7044 00B7EB FF FF FF FF FF FF FF FF    
   7044 00B7F3 FF FF FF FF FF FF FF FF    
   7044 00B7FB FF FF FF FF FF FF FF FF    
   7044 00B803 FF FF FF FF FF FF FF FF    
   7044 00B80B FF FF FF FF FF FF FF FF    
   7044 00B813 FF FF FF FF FF FF FF FF    
   7044 00B81B FF FF FF FF FF FF FF FF    
   7044 00B823 FF FF FF FF FF FF FF FF    
   7044 00B82B FF FF FF FF FF FF FF FF    
   7044 00B833 FF FF FF FF FF FF FF FF    
   7044 00B83B FF FF FF FF FF FF FF FF    
   7044 00B843 FF FF FF FF FF FF FF FF    
   7044 00B84B FF FF FF FF FF FF FF FF    
   7044 00B853 FF FF FF FF FF FF FF FF    
   7044 00B85B FF FF FF FF FF FF FF FF    
   7044 00B863 FF FF FF FF FF FF FF FF    
   7044 00B86B FF FF FF FF FF FF FF FF    
   7044 00B873 FF FF FF FF FF FF FF FF    
   7044 00B87B FF FF FF FF FF FF FF FF    
   7044 00B883 FF FF FF FF FF FF FF FF    
   7044 00B88B FF FF FF FF FF FF FF FF    
   7044 00B893 FF FF FF FF FF FF FF FF    
   7044 00B89B FF FF FF FF FF FF FF FF    
   7044 00B8A3 FF FF FF FF FF FF FF FF    
   7044 00B8AB FF FF FF FF FF FF FF FF    
   7044 00B8B3 FF FF FF FF FF FF FF FF    
   7044 00B8BB FF FF FF FF FF FF FF FF    
   7044 00B8C3 FF FF FF FF FF FF FF FF    
   7044 00B8CB FF FF FF FF FF FF FF FF    
   7044 00B8D3 FF FF FF FF FF FF FF FF    
   7044 00B8DB FF FF FF FF FF FF FF FF    
   7044 00B8E3 FF FF FF FF FF FF FF FF    
   7044 00B8EB FF FF FF FF FF FF FF FF    
   7044 00B8F3 FF FF FF FF FF FF FF FF    
   7044 00B8FB FF FF FF FF FF FF FF FF    
   7044 00B903 FF FF FF FF FF FF FF FF    
   7044 00B90B FF FF FF FF FF FF FF FF    
   7044 00B913 FF FF FF FF FF FF FF FF    
   7044 00B91B FF FF FF FF FF FF FF FF    
   7044 00B923 FF FF FF FF FF FF FF FF    
   7044 00B92B FF FF FF FF FF FF FF FF    
   7044 00B933 FF FF FF FF FF FF FF FF    
   7044 00B93B FF FF FF FF FF FF FF FF    
   7044 00B943 FF FF FF FF FF FF FF FF    
   7044 00B94B FF FF FF FF FF FF FF FF    
   7044 00B953 FF FF FF FF FF FF FF FF    
   7044 00B95B FF FF FF FF FF FF FF FF    
   7044 00B963 FF FF FF FF FF FF FF FF    
   7044 00B96B FF FF FF FF FF FF FF FF    
   7044 00B973 FF FF FF FF FF FF FF FF    
   7044 00B97B FF FF FF FF FF FF FF FF    
   7044 00B983 FF FF FF FF FF FF FF FF    
   7044 00B98B FF FF FF FF FF FF FF FF    
   7044 00B993 FF FF FF FF FF FF FF FF    
   7044 00B99B FF FF FF FF FF FF FF FF    
   7044 00B9A3 FF FF FF FF FF FF FF FF    
   7044 00B9AB FF FF FF FF FF FF FF FF    
   7044 00B9B3 FF FF FF FF FF FF FF FF    
   7044 00B9BB FF FF FF FF FF FF FF FF    
   7044 00B9C3 FF FF FF FF FF FF FF FF    
   7044 00B9CB FF FF FF FF FF FF FF FF    
   7044 00B9D3 FF FF FF FF FF FF FF FF    
   7044 00B9DB FF FF FF FF FF FF FF FF    
   7044 00B9E3 FF FF FF FF FF FF FF FF    
   7044 00B9EB FF FF FF FF FF FF FF FF    
   7044 00B9F3 FF FF FF FF FF FF FF FF    
   7044 00B9FB FF FF FF FF FF FF FF FF    
   7044 00BA03 FF FF FF FF FF FF FF FF    
   7044 00BA0B FF FF FF FF FF FF FF FF    
   7044 00BA13 FF FF FF FF FF FF FF FF    
   7044 00BA1B FF FF FF FF FF FF FF FF    
   7044 00BA23 FF FF FF FF FF FF FF FF    
   7044 00BA2B FF FF FF FF FF FF FF FF    
   7044 00BA33 FF FF FF FF FF FF FF FF    
   7044 00BA3B FF FF FF FF FF FF FF FF    
   7044 00BA43 FF FF FF FF FF FF FF FF    
   7044 00BA4B FF FF FF FF FF FF FF FF    
   7044 00BA53 FF FF FF FF FF FF FF FF    
   7044 00BA5B FF FF FF FF FF FF FF FF    
   7044 00BA63 FF FF FF FF FF FF FF FF    
   7044 00BA6B FF FF FF FF FF FF FF FF    
   7044 00BA73 FF FF FF FF FF FF FF FF    
   7044 00BA7B FF FF FF FF FF FF FF FF    
   7044 00BA83 FF FF FF FF FF FF FF FF    
   7044 00BA8B FF FF FF FF FF FF FF FF    
   7044 00BA93 FF FF FF FF FF FF FF FF    
   7044 00BA9B FF FF FF FF FF FF FF FF    
   7044 00BAA3 FF FF FF FF FF FF FF FF    
   7044 00BAAB FF FF FF FF FF FF FF FF    
   7044 00BAB3 FF FF FF FF FF FF FF FF    
   7044 00BABB FF FF FF FF FF FF FF FF    
   7044 00BAC3 FF FF FF FF FF FF FF FF    
   7044 00BACB FF FF FF FF FF FF FF FF    
   7044 00BAD3 FF FF FF FF FF FF FF FF    
   7044 00BADB FF FF FF FF FF FF FF FF    
   7044 00BAE3 FF FF FF FF FF FF FF FF    
   7044 00BAEB FF FF FF FF FF FF FF FF    
   7044 00BAF3 FF FF FF FF FF FF FF FF    
   7044 00BAFB FF FF FF FF FF FF FF FF    
   7044 00BB03 FF FF FF FF FF FF FF FF    
   7044 00BB0B FF FF FF FF FF FF FF FF    
   7044 00BB13 FF FF FF FF FF FF FF FF    
   7044 00BB1B FF FF FF FF FF FF FF FF    
   7044 00BB23 FF FF FF FF FF FF FF FF    
   7044 00BB2B FF FF FF FF FF FF FF FF    
   7044 00BB33 FF FF FF FF FF FF FF FF    
   7044 00BB3B FF FF FF FF FF FF FF FF    
   7044 00BB43 FF FF FF FF FF FF FF FF    
   7044 00BB4B FF FF FF FF FF FF FF FF    
   7044 00BB53 FF FF FF FF FF FF FF FF    
   7044 00BB5B FF FF FF FF FF FF FF FF    
   7044 00BB63 FF FF FF FF FF FF FF FF    
   7044 00BB6B FF FF FF FF FF FF FF FF    
   7044 00BB73 FF FF FF FF FF FF FF FF    
   7044 00BB7B FF FF FF FF FF FF FF FF    
   7044 00BB83 FF FF FF FF FF FF FF FF    
   7044 00BB8B FF FF FF FF FF FF FF FF    
   7044 00BB93 FF FF FF FF FF FF FF FF    
   7044 00BB9B FF FF FF FF FF FF FF FF    
   7044 00BBA3 FF FF FF FF FF FF FF FF    
   7044 00BBAB FF FF FF FF FF FF FF FF    
   7044 00BBB3 FF FF FF FF FF FF FF FF    
   7044 00BBBB FF FF FF FF FF FF FF FF    
   7044 00BBC3 FF FF FF FF FF FF FF FF    
   7044 00BBCB FF FF FF FF FF FF FF FF    
   7044 00BBD3 FF FF FF FF FF FF FF FF    
   7044 00BBDB FF FF FF FF FF FF FF FF    
   7044 00BBE3 FF FF FF FF FF FF FF FF    
   7044 00BBEB FF FF FF FF FF FF FF FF    
   7044 00BBF3 FF FF FF FF FF FF FF FF    
   7044 00BBFB FF FF FF FF FF FF FF FF    
   7044 00BC03 FF FF FF FF FF FF FF FF    
   7044 00BC0B FF FF FF FF FF FF FF FF    
   7044 00BC13 FF FF FF FF FF FF FF FF    
   7044 00BC1B FF FF FF FF FF FF FF FF    
   7044 00BC23 FF FF FF FF FF FF FF FF    
   7044 00BC2B FF FF FF FF FF FF FF FF    
   7044 00BC33 FF FF FF FF FF FF FF FF    
   7044 00BC3B FF FF FF FF FF FF FF FF    
   7044 00BC43 FF FF FF FF FF FF FF FF    
   7044 00BC4B FF FF FF FF FF FF FF FF    
   7044 00BC53 FF FF FF FF FF FF FF FF    
   7044 00BC5B FF FF FF FF FF FF FF FF    
   7044 00BC63 FF FF FF FF FF FF FF FF    
   7044 00BC6B FF FF FF FF FF FF FF FF    
   7044 00BC73 FF FF FF FF FF FF FF FF    
   7044 00BC7B FF FF FF FF FF FF FF FF    
   7044 00BC83 FF FF FF FF FF FF FF FF    
   7044 00BC8B FF FF FF FF FF FF FF FF    
   7044 00BC93 FF FF FF FF FF FF FF FF    
   7044 00BC9B FF FF FF FF FF FF FF FF    
   7044 00BCA3 FF FF FF FF FF FF FF FF    
   7044 00BCAB FF FF FF FF FF FF FF FF    
   7044 00BCB3 FF FF FF FF FF FF FF FF    
   7044 00BCBB FF FF FF FF FF FF FF FF    
   7044 00BCC3 FF FF FF FF FF FF FF FF    
   7044 00BCCB FF FF FF FF FF FF FF FF    
   7044 00BCD3 FF FF FF FF FF FF FF FF    
   7044 00BCDB FF FF FF FF FF FF FF FF    
   7044 00BCE3 FF FF FF FF FF FF FF FF    
   7044 00BCEB FF FF FF FF FF FF FF FF    
   7044 00BCF3 FF FF FF FF FF FF FF FF    
   7044 00BCFB FF FF FF FF FF FF FF FF    
   7044 00BD03 FF FF FF FF FF FF FF FF    
   7044 00BD0B FF FF FF FF FF FF FF FF    
   7044 00BD13 FF FF FF FF FF FF FF FF    
   7044 00BD1B FF FF FF FF FF FF FF FF    
   7044 00BD23 FF FF FF FF FF FF FF FF    
   7044 00BD2B FF FF FF FF FF FF FF FF    
   7044 00BD33 FF FF FF FF FF FF FF FF    
   7044 00BD3B FF FF FF FF FF FF FF FF    
   7044 00BD43 FF FF FF FF FF FF FF FF    
   7044 00BD4B FF FF FF FF FF FF FF FF    
   7044 00BD53 FF FF FF FF FF FF FF FF    
   7044 00BD5B FF FF FF FF FF FF FF FF    
   7044 00BD63 FF FF FF FF FF FF FF FF    
   7044 00BD6B FF FF FF FF FF FF FF FF    
   7044 00BD73 FF FF FF FF FF FF FF FF    
   7044 00BD7B FF FF FF FF FF FF FF FF    
   7044 00BD83 FF FF FF FF FF FF FF FF    
   7044 00BD8B FF FF FF FF FF FF FF FF    
   7044 00BD93 FF FF FF FF FF FF FF FF    
   7044 00BD9B FF FF FF FF FF FF FF FF    
   7044 00BDA3 FF FF FF FF FF FF FF FF    
   7044 00BDAB FF FF FF FF FF FF FF FF    
   7044 00BDB3 FF FF FF FF FF FF FF FF    
   7044 00BDBB FF FF FF FF FF FF FF FF    
   7044 00BDC3 FF FF FF FF FF FF FF FF    
   7044 00BDCB FF FF FF FF FF FF FF FF    
   7044 00BDD3 FF FF FF FF FF FF FF FF    
   7044 00BDDB FF FF FF FF FF FF FF FF    
   7044 00BDE3 FF FF FF FF FF FF FF FF    
   7044 00BDEB FF FF FF FF FF FF FF FF    
   7044 00BDF3 FF FF FF FF FF FF FF FF    
   7044 00BDFB FF FF FF FF FF FF FF FF    
   7044 00BE03 FF FF FF FF FF FF FF FF    
   7044 00BE0B FF FF FF FF FF FF FF FF    
   7044 00BE13 FF FF FF FF FF FF FF FF    
   7044 00BE1B FF FF FF FF FF FF FF FF    
   7044 00BE23 FF FF FF FF FF FF FF FF    
   7044 00BE2B FF FF FF FF FF FF FF FF    
   7044 00BE33 FF FF FF FF FF FF FF FF    
   7044 00BE3B FF FF FF FF FF FF FF FF    
   7044 00BE43 FF FF FF FF FF FF FF FF    
   7044 00BE4B FF FF FF FF FF FF FF FF    
   7044 00BE53 FF FF FF FF FF FF FF FF    
   7044 00BE5B FF FF FF FF FF FF FF FF    
   7044 00BE63 FF FF FF FF FF FF FF FF    
   7044 00BE6B FF FF FF FF FF FF FF FF    
   7044 00BE73 FF FF FF FF FF FF FF FF    
   7044 00BE7B FF FF FF FF FF FF FF FF    
   7044 00BE83 FF FF FF FF FF FF FF FF    
   7044 00BE8B FF FF FF FF FF FF FF FF    
   7044 00BE93 FF FF FF FF FF FF FF FF    
   7044 00BE9B FF FF FF FF FF FF FF FF    
   7044 00BEA3 FF FF FF FF FF FF FF FF    
   7044 00BEAB FF FF FF FF FF FF FF FF    
   7044 00BEB3 FF FF FF FF FF FF FF FF    
   7044 00BEBB FF FF FF FF FF FF FF FF    
   7044 00BEC3 FF FF FF FF FF FF FF FF    
   7044 00BECB FF FF FF FF FF FF FF FF    
   7044 00BED3 FF FF FF FF FF FF FF FF    
   7044 00BEDB FF FF FF FF FF FF FF FF    
   7044 00BEE3 FF FF FF FF FF FF FF FF    
   7044 00BEEB FF FF FF FF FF FF FF FF    
   7044 00BEF3 FF FF FF FF FF FF FF FF    
   7044 00BEFB FF FF FF FF FF FF FF FF    
   7044 00BF03 FF FF FF FF FF FF FF FF    
   7044 00BF0B FF FF FF FF FF FF FF FF    
   7044 00BF13 FF FF FF FF FF FF FF FF    
   7044 00BF1B FF FF FF FF FF FF FF FF    
   7044 00BF23 FF FF FF FF FF FF FF FF    
   7044 00BF2B FF FF FF FF FF FF FF FF    
   7044 00BF33 FF FF FF FF FF FF FF FF    
   7044 00BF3B FF FF FF FF FF FF FF FF    
   7044 00BF43 FF FF FF FF FF FF FF FF    
   7044 00BF4B FF FF FF FF FF FF FF FF    
   7044 00BF53 FF FF FF FF FF FF FF FF    
   7044 00BF5B FF FF FF FF FF FF FF FF    
   7044 00BF63 FF FF FF FF FF FF FF FF    
   7044 00BF6B FF FF FF FF FF FF FF FF    
   7044 00BF73 FF FF FF FF FF FF FF FF    
   7044 00BF7B FF FF FF FF FF FF FF FF    
   7044 00BF83 FF FF FF FF FF FF FF FF    
   7044 00BF8B FF FF FF FF FF FF FF FF    
   7044 00BF93 FF FF FF FF FF FF FF FF    
   7044 00BF9B FF FF FF FF FF FF FF FF    
   7044 00BFA3 FF FF FF FF FF FF FF FF    
   7044 00BFAB FF FF FF FF FF FF FF FF    
   7044 00BFB3 FF FF FF FF FF FF FF FF    
   7044 00BFBB FF FF FF FF FF FF FF FF    
   7044 00BFC3 FF FF FF FF FF FF FF FF    
   7044 00BFCB FF FF FF FF FF FF FF FF    
   7044 00BFD3 FF FF FF FF FF FF FF FF    
   7044 00BFDB FF FF FF FF FF FF FF FF    
   7044 00BFE3 FF FF FF FF FF FF FF FF    
   7044 00BFEB FF FF FF FF FF FF FF FF    
   7044 00BFF3 FF FF FF FF FF FF FF FF    
   7044 00BFFB FF FF FF FF FF             
                                           
   7046 00C000                             start:
   7047 00C000 78                           	SEI					; not strictly necessary after power on reset
   7048 00C001 D8                           	CLD
                                           ;	CLV					; overflow low
                                           ;	SEC					; carry high
                                           ;	XCE					; sets 32 bit mode, 32 bit registers
                                           ;	REP		#$30		; 32 bit registers
                                           ;	MEM		32
                                           ;	NDX		32
                                           ;	LDA		#$3FFF
                                           ;	TAS
                                           ;
   7058 00C002 18                           	CLC					; switch to '816 mode
   7059 00C003 E2 40                        	SEP		#$40		; set overflow bit
   7060 00C005 FB                           	XCE
   7061 00C006 C2 30                        	REP		#$30		; set 16 bit regs & mem
                                           	NDX 	16
                                           	MEM		16
                                           
                                           	; Setup all the segment descriptors
                                           	; This must be done before the stack can be accessed, and
                                           	; before subroutine calls and task switching can be made.
                                           
                                           	; First setup segment #0, the segment the core starts running under.
                                           	; It's setup for flat addressing.
   7071 00C008 A9 00 00                     	LDA		#0
   7072 00C00B 42 EB                        	XBAW
   7073 00C00D A9 00 00                     	LDA		#0
   7074 00C010 A2 8D 09                     	LDX		#$98D		; present, writeable, executable, max size.
   7075 00C013 A8                           	TAY
   7076 00C014 42 BA                        	SDU
   7077 00C016 C8                           	INY
                                           
                                           	; Flag remaining segments as not present 
   7080 00C017 A2 00 00                     	LDX		#$000		; not present, non-executable, non-writeable, min size
   7081 00C01A                             .0003:
   7082 00C01A 42 BA                        	SDU					; update segment descriptor
   7083 00C01C C8                           	INY
   7084 00C01D C0 00 10                     	CPY		#4096
   7085 00C020 D0 F8                        	BNE		.0003
                                           
                                           	; setup code segment #1
   7088 00C022 A2 05 09                     	LDX		#$905		; executable, 64k
   7089 00C025 A8                           	TAY
   7090 00C026 C8                           	INY
   7091 00C027 42 BA                        	SDU
                                           	; setup data segment #2
   7093 00C029 A2 8B 08                     	LDX		#$88B		; writeable, 256M
   7094 00C02C C8                           	INY
   7095 00C02D 42 BA                        	SDU
                                           	; setup stack segment #3 (for 65c02 mode)
   7097 00C02F A2 82 08                     	LDX		#$882		; writeable, 1k (based at zero)
   7098 00C032 C8                           	INY
   7099 00C033 42 BA                        	SDU
                                           	; setup stack segment #4 (for 65c816 mode)
   7101 00C035 A2 85 08                     	LDX		#$885		; writeable, 64k (based at zero)
   7102 00C038 C8                           	INY
   7103 00C039 42 BA                        	SDU
                                           	; seg #5 is the maxed out segment
   7105 00C03B A2 8D 09                     	LDX		#$98D		; executable, writable, max size
   7106 00C03E C8                           	INY
   7107 00C03F 42 BA                        	SDU
                                           
                                           	; I/O segment
   7110 00C041 A9 F0 00                     	LDA		#$00F0
   7111 00C044 42 EB                        	XBAW
   7112 00C046 A9 00 00                     	LDA		#$0000
   7113 00C049 A2 87 08                     	LDX		#$887		; writeable, 1M (based at $F00000)
   7114 00C04C A0 FF 0F                     	LDY		#$FFF
   7115 00C04F 42 BA                        	SDU
                                           
                                           	; now set the code segment (test far jump)
   7118 00C051 42 5C 58 C0 00 01 00         	JMF		1:.0004
   7119 00C058                             .0004:
                                           	; set the stack segment
                                           	; (must be before PEA/PLDS)
   7122 00C058 A9 05 00                     	LDA		#5
   7123 00C05B 42 5A                        	TASS
   7124 00C05D A9 FF 6B                     	LDA		#$6BFF		; set top of stack
   7125 00C060 1B                           	TAS
                                           
                                           	; setup the programmable address decodes
   7128 00C061 A9 70 00                     	LDA		#$0070		; program chip selects for I/O
   7129 00C064 8D 00 B0                     	STA		PCS0		; at $007000
   7130 00C067 A9 71 00                     	LDA		#$0071
   7131 00C06A 8D 02 B0                     	STA		PCS1
                                           ;	LDA		#$FEA1		; select $FEA1xx I/O
                                           ;	STA		PCS3
                                           ;	LDA		#$0000		; select zero page ram
                                           ;	STA		PCS5
                                           
                                           	; set the data segment
                                           	; this must be setup after address decoding is setup
   7139 00C06D F4 05 00                     	PEA		5
   7140 00C070 42 2B                        	PLDS
                                           
   7142 00C072 20 01 D9                     	JSR		FMTK_Init
                                           
                                           	; Setup the counters
   7145 00C075 E2 30                        	SEP		#$30		; set 8 bit regs
                                           	NDX		8			; tell the assembler
                                           	MEM		8
                                           	; Counter #0 is setup as a free running tick count
   7149 00C077 A9 FF                        	LDA		#$FF		; set limit to $FFFFFF
   7150 00C079 8D 10 B0                     	STA		CTR0_LMT
   7151 00C07C 8D 11 B0                     	STA		CTR0_LMT+1
   7152 00C07F 8D 12 B0                     	STA		CTR0_LMT+2
   7153 00C082 A9 14                        	LDA		#$14		; count up, on mpu clock
   7154 00C084 8D 13 B0                     	STA		CTR0_CTRL
                                           	; Counter #1 is set to interrupt at a 50Hz rate
   7156 00C087 A9 2A                        	LDA		#$2A	;94		; divide by 95794 (for 50Hz)
   7157 00C089 8D 14 B0                     	STA		CTR1_LMT		; FFFFFE = 2Hz with 33MHz clock
   7158 00C08C A9 2C                        	LDA		#$2C	;57
   7159 00C08E 8D 15 B0                     	STA		CTR1_LMT+1
   7160 00C091 A9 0A                        	LDA		#$0A	;09
   7161 00C093 8D 16 B0                     	STA		CTR1_LMT+2
   7162 00C096 A9 05                        	LDA		#$05		; count down, on mpu clock, irq disenabled
   7163 00C098 8D 17 B0                     	STA		CTR1_CTRL
                                           	; Counter #2 isn't setup
                                           
   7166 00C09B C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   7169 00C09D 20 C8 CE                     	JSR		ResetKbd
                                           
   7171 00C0A0 64 D0                        	STZ		TaskSwitchEn
                                           
                                           	; Setup the task registers
   7174 00C0A2 A0 09 00                     	LDY		#9			; # tasks to setup
   7175 00C0A5 A2 01 00                     	LDX		#1
   7176 00C0A8                             .0001:
   7177 00C0A8 42 4C 1A E1 00 00            	LDT		TaskStartTbl,X
   7178 00C0AE E8                           	INX
   7179 00C0AF 88                           	DEY
   7180 00C0B0 D0 F6                        	BNE		.0001
                                           
   7182 00C0B2 42 9C 00 20 05 00            	STZ		running_task
                                           
   7184 00C0B8 A9 AF E0                     	LDA		#BrkRout1
   7185 00C0BB 8D 02 01                     	STA		$0102
                                           
   7187 00C0BE 64 04                        	STZ		TickCount
   7188 00C0C0 64 06                        	STZ		TickCount+2
   7189 00C0C2                             Task0:
                                           	; Start the single stepping task.
   7191 00C0C2 A9 01 00                     	LDA		#$01
   7192 00C0C5 8D 00 70                     	STA		$7000
   7193 00C0C8 42 A2 09 00                  	TSK		#9
   7194 00C0CC                             .0001:
   7195 00C0CC A9 04 00                     	LDA		#$04
   7196 00C0CF 8D 00 70                     	STA		$7000
   7197 00C0D2 A9 FF 0F                     	LDA		#$FFF
   7198 00C0D5 85 44                        	STA		Vidptr+4
   7199 00C0D7 85 4A                        	STA		Vidregs+4
   7200 00C0D9 A9 0D 00                     	LDA		#VIDBUF>>16
   7201 00C0DC 85 42                        	STA		Vidptr+2
   7202 00C0DE 64 40                        	STZ		Vidptr
   7203 00C0E0 A9 0D BF                     	LDA		#$BF0D	; 'm'
   7204 00C0E3 42 DA 42 87 40               	STA		FAR {Vidptr}
   7205 00C0E8 A9 0E 00                     	LDA		#VIDREGS >> 16
   7206 00C0EB 85 48                        	STA		Vidregs+2
   7207 00C0ED A9 00 A0                     	LDA		#VIDREGS
   7208 00C0F0 85 46                        	STA		Vidregs
   7209 00C0F2 A0 07 00                     	LDY		#7	
   7210 00C0F5 A9 21 00                     	LDA		#$21		; divide by 3 vertically, 2 horizontally
   7211 00C0F8 20 43 CD                     	JSR		SetVideoReg	; clear POR state
   7212 00C0FB A9 54 00                     	LDA		#84		; set window left position 84
   7213 00C0FE A0 02 00                     	LDY		#2
   7214 00C101 20 43 CD                     	JSR		SetVideoReg
   7215 00C104 A9 00 00                     	LDA		#0
   7216 00C107 A0 03 00                     	LDY		#3
   7217 00C10A 20 43 CD                     	JSR		SetVideoReg
   7218 00C10D A9 10 00                     	LDA		#16			; set window top position
   7219 00C110 A0 04 00                     	LDY		#4
   7220 00C113 20 43 CD                     	JSR		SetVideoReg
   7221 00C116 20 28 CD                     	JSR		GetTextRowsCols
   7222 00C119 A9 F8 CA                     	LDA		#DisplayChar
   7223 00C11C 8D F0 03                     	STA		OutputVec
   7224 00C11F AD F0 03                     	LDA		OutputVec
   7225 00C122 C9 F8 CA                     	CMP		#DisplayChar
   7226 00C125 D0 A5                        	BNE		.0001
   7227 00C127 A9 02 00                     	LDA		#$02
   7228 00C12A 8D 00 70                     	STA		$7000
   7229 00C12D A9 00 BF                     	LDA		#$BF00
   7230 00C130 85 36                        	STA		NormAttr
   7231 00C132 20 6D CD                     	JSR		ClearScreen
   7232 00C135 20 BD CC                     	JSR		HomeCursor
                                           ;	JSR		beep
   7234 00C138 A9 03 00                     	LDA		#$03
   7235 00C13B 42 3B 05 00 8D 00 70         	STA		5:$7000
   7236 00C142 F4 05 00                     	PEA		5
   7237 00C145 F4 5C C9                     	PEA		msgStarting
   7238 00C148 20 F9 CC                     	JSR		DisplayString
   7239 00C14B 20 32 D6                     	JSR		rtc_init
   7240 00C14E 20 3A D6                     	JSR		rtc_read
   7241 00C151 C9 00 00                     	CMP		#0
   7242 00C154 F0 09                        	BEQ		.0006
   7243 00C156 F4 01 00                     	PEA		1
   7244 00C159 F4 02 D7                     	PEA		msgRtcReadFail
   7245 00C15C 20 F9 CC                     	JSR		DisplayString
   7246 00C15F                             .0006:
                                           ;	SEP		#$1000		; turn on single step mode
                                           ;	LDA		#0
                                           ;	STA		$FFF:FAC1
                                           ;	STA		$FFF:FAC1+2
                                           ;	STA		$FFF:FAC1+4
                                           ;	STA		$FFF:FAC1+6
                                           ;	STA		$FFF:FAC1+8
                                           ;	STA		$FFF:FAC1+10
                                           ;	LDA		#3
                                           ;	STA		$7000
                                           ;	LDA		#1234
                                           ;	STA		FAC1
                                           ;	LDA		#5			; FIX2FLT
                                           ;	JSR 	FPCommandWait
                                           ;	LDA		#4
                                           ;	STA		$7000
                                           ;	JSR		DivideByTen
                                           ;	LDA		#5
                                           ;	STA		$7000
                                           ;	JSR		FAC1ToString
                                           ;	PEA		2
                                           ;	PEA		$3A0
                                           ;	JSR		DisplayString
                                           ;	LDA		#' '
                                           ;	JSR		OutChar
                                           ;	JSR		DispFAC1
                                           
                                           ;	FORK	#11
                                           ;	TTA
                                           ;	CMP		#11
                                           ;	LBEQ	KeybdInit
                                           
                                           ;	REP		#$130
                                           ;	SEP		#$200		; 32 bit mode
                                           ;	NDX 	32
                                           ;	MEM		32
                                           ;	LDA		#0
                                           ;	JSR		hTcbToAddr
                                           ;	TAX
                                           ;	LDA		#$20
                                           ;	STA.B	TCB_priority,X
                                           ;	LDA		#0
                                           ;	JSR		InsertIntoReadyFifo
                                           ;	REP		#$230		; back to 16 bit mode
                                           ;	SEP		#$100
                                           	NDX		16
                                           	MEM		16
                                           
                                           	; Create a workhorse OS context that will allow subroutine calls into
                                           	; the OS code from alternate contexts which may not have the same VM
                                           	; settings.
                                           	;
   7299 00C15F 78                           	SEI
   7300 00C160 42 A0 FD 00                  	FORK	#$FD
   7301 00C164 42 1A                        	TTA
   7302 00C166 29 FF 01                     	AND		#$01FF
   7303 00C169 C9 FD 00                     	CMP		#$FD
   7304 00C16C D0 21                        	BNE		TaskMon2
   7305 00C16E                             TaskFD:
   7306 00C16E 78                           	SEI
   7307 00C16F 42 C2 30 01                  	REP		#$130
   7308 00C173 42 E2 00 02                  	SEP		#$200		; switch to 32 bit mode
                                           	MEM		32
                                           	NDX		32
                                           	; A 16 bit pull is needed here so we make use of the direct page register
                                           	; It'll be restored to zero later.
   7313 00C177 2B                           	PLD					; get 16 bit value from stack
   7314 00C178 A2 FF 22 00 00               	LDX		#$22FF
   7315 00C17D 9A                           	TXS
   7316 00C17E 0B                           	PHD					; store 16 bit value to new stack
   7317 00C17F A9 00 00 00 00               	LDA		#0			; restore the DP value
   7318 00C184 5B                           	TCD
   7319 00C185 58                           	CLI
   7320 00C186 EA                           	NOP		; allow CLI to take place
   7321 00C187 EA                           	NOP
   7322 00C188 EA                           	NOP
   7323 00C189 EA                           	NOP
   7324 00C18A EA                           	NOP
   7325 00C18B 42 60                        	RTT
   7326 00C18D 80 DF                        	BRA		TaskFD
                                           
   7328 00C18F                             TaskMon2:
                                           	NDX		16
                                           	MEM		16
                                           	; Create a workhorse BIOS context that will allow subroutine calls into
                                           	; the BIOS code from alternate contexts which may not have the same VM
                                           	; settings.
                                           	;
   7335 00C18F 78                           	SEI
   7336 00C190 42 A0 FC 00                  	FORK	#$FC
   7337 00C194 42 1A                        	TTA
   7338 00C196 29 FF 01                     	AND		#$01FF
   7339 00C199 C9 FC 00                     	CMP		#$FC
   7340 00C19C D0 11                        	BNE		TaskMon1
   7341 00C19E                             TaskFC:
   7342 00C19E                             .0003
   7343 00C19E 78                           	SEI
   7344 00C19F 68                           	PLA
   7345 00C1A0 A2 FF 23                     	LDX		#$23FF
   7346 00C1A3 9A                           	TXS
   7347 00C1A4 48                           	PHA
   7348 00C1A5 58                           	CLI
   7349 00C1A6 EA                           	NOP		; allow CLI to take place
   7350 00C1A7 EA                           	NOP
   7351 00C1A8 EA                           	NOP
   7352 00C1A9 EA                           	NOP
   7353 00C1AA EA                           	NOP
   7354 00C1AB 42 60                        	RTT
   7355 00C1AD 80 EF                        	BRA		.0003
   7356 00C1AF                             TaskMon1:
                                           
   7358 00C1AF 58                           	CLI
                                           
   7360 00C1B0                             Mon1:
   7361 00C1B0                             .mon1:
   7362 00C1B0 A9 FF 6B                     	LDA		#$6BFF
   7363 00C1B3 1B                           	TAS
   7364 00C1B4 20 4D CD                     	JSR		CursorOn
   7365 00C1B7 20 E1 CC                     	JSR		OutCRLF
   7366 00C1BA A9 24 00                     	LDA		#'$'
                                           	;STA		TaskSwitchEn
   7368 00C1BD                             .mon3:
   7369 00C1BD 20 EA CC                     	JSR		OutChar
   7370 00C1C0 20 5A D0                     	JSR		KeybdGetCharWait
   7371 00C1C3 29 FF 00                     	AND		#$FF
                                           ;	CMP		#'.'
                                           ;	BEQ		.mon3
   7374 00C1C6 C9 0D 00                     	CMP		#CR
   7375 00C1C9 D0 F2                        	BNE		.mon3
   7376 00C1CB A5 32                        	LDA		CursorY
   7377 00C1CD 0A                           	ASL
   7378 00C1CE AA                           	TAX
   7379 00C1CF 42 1B BD DC E0               	LDA		CS:LineTbl,X
   7380 00C1D4 0A                           	ASL
   7381 00C1D5 AA                           	TAX
   7382 00C1D6                             .mon4:
   7383 00C1D6 20 F4 C8                     	JSR		IgnoreBlanks
   7384 00C1D9 20 D1 C2                     	JSR		MonGetch
   7385 00C1DC C9 24 00                     	CMP		#'$'
   7386 00C1DF F0 F5                        	BEQ		.mon4
   7387 00C1E1 C9 53 00                     	CMP		#'S'
   7388 00C1E4 D0 51                        	BNE		.mon2
   7389 00C1E6 20 D1 C2                     	JSR		MonGetch
   7390 00C1E9 C9 45 00                     	CMP		#'E'
   7391 00C1EC F0 FF 57 02                  	LBEQ	GetSecnum
   7392 00C1F0 C9 55 00                     	CMP		#'U'
   7393 00C1F3 D0 FF F8 FF                  	LBNE	doSavefile
   7394 00C1F7 42 C2 30 01                  	REP		#$130
   7395 00C1FB 42 E2 00 02                  	SEP		#$200
                                           	MEM		32
                                           	NDX		32
   7398 00C1FF A9 08 00 00 00               	LDA		#8
   7399 00C204 20 6A D9                     	JSR		hTcbToAddr
   7400 00C207 AA                           	TAX
   7401 00C208 A9 20 00 00 00               	LDA		#$20
   7402 00C20D 95 2C                        	STA		TCB_priority,X
   7403 00C20F A9 00 00 00 00               	LDA		#0
   7404 00C214 20 6A D9                     	JSR		hTcbToAddr
   7405 00C217 AA                           	TAX
   7406 00C218 74 2D                        	STZ		TCB_status,X	; monitor is no longer ready
   7407 00C21A A9 08 00 00 00               	LDA		#8
   7408 00C21F 42 AB 85 CE                  	STA.H	IOFocusTask
   7409 00C223 20 0F DF                     	JSR		InsertIntoReadyFifo
   7410 00C226 42 C2 00 02                  	REP		#$200
   7411 00C22A 42 E2 00 01                  	SEP		#$100
                                           	MEM		16
                                           	NDX		16
   7414 00C22E 42 CB 42 A2 08 00            	TSK		JMP:#8
   7415 00C234 82 79 FF                     	BRL		.mon1
                                           	;JMP		$8000		; invoke Supermon832
   7417 00C237                             .mon2:
   7418 00C237 C9 43 00                     	CMP		#'C'
   7419 00C23A D0 09                        	BNE		.mon5
   7420 00C23C 20 6D CD                     	JSR		ClearScreen
   7421 00C23F 20 BD CC                     	JSR		HomeCursor
   7422 00C242 82 6B FF                     	BRL		.mon1
   7423 00C245                             .mon5:
   7424 00C245 C9 4D 00                     	CMP		#'M'
   7425 00C248 D0 06                        	BNE		.mon6
   7426 00C24A 20 37 C7                     	JSR		doMemoryDump
   7427 00C24D 82 60 FF                     	BRL		Mon1
   7428 00C250                             .mon6:
   7429 00C250 C9 44 00                     	CMP		#'D'
   7430 00C253 F0 FF 97 00                  	LBEQ	doD
   7431 00C257 C9 3E 00                     	CMP		#'>'
   7432 00C25A F0 FF 4B 05                  	LBEQ	doMemoryEdit
   7433 00C25E C9 46 00                     	CMP		#'F'
   7434 00C261 F0 FF 7F 05                  	LBEQ	doFill
   7435 00C265 C9 4A 00                     	CMP		#'J'
   7436 00C268 F0 FF 1E 06                  	LBEQ	doJump
   7437 00C26C C9 54 00                     	CMP		#'T'
   7438 00C26F F0 FF F2 00                  	LBEQ	doTask
   7439 00C273 C9 49 00                     	CMP		#'I'
   7440 00C276 F0 FF 46 02                  	LBEQ	doInvaders
   7441 00C27A C9 52 00                     	CMP		#'R'
   7442 00C27D D0 0F                        	BNE		.mon7
   7443 00C27F 20 D1 C2                     	JSR		MonGetch
   7444 00C282 C9 44 00                     	CMP		#'D'
   7445 00C285 F0 FF D3 01                  	LBEQ	doRead
   7446 00C289 CA                           	DEX
   7447 00C28A CA                           	DEX
   7448 00C28B 82 3F 02                     	BRL		doRegs
   7449 00C28E                             .mon7:
   7450 00C28E C9 42 00                     	CMP		#'B'
   7451 00C291 F0 FF F5 00                  	LBEQ	doBasic
   7452 00C295 C9 57 00                     	CMP		#'W'
   7453 00C298 F0 FF B9 01                  	LBEQ	doWrite
   7454 00C29C C9 66 00                     	CMP		#'f'
   7455 00C29F D0 FF 0D FF                  	LBNE	Mon1
   7456 00C2A3 20 D1 C2                     	JSR		MonGetch
   7457 00C2A6 C9 6D 00                     	CMP		#'m'
   7458 00C2A9 D0 FF 03 FF                  	LBNE	Mon1
   7459 00C2AD 20 D1 C2                     	JSR		MonGetch
   7460 00C2B0 C9 74 00                     	CMP		#'t'
   7461 00C2B3 D0 FF F9 FE                  	LBNE	Mon1
   7462 00C2B7 20 6A D7                     	JSR		SDC_Format
   7463 00C2BA 82 F3 FE                     	BRL		Mon1
   7464 00C2BD                             .mon8:
   7465 00C2BD C9 4C 00                     	CMP		#'L'
   7466 00C2C0 D0 03                        	BNE		.mon9
   7467 00C2C2 82 66 01                     	BRL		doLoadfile
   7468 00C2C5                             .mon9:
   7469 00C2C5 82 E8 FE                     	BRL		Mon1
                                           ; Get a character from the screen, skipping over spaces and tabs
                                           ;
   7472 00C2C8                             MonGetNonSpace:
   7473 00C2C8                             .0001:
   7474 00C2C8 20 D1 C2                     	JSR		MonGetch
   7475 00C2CB C9 20 00                     	CMP		#' '
   7476 00C2CE F0 F8                        	BEQ		.0001
   7477 00C2D0 60                           	RTS
                                           
                                           ; Get a character from the screen.
                                           ;
   7481 00C2D1                             MonGetch:
   7482 00C2D1 42 3B FF 0F BF 00 00 0D      	LDA		$FFF:VIDBUF,X
                                         
   7483 00C2D9 E8                           	INX
   7484 00C2DA E8                           	INX
   7485 00C2DB 29 FF 00                     	AND		#$FF
   7486 00C2DE 20 EC CA                     	JSR		ScreenToAscii
   7487 00C2E1 60                           	RTS
                                           
   7489 00C2E2                             MonErr:
   7490 00C2E2 F4 01 00                     	PEA		1
   7491 00C2E5 F4 F5 E2                     	PEA		msgErr
   7492 00C2E8 20 F9 CC                     	JSR		DisplayString
   7493 00C2EB 82 C2 FE                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   7497 00C2EE                             doD:
   7498 00C2EE 20 D1 C2                     	JSR		MonGetch
   7499 00C2F1 C9 54 00                     	CMP		#'T'
   7500 00C2F4 F0 05                        	BEQ		doDate
   7501 00C2F6 CA                           	DEX
   7502 00C2F7 CA                           	DEX
   7503 00C2F8 82 3F 05                     	BRL		doDisassemble
                                           
                                           ;------------------------------------------------------------------------------
                                           ; DT? - displays the date from the RTC
                                           ; DT <year> <month> <day> - updates the RTC with the year, month and day.
                                           ;------------------------------------------------------------------------------
                                           
   7510 00C2FB                             doDate:
   7511 00C2FB 20 D1 C2                     	JSR		MonGetch
   7512 00C2FE C9 3F 00                     	CMP		#'?'
   7513 00C301 F0 35                        	BEQ		DispDate
   7514 00C303 CA                           	DEX
   7515 00C304 CA                           	DEX
   7516 00C305 20 25 CE                     	JSR		GetHexNumber
   7517 00C308 C0 00 00                     	CPY		#0
   7518 00C30B F0 28                        	BEQ		.0001
   7519 00C30D A5 0C                        	LDA		NumWorkArea
   7520 00C30F 42 8B 8D 06 03               	STA.B	RTCBuf+6
   7521 00C314 20 25 CE                     	JSR		GetHexNumber
   7522 00C317 C0 00 00                     	CPY		#0
   7523 00C31A F0 19                        	BEQ		.0001
   7524 00C31C A5 0C                        	LDA		NumWorkArea
   7525 00C31E 42 8B 8D 05 03               	STA.B	RTCBuf+5
   7526 00C323 20 25 CE                     	JSR		GetHexNumber
   7527 00C326 C0 00 00                     	CPY		#0
   7528 00C329 F0 0A                        	BEQ		.0001
   7529 00C32B A5 0C                        	LDA		NumWorkArea
   7530 00C32D 42 8B 8D 04 03               	STA.B	RTCBuf+4
   7531 00C332 20 BC D6                     	JSR		rtc_write
   7532 00C335                             .0001:
   7533 00C335 82 78 FE                     	BRL		Mon1
                                           
   7535 00C338                             DispDate:
   7536 00C338 20 3A D6                     	JSR		rtc_read
   7537 00C33B 42 8B AD 06 03               	LDA.B	RTCBuf+6
   7538 00C340 20 CF CD                     	JSR		DispByte
   7539 00C343 A9 2F 00                     	LDA		#'/'
   7540 00C346 20 EA CC                     	JSR		OutChar
   7541 00C349 42 8B AD 05 03               	LDA.B	RTCBuf+5
   7542 00C34E 20 CF CD                     	JSR		DispByte
   7543 00C351 A9 2F 00                     	LDA		#'/'
   7544 00C354 20 EA CC                     	JSR		OutChar
   7545 00C357 42 8B AD 04 03               	LDA.B	RTCBuf+4
   7546 00C35C 20 CF CD                     	JSR		DispByte
   7547 00C35F 20 E1 CC                     	JSR		OutCRLF
   7548 00C362 82 4B FE                     	BRL		Mon1
                                           		
                                           ;------------------------------------------------------------------------------
   7551 00C365                             doTask:
   7552 00C365 20 D1 C2                     	JSR		MonGetch
   7553 00C368 C9 53 00                     	CMP		#'S'
   7554 00C36B D0 14                        	BNE		.0001
   7555 00C36D 20 25 CE                     	JSR		GetHexNumber
   7556 00C370 A5 0C                        	LDA		NumWorkArea
   7557 00C372 0A                           	ASL
   7558 00C373 AA                           	TAX		
   7559 00C374 A9 20 00                     	LDA		#$20
   7560 00C377 95 2C                        	STA		TCB_priority,X
   7561 00C379 A5 0C                        	LDA		NumWorkArea
   7562 00C37B 20 0F DF                     	JSR		InsertIntoReadyFifo
                                           ;	TSK
   7564 00C37E 82 2F FE                     	BRL		Mon1
   7565 00C381                             .0001:
   7566 00C381 CA                           	DEX
   7567 00C382 CA                           	DEX
   7568 00C383 20 25 CE                     	JSR		GetHexNumber
   7569 00C386 A5 0C                        	LDA		NumWorkArea
   7570 00C388 42 3A                        	TSK
                                           	BRK		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Start the BASIC interpreter.
                                           ;------------------------------------------------------------------------------
                                           
   7577 00C38A                             doBasic:
                                           	; Setup the BASIC descriptor
   7579 00C38A A9 01 00                     	LDA		#$0001
   7580 00C38D 42 EB                        	XBAW
   7581 00C38F A9 00 00                     	LDA		#$0000
   7582 00C392 A2 85 09                     	LDX		#$985		; executable, writeable, 64k (based at $10000)
   7583 00C395 A0 FD 0F                     	LDY		#$FFD
   7584 00C398 42 BA                        	SDU
                                           	; Switch to 32 bit mode in order to set the task priority and insert the
                                           	; BASIC task into the ready queue.
   7587 00C39A 42 C2 30 01                  	REP		#$130
   7588 00C39E 42 E2 00 02                  	SEP		#$200
                                           	MEM		32
                                           	NDX		32
   7591 00C3A2 A9 07 00 00 00               	LDA		#7
   7592 00C3A7 20 6A D9                     	JSR		hTcbToAddr
   7593 00C3AA AA                           	TAX
   7594 00C3AB A9 20 00 00 00               	LDA		#$20
   7595 00C3B0 95 2C                        	STA		TCB_priority,X
   7596 00C3B2 A9 00 00 00 00               	LDA		#0
   7597 00C3B7 20 6A D9                     	JSR		hTcbToAddr
   7598 00C3BA AA                           	TAX
   7599 00C3BB 74 2D                        	STZ		TCB_status,X	; monitor is no longer ready
   7600 00C3BD A9 07 00 00 00               	LDA		#7
   7601 00C3C2 42 AB 85 CE                  	STA.H	IOFocusTask
   7602 00C3C6 20 0F DF                     	JSR		InsertIntoReadyFifo
   7603 00C3C9 42 C2 30 02                  	REP		#$230
   7604 00C3CD 42 E2 00 01                  	SEP		#$100
                                           	NDX		16
                                           	MEM		16
   7607 00C3D1 42 A2 07 00                  	TSK		#7
   7608 00C3D5 82 D8 FD                     	BRL		Mon1
                                           
   7610 00C3D8                             ClearFilenameBuf:
   7611 00C3D8 A0 00 00                     	LDY		#0
   7612 00C3DB A9 20 00                     	LDA		#' '
   7613 00C3DE                             .0002:
   7614 00C3DE 42 8B 99 80 03               	STA.B	FilenameBuf,Y
   7615 00C3E3 C8                           	INY
   7616 00C3E4 C0 0F 00                     	CPY		#15
   7617 00C3E7 D0 F5                        	BNE		.0002
   7618 00C3E9 A9 00 00                     	LDA		#0
   7619 00C3EC 42 8B 99 80 03               	STA.B	FilenameBuf,Y
   7620 00C3F1 60                           	RTS
                                           
   7622 00C3F2                             MonGetFilename:
   7623 00C3F2 20 D8 C3                     	JSR		ClearFilenameBuf
   7624 00C3F5                             .0004:
   7625 00C3F5 20 D1 C2                     	JSR		MonGetch
   7626 00C3F8 C9 20 00                     	CMP		#' '
   7627 00C3FB F0 F8                        	BEQ		.0004
   7628 00C3FD C9 22 00                     	CMP		#'"'
   7629 00C400 D0 26                        	BNE		.badFname
   7630 00C402                             .nextChar:
   7631 00C402 20 D1 C2                     	JSR		MonGetch
   7632 00C405 C9 22 00                     	CMP		#'"'
   7633 00C408 F0 1D                        	BEQ		.0001
   7634 00C40A C9 2E 00                     	CMP		#'.'
   7635 00C40D D0 05                        	BNE		.0003
   7636 00C40F A0 0D 00                     	LDY		#13
   7637 00C412 80 EE                        	BRA		.nextChar
   7638 00C414                             .0003:
   7639 00C414 42 8B 99 80 03               	STA.B	FilenameBuf,Y
   7640 00C419 C8                           	INY
   7641 00C41A C0 0F 00                     	CPY		#15
   7642 00C41D D0 E3                        	BNE		.nextChar
   7643 00C41F 20 D1 C2                     	JSR		MonGetch
   7644 00C422 C9 22 00                     	CMP		#'"'
   7645 00C425 D0 01                        	BNE		.badFname
   7646 00C427                             .0001:
   7647 00C427 60                           	RTS
   7648 00C428                             .badFname:
   7649 00C428 82 85 FD                     	BRL		Mon1
                                           
   7651 00C42B                             doLoadfile:
   7652 00C42B 20 F2 C3                     	JSR		MonGetFilename
   7653 00C42E 20 25 CE                     	JSR		GetHexNumber
   7654 00C431 C0 00 00                     	CPY		#0
   7655 00C434 F0 10                        	BEQ		.noBuf
   7656 00C436 A5 0E                        	LDA		NumWorkArea+2
   7657 00C438 48                           	PHA
   7658 00C439 A5 0C                        	LDA		NumWorkArea
   7659 00C43B 48                           	PHA
   7660 00C43C F4 00 00                     	PEA		0
   7661 00C43F A9 80 03                     	LDA		#FilenameBuf
   7662 00C442 48                           	PHA
   7663 00C443 20 3F C4                     	JSR		SDC_Loadfile
   7664 00C446                             .noBuf:
   7665 00C446 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Get starting sector number for SD Card read/write routines
                                           ;------------------------------------------------------------------------------
                                           
   7671 00C447                             GetSecnum:
   7672 00C447 20 25 CE                     	JSR		GetHexNumber
   7673 00C44A A5 0C                        	LDA		NumWorkArea
   7674 00C44C 85 C4                        	STA		secnum
   7675 00C44E A5 0E                        	LDA		NumWorkArea+2
   7676 00C450 85 C6                        	STA		secnum+2
   7677 00C452 82 5B FD                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Read or write a block of memory to SD Card.
                                           ;------------------------------------------------------------------------------
                                           
   7683 00C455                             doWrite:
   7684 00C455 A9 FF FF                     	LDA		#$FFFF
   7685 00C458 85 BA                        	STA		rw_flag
   7686 00C45A 80 02                        	BRA		doReadWrite
   7687 00C45C                             doRead:
   7688 00C45C 64 BA                        	STZ		rw_flag
   7689 00C45E                             doReadWrite:
   7690 00C45E 20 FA CD                     	JSR		GetRange
   7691 00C461 20 BA D4                     	JSR		spi_master_init
   7692 00C464 C9 00 00                     	CMP		#0
   7693 00C467 F0 03                        	BEQ		.0004
   7694 00C469 82 44 FD                     	BRL		Mon1
   7695 00C46C                             .0004:
   7696 00C46C 20 E1 CC                     	JSR		OutCRLF
   7697 00C46F                             .0002:
   7698 00C46F 20 B0 C4                     	JSR		DispSecnum
   7699 00C472 A5 22                        	LDA		RangeStart+2
   7700 00C474 48                           	PHA
   7701 00C475 A5 20                        	LDA		RangeStart
   7702 00C477 48                           	PHA
   7703 00C478 A5 C6                        	LDA		secnum+2
   7704 00C47A 48                           	PHA
   7705 00C47B A5 C4                        	LDA		secnum
   7706 00C47D 48                           	PHA
   7707 00C47E 24 BA                        	BIT		rw_flag
   7708 00C480 50 05                        	BVC		.0005
   7709 00C482 20 66 D5                     	JSR		spi_master_write
   7710 00C485 80 03                        	BRA		.0006
   7711 00C487                             .0005:
   7712 00C487 20 EE D4                     	JSR		spi_master_read
   7713 00C48A                             .0006:
   7714 00C48A E6 C4                        	INC		secnum
   7715 00C48C D0 02                        	BNE		.0001
   7716 00C48E E6 C6                        	INC		secnum+2
   7717 00C490                             .0001:
   7718 00C490 18                           	CLC
   7719 00C491 A5 20                        	LDA		RangeStart
   7720 00C493 69 00 02                     	ADC		#512
   7721 00C496 85 20                        	STA		RangeStart
   7722 00C498 A5 22                        	LDA		RangeStart+2
   7723 00C49A 69 00 00                     	ADC		#0
   7724 00C49D 85 22                        	STA		RangeStart+2
   7725 00C49F 38                           	SEC
   7726 00C4A0 A5 20                        	LDA		RangeStart
   7727 00C4A2 E5 24                        	SBC		RangeEnd
   7728 00C4A4 A5 22                        	LDA		RangeStart+2
   7729 00C4A6 E5 26                        	SBC		RangeEnd+2
   7730 00C4A8 30 C5                        	BLT		.0002
   7731 00C4AA 20 E1 CC                     	JSR		OutCRLF
   7732 00C4AD 82 00 FD                     	BRL		Mon1
                                           
   7734 00C4B0                             DispSecnum:
   7735 00C4B0 A5 C6                        	LDA		secnum+2
   7736 00C4B2 20 CA CD                     	JSR		DispWord
   7737 00C4B5 A5 C4                        	LDA		secnum
   7738 00C4B7 20 CA CD                     	JSR		DispWord
   7739 00C4BA A9 0D 00                     	LDA		#$0D
   7740 00C4BD 4C EA CC                     	JMP		OutChar
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   7744 00C4C0                             doInvaders:
   7745 00C4C0 A9 FF FF                     	LDA		#$FFFF
   7746 00C4C3 8D 68 78                     	STA		do_invaders
   7747 00C4C6 42 A2 05 00                  	TSK		#5
                                           ;	FORK	#5
                                           ;	TTA
                                           ;	CMP		#5
                                           ;	LBEQ	InvadersTask
   7752 00C4CA 82 E3 FC                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Display Registers
                                           ; R<xx>		xx = context register to display
                                           ; Update Registers
                                           ; R.<reg> <val>
                                           ;	reg = CS PB PC A X Y SP SR DS DB DP or MP
                                           ;------------------------------------------------------------------------------
                                           
   7762 00C4CD                             doRegs:
   7763 00C4CD 20 D1 C2                     	JSR		MonGetch
   7764 00C4D0 C9 2E 00                     	CMP		#'.'
   7765 00C4D3 D0 FF 31 01                  	LBNE	.0004
   7766 00C4D7 20 D1 C2                     	JSR		MonGetch
   7767 00C4DA C9 43 00                     	CMP		#'C'
   7768 00C4DD D0 26                        	BNE		.0005
   7769 00C4DF 20 D1 C2                     	JSR		MonGetch
   7770 00C4E2 C9 53 00                     	CMP		#'S'
   7771 00C4E5 D0 FF C7 FC                  	LBNE	Mon1
   7772 00C4E9 20 F4 C8                     	JSR		IgnoreBlanks
   7773 00C4EC 20 25 CE                     	JSR		GetHexNumber
   7774 00C4EF A5 0C                        	LDA		NumWorkArea
   7775 00C4F1 85 80                        	STA		reg_cs
   7776 00C4F3 A5 0E                        	LDA		NumWorkArea+2
   7777 00C4F5 85 82                        	STA		reg_cs+2
   7778 00C4F7                             .buildrec
   7779 00C4F7 20 CA C6                     	JSR		BuildRec
   7780 00C4FA A6 BE                        	LDX		WorkTR
   7781 00C4FC 42 6C 00 01 00 00            	LDT		ldtrec
   7782 00C502 82 AB FC                     	BRL		Mon1
   7783 00C505                             .0005:
   7784 00C505 C9 50 00                     	CMP		#'P'
   7785 00C508 D0 27                        	BNE		.0006
   7786 00C50A 20 D1 C2                     	JSR		MonGetch
   7787 00C50D C9 42 00                     	CMP		#'B'
   7788 00C510 D0 0C                        	BNE		.0007
   7789 00C512 20 F4 C8                     	JSR		IgnoreBlanks
   7790 00C515 20 25 CE                     	JSR		GetHexNumber
   7791 00C518 A5 0E                        	LDA		NumWorkArea+2
   7792 00C51A 85 8E                        	STA		reg_pc+2
   7793 00C51C 80 D9                        	BRA		.buildrec
   7794 00C51E                             .0007:
   7795 00C51E C9 43 00                     	CMP		#'C'
   7796 00C521 D0 FF 8B FC                  	LBNE	Mon1
   7797 00C525 20 F4 C8                     	JSR		IgnoreBlanks
   7798 00C528 20 25 CE                     	JSR		GetHexNumber
   7799 00C52B A5 0C                        	LDA		NumWorkArea
   7800 00C52D 85 8C                        	STA		reg_pc
   7801 00C52F 80 C6                        	BRA		.buildrec
   7802 00C531                             .0006:
   7803 00C531 C9 41 00                     	CMP		#'A'
   7804 00C534 D0 10                        	BNE		.0008
   7805 00C536 20 F4 C8                     	JSR		IgnoreBlanks
   7806 00C539 20 25 CE                     	JSR		GetHexNumber
   7807 00C53C A5 0C                        	LDA		NumWorkArea
   7808 00C53E 85 90                        	STA		reg_a
   7809 00C540 A5 0E                        	LDA		NumWorkArea+2
   7810 00C542 85 92                        	STA		reg_a+2
   7811 00C544 80 B1                        	BRA		.buildrec
   7812 00C546                             .0008:
   7813 00C546 C9 58 00                     	CMP		#'X'
   7814 00C549 D0 11                        	BNE		.0009
   7815 00C54B 20 F4 C8                     	JSR		IgnoreBlanks
   7816 00C54E 20 25 CE                     	JSR		GetHexNumber
   7817 00C551 A5 0C                        	LDA		NumWorkArea
   7818 00C553 85 94                        	STA		reg_x
   7819 00C555 A5 0E                        	LDA		NumWorkArea+2
   7820 00C557 85 96                        	STA		reg_x+2
   7821 00C559 82 9B FF                     	BRL		.buildrec
   7822 00C55C                             .0009:
   7823 00C55C C9 59 00                     	CMP		#'Y'
   7824 00C55F D0 11                        	BNE		.0010
   7825 00C561 20 F4 C8                     	JSR		IgnoreBlanks
   7826 00C564 20 25 CE                     	JSR		GetHexNumber
   7827 00C567 A5 0C                        	LDA		NumWorkArea
   7828 00C569 85 98                        	STA		reg_y
   7829 00C56B A5 0E                        	LDA		NumWorkArea+2
   7830 00C56D 85 9A                        	STA		reg_y+2
   7831 00C56F 82 85 FF                     	BRL		.buildrec
   7832 00C572                             .0010:
   7833 00C572 C9 53 00                     	CMP		#'S'
   7834 00C575 D0 2D                        	BNE		.0011
   7835 00C577 20 D1 C2                     	JSR		MonGetch
   7836 00C57A C9 50 00                     	CMP		#'P'
   7837 00C57D D0 11                        	BNE		.0015
   7838 00C57F 20 F4 C8                     	JSR		IgnoreBlanks
   7839 00C582 20 25 CE                     	JSR		GetHexNumber
   7840 00C585 A5 0C                        	LDA		NumWorkArea
   7841 00C587 85 9C                        	STA		reg_sp
   7842 00C589 A5 0E                        	LDA		NumWorkArea+2
   7843 00C58B 85 9E                        	STA		reg_sp+2
   7844 00C58D 82 67 FF                     	BRL		.buildrec
   7845 00C590                             .0015:
   7846 00C590 C9 52 00                     	CMP		#'R'
   7847 00C593 D0 FF 19 FC                  	LBNE	Mon1
   7848 00C597 20 F4 C8                     	JSR		IgnoreBlanks
   7849 00C59A 20 25 CE                     	JSR		GetHexNumber
   7850 00C59D A5 0C                        	LDA		NumWorkArea
   7851 00C59F 85 A0                        	STA		reg_sr
   7852 00C5A1 82 53 FF                     	BRL		.buildrec
   7853 00C5A4                             .0011:
   7854 00C5A4 C9 44 00                     	CMP		#'D'
   7855 00C5A7 D0 FF F8 FF                  	LBNE	Mon14
   7856 00C5AB 20 D1 C2                     	JSR		MonGetch
   7857 00C5AE C9 53 00                     	CMP		#'S'
   7858 00C5B1 D0 11                        	BNE		.0012
   7859 00C5B3 20 F4 C8                     	JSR		IgnoreBlanks
   7860 00C5B6 20 25 CE                     	JSR		GetHexNumber
   7861 00C5B9 A5 0C                        	LDA		NumWorkArea
   7862 00C5BB 85 84                        	STA		reg_ds
   7863 00C5BD A5 0E                        	LDA		NumWorkArea+2
   7864 00C5BF 85 86                        	STA		reg_ds+2
   7865 00C5C1 82 33 FF                     	BRL		.buildrec
   7866 00C5C4                             .0012:
   7867 00C5C4 C9 42 00                     	CMP		#'B'
   7868 00C5C7 D0 0D                        	BNE		.0013
   7869 00C5C9 20 F4 C8                     	JSR		IgnoreBlanks
   7870 00C5CC 20 25 CE                     	JSR		GetHexNumber
   7871 00C5CF A5 0C                        	LDA		NumWorkArea
   7872 00C5D1 85 A4                        	STA		reg_db
   7873 00C5D3 82 21 FF                     	BRL		.buildrec
   7874 00C5D6                             .0013:
   7875 00C5D6 C9 50 00                     	CMP		#'P'
   7876 00C5D9 D0 FF D3 FB                  	LBNE	Mon1
   7877 00C5DD 20 F4 C8                     	JSR		IgnoreBlanks
   7878 00C5E0 20 25 CE                     	JSR		GetHexNumber
   7879 00C5E3 A5 0C                        	LDA		NumWorkArea
   7880 00C5E5 85 A8                        	STA		reg_dp
   7881 00C5E7 82 0D FF                     	BRL		.buildrec
   7882 00C5EA                             .0014:
   7883 00C5EA C9 4D 00                     	CMP		#'M'
   7884 00C5ED D0 FF BF FB                  	LBNE	Mon1
   7885 00C5F1 20 D1 C2                     	JSR		MonGetch
   7886 00C5F4 C9 50 00                     	CMP		#'P'
   7887 00C5F7 D0 FF B5 FB                  	LBNE	Mon1
   7888 00C5FB 20 F4 C8                     	JSR		IgnoreBlanks
   7889 00C5FE 20 25 CE                     	JSR		GetHexNumber
   7890 00C601 A5 0C                        	LDA		NumWorkArea
   7891 00C603 85 B0                        	STA		reg_mp
   7892 00C605 82 EF FE                     	BRL		.buildrec
                                           
   7894 00C608                             .0004:
   7895 00C608 CA                           	DEX
   7896 00C609 CA                           	DEX
                                           ;	JSR		IgnoreBlanks
   7898 00C60A 20 25 CE                     	JSR		GetHexNumber
   7899 00C60D C0 00 00                     	CPY		#0
   7900 00C610 F0 FF 9C FB                  	LBEQ	Mon1
   7901 00C614 A5 0C                        	LDA		NumWorkArea
   7902 00C616 85 BE                        	STA		WorkTR
   7903 00C618 42 28 03 00                  	BSR		DispRegs
   7904 00C61C 82 91 FB                     	BRL		Mon1
                                           
   7906 00C61F                             DispRegs:
   7907 00C61F F4 01 00                     	PEA		1
   7908 00C622 F4 7A E2                     	PEA		msgRegs
   7909 00C625 20 F9 CC                     	JSR		DisplayString
   7910 00C628 20 F1 CD                     	JSR		space
                                           
   7912 00C62B A5 BE                        	LDA		WorkTR
   7913 00C62D 0A                           	ASL
   7914 00C62E 0A                           	ASL
   7915 00C62F 0A                           	ASL
   7916 00C630 0A                           	ASL
   7917 00C631 AA                           	TAX
                                           
   7919 00C632 A0 00 00                     	LDY		#0
   7920 00C635                             .0001:
   7921 00C635 42 4A                        	INF
   7922 00C637 E8                           	INX
   7923 00C638 99 80 00                     	STA		reg_cs,Y
   7924 00C63B 42 EB                        	XBAW
   7925 00C63D 99 82 00                     	STA		reg_cs+2,Y
   7926 00C640 42 C8                        	INY4
   7927 00C642 C0 30 00                     	CPY		#48
   7928 00C645 D0 EE                        	BNE		.0001
                                           
                                           	; Display CS
   7931 00C647 A5 80                        	LDA		reg_cs
   7932 00C649 20 CA CD                     	JSR		DispWord
   7933 00C64C A9 3A 00                     	LDA		#':'
   7934 00C64F 20 EA CC                     	JSR		OutChar
                                           
                                           	; Display PB PC
   7937 00C652 A5 8E                        	LDA		reg_pc+2
   7938 00C654 20 CF CD                     	JSR		DispByte
   7939 00C657 A5 8C                        	LDA		reg_pc
   7940 00C659 20 CA CD                     	JSR		DispWord
   7941 00C65C 20 F1 CD                     	JSR		space
                                           
                                           	; Display SRX,SR
   7944 00C65F A5 A0                        	LDA		reg_cs+32
   7945 00C661 A2 10 00                     	LDX		#16
   7946 00C664                             .0003:
   7947 00C664 0A                           	ASL
   7948 00C665 48                           	PHA
   7949 00C666 A9 30 00                     	LDA		#'0'
   7950 00C669 69 00 00                     	ADC		#0
   7951 00C66C 20 D8 CD                     	JSR		DispNybble
   7952 00C66F 68                           	PLA
   7953 00C670 CA                           	DEX
   7954 00C671 D0 F1                        	BNE		.0003
   7955 00C673 20 F1 CD                     	JSR		space
                                           
   7957 00C676 A2 10 00                     	LDX		#16
   7958 00C679                             .0002
                                           	; display Acc,.X,.Y,.SP
   7960 00C679 B5 82                        	LDA		reg_cs+2,X
   7961 00C67B 20 CA CD                     	JSR		DispWord
   7962 00C67E B5 80                        	LDA		reg_cs,X
   7963 00C680 20 CA CD                     	JSR		DispWord
   7964 00C683 20 F1 CD                     	JSR		space
   7965 00C686 42 E8                        	INX4
   7966 00C688 E0 20 00                     	CPX		#32
   7967 00C68B D0 EC                        	BNE		.0002
                                           
   7969 00C68D F4 01 00                     	PEA		1
   7970 00C690 F4 D6 E2                     	PEA		msgRegs2
   7971 00C693 20 F9 CC                     	JSR		DisplayString
   7972 00C696 20 F1 CD                     	JSR		space
                                           
                                           	; Display SS
   7975 00C699 A5 88                        	LDA		reg_ss
   7976 00C69B 20 CA CD                     	JSR		DispWord
   7977 00C69E 20 F1 CD                     	JSR		space
                                           
                                           	; Display DS
   7980 00C6A1 A5 84                        	LDA		reg_ds
   7981 00C6A3 20 CA CD                     	JSR		DispWord
   7982 00C6A6 20 F1 CD                     	JSR		space
                                           
                                           	; Display DB
   7985 00C6A9 A5 A4                        	LDA		reg_db
   7986 00C6AB 20 CF CD                     	JSR		DispByte
   7987 00C6AE 20 F1 CD                     	JSR		space
                                           
                                           	; Display DPR
   7990 00C6B1 A5 A8                        	LDA		reg_dp
   7991 00C6B3 20 CA CD                     	JSR		DispWord
   7992 00C6B6 20 F1 CD                     	JSR		space
                                           
                                           	; Display back link
   7995 00C6B9 A5 AC                        	LDA		reg_bl
   7996 00C6BB 20 CA CD                     	JSR		DispWord
                                           
                                           	; Display map number
   7999 00C6BE 20 F1 CD                     	JSR		space
   8000 00C6C1 A5 B0                        	LDA		reg_mp
   8001 00C6C3 20 CF CD                     	JSR		DispByte
                                           
   8003 00C6C6 20 E1 CC                     	JSR		OutCRLF
   8004 00C6C9 60                           	RTS
                                           
                                           ; Build a startup record from the register values so that a context reg
                                           ; may be loaded
                                           
   8009 00C6CA                             BuildRec:
   8010 00C6CA A5 80                        	LDA		reg_cs
   8011 00C6CC 8D 00 01                     	STA		ldtrec
   8012 00C6CF A5 84                        	LDA		reg_ds
   8013 00C6D1 8D 02 01                     	STA		ldtrec+2
   8014 00C6D4 A5 88                        	LDA		reg_ss
   8015 00C6D6 8D 04 01                     	STA		ldtrec+4
   8016 00C6D9 A5 8C                        	LDA		reg_pc
   8017 00C6DB 8D 06 01                     	STA		ldtrec+6
   8018 00C6DE A5 8E                        	LDA		reg_pc+2
   8019 00C6E0 29 FF 00                     	AND		#$FF
   8020 00C6E3 E2 30                        	SEP		#$30		; 8 bit regs
                                           	MEM		8
   8022 00C6E5 EB                           	XBA
   8023 00C6E6 A5 90                        	LDA		reg_a
   8024 00C6E8 EB                           	XBA
   8025 00C6E9 C2 30                        	REP		#$30
                                           	MEM		16
   8027 00C6EB 8D 08 01                     	STA		ldtrec+8
   8028 00C6EE A5 91                        	LDA		reg_a+1
   8029 00C6F0 8D 0A 01                     	STA		ldtrec+10
   8030 00C6F3 A5 93                        	LDA		reg_a+3
   8031 00C6F5 8D 0C 01                     	STA		ldtrec+12
   8032 00C6F8 A5 95                        	LDA		reg_x+1
   8033 00C6FA 8D 0E 01                     	STA		ldtrec+14
   8034 00C6FD A5 97                        	LDA		reg_x+3
   8035 00C6FF 8D 10 01                     	STA		ldtrec+16
   8036 00C702 A5 99                        	LDA		reg_y+1
   8037 00C704 8D 12 01                     	STA		ldtrec+18
   8038 00C707 A5 9B                        	LDA		reg_y+3
   8039 00C709 8D 14 01                     	STA		ldtrec+20
   8040 00C70C A5 9D                        	LDA		reg_sp+1
   8041 00C70E 8D 16 01                     	STA		ldtrec+22
   8042 00C711 A5 9F                        	LDA		reg_sp+3
   8043 00C713 8D 18 01                     	STA		ldtrec+24
   8044 00C716 E2 30                        	SEP		#$30
   8045 00C718 A5 A1                        	LDA		reg_sr+1
   8046 00C71A 8D 1A 01                     	STA		ldtrec+26
   8047 00C71D A5 A4                        	LDA		reg_db
   8048 00C71F 8D 1B 01                     	STA		ldtrec+27
   8049 00C722 A5 A8                        	LDA		reg_dp
   8050 00C724 8D 1C 01                     	STA		ldtrec+28
   8051 00C727 A5 A9                        	LDA		reg_dp+1
   8052 00C729 8D 1D 01                     	STA		ldtrec+29
   8053 00C72C A5 B0                        	LDA		reg_mp
   8054 00C72E 8D 1E 01                     	STA		ldtrec+30
   8055 00C731 9C 1F 01                     	STZ		ldtrec+31
   8056 00C734 C2 30                        	REP		#$30
   8057 00C736 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Dump memory.
                                           ;------------------------------------------------------------------------------
                                           
   8063 00C737                             doMemoryDump:
   8064 00C737 20 F4 C8                     	JSR		IgnoreBlanks
   8065 00C73A 20 FA CD                     	JSR		GetRange
   8066 00C73D 20 E1 CC                     	JSR		OutCRLF
   8067 00C740                             .0007:
   8068 00C740 A9 3E 00                     	LDA		#'>'
   8069 00C743 20 EA CC                     	JSR		OutChar
   8070 00C746 20 E4 C8                     	JSR		DispRangeStart
   8071 00C749 A0 00 00                     	LDY		#0
   8072 00C74C                             .0001:
   8073 00C74C 42 B7 20                     	LDA		{RangeStart},Y
   8074 00C74F 20 CF CD                     	JSR		DispByte
   8075 00C752 A9 20 00                     	LDA		#' '
   8076 00C755 20 EA CC                     	JSR		OutChar
   8077 00C758 C8                           	INY
   8078 00C759 C0 08 00                     	CPY		#8
   8079 00C75C D0 EE                        	BNE		.0001
   8080 00C75E A0 00 00                     	LDY 	#0
   8081 00C761                             .0005:
   8082 00C761 42 B7 20                     	LDA		{RangeStart},Y
   8083 00C764 29 FF 00                     	AND		#$FF
   8084 00C767 C9 20 00                     	CMP		#' '
   8085 00C76A B0 05                        	BCS		.0002
   8086 00C76C                             .0004:
   8087 00C76C A9 2E 00                     	LDA		#'.'
   8088 00C76F 80 05                        	BRA		.0003
   8089 00C771                             .0002:
   8090 00C771 C9 7F 00                     	CMP		#$7f
   8091 00C774 B0 F6                        	BCS		.0004
   8092 00C776                             .0003:
   8093 00C776 20 EA CC                     	JSR		OutChar
   8094 00C779 C8                           	INY
   8095 00C77A C0 08 00                     	CPY		#8
   8096 00C77D D0 E2                        	BNE		.0005
   8097 00C77F 20 E1 CC                     	JSR		OutCRLF
   8098 00C782 18                           	CLC
   8099 00C783 A5 20                        	LDA		RangeStart
   8100 00C785 69 08 00                     	ADC		#8
   8101 00C788 85 20                        	STA		RangeStart
   8102 00C78A 90 02                        	BCC		.0006
   8103 00C78C E6 22                        	INC		RangeStart+2
   8104 00C78E                             .0006:
   8105 00C78E 38                           	SEC
   8106 00C78F A5 24                        	LDA		RangeEnd
   8107 00C791 E5 20                        	SBC		RangeStart
   8108 00C793 A5 26                        	LDA		RangeEnd+2
   8109 00C795 E5 22                        	SBC		RangeStart+2
   8110 00C797 08                           	PHP
   8111 00C798 20 44 D0                     	JSR		KeybdGetCharNoWait;Ctx,7
   8112 00C79B 29 FF 00                     	AND		#$FF
   8113 00C79E C9 03 00                     	CMP		#CTRLC
   8114 00C7A1 F0 04                        	BEQ		.0009
   8115 00C7A3 28                           	PLP
   8116 00C7A4 10 9A                        	BPL		.0007
   8117 00C7A6                             .0008:
   8118 00C7A6 60                           	RTS
   8119 00C7A7                             .0009:
   8120 00C7A7 28                           	PLP
   8121 00C7A8 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Edit memory.
                                           ; ><memory address> <val1> <val2> ... <val8>
                                           ;------------------------------------------------------------------------------
                                           
   8128 00C7A9                             doMemoryEdit:
   8129 00C7A9 20 F4 C8                     	JSR		IgnoreBlanks
   8130 00C7AC 20 25 CE                     	JSR		GetHexNumber
   8131 00C7AF C0 00 00                     	CPY		#0
   8132 00C7B2 F0 FF FA F9                  	LBEQ	Mon1
   8133 00C7B6 A5 0C                        	LDA		NumWorkArea
   8134 00C7B8 85 20                        	STA		RangeStart
   8135 00C7BA A5 0E                        	LDA		NumWorkArea+2
   8136 00C7BC 85 22                        	STA		RangeStart+2
   8137 00C7BE A0 00 00                     	LDY		#0
   8138 00C7C1                             .0001:
   8139 00C7C1 5A                           	PHY
   8140 00C7C2 20 F4 C8                     	JSR		IgnoreBlanks
   8141 00C7C5 20 25 CE                     	JSR		GetHexNumber
   8142 00C7C8 C0 00 00                     	CPY		#0
   8143 00C7CB F0 13                        	BEQ		.0002
   8144 00C7CD 7A                           	PLY
   8145 00C7CE E2 20                        	SEP		#$20
   8146 00C7D0 A5 0C                        	LDA		NumWorkArea
   8147 00C7D2 42 97 20                     	STA		{RangeStart},Y
   8148 00C7D5 C2 20                        	REP		#$20
   8149 00C7D7 C8                           	INY
   8150 00C7D8 C0 08 00                     	CPY		#8
   8151 00C7DB D0 E4                        	BNE		.0001
   8152 00C7DD 82 D0 F9                     	BRL		Mon1
   8153 00C7E0                             .0002:
   8154 00C7E0 7A                           	PLY
   8155 00C7E1 82 CC F9                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Fill memory.
                                           ; $F <start address> <end address> <val1>
                                           ;------------------------------------------------------------------------------
                                           
   8162 00C7E4                             doFill:
   8163 00C7E4 20 F4 C8                     	JSR		IgnoreBlanks
   8164 00C7E7 20 25 CE                     	JSR		GetHexNumber
   8165 00C7EA C0 00 00                     	CPY		#0
   8166 00C7ED F0 FF F1 FA                  	LBEQ	MonErr
   8167 00C7F1 A5 0C                        	LDA		NumWorkArea
   8168 00C7F3 85 20                        	STA		RangeStart
   8169 00C7F5 A5 0E                        	LDA		NumWorkArea+2
   8170 00C7F7 85 22                        	STA		RangeStart+2
   8171 00C7F9 20 F4 C8                     	JSR		IgnoreBlanks
   8172 00C7FC 20 25 CE                     	JSR		GetHexNumber
   8173 00C7FF C0 00 00                     	CPY		#0
   8174 00C802 F0 FF DC FA                  	LBEQ	MonErr
   8175 00C806 A5 0C                        	LDA		NumWorkArea
   8176 00C808 85 24                        	STA		RangeEnd
   8177 00C80A A5 0E                        	LDA		NumWorkArea+2
   8178 00C80C 85 26                        	STA		RangeEnd+2
   8179 00C80E 20 F4 C8                     	JSR		IgnoreBlanks
   8180 00C811 20 25 CE                     	JSR		GetHexNumber
   8181 00C814 C0 00 00                     	CPY		#0
   8182 00C817 F0 FF C7 FA                  	LBEQ	MonErr
   8183 00C81B A6 0C                        	LDX		NumWorkArea
                                           	; Process in 32 bit mode
   8185 00C81D 42 E2 00 02                  	SEP		#$200
   8186 00C821 42 C2 00 01                  	REP		#$100
   8187 00C825 A5 24                        	LDA		RangeEnd
   8188 00C827 38                           	SEC
   8189 00C828 E5 20                        	SBC		RangeStart
   8190 00C82A A4 20                        	LDY		RangeStart
   8191 00C82C 42 44 00                     	FIL		$00
                                           	; Back to 16 bits mode
   8193 00C82F 42 C2 00 02                  	REP		#$200
   8194 00C833 42 E2 00 01                  	SEP		#$100
   8195 00C837 82 76 F9                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Disassemble code
                                           ;------------------------------------------------------------------------------
                                           
   8201 00C83A                             doDisassemble:
   8202 00C83A 20 D1 C2                     	JSR		MonGetch
   8203 00C83D C9 4D 00                     	CMP		#'M'
   8204 00C840 F0 11                        	BEQ		.0002
   8205 00C842                             .0004:
   8206 00C842 C9 4E 00                     	CMP		#'N'
   8207 00C845 D0 1B                        	BNE		.0003
   8208 00C847 E2 20                        	SEP		#$20
                                           	MEM		8
   8210 00C849 A5 BC                        	LDA		$BC
   8211 00C84B 09 40                        	ORA		#$40
   8212 00C84D 85 BC                        	STA		$BC
   8213 00C84F C2 20                        	REP		#$20
   8214 00C851 80 11                        	BRA		.0005
   8215 00C853                             .0002:
   8216 00C853 E2 20                        	SEP		#$20
   8217 00C855 A5 BC                        	LDA		$BC
   8218 00C857 09 80                        	ORA		#$80
   8219 00C859 85 BC                        	STA		$BC
   8220 00C85B C2 20                        	REP		#$20
   8221 00C85D 20 D1 C2                     	JSR		MonGetch
   8222 00C860 80 E0                        	BRA		.0004
                                           	MEM		16
   8224 00C862                             .0003:
   8225 00C862 CA                           	DEX
   8226 00C863 CA                           	DEX
   8227 00C864                             .0005:
   8228 00C864 20 F4 C8                     	JSR		IgnoreBlanks
   8229 00C867 20 FA CD                     	JSR		GetRange
   8230 00C86A A5 20                        	LDA		RangeStart
   8231 00C86C 85 8F                        	STA		$8F				; addra
   8232 00C86E A5 21                        	LDA		RangeStart+1
   8233 00C870 85 90                        	STA		$90
   8234 00C872 20 E1 CC                     	JSR		OutCRLF
   8235 00C875 A0 14 00                     	LDY		#20
   8236 00C878                             .0001:
   8237 00C878 5A                           	PHY
   8238 00C879 E2 30                        	SEP		#$30
   8239 00C87B 20 59 86                     	JSR		dpycod
   8240 00C87E C2 30                        	REP		#$30
   8241 00C880 20 E1 CC                     	JSR		OutCRLF
   8242 00C883 7A                           	PLY
   8243 00C884 88                           	DEY
   8244 00C885 D0 F1                        	BNE		.0001
   8245 00C887 4C B0 C1                     	JMP		Mon1
                                           
                                           ;$BC flimflag
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Jump to subroutine
                                           ;
                                           ; Either JSR for 16 bit address or JSL for 24 bit address
                                           ;------------------------------------------------------------------------------
                                           
   8255 00C88A                             doJump:
   8256 00C88A 20 D1 C2                     	JSR		MonGetch
   8257 00C88D C9 53 00                     	CMP		#'S'
   8258 00C890 D0 FF 1C F9                  	LBNE	Mon1
   8259 00C894 20 D1 C2                     	JSR		MonGetch
   8260 00C897 C9 52 00                     	CMP		#'R'
   8261 00C89A D0 1A                        	BNE		.testL
   8262 00C89C 20 F4 C8                     	JSR		IgnoreBlanks
   8263 00C89F 20 25 CE                     	JSR		GetHexNumber
   8264 00C8A2 C0 00 00                     	CPY		#0
   8265 00C8A5 F0 FF 07 F9                  	LBEQ	Mon1
   8266 00C8A9 A5 0C                        	LDA		NumWorkArea
   8267 00C8AB 85 24                        	STA		RangeEnd
   8268 00C8AD A2 00 00                     	LDX		#0
   8269 00C8B0 FC 24 00                     	JSR		(RangeEnd,X)
   8270 00C8B3 82 FA F8                     	BRL		Mon1
   8271 00C8B6                             .testL:
   8272 00C8B6 C9 4C 00                     	CMP		#'L'
   8273 00C8B9 D0 FF F3 F8                  	LBNE	Mon1
   8274 00C8BD 20 F4 C8                     	JSR		IgnoreBlanks
   8275 00C8C0 20 25 CE                     	JSR		GetHexNumber
   8276 00C8C3 C0 00 00                     	CPY		#0
   8277 00C8C6 F0 FF E6 F8                  	LBEQ	Mon1
   8278 00C8CA A9 5C 00                     	LDA		#$5C			; JML opcode
   8279 00C8CD 85 23                        	STA		RangeEnd-1
   8280 00C8CF A5 0C                        	LDA		NumWorkArea
   8281 00C8D1 85 24                        	STA		RangeEnd
   8282 00C8D3 A5 0D                        	LDA		NumWorkArea+1
   8283 00C8D5 85 25                        	STA		RangeEnd+1
   8284 00C8D7 A9 24 00                     	LDA		#RangeEnd
   8285 00C8DA 42 E0 01                     	CACHE	#1				; 1= invalidate instruction line identified by accumulator
   8286 00C8DD 22 24 00 00                  	JSL		RangeEnd
   8287 00C8E1 82 CC F8                     	BRL		Mon1
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   8291 00C8E4                             DispRangeStart:
   8292 00C8E4 A5 21                        	LDA		RangeStart+1
   8293 00C8E6 20 CA CD                     	JSR		DispWord
   8294 00C8E9 A5 20                        	LDA		RangeStart
   8295 00C8EB 20 CF CD                     	JSR		DispByte
   8296 00C8EE A9 20 00                     	LDA		#' '
   8297 00C8F1 4C EA CC                     	JMP		OutChar
                                           	
                                           ; Skip over blanks in the input
                                           ;------------------------------------------------------------------------------
                                           
   8302 00C8F4                             IgnoreBlanks:
   8303 00C8F4                             .0001:
   8304 00C8F4 20 D1 C2                     	JSR		MonGetch
   8305 00C8F7 C9 20 00                     	CMP		#' '
   8306 00C8FA F0 F8                        	BEQ		.0001
   8307 00C8FC CA                           	DEX
   8308 00C8FD CA                           	DEX
   8309 00C8FE 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; BIOSInput allows full screen editing of text until a carriage return is keyed
                                           ; at which point the line the cursor is on is copied to a buffer. The buffer
                                           ; must be at least TEXTCOLS characters in size.
                                           ;------------------------------------------------------------------------------
                                           ;
   8317 00C8FF                             BIOSInput:
   8318 00C8FF                             .bin1:
   8319 00C8FF 20 5A D0                     	JSR		KeybdGetCharWait
   8320 00C902 29 FF 00                     	AND		#$FF
   8321 00C905 C9 0D 00                     	CMP		#CR
   8322 00C908 F0 05                        	BEQ		.bin2
   8323 00C90A 20 EA CC                     	JSR		OutChar
   8324 00C90D 80 F0                        	BRA		.bin1
   8325 00C90F                             .bin2:
   8326 00C90F A5 30                        	LDA		CursorX
   8327 00C911 F0 1E                        	BEQ		.bin4
   8328 00C913 A5 34                        	LDA		VideoPos	; get current video position
   8329 00C915 38                           	SEC
   8330 00C916 E5 30                        	SBC		CursorX		; go back to the start of the line
   8331 00C918 0A                           	ASL
   8332 00C919 AA                           	TAX
   8333 00C91A                             .bin3:
   8334 00C91A 42 3B FF 0F BF 00 00 0D      	LDA		$FFF:VIDBUF,X
                                         
   8335 00C922 29 FF 00                     	AND		#$FF
   8336 00C925 93 03                        	STA		(3,s),Y
   8337 00C927 E8                           	INX
   8338 00C928 E8                           	INX
   8339 00C929 C8                           	INY
   8340 00C92A C6 30                        	DEC		CursorX
   8341 00C92C D0 EC                        	BNE		.bin3
   8342 00C92E A9 00 00                     	LDA		#0
   8343 00C931                             .bin4:
   8344 00C931 93 03                        	STA		(3,s),Y	; NULL terminate buffer
   8345 00C933 60                           	RTS
                                           
   8347 00C934                             .st0003:
   8348 00C934 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD
                                         
   8349 00C93C 10 F6                        	BPL		.st0003
   8350 00C93E 48                           	PHA						; save off the char (we need to trash acc)
   8351 00C93F 42 3B FF 0F AF 14 A1 0E      	LDA		$FFF:KEYBD+4	; clear keyboard strobe (must be a read operation)
                                         
   8352 00C947 68                           	PLA						; restore char
   8353 00C948 20 F8 CA                     	JSR		DisplayChar
   8354 00C94B 80 E7                        	BRA		.st0003
   8355 00C94D A0 00 00                     	ldy		#$0000
   8356 00C950                             .st0001:
   8357 00C950 A2 00 00                     	ldx		#$0000
   8358 00C953                             .st0002:
   8359 00C953 E8                           	inx
   8360 00C954 D0 FD                        	bne		.st0002
   8361 00C956 20 99 C9                     	jsr		echo_switch
   8362 00C959 C8                           	iny
   8363 00C95A 80 F4                        	bra		.st0001
                                           
   8365 00C95C                             msgStarting:
   8366 00C95C 46 54 38 33 32 20 54 65      	.byte	"FT832 Test System Starting",CR,LF
   8366 00C964 73 74 20 53 79 73 74 65    
   8366 00C96C 6D 20 53 74 61 72 74 69    
   8366 00C974 6E 67 0D 0A                
   8367 00C978 36 35 43 30 32 2F 36 35      	.byte	"65C02/65C816/65C832 Compatible",CR,LF,0
   8367 00C980 43 38 31 36 2F 36 35 43    
   8367 00C988 38 33 32 20 43 6F 6D 70    
   8367 00C990 61 74 69 62 6C 65 0D 0A    
   8367 00C998 00                         
                                           
   8369 00C999                             echo_switch:
   8370 00C999 AD 00 71                     	lda		$7100
   8371 00C99C 8D 00 70                     	sta		$7000
   8372 00C99F 60                           	rts
                                           
                                           ;------------------------------------------------------------------------------
                                           ; On entry to the SSM task the .A register will be set to the task number
                                           ; being single stepped. The .X register will contain the address of the
                                           ; next instruction to execute.
                                           ;------------------------------------------------------------------------------
                                           
   8380 00C9A0                             SSMInit:
                                           	; setup SSM data segment in SDT
   8382 00C9A0 A0 06 00                     	LDY		#6
   8383 00C9A3 A9 01 00                     	LDA		#1
   8384 00C9A6 42 EB                        	XBAW
   8385 00C9A8 A9 00 00                     	LDA		#$0000
   8386 00C9AB A2 82 08                     	LDX		#$882		; 1k data
   8387 00C9AE 42 BA                        	SDU
                                           	; Setup SSM stack segment in SDT
   8389 00C9B0 C8                           	INY
   8390 00C9B1 A9 00 04                     	LDA		#$0400
   8391 00C9B4 A2 82 08                     	LDX		#$882		; 1k stack
   8392 00C9B7 42 BA                        	SDU
                                           	; Setup SSM code segment in SDT
   8394 00C9B9 C8                           	INY
   8395 00C9BA A9 00 00                     	LDA		#$0000
   8396 00C9BD 42 EB                        	XBAW
   8397 00C9BF A9 00 00                     	LDA		#$0000
   8398 00C9C2 A2 05 09                     	LDX		#$905
   8399 00C9C5 42 BA                        	SDU
   8400 00C9C7 42 5C CE C9 00 08 00         	JMF		8:.0001
   8401 00C9CE                             .0001:
                                           	; Initialize data selector and stack selector, pointer
                                           	; The stack is begin switched from the one currently defined by
                                           	; by the task table. So the return task needs to be popped off
                                           	; the current stack and placed on the new one.
   8406 00C9CE FA                           	PLX					; get the task to return to
   8407 00C9CF A9 07 00                     	LDA		#7
   8408 00C9D2 78                           	SEI
   8409 00C9D3 42 5A                        	TASS
   8410 00C9D5 A9 FF 03                     	LDA		#$3FF		; setup stack pointer
   8411 00C9D8 1B                           	TAS
   8412 00C9D9 58                           	CLI
   8413 00C9DA DA                           	PHX					; save return task on new stack
   8414 00C9DB F4 06 00                     	PEA		6
   8415 00C9DE 42 2B                        	PLDS
                                           
   8417 00C9E0 A9 00 61                     	LDA		#$6100
   8418 00C9E3 85 36                        	STA		NormAttr
   8419 00C9E5 A9 FF 0F                     	LDA		#4095		; set segment
   8420 00C9E8 85 44                        	STA		Vidptr+4
   8421 00C9EA 85 4A                        	STA		Vidregs+4
   8422 00C9EC A9 0B 00                     	LDA		#$000B		; screen location is $FB0000
   8423 00C9EF 85 42                        	STA		Vidptr+2
   8424 00C9F1 64 40                        	STZ		Vidptr
   8425 00C9F3 A9 0E 00                     	LDA		#$000E		; regset is at $FEA010
   8426 00C9F6 85 48                        	STA		Vidregs+2
   8427 00C9F8 A9 10 A0                     	LDA		#$A010
   8428 00C9FB 85 46                        	STA		Vidregs
   8429 00C9FD A0 07 00                     	LDY		#7
   8430 00CA00 A9 10 00                     	LDA		#$10		; divide by 2 vertically, 1 horizontally
   8431 00CA03 20 43 CD                     	JSR		SetVideoReg
   8432 00CA06 A9 B4 00                     	LDA		#180		; set window left position 672
   8433 00CA09 A0 02 00                     	LDY		#2
   8434 00CA0C 20 43 CD                     	JSR		SetVideoReg
   8435 00CA0F A9 02 00                     	LDA		#2
   8436 00CA12 A0 03 00                     	LDY		#3
   8437 00CA15 20 43 CD                     	JSR		SetVideoReg
   8438 00CA18 A9 20 00                     	LDA		#32			; set window top position
   8439 00CA1B A0 04 00                     	LDY		#4
   8440 00CA1E 20 43 CD                     	JSR		SetVideoReg
   8441 00CA21 20 28 CD                     	JSR		GetTextRowsCols
   8442 00CA24 A9 F8 CA                     	LDA		#DisplayChar
   8443 00CA27 8D F0 03                     	STA		OutputVec
   8444 00CA2A 20 6D CD                     	JSR		ClearScreen
   8445 00CA2D 20 BD CC                     	JSR		HomeCursor
   8446 00CA30 F4 08 00                     	PEA		8
   8447 00CA33 F4 AE CA                     	PEA		msgSSM
   8448 00CA36 20 F9 CC                     	JSR		DisplayString
   8449 00CA39 42 60                        	RTT
   8450 00CA3B                             SSMTask:
   8451 00CA3B 85 BE                        	STA		WorkTR
   8452 00CA3D 20 1F C6                     	JSR		DispRegs
   8453 00CA40                             .0004:
   8454 00CA40 A9 53 00                     	LDA		#'S'
   8455 00CA43 20 EA CC                     	JSR		OutChar
   8456 00CA46 A9 53 00                     	LDA		#'S'
   8457 00CA49 20 EA CC                     	JSR		OutChar
   8458 00CA4C A9 4D 00                     	LDA		#'M'
   8459 00CA4F 20 EA CC                     	JSR		OutChar
   8460 00CA52 A9 3E 00                     	LDA		#'>'
   8461 00CA55                             .0005:
   8462 00CA55 20 EA CC                     	JSR		OutChar
   8463 00CA58                             .0008:
   8464 00CA58 20 5A D0                     	JSR		KeybdGetCharWait
   8465 00CA5B B0 FB                        	BCS		.0008
   8466 00CA5D 29 FF 00                     	AND		#$FF
   8467 00CA60 C9 53 00                     	CMP		#'S'		; step
   8468 00CA63 D0 04                        	BNE		.0001
   8469 00CA65                             .0002:
   8470 00CA65 42 60                        	RTT
   8471 00CA67 80 D2                        	BRA		SSMTask
   8472 00CA69                             .0001:
   8473 00CA69 C9 58 00                     	CMP		#'X'
   8474 00CA6C D0 16                        	BNE		.0006
   8475 00CA6E A5 A0                        	LDA		reg_sr
   8476 00CA70 29 FF EF                     	AND		#$EFFF
   8477 00CA73 85 A0                        	STA		reg_sr
   8478 00CA75 20 CA C6                     	JSR		BuildRec
   8479 00CA78 A6 BE                        	LDX		WorkTR
   8480 00CA7A 42 6C 00 01 00 00            	LDT		ldtrec
   8481 00CA80 42 60                        	RTT
   8482 00CA82 80 B7                        	BRA		SSMTask
   8483 00CA84                             .0006:
   8484 00CA84 C9 0D 00                     	CMP		#CR
   8485 00CA87 D0 CC                        	BNE		.0005
   8486 00CA89 A5 32                        	LDA		CursorY
   8487 00CA8B 0A                           	ASL
   8488 00CA8C AA                           	TAX
   8489 00CA8D 42 1B BD DC E0               	LDA		CS:LineTbl,X
   8490 00CA92 18                           	CLC
   8491 00CA93 69 04 00                     	ADC		#4
   8492 00CA96 0A                           	ASL
   8493 00CA97 AA                           	TAX
   8494 00CA98 20 F4 C8                     	JSR		IgnoreBlanks
   8495 00CA9B 20 D1 C2                     	JSR		MonGetch
   8496 00CA9E C9 4D 00                     	CMP		#'M'
   8497 00CAA1 D0 03                        	BNE		.0007
   8498 00CAA3 20 37 C7                     	JSR		doMemoryDump
   8499 00CAA6                             .0007:
   8500 00CAA6 82 AC FF                     	BRL		.0005
   8501 00CAA9 42 60                        	RTT
   8502 00CAAB 82 8D FF                     	BRL		SSMTask
                                           
   8504 00CAAE                             msgSSM:
   8505 00CAAE 53 69 6E 67 6C 65 20 73      	.byte	"Single step mode task starting.",CR,LF,0
   8505 00CAB6 74 65 70 20 6D 6F 64 65    
   8505 00CABE 20 74 61 73 6B 20 73 74    
   8505 00CAC6 61 72 74 69 6E 67 2E 0D    
   8505 00CACE 0A 00                      
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Convert Ascii character to screen character.
                                           ;------------------------------------------------------------------------------
                                           
   8511 00CAD0                             AsciiToScreen:
   8512 00CAD0 29 FF 00                     	AND		#$FF
   8513 00CAD3 89 20 00                     	BIT		#%00100000	; if bit 5 isn't set
   8514 00CAD6 F0 08                        	BEQ		.00001
   8515 00CAD8 89 40 00                     	BIT		#%01000000	; or bit 6 isn't set
   8516 00CADB F0 03                        	BEQ		.00001
   8517 00CADD 29 9F 00                     	AND		#%10011111
   8518 00CAE0                             .00001:
   8519 00CAE0 60                           	rts
                                           
                                           	MEM		8
   8522 00CAE1                             AsciiToScreen8:
   8523 00CAE1 89 20                        	BIT		#%00100000	; if bit 5 isn't set
   8524 00CAE3 F0 06                        	BEQ		.00001
   8525 00CAE5 89 40                        	BIT		#%01000000	; or bit 6 isn't set
   8526 00CAE7 F0 02                        	BEQ		.00001
   8527 00CAE9 29 9F                        	AND		#%10011111
   8528 00CAEB                             .00001:
   8529 00CAEB 60                           	rts
                                           
                                           	MEM		16
                                           ;------------------------------------------------------------------------------
                                           ; Convert screen character to ascii character
                                           ;------------------------------------------------------------------------------
                                           ;
   8536 00CAEC                             ScreenToAscii:
   8537 00CAEC 29 FF 00                     	AND		#$FF
   8538 00CAEF C9 1B 00                     	CMP		#26+1
   8539 00CAF2 B0 03                        	BCS		.0001
   8540 00CAF4 69 60 00                     	ADC		#$60
   8541 00CAF7                             .0001:
   8542 00CAF7 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Display a character on the screen device
                                           ; Expects the processor to be in 16 bit mode with 16 bit acc and 16 bit indexes
                                           ;------------------------------------------------------------------------------
                                           ;
   8549 00CAF8                             DisplayChar:
   8550 00CAF8 29 FF 00                     	AND		#$0FF
   8551 00CAFB 24 3C                        	BIT		EscState		; check if processing escape sequence
   8552 00CAFD 30 FF 89 00                  	LBMI	processEsc
   8553 00CB01 C9 08 00                     	CMP		#BS
   8554 00CB04 F0 FF 33 01                  	LBEQ	doBackSpace
   8555 00CB08 C9 91 00                     	CMP		#$91			; cursor right
   8556 00CB0B F0 FF 89 01                  	LBEQ	doCursorRight
   8557 00CB0F C9 93 00                     	CMP		#$93			; cursor left
   8558 00CB12 F0 FF 8D 01                  	LBEQ	doCursorLeft
   8559 00CB16 C9 90 00                     	CMP		#$90			; cursor up
   8560 00CB19 F0 FF 8D 01                  	LBEQ	doCursorUp
   8561 00CB1D C9 92 00                     	CMP		#$92			; cursor down
   8562 00CB20 F0 FF 8D 01                  	LBEQ	doCursorDown
   8563 00CB24 C9 99 00                     	CMP		#$99			; delete
   8564 00CB27 F0 FF 3B 01                  	LBEQ	doDelete
   8565 00CB2B C9 0D 00                     	CMP		#CR
   8566 00CB2E F0 47                        	BEQ		doCR
   8567 00CB30 C9 0A 00                     	CMP		#LF
   8568 00CB33 F0 47                        	BEQ		doLF
   8569 00CB35 C9 94 00                     	CMP		#$94
   8570 00CB38 F0 FF 54 01                  	LBEQ	doCursorHome	; cursor home
   8571 00CB3C C9 1B 00                     	CMP		#ESC
   8572 00CB3F D0 05                        	BNE		.0003
   8573 00CB41 64 3C                        	STZ		EscState		; put a -1 in the escape state
   8574 00CB43 C6 3C                        	DEC		EscState
   8575 00CB45 60                           	RTS
   8576 00CB46                             .0003:
   8577 00CB46 20 D0 CA                     	JSR		AsciiToScreen
   8578 00CB49 05 36                        	ORA		NormAttr
   8579 00CB4B 48                           	PHA
   8580 00CB4C A5 34                        	LDA		VideoPos
   8581 00CB4E 0A                           	ASL
   8582 00CB4F A8                           	TAY
   8583 00CB50 68                           	PLA
   8584 00CB51 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8585 00CB56 A5 30                        	LDA		CursorX
   8586 00CB58 1A                           	INA
   8587 00CB59 C5 4C                        	CMP		Textcols
   8588 00CB5B D0 15                        	BNE		.0001
   8589 00CB5D 64 30                        	STZ		CursorX
   8590 00CB5F A5 32                        	LDA		CursorY
   8591 00CB61 1A                           	INA
   8592 00CB62 C5 4E                        	CMP		Textrows
   8593 00CB64 F0 05                        	BEQ		.0002
   8594 00CB66 85 32                        	STA		CursorY
   8595 00CB68 82 59 01                     	BRL		SyncVideoPos
   8596 00CB6B                             .0002:
   8597 00CB6B 3A                           	DEA
   8598 00CB6C 20 C4 CC                     	JSR		SyncVideoPos
   8599 00CB6F 82 14 02                     	BRL		ScrollUp
   8600 00CB72                             .0001:
   8601 00CB72 85 30                        	STA		CursorX
   8602 00CB74 82 4D 01                     	BRL		SyncVideoPos
   8603 00CB77                             doCR:
   8604 00CB77 64 30                        	STZ		CursorX
   8605 00CB79 82 48 01                     	BRL		SyncVideoPos
   8606 00CB7C                             doLF:
   8607 00CB7C A5 32                        	LDA		CursorY
   8608 00CB7E 1A                           	INA
   8609 00CB7F C5 4E                        	CMP		Textrows
   8610 00CB81 10 FF 01 02                  	LBPL	ScrollUp
   8611 00CB85 85 32                        	STA		CursorY
   8612 00CB87 82 3A 01                     	BRL		SyncVideoPos
                                           
                                           ; Process escape sequences for WYSE terminal emulation
                                           ; Handles:
                                           ; {esc}T		- clear to end of line
                                           ; {esc}W		- delete character
                                           ; {esc}`1		- cursor on
                                           ; {esc}`0		- cursor off
                                           ; {esc}({esc}G4	- reverse video
                                           ; {esc}({esc}G0	- normal video
                                           ;
                                           ; EscState
                                           ; -1 = first esc char
                                           ; -2 = second esc char
                                           ; ...
                                           ;
   8628 00CB8A                             processEsc:
   8629 00CB8A A6 3C                        	LDX		EscState
   8630 00CB8C E0 FF FF                     	CPX		#-1
   8631 00CB8F D0 45                        	BNE		.0006
   8632 00CB91 C9 54 00                     	CMP		#'T'	; clear to EOL
   8633 00CB94 D0 1D                        	BNE		.0003
   8634 00CB96 A5 34                        	LDA		VideoPos
   8635 00CB98 0A                           	ASL
   8636 00CB99 A8                           	TAY
   8637 00CB9A A6 30                        	LDX		CursorX
   8638 00CB9C E8                           	INX
   8639 00CB9D                             .0001:
   8640 00CB9D E4 4C                        	CPX		Textcols
   8641 00CB9F 10 0F                        	BPL		.0002
   8642 00CBA1 A9 20 00                     	LDA		#' '
   8643 00CBA4 05 36                        	ORA		NormAttr
   8644 00CBA6 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8645 00CBAB E8                           	INX
   8646 00CBAC C8                           	INY
   8647 00CBAD C8                           	INY
   8648 00CBAE D0 ED                        	BNE		.0001
   8649 00CBB0                             .0002:
   8650 00CBB0 64 3C                        	STZ		EscState
   8651 00CBB2 60                           	RTS
   8652 00CBB3                             .0003:
   8653 00CBB3 C9 57 00                     	CMP		#'W'
   8654 00CBB6 D0 05                        	BNE		.0004
   8655 00CBB8 64 3C                        	STZ		EscState
   8656 00CBBA 82 A9 00                     	BRL		doDelete
   8657 00CBBD                             .0004:
   8658 00CBBD C9 60 00                     	CMP		#'`'
   8659 00CBC0 D0 06                        	BNE		.0005
   8660 00CBC2 A9 FE FF                     	LDA		#-2
   8661 00CBC5 85 3C                        	STA		EscState
   8662 00CBC7 60                           	RTS
   8663 00CBC8                             .0005:
   8664 00CBC8 C9 28 00                     	CMP		#'('
   8665 00CBCB D0 06                        	BNE		.0008
   8666 00CBCD A9 FD FF                     	LDA		#-3
   8667 00CBD0 85 3C                        	STA		EscState
   8668 00CBD2 60                           	RTS
   8669 00CBD3                             .0008:
   8670 00CBD3 64 3C                        	STZ		EscState
   8671 00CBD5 60                           	RTS
   8672 00CBD6                             .0006:
   8673 00CBD6 E0 FE FF                     	CPX		#-2
   8674 00CBD9 D0 11                        	BNE		.0007
   8675 00CBDB 64 3C                        	STZ		EscState
   8676 00CBDD C9 31 00                     	CMP		#'1'
   8677 00CBE0 F0 FF 69 01                  	LBEQ	CursorOn
   8678 00CBE4 C9 30 00                     	CMP		#'0'
   8679 00CBE7 F0 FF 72 01                  	LBEQ	CursorOff
   8680 00CBEB 60                           	RTS
   8681 00CBEC                             .0007:
   8682 00CBEC E0 FD FF                     	CPX		#-3
   8683 00CBEF D0 0B                        	BNE		.0009
   8684 00CBF1 C9 1B 00                     	CMP		#ESC
   8685 00CBF4 D0 DD                        	BNE		.0008
   8686 00CBF6 A9 FC FF                     	LDA		#-4
   8687 00CBF9 85 3C                        	STA		EscState
   8688 00CBFB 60                           	RTS
   8689 00CBFC                             .0009:
   8690 00CBFC E0 FC FF                     	CPX		#-4
   8691 00CBFF D0 0B                        	BNE		.0010
   8692 00CC01 C9 47 00                     	CMP		#'G'
   8693 00CC04 D0 CD                        	BNE		.0008
   8694 00CC06 A9 FB FF                     	LDA		#-5
   8695 00CC09 85 3C                        	STA		EscState
   8696 00CC0B 60                           	RTS
   8697 00CC0C                             .0010:
   8698 00CC0C E0 FB FF                     	CPX		#-5
   8699 00CC0F D0 C2                        	BNE		.0008
   8700 00CC11 64 3C                        	STZ		EscState
   8701 00CC13 C9 34 00                     	CMP		#'4'
   8702 00CC16 D0 12                        	BNE		.0011
   8703 00CC18 A5 36                        	LDA		NormAttr
                                           	; Swap the high nybbles of the attribute
   8705 00CC1A EB                           	XBA				
   8706 00CC1B E2 30                        	SEP		#$30		; set 8 bit regs
                                           	NDX		8			; tell the assembler
                                           	MEM		8
   8709 00CC1D 2A                           	ROL
   8710 00CC1E 2A                           	ROL
   8711 00CC1F 2A                           	ROL
   8712 00CC20 2A                           	ROL
   8713 00CC21 C2 30                        	REP		#$30		; set 16 bit regs
                                           	NDX		16			; tell the assembler
                                           	MEM		16
   8716 00CC23 EB                           	XBA
   8717 00CC24 29 00 FF                     	AND		#$FF00
   8718 00CC27 85 36                        	STA		NormAttr
   8719 00CC29 60                           	RTS
   8720 00CC2A                             .0011:
   8721 00CC2A C9 30 00                     	CMP		#'0'
   8722 00CC2D D0 06                        	BNE		.0012
   8723 00CC2F A9 00 BF                     	LDA		#$BF00		; Light Grey on Dark Grey
   8724 00CC32 85 36                        	STA		NormAttr
   8725 00CC34 60                           	RTS
   8726 00CC35                             .0012:
   8727 00CC35 A9 00 BF                     	LDA		#$BF00		; Light Grey on Dark Grey
   8728 00CC38 85 36                        	STA		NormAttr
   8729 00CC3A 60                           	RTS
                                           
   8731 00CC3B                             doBackSpace:
   8732 00CC3B A6 30                        	LDX		CursorX
   8733 00CC3D F0 26                        	BEQ		.0001		; Can't backspace anymore
   8734 00CC3F A5 34                        	LDA		VideoPos
   8735 00CC41 0A                           	ASL
   8736 00CC42 A8                           	TAY
   8737 00CC43                             .0002:
   8738 00CC43 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y
   8739 00CC48 88                           	DEY
   8740 00CC49 88                           	DEY
   8741 00CC4A 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8742 00CC4F 42 C8                        	INY4
   8743 00CC51 E8                           	INX
   8744 00CC52 E4 4C                        	CPX		Textcols
   8745 00CC54 D0 ED                        	BNE		.0002
   8746 00CC56                             .0003:
   8747 00CC56 A9 20 00                     	LDA		#' '
   8748 00CC59 05 36                        	ORA		NormAttr
   8749 00CC5B 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8750 00CC60 C6 30                        	DEC		CursorX
   8751 00CC62 82 5F 00                     	BRL		SyncVideoPos
   8752 00CC65                             .0001:
   8753 00CC65 60                           	RTS
                                           
                                           ; Deleting a character does not change the video position so there's no need
                                           ; to resynchronize it.
                                           
   8758 00CC66                             doDelete:
   8759 00CC66 A6 30                        	LDX		CursorX
   8760 00CC68 A5 34                        	LDA		VideoPos
   8761 00CC6A 0A                           	ASL
   8762 00CC6B A8                           	TAY
   8763 00CC6C                             .0002:
   8764 00CC6C E8                           	INX
   8765 00CC6D E4 4C                        	CPX		Textcols
   8766 00CC6F 10 14                        	BPL		.0001
   8767 00CC71 CA                           	DEX
   8768 00CC72 C8                           	INY
   8769 00CC73 C8                           	INY
   8770 00CC74 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y
   8771 00CC79 88                           	DEY
   8772 00CC7A 88                           	DEY
   8773 00CC7B 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8774 00CC80 C8                           	INY
   8775 00CC81 C8                           	INY
   8776 00CC82 E8                           	INX
   8777 00CC83 80 E7                        	BRA		.0002
   8778 00CC85                             .0001:
   8779 00CC85 A9 20 00                     	LDA		#' '
   8780 00CC88 05 36                        	ORA		NormAttr
   8781 00CC8A 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8782 00CC8F 60                           	RTS
                                           
   8784 00CC90                             doCursorHome:
   8785 00CC90 A5 30                        	LDA		CursorX
   8786 00CC92 F0 24                        	BEQ		doCursor1
   8787 00CC94 64 30                        	STZ		CursorX
   8788 00CC96 80 2C                        	BRA		SyncVideoPos
   8789 00CC98                             doCursorRight:
   8790 00CC98 A5 30                        	LDA		CursorX
   8791 00CC9A 1A                           	INA
   8792 00CC9B C5 4C                        	CMP		Textcols
   8793 00CC9D 10 1D                        	BPL		doRTS
   8794 00CC9F                             doCursor2:
   8795 00CC9F 85 30                        	STA		CursorX
   8796 00CCA1 80 21                        	BRA		SyncVideoPos
   8797 00CCA3                             doCursorLeft:
   8798 00CCA3 A5 30                        	LDA		CursorX
   8799 00CCA5 F0 15                        	BEQ		doRTS
   8800 00CCA7 3A                           	DEA
   8801 00CCA8 80 F5                        	BRA		doCursor2
   8802 00CCAA                             doCursorUp:
   8803 00CCAA A5 32                        	LDA		CursorY
   8804 00CCAC F0 0E                        	BEQ		doRTS
   8805 00CCAE 3A                           	DEA
   8806 00CCAF 80 07                        	BRA		doCursor1
   8807 00CCB1                             doCursorDown:
   8808 00CCB1 A5 32                        	LDA		CursorY
   8809 00CCB3 1A                           	INA
   8810 00CCB4 C5 4E                        	CMP		Textrows
   8811 00CCB6 10 04                        	BPL		doRTS
   8812 00CCB8                             doCursor1:
   8813 00CCB8 85 32                        	STA		CursorY
   8814 00CCBA 80 08                        	BRA		SyncVideoPos
   8815 00CCBC                             doRTS:
   8816 00CCBC 60                           	RTS
                                           
   8818 00CCBD                             HomeCursor:
   8819 00CCBD A9 00 00                     	LDA		#0
   8820 00CCC0 64 30                        	STZ		CursorX
   8821 00CCC2 64 32                        	STZ		CursorY
                                           
                                           ; Synchronize the absolute video position with the cursor co-ordinates.
                                           ;
   8825 00CCC4                             SyncVideoPos:
   8826 00CCC4 48                           	PHA
   8827 00CCC5 5A                           	PHY
   8828 00CCC6 A5 32                        	LDA		CursorY
   8829 00CCC8 0A                           	ASL
   8830 00CCC9 AA                           	TAX
   8831 00CCCA 42 3B 05 00 BD DC E0         	LDA		5:LineTbl,X
   8832 00CCD1 18                           	CLC
   8833 00CCD2 65 30                        	ADC		CursorX
   8834 00CCD4 85 34                        	STA		VideoPos
   8835 00CCD6 A0 0D 00                     	LDY		#13
   8836 00CCD9 42 DA 42 97 46               	STA		FAR {Vidregs},Y		; Update the position in the text controller
   8837 00CCDE 7A                           	PLY
   8838 00CCDF 68                           	PLA
   8839 00CCE0 60                           	RTS
                                           
   8841 00CCE1                             OutCRLF:
   8842 00CCE1 A9 0D 00                     	LDA		#CR
   8843 00CCE4 20 EA CC                     	JSR		OutChar
   8844 00CCE7 A9 0A 00                     	LDA		#LF
                                           
   8846 00CCEA                             OutChar:
   8847 00CCEA DA                           	PHX
   8848 00CCEB 5A                           	PHY
   8849 00CCEC 08                           	PHP
   8850 00CCED C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   8853 00CCEF A2 00 00                     	LDX		#0
   8854 00CCF2 FC F0 03                     	JSR		(OutputVec,x)
   8855 00CCF5 28                           	PLP
   8856 00CCF6 7A                           	PLY
   8857 00CCF7 FA                           	PLX
   8858 00CCF8 60                           	RTS
                                           
   8860 00CCF9                             DisplayString:
   8861 00CCF9 08                           	PHP							; push reg settings
   8862 00CCFA E2 20                        	SEP		#$20				; ACC = 8 bit
                                           	MEM		8
   8864 00CCFC A0 00 00                     	LDY		#0
   8865 00CCFF                             .0002:
   8866 00CCFF 42 DA B3 04                  	LDA		FAR (4,S),Y
   8867 00CD03 F0 06                        	BEQ		.0001
   8868 00CD05 20 EA CC                     	JSR		OutChar
   8869 00CD08 C8                           	INY
   8870 00CD09 80 F4                        	BRA		.0002
   8871 00CD0B                             .0001:
   8872 00CD0B 28                           	PLP							; restore regs settings
                                           ;	REP		#$20				; ACC 16 bits
                                           	MEM		16
   8875 00CD0C 42 C0 04                     	RTS		#4					; pop stack argument
                                           
   8877 00CD0F                             DisplayString2:
   8878 00CD0F 68                           	PLA							; pop return address
   8879 00CD10 FA                           	PLX							; get string address parameter
   8880 00CD11 48                           	PHA							; push return address
   8881 00CD12 E2 20                        	SEP		#$20				; ACC = 8 bit
   8882 00CD14 86 38                        	STX		StringPos
   8883 00CD16 A0 00 00                     	LDY		#0
   8884 00CD19 A2 32 00                     	LDX		#50
   8885 00CD1C                             .0002:
   8886 00CD1C B1 38                        	LDA		(StringPos),Y
   8887 00CD1E 20 EA CC                     	JSR		OutChar
   8888 00CD21 C8                           	INY
   8889 00CD22 CA                           	DEX
   8890 00CD23 D0 F7                        	BNE		.0002
   8891 00CD25                             .0001:
   8892 00CD25 C2 20                        	REP		#$20				; ACC 16 bits
   8893 00CD27 60                           	RTS
                                           
   8895 00CD28                             GetTextRowsCols:
   8896 00CD28 48                           	PHA
   8897 00CD29 5A                           	PHY
   8898 00CD2A A0 00 00                     	LDY		#0
   8899 00CD2D 42 DA 42 9B 42 B7 46         	LDA.UB	FAR {Vidregs},Y
   8900 00CD34 85 4C                        	STA		Textcols
   8901 00CD36 C8                           	INY
   8902 00CD37 42 DA 42 9B 42 B7 46         	LDA.UB	FAR {Vidregs},Y
   8903 00CD3E 85 4E                        	STA		Textrows
   8904 00CD40 7A                           	PLY
   8905 00CD41 68                           	PLA
   8906 00CD42 60                           	RTS
                                           
                                           ; .Y = register number to set
                                           ; Acc = value
                                           ;
   8911 00CD43                             SetVideoReg:
   8912 00CD43 08                           	PHP								; save regs size settings
   8913 00CD44 E2 20                        	SEP		#$20
   8914 00CD46 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8915 00CD4B 28                           	PLP								; restore reg size settings
   8916 00CD4C 60                           	RTS
                                           
   8918 00CD4D                             CursorOn:
   8919 00CD4D 48                           	PHA
   8920 00CD4E 5A                           	PHY
   8921 00CD4F A0 09 00                     	LDY		#9
   8922 00CD52 A9 60 1F                     	LDA		#$1F60
   8923 00CD55 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8924 00CD5A 7A                           	PLY
   8925 00CD5B 68                           	PLA
   8926 00CD5C 60                           	RTS
                                           
   8928 00CD5D                             CursorOff:
   8929 00CD5D 48                           	PHA
   8930 00CD5E 5A                           	PHY
   8931 00CD5F A0 09 00                     	LDY		#9
   8932 00CD62 A9 20 00                     	LDA		#$0020
   8933 00CD65 42 DA 42 97 46               	STA		FAR {Vidregs},Y
   8934 00CD6A 7A                           	PLY
   8935 00CD6B 68                           	PLA
   8936 00CD6C 60                           	RTS
                                           
   8938 00CD6D                             ClearScreen:
   8939 00CD6D A2 FF 0F                     	LDX		#4095
   8940 00CD70 A0 00 00                     	LDY		#$00
   8941 00CD73 A9 20 00                     	LDA		#' '
   8942 00CD76 20 D0 CA                     	JSR		AsciiToScreen
   8943 00CD79 05 36                        	ORA		NormAttr
   8944 00CD7B                             .0001:
   8945 00CD7B 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8946 00CD80 C8                           	INY
   8947 00CD81 C8                           	INY
   8948 00CD82 CA                           	DEX
   8949 00CD83 D0 F6                        	BNE		.0001
   8950 00CD85 60                           	RTS
                                           
   8952 00CD86                             ScrollUp:
   8953 00CD86 A0 00 00                     	LDY		#0				; .Y used as index to char
   8954 00CD89 A2 2B 0A                     	LDX 	#2603			; number of chars on screen
   8955 00CD8C                             .0001:
   8956 00CD8C 5A                           	PHY						; save off current .Y
   8957 00CD8D 98                           	TYA								
   8958 00CD8E 18                           	CLC						; Add double the number of text
   8959 00CD8F 65 4C                        	ADC		Textcols		; columns to .Y to find start of next
   8960 00CD91 18                           	CLC						; row 
   8961 00CD92 65 4C                        	ADC		Textcols
   8962 00CD94 A8                           	TAY						
   8963 00CD95 42 DA 42 B7 40               	LDA		FAR {Vidptr},Y	; .A = Load buffer[textcols+Y]
   8964 00CD9A 7A                           	PLY						; .Y = restore current .Y
   8965 00CD9B 42 DA 42 97 40               	STA		FAR {Vidptr},Y	; Store .A in buffer[0+Y]
   8966 00CDA0 C8                           	INY						; advance to next character
   8967 00CDA1 C8                           	INY						; decrement total char count
   8968 00CDA2 CA                           	DEX
   8969 00CDA3 D0 E7                        	BNE		.0001
   8970 00CDA5 A5 4E                        	LDA		Textrows
   8971 00CDA7 3A                           	DEA
                                           
   8973 00CDA8                             BlankLine:
   8974 00CDA8 0A                           	ASL
   8975 00CDA9 A8                           	TAY
   8976 00CDAA 42 1B B9 DC E0               	LDA		CS:LineTbl,Y
   8977 00CDAF 0A                           	ASL
   8978 00CDB0 A8                           	TAY
   8979 00CDB1 A6 4C                        	LDX		Textcols		; number of chars to clear
   8980 00CDB3 A5 36                        	LDA		NormAttr
   8981 00CDB5 09 20 00                     	ORA		#$20			; space
   8982 00CDB8                             .0001:
   8983 00CDB8 42 DA 42 97 40               	STA		FAR {Vidptr},Y
   8984 00CDBD C8                           	INY						; increment to next char
   8985 00CDBE C8                           	INY
   8986 00CDBF CA                           	DEX						; decrement number of chars
   8987 00CDC0 D0 F6                        	BNE		.0001
   8988 00CDC2 60                           	RTS
                                           
   8990 00CDC3                             DispDWord:
   8991 00CDC3 42 EB                        	XBAW
   8992 00CDC5 20 CA CD                     	JSR		DispWord
   8993 00CDC8 42 EB                        	XBAW
   8994 00CDCA                             DispWord:
   8995 00CDCA EB                           	XBA
   8996 00CDCB 20 CF CD                     	JSR		DispByte
   8997 00CDCE EB                           	XBA
   8998 00CDCF                             DispByte:
   8999 00CDCF 48                           	PHA
   9000 00CDD0 4A                           	LSR
   9001 00CDD1 4A                           	LSR
   9002 00CDD2 4A                           	LSR
   9003 00CDD3 4A                           	LSR
   9004 00CDD4 20 D8 CD                     	JSR		DispNybble
   9005 00CDD7 68                           	PLA
   9006 00CDD8                             DispNybble:
   9007 00CDD8 48                           	PHA
   9008 00CDD9 29 0F 00                     	AND		#$0F
   9009 00CDDC C9 0A 00                     	CMP		#10
   9010 00CDDF 90 08                        	BCC		.0001
   9011 00CDE1 69 36 00                     	ADC		#'A'-11			; -11 cause the carry is set
   9012 00CDE4 20 EA CC                     	JSR		OutChar
   9013 00CDE7 68                           	PLA
   9014 00CDE8 60                           	RTS
   9015 00CDE9                             .0001:
   9016 00CDE9 09 30 00                     	ORA		#'0'
   9017 00CDEC 20 EA CC                     	JSR		OutChar
   9018 00CDEF 68                           	PLA
   9019 00CDF0 60                           	RTS
                                           
   9021 00CDF1                             space:
   9022 00CDF1 48                           	PHA
   9023 00CDF2 A9 20 00                     	LDA		#' '
   9024 00CDF5 20 EA CC                     	JSR		OutChar
   9025 00CDF8 68                           	PLA
   9026 00CDF9 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Get a range (two hex numbers)
                                           ;------------------------------------------------------------------------------
                                           
   9032 00CDFA                             GetRange:
   9033 00CDFA 20 F4 C8                     	JSR		IgnoreBlanks
   9034 00CDFD 20 25 CE                     	JSR		GetHexNumber
   9035 00CE00 C0 00 00                     	CPY		#0
   9036 00CE03 F0 1F                        	BEQ		.0001
   9037 00CE05 A5 0C                        	LDA		NumWorkArea
   9038 00CE07 85 20                        	STA		RangeStart
   9039 00CE09 85 24                        	STA		RangeEnd
   9040 00CE0B A5 0E                        	LDA		NumWorkArea+2
   9041 00CE0D 85 22                        	STA		RangeStart+2
   9042 00CE0F 85 26                        	STA		RangeEnd+2
   9043 00CE11 20 F4 C8                     	JSR		IgnoreBlanks
   9044 00CE14 20 25 CE                     	JSR		GetHexNumber
   9045 00CE17 C0 00 00                     	CPY		#0
   9046 00CE1A F0 08                        	BEQ		.0001
   9047 00CE1C A5 0C                        	LDA		NumWorkArea
   9048 00CE1E 85 24                        	STA		RangeEnd
   9049 00CE20 A5 0E                        	LDA		NumWorkArea+2
   9050 00CE22 85 26                        	STA		RangeEnd+2
   9051 00CE24                             .0001:
   9052 00CE24 60                           	RTS
                                           	
                                           ; Get a hexidecimal number. Maximum of six digits.
                                           ; .X = text pointer (updated)
                                           ;------------------------------------------------------------------------------
                                           ;
   9058 00CE25                             GetHexNumber:
   9059 00CE25 A0 00 00                     	LDY		#0					; maximum of eight digits
   9060 00CE28 64 0C                        	STZ		NumWorkArea
   9061 00CE2A 64 0E                        	STZ		NumWorkArea+2
   9062 00CE2C                             gthxn2:
   9063 00CE2C 20 D1 C2                     	JSR		MonGetch
   9064 00CE2F 20 52 CE                     	JSR		AsciiToHexNybble
   9065 00CE32 30 1B                        	BMI		gthxn1
   9066 00CE34 06 0C                        	ASL		NumWorkArea
   9067 00CE36 26 0E                        	ROL		NumWorkArea+2
   9068 00CE38 06 0C                        	ASL		NumWorkArea
   9069 00CE3A 26 0E                        	ROL		NumWorkArea+2
   9070 00CE3C 06 0C                        	ASL		NumWorkArea
   9071 00CE3E 26 0E                        	ROL		NumWorkArea+2
   9072 00CE40 06 0C                        	ASL		NumWorkArea
   9073 00CE42 26 0E                        	ROL		NumWorkArea+2
   9074 00CE44 05 0C                        	ORA		NumWorkArea
   9075 00CE46 85 0C                        	STA		NumWorkArea
   9076 00CE48 C8                           	INY
   9077 00CE49 C0 08 00                     	CPY		#8
   9078 00CE4C D0 DE                        	BNE		gthxn2
   9079 00CE4E 60                           	RTS
   9080 00CE4F                             gthxn1:
   9081 00CE4F CA                           	DEX
   9082 00CE50 CA                           	DEX
   9083 00CE51 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ; Convert ASCII character in the range '0' to '9', 'a' to 'f' or 'A' to 'F'
                                           ; to a hex nybble.
                                           ;------------------------------------------------------------------------------
                                           ;
   9090 00CE52                             AsciiToHexNybble:
   9091 00CE52 C9 30 00                     	CMP		#'0'
   9092 00CE55 90 30                        	BCC		gthx3
   9093 00CE57 C9 3A 00                     	CMP		#'9'+1
   9094 00CE5A B0 05                        	BCS		gthx5
   9095 00CE5C 38                           	SEC
   9096 00CE5D E9 30 00                     	SBC		#'0'
   9097 00CE60 60                           	RTS
   9098 00CE61                             gthx5:
   9099 00CE61 C9 41 00                     	CMP		#'A'
   9100 00CE64 90 21                        	BCC		gthx3
   9101 00CE66 C9 47 00                     	CMP		#'F'+1
   9102 00CE69 B0 09                        	BCS		gthx6
   9103 00CE6B 38                           	SEC
   9104 00CE6C E9 41 00                     	SBC		#'A'
   9105 00CE6F 18                           	CLC
   9106 00CE70 69 0A 00                     	ADC		#10
   9107 00CE73 60                           	RTS
   9108 00CE74                             gthx6:
   9109 00CE74 C9 61 00                     	CMP		#'a'
   9110 00CE77 90 0E                        	BCC		gthx3
   9111 00CE79 C9 7B 00                     	CMP		#'z'+1
   9112 00CE7C B0 09                        	BCS		gthx3
   9113 00CE7E 38                           	SEC
   9114 00CE7F E9 61 00                     	SBC		#'a'
   9115 00CE82 18                           	CLC
   9116 00CE83 69 0A 00                     	ADC		#10
   9117 00CE86 60                           	RTS
   9118 00CE87                             gthx3:
   9119 00CE87 A9 FF FF                     	LDA		#-1		; not a hex number
   9120 00CE8A 60                           	RTS
                                           
   9122 00CE8B                             AsciiToDecNybble:
   9123 00CE8B C9 30 00                     	CMP		#'0'
   9124 00CE8E 90 0A                        	BCC		gtdc3
   9125 00CE90 C9 3A 00                     	CMP		#'9'+1
   9126 00CE93 B0 05                        	BCS		gtdc3
   9127 00CE95 38                           	SEC
   9128 00CE96 E9 30 00                     	SBC		#'0'
   9129 00CE99 60                           	RTS
   9130 00CE9A                             gtdc3:
   9131 00CE9A A9 FF FF                     	LDA		#-1
   9132 00CE9D 60                           	RTS
                                           
   9134 00CE9E                             getcharNoWait:
   9135 00CE9E A9 01 00                     	LDA		#1
   9136 00CEA1 42 5B 85 BC                  	STA		ZS:keybd_cmd
   9137 00CEA5 42 A2 06 00                  	TSK		#6
   9138 00CEA9 42 5B A5 BA                  	LDA		ZS:keybd_char
   9139 00CEAD 10 02                        	BPL		.0001
   9140 00CEAF 38                           	SEC
   9141 00CEB0 60                           	RTS
   9142 00CEB1                             .0001:
   9143 00CEB1 18                           	CLC
   9144 00CEB2 60                           	RTS
                                           
   9146 00CEB3                             getcharWait:
   9147 00CEB3 A9 02 00                     	LDA		#2
   9148 00CEB6 42 5B 85 BC                  	STA		ZS:keybd_cmd
   9149 00CEBA 42 A2 06 00                  	TSK		#6
   9150 00CEBE 42 5B A5 BA                  	LDA		ZS:keybd_char
   9151 00CEC2 10 02                        	BPL		.0001
   9152 00CEC4 38                           	SEC
   9153 00CEC5 60                           	RTS
   9154 00CEC6                             .0001:
   9155 00CEC6 18                           	CLC
   9156 00CEC7 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; Keyboard processing routines follow.
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
   9163 00CEC8                             ResetKbd:
   9164 00CEC8 E2 30                        	SEP		#$30
                                           	MEM		8
                                           	NDX		8
   9167 00CECA 64 08                        	STZ		KeyState1
   9168 00CECC 64 09                        	STZ		KeyState2
   9169 00CECE A9 FF                        	LDA		#$FF
   9170 00CED0 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9171 00CED8 20 EB CF                     	JSR		KeybdWaitTx
   9172 00CEDB C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9175 00CEDD 60                           	RTS
   9176 00CEDE                             KeybdInit:
   9177 00CEDE A9 00 20                     	LDA		#$2000
   9178 00CEE1 1B                           	TAS
   9179 00CEE2 A9 05 00                     	LDA		#5
   9180 00CEE5 85 BC                        	STA		keybd_cmd
   9181 00CEE7 E2 30                        	SEP		#$30
                                           	MEM		8
                                           	NDX		8
   9184 00CEE9 64 08                        	STZ		KeyState1
   9185 00CEEB 64 09                        	STZ		KeyState2
   9186 00CEED A0 0C                        	LDY		#12
   9187 00CEEF 42 60                        	RTT
   9188 00CEF1                             .resetAgain:
   9189 00CEF1 A9 FF                        	LDA		#$FF			; send reset code to keyboard
   9190 00CEF3 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9191 00CEFB 20 EB CF                     	JSR		KeybdWaitTx
   9192 00CEFE                             .0001:
   9193 00CEFE 20 C6 CF                     	JSR		KeybdRecvByte	; Look for $AA
   9194 00CF01 90 5A                        	BCC		.tryAgain
   9195 00CF03 C9 AA                        	CMP		#$AA			;
   9196 00CF05 F0 37                        	BEQ		.config
   9197 00CF07                             .0002:
                                           	; wait until keyboard not busy
   9199 00CF07 20 09 D0                     	JSR		Wait10ms
   9200 00CF0A 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1		;
                                         
   9201 00CF12 89 40                        	BIT		#$40
   9202 00CF14 D0 47                        	BNE		.tryAgain
   9203 00CF16 A9 FF                        	LDA		#$FF			; send reset code to keyboard
   9204 00CF18 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9205 00CF20 20 09 D0                     	JSR		Wait10ms
   9206 00CF23 20 EB CF                     	JSR		KeybdWaitTx		; wait until no longer busy
   9207 00CF26 20 C6 CF                     	JSR		KeybdRecvByte	; look for an ACK ($FA)
   9208 00CF29 90 32                        	BCC		.tryAgain
   9209 00CF2B C9 FE                        	CMP		#$FE
   9210 00CF2D F0 2E                        	BEQ		.tryAgain
   9211 00CF2F C9 FA                        	CMP		#$FA
   9212 00CF31 D0 2A                        	BNE		.tryAgain
   9213 00CF33 20 C6 CF                     	JSR		KeybdRecvByte
   9214 00CF36 C9 FC                        	CMP		#$FC			; reset error ?
   9215 00CF38 F0 23                        	BEQ		.tryAgain
   9216 00CF3A C9 AA                        	CMP		#$AA			; reset complete okay ?
   9217 00CF3C D0 1F                        	BNE		.tryAgain
   9218 00CF3E                             .config:
   9219 00CF3E 20 EB CF                     	JSR		KeybdWaitBusy
   9220 00CF41 A9 F0                        	LDA		#$F0			; send scan code select
   9221 00CF43 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9222 00CF4B 20 EB CF                     	JSR		KeybdWaitTx
   9223 00CF4E 90 0D                        	BCC		.tryAgain
   9224 00CF50 20 C6 CF                     	JSR		KeybdRecvByte	; wait for response from keyboard
   9225 00CF53 90 08                        	BCC		.tryAgain
   9226 00CF55 C9 FE                        	CMP		#$FE
   9227 00CF57 F0 04                        	BEQ		.tryAgain
   9228 00CF59 C9 FA                        	CMP		#$FA
   9229 00CF5B F0 16                        	BEQ		.0004
   9230 00CF5D                             .tryAgain:
   9231 00CF5D 88                           	DEY
   9232 00CF5E D0 9E                        	BNE		.0001
   9233 00CF60 C6 BC                        	DEC		keybd_cmd
   9234 00CF62 D0 8D                        	BNE		.resetAgain
   9235 00CF64                             .keybdErr:
   9236 00CF64 C2 30                        	REP		#$30
   9237 00CF66 F4 01 00                     	PEA		1
   9238 00CF69 F4 21 D0                     	PEA		msgKeybdNR
   9239 00CF6C 20 F9 CC                     	JSR		DisplayString
   9240 00CF6F 42 60                        	RTT
   9241 00CF71 80 1A                        	BRA		KeybdService
   9242 00CF73                             .0004:
   9243 00CF73 A9 02                        	LDA		#2				; select scan code set #2
   9244 00CF75 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9245 00CF7D 20 EB CF                     	JSR		KeybdWaitTx
   9246 00CF80 90 DB                        	BCC		.tryAgain
   9247 00CF82 20 C6 CF                     	JSR		KeybdRecvByte
   9248 00CF85 90 D6                        	BCC		.tryAgain
   9249 00CF87 C2 30                        	REP		#$30
   9250 00CF89 42 60                        	RTT
   9251 00CF8B 80 00                        	BRA		KeybdService
                                           
   9253 00CF8D                             KeybdService:
   9254 00CF8D C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9257 00CF8F A9 00 20                     	LDA		#$2000
   9258 00CF92 1B                           	TAS
   9259 00CF93 A5 BC                        	LDA		keybd_cmd
   9260 00CF95 C9 01 00                     	CMP		#1
   9261 00CF98 D0 18                        	BNE		.0001
   9262 00CF9A 20 44 D0                     	JSR		KeybdGetCharNoWait
   9263 00CF9D B0 08                        	BCS		.nokey
   9264 00CF9F 64 BC                        	STZ		keybd_cmd
   9265 00CFA1 85 BA                        	STA		keybd_char
   9266 00CFA3 42 60                        	RTT
   9267 00CFA5 80 E6                        	BRA		KeybdService
   9268 00CFA7                             .nokey
   9269 00CFA7 A9 FF FF                     	LDA		#-1
   9270 00CFAA 64 BC                        	STZ		keybd_cmd
   9271 00CFAC 85 BA                        	STA		keybd_char
   9272 00CFAE 42 60                        	RTT
   9273 00CFB0 80 DB                        	BRA		KeybdService
   9274 00CFB2                             .0001:
   9275 00CFB2 C9 02 00                     	CMP		#2
   9276 00CFB5 D0 0B                        	BNE		.0002
   9277 00CFB7 20 5A D0                     	JSR		KeybdGetCharWait
   9278 00CFBA 64 BC                        	STZ		keybd_cmd
   9279 00CFBC 85 BA                        	STA		keybd_char
   9280 00CFBE 42 60                        	RTT
   9281 00CFC0 80 CB                        	BRA		KeybdService
   9282 00CFC2                             .0002:
   9283 00CFC2 42 60                        	RTT
   9284 00CFC4 80 C7                        	BRA		KeybdService
                                           
                                           	MEM		8
                                           	NDX		8
                                           
                                           ; Receive a byte from the keyboard, used after a command is sent to the
                                           ; keyboard in order to wait for a response.
                                           ;
   9292 00CFC6                             KeybdRecvByte:
   9293 00CFC6 5A                           	PHY
   9294 00CFC7 A0 14                        	LDY		#20				; wait up to .2s
   9295 00CFC9                             .0003:
   9296 00CFC9 20 EB CF                     	JSR		KeybdWaitBusy
   9297 00CFCC 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1	; wait for response from keyboard
                                         
   9298 00CFD4 0A                           	ASL						; is input buffer full ?
   9299 00CFD5 B0 09                        	BCS		.0004			; yes, branch
   9300 00CFD7 20 09 D0                     	JSR		Wait10ms		; wait a bit
   9301 00CFDA 88                           	DEY
   9302 00CFDB D0 EC                        	BNE		.0003			; go back and try again
   9303 00CFDD 7A                           	PLY						; timeout
   9304 00CFDE 18                           	CLC						; carry clear = no code
   9305 00CFDF 60                           	RTS
   9306 00CFE0                             .0004:
   9307 00CFE0 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD		; clear recieve state
                                         
   9308 00CFE8 7A                           	PLY
   9309 00CFE9 38                           	SEC						; carry set = code available
   9310 00CFEA 60                           	RTS
                                           
                                           ; Wait until the keyboard isn't busy anymore
                                           ; Wait until the keyboard transmit is complete
                                           ; Returns .CF = 1 if successful, .CF=0 timeout
                                           ;
   9316 00CFEB                             KeybdWaitBusy:				; alias for KeybdWaitTx
   9317 00CFEB                             KeybdWaitTx:
   9318 00CFEB 48                           	PHA
   9319 00CFEC 5A                           	PHY
   9320 00CFED A0 0A                        	LDY		#10				; wait a max of .1s
   9321 00CFEF                             .0001:
   9322 00CFEF 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1
                                         
   9323 00CFF7 89 40                        	BIT		#$40			; check for transmit busy bit
   9324 00CFF9 F0 0A                        	BEQ		.0002			; branch if bit clear
   9325 00CFFB 20 09 D0                     	JSR		Wait10ms		; delay a little bit
   9326 00CFFE 88                           	DEY						; go back and try again
   9327 00CFFF D0 EE                        	BNE		.0001
   9328 00D001 7A                           	PLY						; timed out
   9329 00D002 68                           	PLA
   9330 00D003 18                           	CLC						; return carry clear
   9331 00D004 60                           	RTS
   9332 00D005                             .0002:
   9333 00D005 7A                           	PLY						; wait complete, return 
   9334 00D006 68                           	PLA
   9335 00D007 38                           	SEC						; carry set
   9336 00D008 60                           	RTS
                                           
                                           ; Wait approximately 10ms. Used by keyboard routines. Makes use of the free
                                           ; running counter #0.
                                           ; .A = trashed (=-5)
                                           ;
   9342 00D009                             Wait10ms:
   9343 00D009 48                           	PHA
   9344 00D00A DA                           	PHX				; save .X
   9345 00D00B 42 5B A5 12                  	LDA		ZS:CNT0H	; get starting count
   9346 00D00F AA                           	TAX				; save it off in .X
   9347 00D010                             .0002:
   9348 00D010 38                           	SEC				; compare to current counter value
   9349 00D011 42 5B E5 12                  	SBC		ZS:CNT0H
   9350 00D015 49 FF                        	EOR		#$FF	; make negative
   9351 00D017 C9 0A                        	CMP		#10
   9352 00D019 10 03                        	BPL     .0001
   9353 00D01B 8A                           	TXA				; prepare for next check, get startcount in .A
   9354 00D01C 80 F2                        	BRA		.0002	; go back if less than 5 ticks
   9355 00D01E                             .0001:
   9356 00D01E FA                           	PLX				; restore .X
   9357 00D01F 68                           	PLA
   9358 00D020 60                           	RTS
                                           
                                           	MEM		16
                                           	NDX		16
                                           
   9363 00D021                             msgKeybdNR:
   9364 00D021 0D 0A 4B 65 79 62 6F 61      	.byte	CR,LF,"Keyboard not responding.",CR,LF,0
   9364 00D029 72 64 20 6E 6F 74 20 72    
   9364 00D031 65 73 70 6F 6E 64 69 6E    
   9364 00D039 67 2E 0D 0A 00             
                                           
                                           	cpu		FT832
                                           
   9368 00D03E                             KeybdGetCharNoWaitCtx:
   9369 00D03E 20 44 D0                     	JSR		KeybdGetCharNoWait
   9370 00D041 42 40 00                     	RTC		#0
   9371 00D044                             	
   9372 00D044 08                           	PHP
   9373 00D045 78                           	SEI
   9374 00D046 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
   9377 00D048 42 1A                        	TTA
   9378 00D04A C5 CE                        	CMP		IOFocusTask
                                           ;	BNE		.noFocus
   9380 00D04C E2 20                        	SEP		#$20
   9381 00D04E C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
                                           ;	STZ		TaskSwitchEn
   9385 00D050 58                           	CLI
   9386 00D051 A9 00                        	LDA		#0
   9387 00D053 85 0B                        	STA		KeybdWaitFlag
   9388 00D055 80 13                        	BRA		KeybdGetChar1
   9389 00D057                             .noFocus:
   9390 00D057 28                           	PLP
   9391 00D058 38                           	SEC		; flag no key available
   9392 00D059 60                           	RTS
                                           
   9394 00D05A                             KeybdGetCharWait:
   9395 00D05A 08                           	PHP
   9396 00D05B E2 20                        	SEP		#$20
   9397 00D05D C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9400 00D05F A9 FF                        	LDA		#$FF
   9401 00D061 85 0B                        	STA		KeybdWaitFlag
   9402 00D063 80 05                        	BRA		KeybdGetChar1
                                           
                                           ; Wait for a keyboard character to be available
                                           ; Returns (CF=1) if no key available
                                           ; Return key (CF=0) if key is available
                                           ;
                                           ;
   9409 00D065                             KeybdGetChar:
   9410 00D065 08                           	PHP
   9411 00D066 E2 20                        	SEP		#$20		; 8 bit acc
   9412 00D068 C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9415 00D06A                             KeybdGetChar1:
   9416 00D06A DA                           	PHX
   9417 00D06B EB                           	XBA					; force .B to zero for TAX
   9418 00D06C A9 00                        	LDA		#0
   9419 00D06E EB                           	XBA
   9420 00D06F                             .0002:
   9421 00D06F                             .0003:
   9422 00D06F 42 3B FF 0F AF 11 A1 0E      	LDA		$FFF:KEYBD+1		; check MSB of keyboard status reg.
                                         
   9423 00D077 2A                           	ROL
   9424 00D078 2A                           	ROL
   9425 00D079 B0 F4                        	BCS		.0003		; check busy flag, branch if busy
   9426 00D07B 6A                           	ROR
   9427 00D07C B0 08                        	BCS		.0006		; branch if keystroke ready
   9428 00D07E 24 0B                        	BIT		KeybdWaitFlag
   9429 00D080 30 ED                        	BMI		.0003
   9430 00D082 FA                           	PLX
   9431 00D083 28                           	PLP
   9432 00D084 38                           	SEC
   9433 00D085 60                           	RTS
   9434 00D086                             .0006:
   9435 00D086 42 3B FF 0F AF 10 A1 0E      	LDA		$FFF:KEYBD	; get scan code value
                                         
   9436 00D08E 42 3B FF 0F 42 9C 12 A1      	STZ		$FFF:KEYBD+2	; clear read flag
   9436 00D096 0E 00                      
                                           	;REP		#$20
                                           	;JSR		DispByte
                                           	;JSR		space
                                           	;SEP		#$20
   9441 00D098                             .0001:
   9442 00D098 C9 F0                        	CMP		#SC_KEYUP	; keyup scan code ?
   9443 00D09A F0 FF 6F 00                  	LBEQ	.doKeyup	; 
   9444 00D09E C9 E0                        	CMP		#SC_EXTEND	; extended scan code ?
   9445 00D0A0 F0 FF 70 00                  	LBEQ	.doExtend
   9446 00D0A4 C9 14                        	CMP		#$14		; control ?
   9447 00D0A6 F0 FF 73 00                  	LBEQ	.doCtrl
   9448 00D0AA C9 12                        	CMP		#$12		; left shift
   9449 00D0AC F0 FF 7D 00                  	LBEQ	.doShift
   9450 00D0B0 C9 59                        	CMP		#$59		; right shift
   9451 00D0B2 F0 FF 77 00                  	LBEQ	.doShift
   9452 00D0B6 C9 77                        	CMP		#SC_NUMLOCK
   9453 00D0B8 F0 FF 81 00                  	LBEQ	.doNumLock
   9454 00D0BC C9 58                        	CMP		#SC_CAPSLOCK
   9455 00D0BE F0 FF 8B 00                  	LBEQ	.doCapsLock
   9456 00D0C2 C9 7E                        	CMP		#SC_SCROLLLOCK
   9457 00D0C4 F0 FF 95 00                  	LBEQ	.doScrollLock
   9458 00D0C8 46 08                        	LSR		KeyState1
   9459 00D0CA B0 A3                        	BCS		.0003
   9460 00D0CC AA                           	TAX
   9461 00D0CD A9 80                        	LDA		#$80
   9462 00D0CF 24 09                        	BIT		KeyState2	; Is extended code ?
   9463 00D0D1 F0 13                        	BEQ		.0010
   9464 00D0D3 A9 7F                        	LDA		#$7F
   9465 00D0D5 25 09                        	AND		KeyState2
   9466 00D0D7 85 09                        	STA		KeyState2
   9467 00D0D9 46 08                        	LSR		KeyState1	; clear keyup
   9468 00D0DB 8A                           	TXA
   9469 00D0DC 29 7F                        	AND		#$7F
   9470 00D0DE AA                           	TAX
   9471 00D0DF 42 1B BD 3A D4               	LDA		cs:keybdExtendedCodes,X
   9472 00D0E4 80 23                        	BRA		.0008
   9473 00D0E6                             .0010:
   9474 00D0E6 A9 04                        	LDA		#4
   9475 00D0E8 24 09                        	BIT		KeyState2	; Is Cntrl down ?
   9476 00D0EA F0 0B                        	BEQ		.0009
   9477 00D0EC 8A                           	TXA
   9478 00D0ED 29 7F                        	AND		#$7F		; table is 128 chars
   9479 00D0EF AA                           	TAX
   9480 00D0F0 42 1B BD BA D3               	LDA		cs:keybdControlCodes,X
   9481 00D0F5 80 12                        	BRA		.0008
   9482 00D0F7                             .0009:
   9483 00D0F7 A9 01                        	LDA		#$1			; Is shift down ?
   9484 00D0F9 24 09                        	BIT		KeyState2
   9485 00D0FB F0 07                        	BEQ		.0007
   9486 00D0FD 42 1B BD BA D2               	LDA		cs:shiftedScanCodes,X
   9487 00D102 80 05                        	BRA		.0008
   9488 00D104                             .0007:
   9489 00D104 42 1B BD BA D1               	LDA		cs:unshiftedScanCodes,X
   9490 00D109                             .0008:
   9491 00D109 FA                           	PLX
   9492 00D10A 28                           	PLP
   9493 00D10B 18                           	CLC
   9494 00D10C 60                           	RTS
                                           	MEM		8
   9496 00D10D                             .doKeyup:
   9497 00D10D A9 01                        	LDA		#1
   9498 00D10F 04 08                        	TSB		KeyState1
   9499 00D111 82 5B FF                     	BRL		.0003
   9500 00D114                             .doExtend:				; set extended key flag
   9501 00D114 A5 09                        	LDA		KeyState2
   9502 00D116 09 80                        	ORA		#$80
   9503 00D118 85 09                        	STA		KeyState2
   9504 00D11A 82 52 FF                     	BRL		.0003
   9505 00D11D                             .doCtrl:
   9506 00D11D A9 04                        	LDA		#4
   9507 00D11F 46 08                        	LSR		KeyState1	; check key up/down	
   9508 00D121 90 05                        	BCC		.0004		; keydown = carry clear
   9509 00D123 14 09                        	TRB		KeyState2
   9510 00D125 82 47 FF                     	BRL		.0003
   9511 00D128                             .0004:
   9512 00D128 04 09                        	TSB		KeyState2	; set control active bit
   9513 00D12A 82 42 FF                     	BRL		.0003
   9514 00D12D                             .doShift:
   9515 00D12D A9 01                        	LDA		#1
   9516 00D12F 46 08                        	LSR		KeyState1	; check key up/down	
   9517 00D131 90 05                        	BCC		.0005
   9518 00D133 14 09                        	TRB		KeyState2
   9519 00D135 82 37 FF                     	BRL		.0003
   9520 00D138                             .0005:
   9521 00D138 04 09                        	TSB		KeyState2
   9522 00D13A 82 32 FF                     	BRL		.0003
   9523 00D13D                             .doNumLock:
   9524 00D13D A5 09                        	LDA		KeyState2
   9525 00D13F 49 10                        	EOR		#16
   9526 00D141 85 09                        	STA		KeyState2
   9527 00D143 E2 30                        	SEP		#$30
   9528 00D145 20 6D D1                     	JSR		KeybdSetLEDStatus
   9529 00D148 C2 20                        	REP		#$20
   9530 00D14A 82 22 FF                     	BRL		.0003
   9531 00D14D                             .doCapsLock:
   9532 00D14D A5 09                        	LDA		KeyState2
   9533 00D14F 49 20                        	EOR		#32
   9534 00D151 85 09                        	STA		KeyState2
   9535 00D153 E2 30                        	SEP		#$30
   9536 00D155 20 6D D1                     	JSR		KeybdSetLEDStatus
   9537 00D158 C2 20                        	REP		#$20
   9538 00D15A 82 12 FF                     	BRL		.0003
   9539 00D15D                             .doScrollLock:
   9540 00D15D A5 09                        	LDA		KeyState2
   9541 00D15F 49 40                        	EOR		#64
   9542 00D161 85 09                        	STA		KeyState2
   9543 00D163 E2 30                        	SEP		#$30
   9544 00D165 20 6D D1                     	JSR		KeybdSetLEDStatus
   9545 00D168 C2 20                        	REP		#$20
   9546 00D16A 82 02 FF                     	BRL		.0003
                                           
   9548 00D16D                             KeybdSetLEDStatus:
                                           ;	PHDS				; save off DS
                                           ;	PEA		5			; set DS to zero
                                           ;	PLDS
   9552 00D16D A9 00                        	LDA		#0
   9553 00D16F 85 0A                        	STA		KeybdLEDs
   9554 00D171 A9 10                        	LDA		#16
   9555 00D173 24 09                        	BIT		KeyState2
   9556 00D175 F0 06                        	BEQ		.0002
   9557 00D177 A5 0A                        	LDA		KeybdLEDs	; set bit 1 for Num lock, 0 for scrolllock , 2 for caps lock
   9558 00D179 09 02                        	ORA		#$2
   9559 00D17B 85 0A                        	STA		KeybdLEDs
   9560 00D17D                             .0002:
   9561 00D17D A9 20                        	LDA		#32
   9562 00D17F 24 09                        	BIT		KeyState2
   9563 00D181 F0 06                        	BEQ		.0003
   9564 00D183 A5 0A                        	LDA		KeybdLEDs
   9565 00D185 09 04                        	ORA		#$4
   9566 00D187 85 0A                        	STA		KeybdLEDs
   9567 00D189                             .0003:
   9568 00D189 A9 40                        	LDA		#64
   9569 00D18B 24 09                        	BIT		KeyState2
   9570 00D18D F0 06                        	BEQ		.0004
   9571 00D18F A5 0A                        	LDA		KeybdLEDs
   9572 00D191 09 01                        	ORA		#1
   9573 00D193 85 0A                        	STA		KeybdLEDs
   9574 00D195                             .0004:
   9575 00D195 A9 ED                        	LDA		#$ED		; set status LEDs command
   9576 00D197 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9577 00D19F 20 EB CF                     	JSR		KeybdWaitTx
   9578 00D1A2 20 C6 CF                     	JSR		KeybdRecvByte
   9579 00D1A5 90 12                        	BCC		.0001
   9580 00D1A7 C9 FA                        	CMP		#$FA
   9581 00D1A9 A5 0A                        	LDA		KeybdLEDs
   9582 00D1AB 42 3B FF 0F 8F 10 A1 0E      	STA		$FFF:KEYBD
                                         
   9583 00D1B3 20 EB CF                     	JSR		KeybdWaitTx
   9584 00D1B6 20 C6 CF                     	JSR		KeybdRecvByte	; wait for $FA byte
   9585 00D1B9                             .0001:
                                           ;	PLDS				; recover DS
   9587 00D1B9 60                           	RTS
                                           
                                           
                                           	;--------------------------------------------------------------------------
                                           	; PS2 scan codes to ascii conversion tables.
                                           	;--------------------------------------------------------------------------
                                           	;
   9594 00D1BA                             unshiftedScanCodes:
   9595 00D1BA 2E A9 2E A5 A3 A1 A2 AC      	.byte	$2e,$a9,$2e,$a5,$a3,$a1,$a2,$ac
                                         
   9596 00D1C2 2E AA A8 A6 A4 09 60 2E      	.byte	$2e,$aa,$a8,$a6,$a4,$09,$60,$2e
                                         
   9597 00D1CA 2E 2E 2E 2E 2E 71 31 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$71,$31,$2e
                                         
   9598 00D1D2 2E 2E 7A 73 61 77 32 2E      	.byte	$2e,$2e,$7a,$73,$61,$77,$32,$2e
                                         
   9599 00D1DA 2E 63 78 64 65 34 33 2E      	.byte	$2e,$63,$78,$64,$65,$34,$33,$2e
                                         
   9600 00D1E2 2E 20 76 66 74 72 35 2E      	.byte	$2e,$20,$76,$66,$74,$72,$35,$2e
                                         
   9601 00D1EA 2E 6E 62 68 67 79 36 2E      	.byte	$2e,$6e,$62,$68,$67,$79,$36,$2e
                                         
   9602 00D1F2 2E 2E 6D 6A 75 37 38 2E      	.byte	$2e,$2e,$6d,$6a,$75,$37,$38,$2e
                                         
   9603 00D1FA 2E 2C 6B 69 6F 30 39 2E      	.byte	$2e,$2c,$6b,$69,$6f,$30,$39,$2e
                                         
   9604 00D202 2E 2E 2F 6C 3B 70 2D 2E      	.byte	$2e,$2e,$2f,$6c,$3b,$70,$2d,$2e
                                         
   9605 00D20A 2E 2E 27 2E 5B 3D 2E 2E      	.byte	$2e,$2e,$27,$2e,$5b,$3d,$2e,$2e
                                         
   9606 00D212 AD 2E 0D 5D 2E 5C 2E 2E      	.byte	$ad,$2e,$0d,$5d,$2e,$5c,$2e,$2e
                                         
   9607 00D21A 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9608 00D222 2E 95 2E 93 94 2E 2E 2E      	.byte	$2e,$95,$2e,$93,$94,$2e,$2e,$2e
                                         
   9609 00D22A 98 7F 92 2E 91 90 1B AF      	.byte	$98,$7f,$92,$2e,$91,$90,$1b,$af
                                         
   9610 00D232 AB 2E 97 2E 2E 96 AE 2E      	.byte	$ab,$2e,$97,$2e,$2e,$96,$ae,$2e
                                         
                                           
   9612 00D23A 2E 2E 2E A7 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$a7,$2e,$2e,$2e,$2e
                                         
   9613 00D242 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9614 00D24A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9615 00D252 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9616 00D25A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9617 00D262 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9618 00D26A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9619 00D272 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9620 00D27A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9621 00D282 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9622 00D28A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9623 00D292 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9624 00D29A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9625 00D2A2 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9626 00D2AA 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9627 00D2B2 2E 2E FA 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$fa,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9629 00D2BA                             shiftedScanCodes:
   9630 00D2BA 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9631 00D2C2 2E 2E 2E 2E 2E 09 7E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$09,$7e,$2e
                                         
   9632 00D2CA 2E 2E 2E 2E 2E 51 21 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$51,$21,$2e
                                         
   9633 00D2D2 2E 2E 5A 53 41 57 40 2E      	.byte	$2e,$2e,$5a,$53,$41,$57,$40,$2e
                                         
   9634 00D2DA 2E 43 58 44 45 24 23 2E      	.byte	$2e,$43,$58,$44,$45,$24,$23,$2e
                                         
   9635 00D2E2 2E 20 56 46 54 52 25 2E      	.byte	$2e,$20,$56,$46,$54,$52,$25,$2e
                                         
   9636 00D2EA 2E 4E 42 48 47 59 5E 2E      	.byte	$2e,$4e,$42,$48,$47,$59,$5e,$2e
                                         
   9637 00D2F2 2E 2E 4D 4A 55 26 2A 2E      	.byte	$2e,$2e,$4d,$4a,$55,$26,$2a,$2e
                                         
   9638 00D2FA 2E 3C 4B 49 4F 29 28 2E      	.byte	$2e,$3c,$4b,$49,$4f,$29,$28,$2e
                                         
   9639 00D302 2E 3E 3F 4C 3A 50 5F 2E      	.byte	$2e,$3e,$3f,$4c,$3a,$50,$5f,$2e
                                         
   9640 00D30A 2E 2E 22 2E 7B 2B 2E 2E      	.byte	$2e,$2e,$22,$2e,$7b,$2b,$2e,$2e
                                         
   9641 00D312 2E 2E 0D 7D 2E 7C 2E 2E      	.byte	$2e,$2e,$0d,$7d,$2e,$7c,$2e,$2e
                                         
   9642 00D31A 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9643 00D322 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9644 00D32A 2E 7F 2E 2E 2E 2E 1B 2E      	.byte	$2e,$7f,$2e,$2e,$2e,$2e,$1b,$2e
                                         
   9645 00D332 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9647 00D33A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9648 00D342 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9649 00D34A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9650 00D352 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9651 00D35A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9652 00D362 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9653 00D36A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9654 00D372 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9655 00D37A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9656 00D382 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9657 00D38A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9658 00D392 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9659 00D39A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9660 00D3A2 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9661 00D3AA 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9662 00D3B2 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
                                           ; control
   9665 00D3BA                             keybdControlCodes:
   9666 00D3BA 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9667 00D3C2 2E 2E 2E 2E 2E 09 7E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$09,$7e,$2e
                                         
   9668 00D3CA 2E 2E 2E 2E 2E 11 21 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$11,$21,$2e
                                         
   9669 00D3D2 2E 2E 1A 13 01 17 40 2E      	.byte	$2e,$2e,$1a,$13,$01,$17,$40,$2e
                                         
   9670 00D3DA 2E 03 18 04 05 24 23 2E      	.byte	$2e,$03,$18,$04,$05,$24,$23,$2e
                                         
   9671 00D3E2 2E 20 16 06 14 12 25 2E      	.byte	$2e,$20,$16,$06,$14,$12,$25,$2e
                                         
   9672 00D3EA 2E 0E 02 08 07 19 5E 2E      	.byte	$2e,$0e,$02,$08,$07,$19,$5e,$2e
                                         
   9673 00D3F2 2E 2E 0D 0A 15 26 2A 2E      	.byte	$2e,$2e,$0d,$0a,$15,$26,$2a,$2e
                                         
   9674 00D3FA 2E 3C 0B 09 0F 29 28 2E      	.byte	$2e,$3c,$0b,$09,$0f,$29,$28,$2e
                                         
   9675 00D402 2E 3E 3F 0C 3A 10 5F 2E      	.byte	$2e,$3e,$3f,$0c,$3a,$10,$5f,$2e
                                         
   9676 00D40A 2E 2E 22 2E 7B 2B 2E 2E      	.byte	$2e,$2e,$22,$2e,$7b,$2b,$2e,$2e
                                         
   9677 00D412 2E 2E 0D 7D 2E 7C 2E 2E      	.byte	$2e,$2e,$0d,$7d,$2e,$7c,$2e,$2e
                                         
   9678 00D41A 2E 2E 2E 2E 2E 2E 08 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$08,$2e
                                         
   9679 00D422 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9680 00D42A 2E 7F 2E 2E 2E 2E 1B 2E      	.byte	$2e,$7f,$2e,$2e,$2e,$2e,$1b,$2e
                                         
   9681 00D432 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
                                           
   9683 00D43A                             keybdExtendedCodes:
   9684 00D43A 2E 2E 2E 2E A3 A1 A2 2E      	.byte	$2e,$2e,$2e,$2e,$a3,$a1,$a2,$2e
                                         
   9685 00D442 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9686 00D44A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9687 00D452 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9688 00D45A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9689 00D462 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9690 00D46A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9691 00D472 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9692 00D47A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9693 00D482 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9694 00D48A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9695 00D492 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9696 00D49A 2E 2E 2E 2E 2E 2E 2E 2E      	.byte	$2e,$2e,$2e,$2e,$2e,$2e,$2e,$2e
                                         
   9697 00D4A2 2E 95 2E 93 94 2E 2E 2E      	.byte	$2e,$95,$2e,$93,$94,$2e,$2e,$2e
                                         
   9698 00D4AA 98 99 92 2E 91 90 2E 2E      	.byte	$98,$99,$92,$2e,$91,$90,$2e,$2e
                                         
   9699 00D4B2 2E 2E 97 2E 2E 96 2E 2E      	.byte	$2e,$2e,$97,$2e,$2e,$96,$2e,$2e
                                         
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; SPI MASTER driver
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ; spi_master_init
                                           ; Initialize the spi master controller
                                           
   9710 00D4BA                             spi_master_init:
   9711 00D4BA 08                           	
   9712 00D4BB E2 20                        	SEP		#$20
                                           	MEM		8
   9714 00D4BD A9 01                        	LDA		#SPI_INIT_SD
   9715 00D4BF 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9716 00D4C3 A9 01                        	LDA		#SPI_TRANS_START
   9717 00D4C5 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9718 00D4C9                             .0001:
   9719 00D4C9 AF 04 C0 FE                  	LDA		SPI_TRANS_STATUS_REG	; wait for SPI transfer to complete
   9720 00D4CD C9 01                        	CMP		#SPI_TRANS_BUSY
   9721 00D4CF F0 F8                        	BEQ		.0001
   9722 00D4D1 AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9723 00D4D5 29 03                        	AND		#3	; INIT errors
   9724 00D4D7 C9 00                        	CMP		#SPI_INIT_NO_ERROR
   9725 00D4D9 F0 0E                        	BEQ		.0004
   9726 00D4DB 28                           	PLP
                                           	MEM		16
                                           	NDX		16
   9729 00D4DC F4 01 00                     	PEA		1
   9730 00D4DF F4 DB D5                     	PEA		msgSpiInitError
   9731 00D4E2 20 F9 CC                     	JSR		DisplayString
   9732 00D4E5 A9 01 00                     	LDA		#1
   9733 00D4E8 60                           	RTS
   9734 00D4E9                             .0004:
   9735 00D4E9 28                           	PLP
                                           	;PEA		1
                                           	;PEA		msgSpiInited
                                           	;JSR		DisplayString
   9739 00D4EA A9 00 00                     	LDA		#0
   9740 00D4ED 60                           	RTS
                                           
                                           ; spi_master_read
                                           ; read a block from the SD card
                                           ;
                                           ; Parameters:
                                           ;	32 bit buffer address pushed onto stack
                                           ;	32 bit block number pushed onto stack
                                           ;
   9749 00D4EE                             spi_master_read:
   9750 00D4EE 08                           	PHP
   9751 00D4EF E2 20                        	SEP		#$20
                                           	MEM		8
                                           	NDX		16
   9754 00D4F1 BA                           	TSX
   9755 00D4F2 B5 04                        	LDA		4,X
   9756 00D4F4 8F 07 C0 FE                  	STA		SPI_SD_SECT_7_0_REG
   9757 00D4F8 B5 05                        	LDA		5,X
   9758 00D4FA 8F 08 C0 FE                  	STA		SPI_SD_SECT_15_8_REG
   9759 00D4FE B5 06                        	LDA		6,X
   9760 00D500 8F 09 C0 FE                  	STA		SPI_SD_SECT_23_16_REG
   9761 00D504 B5 07                        	LDA		7,X
   9762 00D506 8F 0A C0 FE                  	STA		SPI_SD_SECT_31_24_REG
   9763 00D50A B5 08                        	LDA		8,X
   9764 00D50C 85 C8                        	STA		bufptr
   9765 00D50E B5 09                        	LDA		9,X
   9766 00D510 85 C9                        	STA		bufptr+1
   9767 00D512 B5 0A                        	LDA		10,X
   9768 00D514 85 CA                        	STA		bufptr+2
   9769 00D516 B5 0B                        	LDA		11,X
   9770 00D518 85 CB                        	STA		bufptr+3
   9771 00D51A A9 02                        	LDA		#SPI_RW_READ_SD_BLOCK
   9772 00D51C 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9773 00D520 A9 01                        	LDA		#SPI_TRANS_START
   9774 00D522 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9775 00D526                             .0001:
   9776 00D526 AF 04 C0 FE                  	LDA		SPI_TRANS_STATUS_REG		; wait for SPI transfer to complete
   9777 00D52A C9 01                        	CMP		#SPI_TRANS_BUSY
   9778 00D52C F0 F8                        	BEQ		.0001
   9779 00D52E AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9780 00D532 4A                           	LSR
   9781 00D533 4A                           	LSR
   9782 00D534 29 03                        	AND		#3	; INIT errors
   9783 00D536 C9 00                        	CMP		#SPI_READ_NO_ERROR
   9784 00D538 F0 10                        	BEQ		.0004
   9785 00D53A 28                           	PLP
                                           	MEM		16
   9787 00D53B F4 01 00                     	PEA		1
   9788 00D53E F4 0F D6                     	PEA		msgSpiReadError
   9789 00D541 20 F9 CC                     	JSR		DisplayString
   9790 00D544 A9 01 00                     	LDA		#1
   9791 00D547 42 C0 08                     	RTS		#8
   9792 00D54A                             .0004:
   9793 00D54A C2 10                        	REP		#$10
                                           	MEM		8
                                           	NDX		16
   9796 00D54C A2 00 02                     	LDX		#512
   9797 00D54F A0 00 00                     	LDY		#0
   9798 00D552                             .0003:
                                           	;TXA
                                           	;AND		#$0F
                                           	;BNE		.0002
                                           	;PLP
                                           	;JSR		OutCRLF
                                           	;PHP
                                           	;SEP		#$20
   9806 00D552                             .0002:
   9807 00D552 AF 10 C0 FE                  	LDA		SPI_RX_FIFO_DATA_REG
   9808 00D556 42 97 C8                     	STA		{bufptr},Y
   9809 00D559 C8                           	INY
                                           	;PLP
                                           	;JSR		DispByte
                                           	;JSR		space
                                           	;PHP
   9814 00D55A E2 20                        	SEP		#$20
   9815 00D55C CA                           	DEX
   9816 00D55D D0 F3                        	BNE		.0003
   9817 00D55F 28                           	PLP
                                           	;JSR		OutCRLF
                                           	MEM		16
                                           	NDX		16
   9821 00D560 A9 00 00                     	LDA		#0
   9822 00D563 42 C0 08                     	RTS		#8
                                           
   9824 00D566                             spi_master_write:
   9825 00D566 08                           	PHP
   9826 00D567 E2 20                        	SEP		#$20
                                           	MEM		8
                                           	NDX		16
                                           
   9830 00D569 BA                           	TSX
   9831 00D56A B5 08                        	LDA		8,X
   9832 00D56C 85 C8                        	STA		bufptr
   9833 00D56E B5 09                        	LDA		9,X
   9834 00D570 85 C9                        	STA		bufptr+1
   9835 00D572 B5 0A                        	LDA		10,X
   9836 00D574 85 CA                        	STA		bufptr+2
   9837 00D576 B5 0B                        	LDA		11,X
   9838 00D578 85 CB                        	STA		bufptr+3
                                           
   9840 00D57A A0 00 00                     	LDY		#0
   9841 00D57D                             .0001:
   9842 00D57D 42 B7 C8                     	LDA		{bufptr},Y
   9843 00D580 8F 20 C0 FE                  	STA		SPI_TX_FIFO_DATA_REG
   9844 00D584 C8                           	INY
   9845 00D585 C0 00 02                     	CPY		#512
   9846 00D588 D0 F3                        	BNE		.0001
                                           
   9848 00D58A B5 04                        	LDA		4,X
   9849 00D58C 8F 07 C0 FE                  	STA		SPI_SD_SECT_7_0_REG
   9850 00D590 B5 05                        	LDA		5,X
   9851 00D592 8F 08 C0 FE                  	STA		SPI_SD_SECT_15_8_REG
   9852 00D596 B5 06                        	LDA		6,X
   9853 00D598 8F 09 C0 FE                  	STA		SPI_SD_SECT_23_16_REG
   9854 00D59C B5 07                        	LDA		7,X
   9855 00D59E 8F 0A C0 FE                  	STA		SPI_SD_SECT_31_24_REG
                                           
   9857 00D5A2 A9 03                        	LDA		#SPI_RW_WRITE_SD_BLOCK
   9858 00D5A4 8F 02 C0 FE                  	STA		SPI_TRANS_TYPE_REG
   9859 00D5A8 A9 01                        	LDA		#SPI_TRANS_START
   9860 00D5AA 8F 03 C0 FE                  	STA		SPI_TRANS_CTRL_REG
   9861 00D5AE                             .0002:
   9862 00D5AE AF 04 C0 FE                  	LDA		SPI_TRANS_STATUS_REG		; wait for SPI transfer to complete
   9863 00D5B2 C9 01                        	CMP		#SPI_TRANS_BUSY
   9864 00D5B4 F0 F8                        	BEQ		.0002
   9865 00D5B6 AF 05 C0 FE                  	LDA		SPI_TRANS_ERROR_REG
   9866 00D5BA 4A                           	LSR
   9867 00D5BB 4A                           	LSR
   9868 00D5BC 4A                           	LSR
   9869 00D5BD 4A                           	LSR
   9870 00D5BE 29 03                        	AND		#3	; write errors
   9871 00D5C0 C9 00                        	CMP		#SPI_WRITE_NO_ERROR
   9872 00D5C2 F0 10                        	BEQ		.0004
   9873 00D5C4 28                           	PLP
                                           	MEM		16
   9875 00D5C5 F4 01 00                     	PEA		1
   9876 00D5C8 F4 20 D6                     	PEA		msgSpiWriteError
   9877 00D5CB 20 F9 CC                     	JSR		DisplayString
   9878 00D5CE A9 01 00                     	LDA		#1
   9879 00D5D1 42 C0 08                     	RTS		#8
   9880 00D5D4                             .0004:
   9881 00D5D4 28                           	PLP
   9882 00D5D5 A9 00 00                     	LDA		#0
   9883 00D5D8 42 C0 08                     	RTS		#8
                                           
   9885 00D5DB                             msgSpiInitError:
   9886 00D5DB 45 72 72 6F 72 20 69 6E      .byte	"Error initializing SPI master",$0D,$0A,$00
   9886 00D5E3 69 74 69 61 6C 69 7A 69    
   9886 00D5EB 6E 67 20 53 50 49 20 6D    
   9886 00D5F3 61 73 74 65 72 0D 0A 00    
                                         
   9887 00D5FB                             msgSpiInited:
   9888 00D5FB 53 50 49 20 6D 61 73 74      .byte	"SPI master inited",$0D,$0A,$00
   9888 00D603 65 72 20 69 6E 69 74 65    
   9888 00D60B 64 0D 0A 00                
   9889 00D60F                             msgSpiReadError:
   9890 00D60F 53 50 49 20 72 65 61 64      .byte	"SPI read error",$0D,$0A,$00
   9890 00D617 20 65 72 72 6F 72 0D 0A    
   9890 00D61F 00                         
   9891 00D620                             msgSpiWriteError:
   9892 00D620 53 50 49 20 77 72 69 74      .byte	"SPI write error",$0D,$0A,$00
   9892 00D628 65 20 65 72 72 6F 72 0D    
   9892 00D630 0A 00                      
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; RTC driver for MCP7941x
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
   9900 00D632                             rtc_init:
   9901 00D632 A9 11 00                     		LDA		#17					; constant for 400kHz I2C from 33MHz
   9902 00D635 8F 00 C1 FE                  		STA		I2C_PRESCALE_LO
   9903 00D639 60                           		RTS
                                           
                                           ; Read all the RTC sram registers into a buffer
                                           
   9907 00D63A                             rtc_read:
   9908 00D63A 08                           		PHP
   9909 00D63B E2 30                        		SEP		#$30
                                           		MEM		8
                                           		NDX		8
   9912 00D63D A9 80                        		LDA		#$80				; enable I2C
   9913 00D63F 8F 02 C1 FE                  		STA		I2C_CONTROL
   9914 00D643 A9 DE                        		LDA		#$DE				; read address, write op
   9915 00D645 A0 90                        		LDY		#$90				; STA + wr bit
   9916 00D647 20 AA D6                     		JSR		rtc_wr_cmd
   9917 00D64A 30 4D                        		BMI		.rxerr
   9918 00D64C A9 00                        		LDA		#$00				; address zero
   9919 00D64E A0 10                        		LDY		#$10				; wr bit
   9920 00D650 20 AA D6                     		JSR		rtc_wr_cmd
   9921 00D653 30 44                        		BMI		.rxerr
   9922 00D655 A9 DF                        		LDA		#$DF				; read address, read op
   9923 00D657 A0 90                        		LDY		#$90				; STA + wr bit
   9924 00D659 20 AA D6                     		JSR		rtc_wr_cmd
   9925 00D65C 30 3B                        		BMI		.rxerr
   9926 00D65E A2 00                        		LDX		#0
   9927 00D660                             .0001:
   9928 00D660 A9 20                        		LDA		#$20				; rd bit
   9929 00D662 8F 04 C1 FE                  		STA		I2C_CMD
   9930 00D666 20 A1 D6                     		JSR		rtc_wait_tip
   9931 00D669 AF 04 C1 FE                  		LDA		I2C_STAT
   9932 00D66D 30 2A                        		BMI		.rxerr
   9933 00D66F AF 03 C1 FE                  		LDA		I2C_RX
   9934 00D673 9D 00 03                     		STA		RTCBuf,X
   9935 00D676 E8                           		INX
   9936 00D677 E0 5F                        		CPX		#$5F
   9937 00D679 D0 E5                        		BNE		.0001
   9938 00D67B A9 68                        		LDA		#$68				; STO, rd bit + nack
   9939 00D67D 8F 04 C1 FE                  		STA		I2C_CMD
   9940 00D681 20 A1 D6                     		JSR		rtc_wait_tip
   9941 00D684 AF 04 C1 FE                  		LDA		I2C_STAT
   9942 00D688 30 0F                        		BMI		.rxerr
   9943 00D68A AF 03 C1 FE                  		LDA		I2C_RX
   9944 00D68E 9D 00 03                     		STA		RTCBuf,X
   9945 00D691 A9 00                        		LDA		#0					; disable I2C and return 0
   9946 00D693 8F 02 C1 FE                  		STA		I2C_CONTROL
   9947 00D697 28                           		PLP
   9948 00D698 60                           		RTS
   9949 00D699                             .rxerr:
   9950 00D699 42 9C 02 C1 FE 00            		STZ		I2C_CONTROL			; disable I2C and return status
   9951 00D69F 28                           		PLP
   9952 00D6A0 60                           		RTS
                                           
   9954 00D6A1                             rtc_wait_tip:
   9955 00D6A1                             .0001:
   9956 00D6A1 AF 04 C1 FE                  		LDA		I2C_STAT
   9957 00D6A5 29 04                        		AND		#$4					; transmit in progress bit
   9958 00D6A7 D0 F8                        		BNE		.0001
   9959 00D6A9 60                           		RTS
                                           
   9961 00D6AA                             rtc_wr_cmd:
   9962 00D6AA 8F 03 C1 FE                  		STA		I2C_TX
   9963 00D6AE 42 8C 04 C1 FE 00            		STY		I2C_CMD
   9964 00D6B4 20 A1 D6                     		JSR		rtc_wait_tip
   9965 00D6B7 AF 04 C1 FE                  		LDA		I2C_STAT
   9966 00D6BB 60                           		RTS
                                           
   9968 00D6BC                             rtc_write:
   9969 00D6BC 08                           		PHP
   9970 00D6BD E2 30                        		SEP		#$30
                                           		MEM		8
                                           		NDX		8
   9973 00D6BF A9 80                        		LDA		#$80				; enable I2C
   9974 00D6C1 8F 02 C1 FE                  		STA		I2C_CONTROL
   9975 00D6C5 A9 DE                        		LDA		#$DE				; read address, write op
   9976 00D6C7 A0 90                        		LDY		#$90				; STA + wr bit
   9977 00D6C9 20 AA D6                     		JSR		rtc_wr_cmd
   9978 00D6CC 30 2C                        		BMI		.rxerr
   9979 00D6CE A9 00                        		LDA		#$00				; address zero
   9980 00D6D0 A0 10                        		LDY		#$10				; wr bit
   9981 00D6D2 20 AA D6                     		JSR		rtc_wr_cmd
   9982 00D6D5 30 23                        		BMI		.rxerr
   9983 00D6D7 A2 00                        		LDX		#0
   9984 00D6D9                             .0001:
   9985 00D6D9 BD 00 03                     		LDA		RTCBuf,X
   9986 00D6DC A0 10                        		LDY		#$10
   9987 00D6DE 20 AA D6                     		JSR		rtc_wr_cmd
   9988 00D6E1 30 17                        		BMI		.rxerr
   9989 00D6E3 E8                           		INX
   9990 00D6E4 E0 5F                        		CPX		#$5F
   9991 00D6E6 D0 F1                        		BNE		.0001
   9992 00D6E8 BD 00 03                     		LDA		RTCBuf,X
   9993 00D6EB A0 50                        		LDY		#$50				; STO, wr bit
   9994 00D6ED 20 AA D6                     		JSR		rtc_wr_cmd
   9995 00D6F0 30 08                        		BMI		.rxerr
   9996 00D6F2 A9 00                        		LDA		#0					; disable I2C and return 0
   9997 00D6F4 8F 02 C1 FE                  		STA		I2C_CONTROL
   9998 00D6F8 28                           		PLP
   9999 00D6F9 60                           		RTS
  10000 00D6FA                             .rxerr:
  10001 00D6FA 42 9C 02 C1 FE 00            		STZ		I2C_CONTROL			; disable I2C and return status
  10002 00D700 28                           		PLP
  10003 00D701 60                           		RTS
                                           
  10005 00D702                             msgRtcReadFail:
  10006 00D702 52 54 43 20 72 65 61 64      	.byte	"RTC read/write failed.",$0D,$0A,$00
  10006 00D70A 2F 77 72 69 74 65 20 66    
  10006 00D712 61 69 6C 65 64 2E 0D 0A    
  10006 00D71A 00                         
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ; Get char routine for Supermon
                                           ; This routine might be called with 8 bit regs.
                                           ;
                                           	MEM		16
                                           	NDX		16
  10018 00D71B                             SuperGetch:
  10019 00D71B 20 44 D0                     	JSR		KeybdGetCharNoWait
  10020 00D71E 29 FF 00                     	AND		#$FF
  10021 00D721 42 40 00                     	RTC		#0
  10022 00D724 82 77 EA                     	BRL		TaskFC
                                           
                                           ; Put char routine for Supermon
                                           ;
  10026 00D727                             SuperPutch:
  10027 00D727 20 EA CC                     	JSR		OutChar
  10028 00D72A 42 40 00                     	RTC		#0
  10029 00D72D 82 6E EA                     	BRL		TaskFC
                                           
                                           ; Char get routine for BASIC
                                           ; Same thing as for Supermon, except carry flag needs to be inverted
                                           ; This routine should be called from a different context than the BIOS,
                                           ; otherwise the call will be ignored.
                                           ;
  10036 00D730                             BasicGetch:
  10037 00D730 A9 F1 00                     	LDA		#$F1
  10038 00D733 8D 00 70                     	STA		$7000
  10039 00D736 20 44 D0                     	JSR		KeybdGetCharNoWait
  10040 00D739 29 FF 00                     	AND		#$FF
  10041 00D73C 42 18                        	CMC
  10042 00D73E 42 40 00                     	RTC		#0
  10043 00D741 82 5A EA                     	BRL		TaskFC
                                           
  10045 00D744                             xitBasic:
  10046 00D744 FA                           	PLX						; get rid of task to return to, we won't be returning
  10047 00D745 85 C0                        	STA		ExitCode
  10048 00D747 64 34                        	STZ		TCB_status+7	; no longer ready
  10049 00D749 64 CE                        	STZ		IOFocusTask
  10050 00D74B 64 CF                        	STZ		IOFocusTask+1
  10051 00D74D 42 CB 42 A2 00 00            	TSK		JMP:#0
  10052 00D753 82 48 EA                     	BRL		TaskFC
                                           
  10054 00D756                             warm_start:
  10055 00D756 42 E2 00 01                  	SEP		#$100		; 16 bit mode
  10056 00D75A C2 30                        	REP		#$30		; 16 bit MEM,NDX
                                           	MEM		16
                                           	NDX		16
  10059 00D75C A9 FF 3F                     	LDA		#$3FFF
  10060 00D75F 1B                           	TAS
  10061 00D760 20 4D CD                     	JSR		CursorOn
  10062 00D763 82 4A EA                     	BRL		Mon1
                                           
                                           	cpu		FT832
  10065 00D766                             ICacheIL832:
  10066 00D766 42 E0 01                     	CACHE	#1			; 1= invalidate instruction line identified by accumulator
  10067 00D769 60                           	RTS
                                           
                                           ;============================================================================
                                           ;============================================================================
                                           ; SD Card COS
                                           ;============================================================================
                                           ;============================================================================
                                           
                                           ; "Format" the SD card. This basically just sets the BAM to zero indicating
                                           ; no allocated clusters, and zeros out the root directory
                                           ;
  10078 00D76A                             SDC_Format:
  10079 00D76A A9 00 00                     	LDA		#0
  10080 00D76D A2 00 00                     	LDX		#0
  10081 00D770                             .zeroSector:
  10082 00D770 9F 00 00 0F                  	STA		$F0000,X
  10083 00D774 E8                           	INX
  10084 00D775 E0 00 02                     	CPX		#512
  10085 00D778 D0 F6                        	BNE		.zeroSector
  10086 00D77A A9 FF FF                     	LDA		#$FFFF				; the first 17 clusters are allocated
  10087 00D77D 8F 00 00 0F                  	STA		$F0000				; for the BAM and root directory
  10088 00D781 A9 00 80                     	LDA		#$8000
  10089 00D784 8F 02 00 0F                  	STA		$F0002
                                           
  10091 00D788 20 BA D4                     	JSR		spi_master_init
  10092 00D78B 64 C4                        	STZ		secnum				; set starting sector # to zero
  10093 00D78D 64 C6                        	STZ		secnum+2
  10094 00D78F                             .nextSector:
  10095 00D78F F4 0F 00                     	PEA		$000F				; push buffer address
  10096 00D792 F4 00 00                     	PEA		$0000
  10097 00D795 A5 C6                        	LDA		secnum+2			; push sector number
  10098 00D797 48                           	PHA
  10099 00D798 A5 C4                        	LDA		secnum
  10100 00D79A 48                           	PHA
  10101 00D79B 20 66 D5                     	JSR		spi_master_write
  10102 00D79E 42 9C 00 00 0F 00            	STZ		$F0000
  10103 00D7A4 42 9C 02 00 0F 00            	STZ		$F0002
  10104 00D7AA A5 C4                        	LDA		secnum
  10105 00D7AC C9 87 00                     	CMP		#135
  10106 00D7AF F0 04                        	BEQ		.doneFmt
  10107 00D7B1 E6 C4                        	INC		secnum
  10108 00D7B3 80 DA                        	BRA		.nextSector
  10109 00D7B5                             .doneFmt:
  10110 00D7B5 60                           	RTS
                                           
                                           ; Parameters
                                           ; .A = # of sectors to read
                                           ; starting sector number
                                           ; pointer to buffer
                                           ;
  10117 00D7B6                             SDC_Jmp:
  10118 00D7B6 6C F4 03                     	JMP		(spi_rw_vect)
                                           
  10120 00D7B9                             SDC_ReadWriteMultiple:
  10121 00D7B9 85 D2                        	STA		numsec
  10122 00D7BB 3B                           	TSA
  10123 00D7BC 38                           	SEC
  10124 00D7BD E9 08 00                     	SBC		#8
  10125 00D7C0 1B                           	TAS
  10126 00D7C1 BA                           	TSX
  10127 00D7C2 B5 0B                        	LDA		11,X
  10128 00D7C4 95 01                        	STA		1,X
  10129 00D7C6 B5 0D                        	LDA		13,X
  10130 00D7C8 95 03                        	STA		3,X
  10131 00D7CA B5 0F                        	LDA		15,X
  10132 00D7CC 95 05                        	STA		5,X
  10133 00D7CE B5 11                        	LDA		17,X
  10134 00D7D0 95 07                        	STA		7,X
  10135 00D7D2                             .nextSector:
  10136 00D7D2 20 B6 D7                     	JSR		SDC_Jmp
  10137 00D7D5 C9 00 00                     	CMP		#0
  10138 00D7D8 D0 26                        	BNE		.abort
  10139 00D7DA 3B                           	TSA
  10140 00D7DB 38                           	SEC
  10141 00D7DC E9 08 00                     	SBC		#8
  10142 00D7DF 1B                           	TAS
  10143 00D7E0 BA                           	TSX
                                           	; increment the starting sector #
  10145 00D7E1 F6 0B                        	INC		11,X
  10146 00D7E3 D0 02                        	BNE		.0001
  10147 00D7E5 F6 0D                        	INC		13,X
  10148 00D7E7                             .0001:
  10149 00D7E7 18                           	CLC
                                           	; increment buffer pointer by 512 bytes
  10151 00D7E8 F6 11                        	INC		17,X
  10152 00D7EA F6 11                        	INC		17,X
                                           	; copy parameters back to stack
  10154 00D7EC B5 0B                        	LDA		11,X
  10155 00D7EE 95 01                        	STA		1,X
  10156 00D7F0 B5 0D                        	LDA		13,X
  10157 00D7F2 95 03                        	STA		3,X
  10158 00D7F4 B5 0F                        	LDA		15,X
  10159 00D7F6 95 05                        	STA		5,X
  10160 00D7F8 B5 11                        	LDA		17,X
  10161 00D7FA 95 07                        	STA		7,X
  10162 00D7FC C6 D2                        	DEC		numsec
  10163 00D7FE D0 D2                        	BNE		.nextSector
  10164 00D800                             .abort:
  10165 00D800 42 C0 08                     	RTS		#8
                                           
  10167 00D803                             SDC_SaveRootDir:
  10168 00D803 A9 66 D5                     	LDA		#spi_master_write
  10169 00D806 80 03                        	BRA		SDC_SRD1
  10170 00D808                             SDC_LoadRootDir:
  10171 00D808 A9 EE D4                     	LDA		#spi_master_read	; flag an spi read
  10172 00D80B                             SDC_SRD1:
  10173 00D80B 8D F4 03                     	STA		spi_rw_vect
  10174 00D80E F4 0E 00                     	PEA		$000E				; directory buffer address = $EF000
  10175 00D811 F4 00 F0                     	PEA		$F000
  10176 00D814 F4 00 00                     	PEA		$0
  10177 00D817 A9 80 00                     	LDA		#128				; root directory is at sector 128
  10178 00D81A 48                           	PHA
  10179 00D81B A9 08 00                     	LDA		#8					; 8 sectors to load
  10180 00D81E 20 B9 D7                     	JSR		SDC_ReadWriteMultiple
  10181 00D821 60                           	RTS
                                           
  10183 00D822                             SDC_SaveBAM:
  10184 00D822 A9 66 D5                     	LDA		#spi_master_write
  10185 00D825 80 03                        	BRA		SDC_SVB1
  10186 00D827                             SDC_LoadBAM:
  10187 00D827 A9 EE D4                     	LDA		#spi_master_read
  10188 00D82A                             SDC_SVB1:
  10189 00D82A 8D F4 03                     	STA		spi_rw_vect
  10190 00D82D F4 0F 00                     	PEA		$000F
  10191 00D830 F4 00 00                     	PEA		$0000
  10192 00D833 F4 00 00                     	PEA		$0000				; BAM starts at sector zero
  10193 00D836 F4 00 00                     	PEA		$0000
  10194 00D839 A9 80 00                     	LDA		#128				; 128 sectors to read
  10195 00D83C 20 B9 D7                     	JSR		SDC_ReadWriteMultiple
  10196 00D83F 60                           	RTS
                                           
                                           ; Parameters (on stack)
                                           ; pointer to filename
                                           ; pointer to disk buffer
                                           ;
  10202 00D840                             SDC_LoadFile:
  10203 00D840 20 08 D8                     	JSR		SDC_LoadRootDir
  10204 00D843 A2 20 00                     	LDX		#32
  10205 00D846                             .nxt2:
  10206 00D846 A0 00 00                     	LDY		#0
  10207 00D849 A9 0E 00                     	LDA		#$000E
  10208 00D84C 8D 46 D8                     	STA		dirptr+2
  10209 00D84F A9 00 F0                     	LDA		#$F000
  10210 00D852 42 8A                        	AAX
  10211 00D854 8D 44 D8                     	STA		dirptr
  10212 00D857                             .nxtCmp:
  10213 00D857 42 8B 42 B3 03               	LDA.B	{3,S},Y
  10214 00D85C F0 2F                        	BEQ		.doneCmp
  10215 00D85E 42 8B D7 44                  	CMP.B	[dirptr],Y
  10216 00D862 D0 2D                        	BNE		.nextDirentry
  10217 00D864 C8                           	INY
  10218 00D865 C0 0F 00                     	CPY		#15
  10219 00D868 30 ED                        	BLT		.nxtCmp
  10220 00D86A                             .found:
  10221 00D86A A3 09                        	LDA		9,S
  10222 00D86C AA                           	TAX
  10223 00D86D A3 07                        	LDA		7,S
  10224 00D86F DA                           	PHX
  10225 00D870 48                           	PHA
  10226 00D871 A0 1A 00                     	LDY		#26
  10227 00D874 B7 44                        	LDA		[dirptr],Y 
  10228 00D876 AA                           	TAX
  10229 00D877 A0 18 00                     	LDY		#24
  10230 00D87A B7 44                        	LDA		[dirptr],Y
  10231 00D87C 20 A8 D8                     	JSR		ClusterToSector
  10232 00D87F DA                           	PHX
  10233 00D880 48                           	PHA
  10234 00D881 A0 1D 00                     	LDY		#29
  10235 00D884 B7 44                        	LDA		[dirptr],Y
  10236 00D886 4A                           	LSR
  10237 00D887 20 7E D8                     	JSR		SDC_ReadMultiple
  10238 00D88A 42 C0 08                     	RTS		#8
  10239 00D88D                             .doneCmp:
  10240 00D88D B7 44                        	LDA		[dirptr],Y
  10241 00D88F F0 D9                        	BEQ		.found
  10242 00D891                             .nextDirentry:
  10243 00D891 8A                           	TXA
  10244 00D892 18                           	CLC
  10245 00D893 69 20 00                     	ADC		#32
  10246 00D896 AA                           	TAX
  10247 00D897 E0 00 10                     	CPX		#$1000
  10248 00D89A 30 AA                        	BLT		.nxt2
  10249 00D89C F4 05 00                     	PEA		5
  10250 00D89F F4 BE D8                     	PEA		msgFileNotFound
  10251 00D8A2 20 F9 CC                     	JSR		DisplayString
  10252 00D8A5 42 C0 08                     	RTS		#8
                                           
  10254 00D8A8                             ClusterToSector:
  10255 00D8A8 85 0C                        	STA		NumWorkArea
  10256 00D8AA 8E A3 D8                     	STX		NumWordArea+2
  10257 00D8AD 06 0C                        	ASL		NumWorkArea
  10258 00D8AF 26 0E                        	ROL		NumWorkArea+2
  10259 00D8B1 06 0C                        	ASL		NumWorkArea
  10260 00D8B3 26 0E                        	ROL		NumWorkArea+2
  10261 00D8B5 06 0C                        	ASL		NumWorkArea
  10262 00D8B7 26 0E                        	ROL		NumWorkArea+2
  10263 00D8B9 A5 0C                        	LDA		NumWorkArea
  10264 00D8BB A6 0E                        	LDX		NumWorkArea+2
  10265 00D8BD 60                           	RTS
                                           
  10267 00D8BE                             msgFileNotFound:
  10268 00D8BE 46 69 6C 65 20 6E 6F 74      	.byte	"File not found",$0D,$0A,$00
  10268 00D8C6 20 66 6F 75 6E 64 0D 0A    
  10268 00D8CE 00                         
                                           
                                           ;============================================================================
                                           ; BASIC support functions
                                           ;============================================================================
  10273 00D8CF                             BASIC_Savefile:
  10274 00D8CF A9 66 D5                     	LDA		#spi_master_write
  10275 00D8D2 8D C8 D8                     	STA		spi_vect
  10276 00D8D5 F4 01 00                     	PEA		$1		; buffer = $10000
  10277 00D8D8 F4 00 00                     	PEA		$0
  10278 00D8DB F4 00 00                     	PEA		$0
  10279 00D8DE F4 88 00                     	PEA		136		; starting sector
  10280 00D8E1 A9 40 00                     	LDA		#64		; 64 sectors (32 kiB)
  10281 00D8E4 20 B9 D7                     	JSR		SDC_ReadWriteMultiple
  10282 00D8E7 60                           	RTS
                                           
  10284 00D8E8                             BASIC_Loadfile:
  10285 00D8E8 A9 EE D4                     	LDA		#spi_master_read
  10286 00D8EB 8D C8 D8                     	STA		spi_vect
  10287 00D8EE F4 01 00                     	PEA		$1		; buffer = $10000
  10288 00D8F1 F4 00 00                     	PEA		$0
  10289 00D8F4 F4 00 00                     	PEA		$0
  10290 00D8F7 F4 88 00                     	PEA		136		; starting sector
  10291 00D8FA A9 40 00                     	LDA		#64		; 64 sectors (32 kiB)
  10292 00D8FD 20 B9 D7                     	JSR		SDC_ReadWriteMultiple
  10293 00D900 60                           	RTS
                                           
                                           ;============================================================================
                                           ; Multi-tasking kernel
                                           ;============================================================================
                                           
  10299 00D901                             FMTK_Init:
  10300 00D901 42 C2 30 01                  	REP		#$130
  10301 00D905 42 E2 00 02                  	SEP		#$200
                                           	MEM		32
                                           	NDX		32
  10304 00D909 A9 00 00 00 00               	LDA		#0
  10305 00D90E 8F 00 20 05                  	STA		running_task
                                           
                                           	; zero out the IRQ hook vectors
  10308 00D912 A9 00 00 00 00               	LDA		#0
  10309 00D917 AA                           	TAX
  10310 00D918                             .0001:
  10311 00D918 9F 10 20 05                  	STA		IRQ1Hook,X
  10312 00D91C 9F 12 20 05                  	STA		IRQ1Hook+2,X
  10313 00D920 42 E8                        	INX4
  10314 00D922 E0 40 00 00 00               	CPX		#MAX_IRQ_HOOK*4
  10315 00D927 D0 EF                        	BNE		.0001
                                           
                                           	; initialize message array
                                           	; create the free message list
                                           	; for each message
                                           	; msg->link = handle of next message
  10321 00D929 A0 00 00 00 00               	LDY		#0
  10322 00D92E                             .nxtMsg:
  10323 00D92E 98                           	TYA
  10324 00D92F 20 8A D9                     	JSR		hMsgToAddr
  10325 00D932 AA                           	TAX
  10326 00D933 C8                           	INY
  10327 00D934 98                           	TYA
  10328 00D935 42 AB 95 10                  	STA.H	MSG_link,X
  10329 00D939 C0 00 10 00 00               	CPY		#NR_MSG
  10330 00D93E 30 EE                        	BLT		.nxtMsg
                                           	; flag the last message as no more links
  10332 00D940 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10333 00D945 42 AB 95 10                  	STA.H	MSG_link,X
                                           	; now point free list to first message
  10335 00D949 42 AB 42 9C 0A 20 05 00      	STZ.H	freeMSG
                                         
                                           
  10337 00D951 42 C2 30 02                  	REP		#$230
  10338 00D955 42 E2 00 01                  	SEP		#$100
                                           	MEM		16
                                           	NDX		16
  10341 00D959 60                           	RTS
                                           
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FMTKmsg.asm

                                           ; ============================================================================
                                           ; FMTKmsg.asm
                                           ;        __
                                           ;   \\__/ o\    (C) 2017  Robert Finch, Waterloo
                                           ;    \  __ /    All rights reserved.
                                           ;     \/_//     robfinch<remove>@finitron.ca
                                           ;       ||
                                           ;  
                                           ;
                                           ; This source file is free software: you can redistribute it and/or modify 
                                           ; it under the terms of the GNU Lesser General Public License as published 
                                           ; by the Free Software Foundation, either version 3 of the License, or     
                                           ; (at your option) any later version.                                      
                                           ;                                                                          
                                           ; This source file is distributed in the hope that it will be useful,      
                                           ; but WITHOUT ANY WARRANTY; without even the implied warranty of           
                                           ; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            
                                           ; GNU General Public License for more details.                             
                                           ;                                                                          
                                           ; You should have received a copy of the GNU General Public License        
                                           ; along with this program.  If not, see <http://www.gnu.org/licenses/>.    
                                           ;                   
                                           ;
                                           ; Messaging Primitives for FMTK                                                       
                                           ; ============================================================================
                                           ;
                                           
                                           		CPU		FT832
                                           		MEM		32
                                           		NDX		32
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Handle to address conversion functions.
                                           ;----------------------------------------------------------------------------
                                           
                                           public hJcbToAddr:
  10380 00D95A 48                           		PHA
  10381 00D95B A2 00 04 00 00               		LDX		#JCB_SIZE
  10382 00D960 42 2A                        		MUL
  10383 00D962 18                           		CLC
  10384 00D963 69 00 80 02 00               		ADC		#jcbs
  10385 00D968 FA                           		PLX
  10386 00D969 60                           		RTS
                                           
                                           public hTcbToAddr:
  10389 00D96A DA                           		PHX
  10390 00D96B A2 40 00 00 00               		LDX		#TCB_SIZE
  10391 00D970 42 2A                        		MUL
  10392 00D972 18                           		CLC
  10393 00D973 69 00 00 02 00               		ADC		#tcbs
  10394 00D978 FA                           		PLX
  10395 00D979 60                           		RTS
                                           
                                           public hMbxToAddr:
  10398 00D97A DA                           		PHX
  10399 00D97B A2 18 00 00 00               		LDX		#MBX_SIZE
  10400 00D980 42 2A                        		MUL
  10401 00D982 18                           		CLC
  10402 00D983 69 00 80 03 00               		ADC		#mailboxes
  10403 00D988 FA                           		PLX
  10404 00D989 60                           		RTS
                                           
                                           public hMsgToAddr:
  10407 00D98A DA                           		PHX
  10408 00D98B A2 14 00 00 00               		LDX		#MSG_SIZE
  10409 00D990 42 2A                        		MUL
  10410 00D992 18                           		CLC
  10411 00D993 69 00 E0 03 00               		ADC		#messages
  10412 00D998 FA                           		PLX
  10413 00D999 60                           		RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; QueueMsg
                                           ;	Queue a message at a mailbox
                                           ; Parameters:
                                           ;	.A	mailbox handle
                                           ;	.X  message handle
                                           ;----------------------------------------------------------------------------
                                           ;
  10423 00D99A                             QueueMsg:
  10424 00D99A 42 AB 86 94                  		STX.H	reg_x
  10425 00D99E 42 AB 85 90                  		STA.H	reg_a
  10426 00D9A2 20 7A D9                     		JSR		hMbxToAddr
  10427 00D9A5 AA                           		TAX
  10428 00D9A6 42 AB F6 0E                  		INC.H	MBX_mq_count,X	; increment queued messages count
  10429 00D9AA 42 BB B5 08                  		LDA.UH	MBX_mq_tail,X	; if (mailboxes[hMbx]->mq_tail >= 0)
  10430 00D9AE 30 0E                        		BMI		.0001			; branch if no messages queued
  10431 00D9B0 20 8A D9                     		JSR		hMsgToAddr
  10432 00D9B3 AA                           		TAX
  10433 00D9B4 42 BB A5 94                  		LDA.UH	reg_x			; .A = message handle
  10434 00D9B8 42 AB 95 10                  		STA.H	MSG_link,X		; message[mailbox[hMbx]->mq_tail].link = hMsg
  10435 00D9BC 80 10                        		BRA		.0002
  10436 00D9BE                             .0001:							; else
  10437 00D9BE 42 AB A5 90                  		LDA.H	reg_a			;	.A = mailbox handle
  10438 00D9C2 20 7A D9                     		JSR		hMbxToAddr
  10439 00D9C5 AA                           		TAX
  10440 00D9C6 42 BB A5 94                  		LDA.UH	reg_x
  10441 00D9CA 42 AB 95 06                  		STA.H	MBX_mq_head,X	; mailbox[hMbx].mq_head = hMsg
  10442 00D9CE                             .0002:
  10443 00D9CE 42 BB A5 90                  		LDA.UH	reg_a			; .A = mailbox handle
  10444 00D9D2 20 7A D9                     		JSR		hMbxToAddr
  10445 00D9D5 AA                           		TAX						; .X = index into mailboxes array
  10446 00D9D6 42 BB A5 94                  		LDA.UH	reg_x			; .A = message handle
  10447 00D9DA 42 AB 95 08                  		STA.H	MBX_mq_tail,X	; mailbox[hMbx]->mq_tail = hMsg
  10448 00D9DE 20 8A D9                     		JSR		hMsgToAddr
  10449 00D9E1 AA                           		TAX
  10450 00D9E2 A9 FF FF FF FF               		LDA		#$FFFFFFFF
  10451 00D9E7 42 AB 95 10                  		STA.H	MSG_link,X		; message[hMsg]->link = -1
  10452 00D9EB 60                           		RTS		
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Dequeue message from mailbox
                                           ;
                                           ; Assumes:
                                           ;	Mailbox parameter is valid
                                           ;	System semaphore is locked already
                                           ; Parameters:
                                           ;	.A = mailbox number
                                           ; Returns:
                                           ;	.A = -1 if no messages available
                                           ;	.A = handle of message
                                           ;----------------------------------------------------------------------------
                                           ;
  10467 00D9EC                             DequeueMsg:
  10468 00D9EC 20 7A D9                     	JSR		hMbxToAddr
  10469 00D9EF AA                           	TAX
  10470 00D9F0 42 BB B5 0E                  	LDA.UH	MBX_mq_count,X	; if (mbx->mq_count)
  10471 00D9F4 F0 2A                        	BEQ		.noMessage
  10472 00D9F6 42 AB D6 0E                  	DEC.H	MBX_mq_count,X	; mbx->mq_count--;
  10473 00D9FA 42 BB B5 06                  	LDA.UH	MBX_mq_head,X	; .A = message handle
  10474 00D9FE 30 20                        	BMI		.noMessage
  10475 00DA00 20 8A D9                     	JSR		hMsgToAddr
  10476 00DA03 48                           	PHA
  10477 00DA04 A8                           	TAY
  10478 00DA05 42 AB B9 10 00               	LDA.H	MSG_link,Y
  10479 00DA0A 42 AB 95 06                  	STA.H	MBX_mq_head,X
  10480 00DA0E 10 09                        	BPL		.0001
  10481 00DA10 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10482 00DA15 42 AB 95 08                  	STA.H	MBX_mq_tail,X
  10483 00DA19                             .0001:
  10484 00DA19 68                           	PLA
  10485 00DA1A 42 AB 99 10 00               	STA.H	MSG_link,Y		; tmpmsg->link = hm
  10486 00DA1F 60                           	RTS						; return hm
  10487 00DA20                             .noMessage:
  10488 00DA20 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10489 00DA25 60                           	RTS
                                           
                                           
                                           ;----------------------------------------------------------------------------
                                           ;		Dequeues a thread from a mailbox. The thread will also
                                           ;	be removed from the timeout list (if it's present there),
                                           ;	and	the timeout list will be adjusted accordingly.
                                           ;
                                           ;	.A = handle to mailbox
                                           ; Returns:
                                           ;	.A = handle to thread (-1 if none available)
                                           ;----------------------------------------------------------------------------
                                           
  10502 00DA26                             DequeueThreadFromMbx:
  10503 00DA26 20 99 DE                     	JSR		LockSysSema
  10504 00DA29 20 7A D9                     	JSR		hMbxToAddr
  10505 00DA2C AA                           	TAX
  10506 00DA2D 42 AB B5 02                  	LDA.H	MBX_tq_head,X
  10507 00DA31 10 09                        	BPL		.0001
  10508 00DA33 20 9B DE                     	JSR		UnlockSysSema
  10509 00DA36 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10510 00DA3B 60                           	RTS						; return .A < 0
  10511 00DA3C                             .0001:
  10512 00DA3C 42 AB D6 0C                  	DEC.H	MBX_tq_count,X
  10513 00DA40 42 BB B5 02                  	LDA.UH	MBX_tq_head,X
  10514 00DA44 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10515 00DA4A 20 6A D9                     	JSR		hTcbToAddr
  10516 00DA4D A8                           	TAY
  10517 00DA4E 42 AB B9 08 00               	LDA.H	TCB_mbq_next,Y
  10518 00DA53 42 AB 95 02                  	STA.H	MBX_tq_head,X
  10519 00DA57 30 0C                        	BMI		.0002
  10520 00DA59 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10521 00DA5E 42 AB 99 0A 00               	STA.H	TCB_mbq_prev,Y
  10522 00DA63 80 09                        	BRA		.0003
  10523 00DA65                             .0002:
  10524 00DA65 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10525 00DA6A 42 AB 95 04                  	STA.H	MBX_tq_tail,X
  10526 00DA6E                             .0003:
  10527 00DA6E 20 9B DE                     	JSR		UnlockSysSema
  10528 00DA71 42 8B B9 2D 00               	LDA.B	TCB_status,Y
  10529 00DA76 29 08 00 00 00               	AND		#TS_TIMEOUT
  10530 00DA7B F0 17                        	BEQ		.0004
  10531 00DA7D 42 BB AF 02 20 05            	LDA.UH	hTcbTmp
  10532 00DA83 42 AB 8F 02 C3 FE            	STA.H	TIMEOUT_LIST+2	; which task to remove
  10533 00DA89 A9 03 00 00 00               	LDA		#TOL_RMV		; remove command to timeout list
  10534 00DA8E 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST	; remove the task
  10535 00DA94                             .0004:
  10536 00DA94 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10537 00DA99 42 AB 99 0A 00               	STA.H	TCB_mbq_prev,Y
  10538 00DA9E 42 AB 99 08 00               	STA.H	TCB_mbq_next,Y
  10539 00DAA3 42 AB 99 28 00               	STA.H	TCB_hWaitMbx,Y
  10540 00DAA8 42 AB B9 2D 00               	LDA.H	TCB_status,Y
  10541 00DAAD 29 FB FF FF FF               	AND		#~TS_WAITMSG
  10542 00DAB2 42 AB 99 2D 00               	STA.H	TCB_status,Y
  10543 00DAB7 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10544 00DABD 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; .A = handle to TCB
                                           ; .X = mailbox
                                           ;----------------------------------------------------------------------------
                                           
  10551 00DABE                             QueueThreadAtMbx:
  10552 00DABE 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10553 00DAC4 42 AB 42 8E 04 20 05 00      	STX.H	hMbxTmp
                                         
  10554 00DACC 20 6A D9                     	JSR		hTcbToAddr
  10555 00DACF AA                           	TAX
  10556 00DAD0 42 8B B5 2D                  	LDA.B	TCB_status,X
  10557 00DAD4 09 04 00 00 00               	ORA		#TS_WAITMSG
  10558 00DAD9 42 8B 95 2D                  	STA.B	TCB_status,X
  10559 00DADD 42 AB 42 AE 04 20 05 00      	LDX.H	hMbxTmp
                                         
  10560 00DAE5 42 AB 95 28                  	STA.H	TCB_hWaitMbx,X
  10561 00DAE9 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10562 00DAEE 42 AB 95 08                  	STA.H	TCB_mbq_next,X
  10563 00DAF2 20 99 DE                     	JSR		LockSysSema
  10564 00DAF5 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10565 00DAFB 20 7A D9                     	JSR		hMbxToAddr
  10566 00DAFE A8                           	TAY
  10567 00DAFF B9 02 00                     	LDA		MBX_tq_head,Y
  10568 00DB02 10 23                        	BPL		.0001
  10569 00DB04 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10570 00DB09 42 AB 95 0A                  	STA.H	TCB_mbq_prev,X
  10571 00DB0D AF 02 20 05                  	LDA		hTcbTmp
  10572 00DB11 42 AB 99 02 00               	STA.H	MBX_tq_head,Y
  10573 00DB16 42 AB 99 04 00               	STA.H	MBX_tq_tail,Y
  10574 00DB1B A9 01 00 00 00               	LDA		#1
  10575 00DB20 42 AB 99 0C 00               	STA.H	MBX_tq_count,Y
  10576 00DB25 80 32                        	BRA		.0002
  10577 00DB27                             .0001:
  10578 00DB27 42 AB B9 04 00               	LDA.H	MBX_tq_tail,Y
  10579 00DB2C 42 AB 95 0A                  	STA.H	TCB_mbq_prev,X
  10580 00DB30 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10581 00DB36 42 AB 99 04 00               	STA.H	MBX_tq_tail,Y
  10582 00DB3B 42 AB B9 0C 00               	LDA.H	MBX_tq_count,Y
  10583 00DB40 1A                           	INA
  10584 00DB41 42 AB 99 0C 00               	STA.H	MBX_tq_count,Y
  10585 00DB46 42 AB B9 04 00               	LDA.H	MBX_tq_tail,Y
  10586 00DB4B 20 6A D9                     	JSR		hTcbToAddr
  10587 00DB4E AA                           	TAX
  10588 00DB4F 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10589 00DB55 42 AB 95 08                  	STA.H	TCB_mbq_next,X
  10590 00DB59                             .0002:
  10591 00DB59 20 9B DE                     	JSR		UnlockSysSema
  10592 00DB5C 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Allocate a mailbox
                                           ;	The default queue strategy is to queue the eight most recent messages.
                                           ; Parameters:
                                           ;	<none>
                                           ; Returns:
                                           ; .A = handle to mailbox (-1 = no mailbox available)
                                           ;----------------------------------------------------------------------------
                                           
                                           public FMTK_AllocMbx:
  10604 00DB5D 20 99 DE                     	JSR		LockSysSema
  10605 00DB60 42 AB AF 08 20 05            	LDA.H	freeMBX
  10606 00DB66 10 09                        	BPL		.0001
  10607 00DB68 20 9B DE                     	JSR		UnlockSysSema
  10608 00DB6B A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10609 00DB70 60                           	RTS
  10610 00DB71                             .0001:
  10611 00DB71 48                           	PHA
  10612 00DB72 20 7A D9                     	JSR		hMbxToAddr
  10613 00DB75 AA                           	TAX
  10614 00DB76 42 AB B5 00                  	LDA.H	MBX_link,X
  10615 00DB7A 42 AB 8F 08 20 05            	STA.H	freeMBX
  10616 00DB80 42 AB 42 CE 0E 20 05 00      	DEC.H	nMailbox
                                         
  10617 00DB88 20 9B DE                     	JSR		UnlockSysSema
  10618 00DB8B 20 56 DB                     	JSR		GetJCB
  10619 00DB8E 42 AB 95 01                  	STA.H	MBX_owner,X
  10620 00DB92 A9 FF FF FF FF               	LDA		#$FFFFFFFF
  10621 00DB97 42 AB 95 02                  	STA.H	MBX_tq_head,X
  10622 00DB9B 42 AB 95 04                  	STA.H	MBX_tq_tail,X
  10623 00DB9F 42 AB 95 06                  	STA.H	MBX_mq_head,X
  10624 00DBA3 42 AB 95 08                  	STA.H	MBX_mq_tail,X
  10625 00DBA7 42 AB 74 0C                  	STZ.H	MBX_tq_count,X
  10626 00DBAB 42 AB 74 0E                  	STZ.H	MBX_mq_count,X
  10627 00DBAF 42 AB 74 12                  	STZ.H	MBX_mq_missed,X
  10628 00DBB3 A9 08 00 00 00               	LDA		#8
  10629 00DBB8 42 AB 95 10                  	STA.H	MBX_mq_size,X
  10630 00DBBC A9 00 00 00 00               	LDA		#MQS_NEWEST
  10631 00DBC1 95 14                        	STA		MBX_mq_strategy,X
  10632 00DBC3 68                           	PLA
  10633 00DBC4 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; SendMsg
                                           ;
                                           ; Parameters:
                                           ;	.A = mailbox handle
                                           ;	D1  (on stack word)
                                           ;	D2  (on stack word)
                                           ;	D3	(on stack word)
                                           ;----------------------------------------------------------------------------
                                           
                                           public FMTK_SendMsg:
                                           public FMTK_PostMsg:
  10647 00DBC5 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10648 00DBCB 20 7A D9                     	JSR		hMbxToAddr
  10649 00DBCE 20 99 DE                     	JSR		LockSysSema
  10650 00DBD1 B5 01                        	LDA		MBX_owner,X
  10651 00DBD3 30 07                        	BMI		.notOwned
  10652 00DBD5 C9 00 04 00 00               	CMP		#NR_MBX
  10653 00DBDA 30 0B                        	BLT		.ownerOk
  10654 00DBDC                             .notOwned:
  10655 00DBDC 20 9B DE                     	JSR		UnlockSysSema
  10656 00DBDF A9 FF FF FF FF               	LDA		#E_NotAlloc
  10657 00DBE4 42 C0 0C                     	RTS		#12
  10658 00DBE7                             .ownerOk:
  10659 00DBE7 42 AB AF 0A 20 05            	LDA.H	freeMSG
  10660 00DBED 30 07                        	BMI		.noMsg
  10661 00DBEF C9 00 10 00 00               	CMP		#NR_MSG
  10662 00DBF4 30 0B                        	BLT		.msgOk
  10663 00DBF6                             .noMsg:
  10664 00DBF6 20 9B DE                     	JSR		UnlockSysSema
  10665 00DBF9 A9 FD FF FF FF               	LDA		#E_NoMoreMsgBlks
  10666 00DBFE 42 C0 0C                     	RTS		#12
  10667 00DC01                             .msgOk:
  10668 00DC01 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10669 00DC07 20 8A D9                     	JSR		hMsgToAddr
  10670 00DC0A AA                           	TAX
  10671 00DC0B B5 10                        	LDA		MSG_link,X
  10672 00DC0D 8F 0A 20 05                  	STA		freeMSG
  10673 00DC11 42 CE 0C 20 05 00            	DEC		nMsgBlk
  10674 00DC17 A9 00 00 00 00               	LDA		#MBT_DATA
  10675 00DC1C 42 8B 95 12                  	STA.B	MSG_type,X
  10676 00DC20 9B                           	TXY
  10677 00DC21 BA                           	TSX
  10678 00DC22 B5 03                        	LDA		3,X
  10679 00DC24 99 00 00                     	STA		MSG_d1,Y
  10680 00DC27 B5 07                        	LDA		7,X
  10681 00DC29 99 04 00                     	STA		MSG_d2,Y
  10682 00DC2C B5 0B                        	LDA		11,X
  10683 00DC2E 99 08 00                     	STA		MSG_d3,Y
  10684 00DC31 20 26 DA                     	JSR		DequeueThreadFromMbx
  10685 00DC34 20 9B DE                     	JSR		UnlockSysSema
  10686 00DC37 C9 00 00 00 00               	CMP		#0
  10687 00DC3C 10 14                        	BPL		.thrdOk
  10688 00DC3E 42 BB AF 04 20 05            	LDA.UH	hMbxTmp
  10689 00DC44 42 BB 42 AE 0A 20 05 00      	LDX.UH	freeMSG
                                         
  10690 00DC4C 20 9A D9                     	JSR		QueueMsg
  10691 00DC4F 42 C0 0C                     	RTS		#12
  10692 00DC52                             .thrdOk:
  10693 00DC52 8F 02 20 05                  	STA		hTcbTmp
  10694 00DC56 20 99 DE                     	JSR		LockSysSema
  10695 00DC59 20 6A D9                     	JSR		hTcbToAddr
  10696 00DC5C 42 8B B9 12 00               	LDA.B	MSG_type,Y
  10697 00DC61 42 8B 95 1E                  	STA.B	TCB_msg_type,X
  10698 00DC65 B9 00 00                     	LDA		MSG_d1,Y
  10699 00DC68 95 0C                        	STA		TCB_msg_d1,X
  10700 00DC6A B9 04 00                     	LDA		MSG_d2,Y
  10701 00DC6D 95 10                        	STA		TCB_msg_d2,X
  10702 00DC6F B9 08 00                     	LDA		MSG_d3,Y
  10703 00DC72 95 14                        	STA		TCB_msg_d3,X
  10704 00DC74 A9 01 00 00 00               	LDA		#MT_FREE
  10705 00DC79 99 12 00                     	STA		MSG_type,Y
  10706 00DC7C 42 AB AF 0A 20 05            	LDA.H	freeMSG
  10707 00DC82 42 AB 99 10 00               	STA.H	MSG_link,Y
  10708 00DC87 AF 06 20 05                  	LDA		hMsgTmp
  10709 00DC8B 8F 0A 20 05                  	STA		freeMSG
  10710 00DC8F 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10711 00DC95 20 6A D9                     	JSR		hTcbToAddr
  10712 00DC98 AA                           	TAX
  10713 00DC99 42 8B B5 2D                  	LDA.B	TCB_status,X
  10714 00DC9D 29 08 00 00 00               	AND		#TS_TIMEOUT
  10715 00DCA2 F0 17                        	BEQ		.noTimeout
  10716 00DCA4 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10717 00DCAA 42 AB 8F 02 C3 FE            	STA.H	TIMEOUT_LIST+2
  10718 00DCB0 A9 03 00 00 00               	LDA		#TOL_RMV
  10719 00DCB5 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST
  10720 00DCBB                             .noTimeout:
  10721 00DCBB 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10722 00DCC1 20 0F DF                     	JSR		InsertIntoReadyFifo		
  10723 00DCC4 20 9B DE                     	JSR		UnlockSysSema
  10724 00DCC7 A9 00 00 00 00               	LDA		#E_Ok
  10725 00DCCC 42 C0 0C                     	RTS		#12
                                           
                                           ;----------------------------------------------------------------------------
                                           ;	Wait for message. If timelimit is zero then the thread will wait
                                           ; indefinately for a message.
                                           ;
                                           ; Parameters:
                                           ;	.A = mailbox number
                                           ;	*d1 = pointer to where to store D1 (on stack)
                                           ;	*d2 = pointer to where to store D2 (on stack)
                                           ;	*d3 = pointer to where to store D3 (on stack)
                                           ;   TimeLimit = value on stack
                                           ;----------------------------------------------------------------------------
                                           
                                           public FMTK_WaitMsg:
  10740 00DCCF 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10741 00DCD5 20 7A D9                     	JSR		hMbxToAddr
  10742 00DCD8 20 99 DE                     	JSR		LockSysSema
  10743 00DCDB B5 01                        	LDA		MBX_owner,X
  10744 00DCDD 30 07                        	BMI		.notOwned
  10745 00DCDF C9 00 04 00 00               	CMP		#NR_MBX
  10746 00DCE4 30 0B                        	BLT		.ownerOk
  10747 00DCE6                             .notOwned:
  10748 00DCE6 20 9B DE                     	JSR		UnlockSysSema
  10749 00DCE9 A9 FF FF FF FF               	LDA		#E_NotAlloc
  10750 00DCEE 42 C0 10                     	RTS		#16
  10751 00DCF1                             .ownerOk:
  10752 00DCF1 AF 04 20 05                  	LDA		hMbxTmp
  10753 00DCF5 20 EC D9                     	JSR		DequeueMsg
  10754 00DCF8 20 9B DE                     	JSR		UnlockSysSema
  10755 00DCFB C9 00 00 00 00               	CMP		#0
  10756 00DD00 10 FF 77 00                  	LBPL	.gotMsg
  10757 00DD04 20 99 DE                     	JSR		LockSysSema
  10758 00DD07 42 1A                        	TTA
  10759 00DD09 48                           	PHA
  10760 00DD0A 20 6A D9                     	JSR		hTcbToAddr
  10761 00DD0D AA                           	TAX
  10762 00DD0E 74 2D                        	STZ		TCB_status,X	; remove thread from ready list
  10763 00DD10 20 9B DE                     	JSR		UnlockSysSema
  10764 00DD13 20 BE DA                     	JSR		QueueThreadAtMbx
  10765 00DD16 BA                           	TSX
  10766 00DD17 B5 0F                        	LDA		15,X			; .A = time limit param
  10767 00DD19 F0 1E                        	BEQ		.noTimelimit
  10768 00DD1B 20 99 DE                     	JSR		LockSysSema
  10769 00DD1E 8F 00 C3 FE                  	STA		TIMEOUT_LIST + 4
  10770 00DD22 68                           	PLA
  10771 00DD23 42 AB 8F 00 C3 FE            	STA.H	TIMEOUT_LIST + 2
  10772 00DD29 A9 02 00 00 00               	LDA		#TOL_INS
  10773 00DD2E 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST
  10774 00DD34 20 9B DE                     	JSR		UnlockSysSema
  10775 00DD37 80 01                        	BRA		.0001
  10776 00DD39                             .noTimelimit:
  10777 00DD39 68                           	PLA
  10778 00DD3A                             .0001:
  10779 00DD3A 42 20 12 FE FD               	JCR		$FE12,$FD		; invoke scheduler
                                           	; Control will return here as a result of a SendMsg or timeout
  10781 00DD3F 42 1A                        	TTA
  10782 00DD41 20 6A D9                     	JSR		hTcbToAddr
  10783 00DD44 AA                           	TAX
  10784 00DD45 B5 1E                        	LDA		TCB_msg_type,X
  10785 00DD47 C9 00 00 00 00               	CMP		#MT_NONE
  10786 00DD4C D0 08                        	BNE		.0002
  10787 00DD4E A9 FE FF FF FF               	LDA		#E_NoMsg
  10788 00DD53 42 C0 10                     	RTS		#16
  10789 00DD56                             .0002:
  10790 00DD56 A9 00 00 00 00               	LDA		#MT_NONE
  10791 00DD5B 42 8B 95 1E                  	STA.B	TCB_msg_type,X
  10792 00DD5F A0 00 00 00 00               	LDY		#0
  10793 00DD64 B5 0C                        	LDA		TCB_msg_d1,X
  10794 00DD66 42 93 03                     	STA		{3,S},Y
  10795 00DD69 B5 10                        	LDA		TCB_msg_d2,X
  10796 00DD6B 42 93 07                     	STA		{7,S},Y
  10797 00DD6E B5 14                        	LDA		TCB_msg_d3,X
  10798 00DD70 42 93 0B                     	STA		{11,S},Y
  10799 00DD73 A9 00 00 00 00               	LDA		#E_Ok
  10800 00DD78 42 C0 10                     	RTS		#16
                                           	;-----------------------------------------------------
                                           	; We get here if there was initially a message
                                           	; available in the mailbox, or a message was made
                                           	; available after a task switch.
                                           	;-----------------------------------------------------
  10806 00DD7B                             .gotMsg:
  10807 00DD7B 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10808 00DD81 20 8A D9                     	JSR		hMsgToAddr
  10809 00DD84 AA                           	TAX
  10810 00DD85 B5 00                        	LDA		MSG_d1,X
  10811 00DD87 A0 00 00 00 00               	LDY		#0
  10812 00DD8C 42 93 03                     	STA		{3,S},Y
  10813 00DD8F B5 04                        	LDA		MSG_d2,X
  10814 00DD91 42 93 07                     	STA		{7,S},Y
  10815 00DD94 B5 08                        	LDA		MSG_d3,X
  10816 00DD96 42 93 0B                     	STA		{11,S},Y
  10817 00DD99 20 99 DE                     	JSR		LockSysSema
  10818 00DD9C A9 01 00 00 00               	LDA		#MT_FREE
  10819 00DDA1 42 8B 95 12                  	STA.B	MSG_type,X
  10820 00DDA5 42 AB AF 0A 20 05            	LDA.H	freeMSG
  10821 00DDAB 42 AB 95 10                  	STA.H	MSG_link,X
  10822 00DDAF 42 AB AF 06 20 05            	LDA.H	hMsgTmp
  10823 00DDB5 42 AB 8F 0A 20 05            	STA.H	freeMSG
  10824 00DDBB 42 AB 42 EE 0C 20 05 00      	INC.H	nMsgBlk
                                         
  10825 00DDC3 20 9B DE                     	JSR		UnlockSysSema
  10826 00DDC6 A9 00 00 00 00               	LDA		#E_Ok
  10827 00DDCB 42 C0 10                     	RTS		#16
                                           
                                           ;----------------------------------------------------------------------------
                                           ; FMTK_CheckMsg(hMbx,int *d1, int *d2, int *d3, int qrmv);
                                           ;
                                           ;		Check for message at mailbox. If no message is
                                           ;	available return immediately to the caller (CheckMsg() is
                                           ;	non blocking). Optionally removes the message from the
                                           ;	mailbox.
                                           ;
                                           ; Parameters:
                                           ;	.A = handle to mailbox
                                           ;	d1 = address to store d1 in (word on stack)
                                           ;	d2 = address to store d2 in (word on stack)
                                           ;	d3 = address to store d3 in (word on stack)
                                           ;	qrmv = 1=remove message from queue (word on stack)
                                           ;----------------------------------------------------------------------------
                                           
                                           public FMTK_CheckMsg:
  10846 00DDCE 42 AB 8F 04 20 05            	STA.H	hMbxTmp
  10847 00DDD4 20 7A D9                     	JSR		hMbxToAddr
  10848 00DDD7 20 99 DE                     	JSR		LockSysSema
  10849 00DDDA B5 01                        	LDA		MBX_owner,X
  10850 00DDDC 30 07                        	BMI		.notOwned
  10851 00DDDE C9 00 04 00 00               	CMP		#NR_MBX
  10852 00DDE3 30 0B                        	BLT		.ownerOk
  10853 00DDE5                             .notOwned:
  10854 00DDE5 20 9B DE                     	JSR		UnlockSysSema
  10855 00DDE8 A9 FF FF FF FF               	LDA		#E_NotAlloc
  10856 00DDED 42 C0 10                     	RTS		#16
  10857 00DDF0                             .ownerOk:
  10858 00DDF0 BA                           	TSX
  10859 00DDF1 B5 0F                        	LDA		15,X
  10860 00DDF3 F0 0B                        	BEQ		.0001
  10861 00DDF5 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10862 00DDFB 20 EC D9                     	JSR		DequeueMsg
  10863 00DDFE 80 0C                        	BRA		.0002
  10864 00DE00                             .0001:
  10865 00DE00 42 AB AF 04 20 05            	LDA.H	hMbxTmp
  10866 00DE06 20 7A D9                     	JSR		hMbxToAddr
  10867 00DE09 AA                           	TAX
  10868 00DE0A B5 06                        	LDA		MBX_mq_head,X
  10869 00DE0C                             .0002:
  10870 00DE0C 20 9B DE                     	JSR		UnlockSysSema
  10871 00DE0F C9 00 00 00 00               	CMP		#0
  10872 00DE14 10 08                        	BPL		.gotMsg
  10873 00DE16 A9 FE FF FF FF               	LDA		#E_NoMsg
  10874 00DE1B 42 C0 10                     	RTS		#16
  10875 00DE1E                             .gotMsg:
  10876 00DE1E 42 AB 8F 06 20 05            	STA.H	hMsgTmp
  10877 00DE24 20 8A D9                     	JSR		hMsgToAddr
  10878 00DE27 AA                           	TAX
  10879 00DE28 A0 00 00 00 00               	LDY		#0
  10880 00DE2D B5 00                        	LDA		MSG_d1,X
  10881 00DE2F 42 93 03                     	STA		{3,S},Y
  10882 00DE32 B5 04                        	LDA		MSG_d2,X
  10883 00DE34 42 93 07                     	STA		{7,S},Y
  10884 00DE37 B5 08                        	LDA		MSG_d3,X
  10885 00DE39 42 93 0B                     	STA		{11,S},Y
  10886 00DE3C DA                           	PHX
  10887 00DE3D BA                           	TSX
  10888 00DE3E B5 0F                        	LDA		15,X
  10889 00DE40 F0 30                        	BEQ		.noRmv
  10890 00DE42 20 99 DE                     	JSR		LockSysSema
  10891 00DE45 FA                           	PLX
  10892 00DE46 A9 01 00 00 00               	LDA		#MT_FREE
  10893 00DE4B 42 8B 95 12                  	STA.B	MSG_type,X
  10894 00DE4F 42 AB AF 0A 20 05            	LDA.H	freeMSG
  10895 00DE55 42 AB 95 10                  	STA.H	MSG_link,X
  10896 00DE59 42 AB AF 06 20 05            	LDA.H	hMsgTmp
  10897 00DE5F 42 AB 8F 0A 20 05            	STA.H	freeMSG
  10898 00DE65 42 AB 42 EE 0C 20 05 00      	INC.H	nMsgBlk
                                         
  10899 00DE6D 20 9B DE                     	JSR		UnlockSysSema
  10900 00DE70 80 01                        	BRA		.0003
  10901 00DE72                             .noRmv:
  10902 00DE72 FA                           	PLX
  10903 00DE73                             .0003:
  10904 00DE73 A9 00 00 00 00               	LDA		#E_Ok
  10905 00DE78 42 C0 10                     	RTS		#16
                                           
                                           ;----------------------------------------------------------------------------
                                           ; PeekMsg(hMbx,int *d1, int *d2, int *d3);
                                           ;
                                           ; Checks for a message without removing it from the queue.
                                           ;----------------------------------------------------------------------------
                                           
                                           public FMTK_PeekMsg:
  10914 00DE7B 8F 04 20 05                  	STA		hMbxTmp
  10915 00DE7F A9 00 00 00 00               	LDA		#0
  10916 00DE84 48                           	PHA
  10917 00DE85 BA                           	TSX
  10918 00DE86 B5 0B                        	LDA		11,X
  10919 00DE88 48                           	PHA
  10920 00DE89 B5 0B                        	LDA		11,X
  10921 00DE8B 48                           	PHA
  10922 00DE8C B5 0B                        	LDA		11,X
  10923 00DE8E 48                           	PHA
  10924 00DE8F AF 04 20 05                  	LDA		hMbxTmp
  10925 00DE93 20 CE DD                     	JSR		FMTK_CheckMsg
  10926 00DE96 42 C0 0C                     	RTS		#12
                                           
Finitron FT832 assembler   version 1.4   Sat Jun 03 20:11:31 2017     Page 1
FTBios816.asm


                                           .include "FMTKmsg.asm"
                                           
                                           	MEM		32
                                           	NDX		32
                                           
  10932 00DE99                             LockSysSema:
  10933 00DE99 78                           	SEI
  10934 00DE9A 60                           	RTS
  10935 00DE9B                             UnlockSysSema:
  10936 00DE9B 58                           	CLI
  10937 00DE9C 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; SelectTaskToRun:
                                           ;
                                           ; Selects a task to run from the ready fifo. The ready fifo is really a 
                                           ; group of fifos, one each for a priority group. Priority groups are
                                           ; priorities of: $0x, $1x, $2x, $3x, $4x
                                           ;
                                           ; Returns
                                           ;	.A = task number to run
                                           ; Modifies:
                                           ;	.X, .Y, and flags
                                           ;----------------------------------------------------------------------------
                                           
  10952 00DE9D                             StartQ:
  10953 00DE9D 00 01 00 02 00 03 00 04      	.byte	0,1,0,2,0,3,0,4,0,1,0,2,0,3,0,4
  10953 00DEA5 00 01 00 02 00 03 00 04    
                                         
                                           
  10955 00DEAD                             SelectTaskToRun:
  10956 00DEAD A9 04 00 00 00               	LDA		#4
  10957 00DEB2 42 8B 85 CC                  	STA.B	qcnt
  10958 00DEB6 42 8B A5 04                  	LDA.B	TickCount		; vary the starting queue to check
  10959 00DEBA 29 0F 00 00 00               	AND		#$0F			; based on the tick count
  10960 00DEBF A8                           	TAY
  10961 00DEC0 42 8B B9 9D DE               	LDA.B	StartQ,Y
  10962 00DEC5 0A                           	ASL
  10963 00DEC6 AA                           	TAX
  10964 00DEC7                             .nextQ:
  10965 00DEC7                             .notReady:
  10966 00DEC7 42 AB BF 10 C2 FE            	LDA.H	READY_FIFO_CNT,X	; get count of ready tasks in fifo
  10967 00DECD F0 29                        	BEQ		.fifoEmpty
  10968 00DECF 42 AB BF 00 C2 FE            	LDA.H	READY_FIFO,X	; get ready task from fifo
  10969 00DED5 42 AB 8F 02 20 05            	STA.H	hTcbTmp
  10970 00DEDB 20 6A D9                     	JSR		hTcbToAddr
  10971 00DEDE A8                           	TAY
  10972 00DEDF 42 8B B9 2D 00               	LDA.B	TCB_status,Y	; check the status and make sure it's ready
  10973 00DEE4 89 03 00 00 00               	BIT		#TS_READY|TS_PREEMPT
  10974 00DEE9 F0 DC                        	BEQ		.notReady
  10975 00DEEB 42 AB AF 02 20 05            	LDA.H	hTcbTmp
  10976 00DEF1 42 AB 9F 00 C2 FE            	STA.H	READY_FIFO,X	; add back to fifo as last entry
  10977 00DEF7 60                           	RTS
                                           
                                           	; move to the next queue
  10980 00DEF8                             .fifoEmpty:
  10981 00DEF8 E8                           	INX
  10982 00DEF9 E8                           	INX
  10983 00DEFA E0 0A 00 00 00               	CPX		#10
  10984 00DEFF 30 05                        	BLT		.0001
  10985 00DF01 A2 00 00 00 00               	LDX		#0				; cycle back around to first Q
  10986 00DF06                             .0001:
  10987 00DF06 42 8B C6 CC                  	DEC.B	qcnt
  10988 00DF0A D0 BB                        	BNE		.nextQ
  10989 00DF0C 42 1A                        	TTA						; if all queues empty, keep running the current
  10990 00DF0E 60                           	RTS
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Insert task into ready fifo.
                                           ;
                                           ; If the task has a bad priority setting then it's added as a lowest
                                           ; priority task, priority zero. It's desired for the task to run even if
                                           ; the priority is screwy.
                                           ;
                                           ; Parameters:
                                           ;	.A = handle to TCB
                                           ; Modifies:
                                           ;	.X = priority queue index
                                           ;----------------------------------------------------------------------------
                                           
  11005 00DF0F                             InsertIntoReadyFifo:
  11006 00DF0F 48                           	PHA
  11007 00DF10 20 6A D9                     	JSR		hTcbToAddr
  11008 00DF13 AA                           	TAX							; .X = task number (index into tables)
  11009 00DF14 A9 01 00 00 00               	LDA		#TS_READY			; set task status to ready
  11010 00DF19 42 8B 95 2D                  	STA.B	TCB_status,X
  11011 00DF1D 42 8B B5 2C                  	LDA.B	TCB_priority,X		; get the priority
  11012 00DF21 4A                           	LSR							; use upper nybble to identify priority que
  11013 00DF22 4A                           	LSR
  11014 00DF23 4A                           	LSR
  11015 00DF24 4A                           	LSR
  11016 00DF25 C9 04 00 00 00               	CMP		#4					; valid priority ?
  11017 00DF2A 42 B0 05                     	BLE		.0001
  11018 00DF2D A9 00 00 00 00               	LDA		#0
  11019 00DF32                             .0001:
  11020 00DF32 0A                           	ASL
  11021 00DF33 AA                           	TAX
  11022 00DF34 68                           	PLA
  11023 00DF35 42 AB 9F 00 C2 FE            	STA.H	READY_FIFO,X
  11024 00DF3B 60                           	RTS
                                           
                                           ; IRQ routine for all modes. The interrupted task must of had interrupts
                                           ; enabled and this status should be saved on the stack with the value of
                                           ; the status register. The RTI instruction will pop the status register off
                                           ; the stack and restore the interrupt enable.
                                           ; Note that all this routine does is switch to a task which has a different
                                           ; register set, so there's no need to stack and restore registers. The
                                           ; task switch also allows the routine to be located anywhere in the memory
                                           ; system, so we don't have to worry about using up bank 0 memory.
                                           
  11035 00DF3C                             IRQRout832:
  11036 00DF3C                             IRQRout816:
  11037 00DF3C                             IRQRout02:
  11038 00DF3C 42 A2 01 00                  	TSK		#1			; switch to the interrupt handling task
  11039 00DF40 40                           	RTI
                                           
                                           ;----------------------------------------------------------------------------
                                           ; Select a task to run from the ready queue.
                                           ; Called by some OS primitives
                                           ; Even if the task was preempted a regular RTT instruction is used to
                                           ; return. This is because this function was called via JCR.
                                           ;----------------------------------------------------------------------------
                                           
  11048 00DF41                             ScheduleTask:
  11049 00DF41 08                           	PHP						; 832 mode will push 2 bytes
  11050 00DF42 78                           	SEI
                                           	; update the number of tick the task has been running.
  11052 00DF43 AF 00 20 05                  	LDA		running_task	; get currently running task
  11053 00DF47 20 6A D9                     	JSR		hTcbToAddr		; get address from handle
  11054 00DF4A AA                           	TAX
  11055 00DF4B A5 04                        	LDA		TickCount		; get the tick count
  11056 00DF4D 95 34                        	STA		TCB_end_tick,X	; store it in end ticks
  11057 00DF4F 38                           	SEC
  11058 00DF50 F5 30                        	SBC		TCB_start_tick,X; subtract off the latest starting tick
  11059 00DF52 18                           	CLC						; to get the difference 
  11060 00DF53 75 38                        	ADC		TCB_ticks,X		; ticks = ticks + (end tick - start tick)
  11061 00DF55 95 38                        	STA		TCB_ticks,X
  11062 00DF57 20 AD DE                     	JSR		SelectTaskToRun
  11063 00DF5A BA                           	TSX
  11064 00DF5B 42 AB 95 03                  	STA.H	$3,X			; change return task # on stack
  11065 00DF5F 42 AB 8F 00 20 05            	STA.H	running_task
  11066 00DF65 20 6A D9                     	JSR		hTcbToAddr		; handle to address
  11067 00DF68 AA                           	TAX
  11068 00DF69 A9 01 00 00 00               	LDA		#TS_READY		; reset task status to ready
  11069 00DF6E 42 8B 95 2D                  	STA.B	TCB_status,X
  11070 00DF72 A5 04                        	LDA		TickCount		; get the tick count
  11071 00DF74 95 30                        	STA		TCB_start_tick,X	; update starting tick
  11072 00DF76 28                           	PLP						; restore interrupt mask
  11073 00DF77 42 60                        	RTT						; return
  11074 00DF79 80 C6                        	BRA		ScheduleTask
                                           
                                           ;----------------------------------------------------------------------------
                                           ; This task has interrupts masked in it's startup record and therefore runs
                                           ; with interrupts masked as the task never enables interrupts. Note that it's
                                           ; important that interrupts are masked while this is running, otherwise the
                                           ; uncleared interrupt status would cause another interrupt resulting in an
                                           ; infinite interrupt loop.
                                           ;
                                           ; This task always needs to return using a RTI in order to keep the internal
                                           ; IRQ state stack in sync.
                                           ;----------------------------------------------------------------------------
  11086 00DF7B                             Task1:
                                           	; Counter #1 is set to interrupt at a 50Hz rate
                                           ;	LDA		#$2A	;94		; divide by 95794 (for 50Hz)
                                           ;	STA.B	CTR1_LMT		; FFFFFE = 2Hz with 33MHz clock
                                           ;	LDA		#$2C	;57		; 
                                           ;	STA.B	CTR1_LMT+1
                                           ;	LDA		#$0A	;09
                                           ;	STA.B	CTR1_LMT+2
                                           ;	LDA		#$05		; count down, on mpu clock, irq disenabled
                                           ;	STA.B	CTR1_CTRL
                                           ;	RTT					; falls through on next task activation
                                           
  11098 00DF7B                             TimeSliceIRQ:
  11099 00DF7B 42 8B AD 1F B0               	LDA.B	MPU_IRQ_STATUS	; check if counter expired
  11100 00DF80 89 02 00 00 00               	BIT		#2				; counter #1 IRQ active bit
  11101 00DF85 F0 FF 87 00                  	LBEQ	.notTimeSlice	; no IRQ ?
                                           
                                           	; update the tick count
  11104 00DF89 A5 04                        	LDA		TickCount		; increment the tick count
  11105 00DF8B 1A                           	INA						; lower 16 bits
  11106 00DF8C 85 04                        	STA		TickCount
  11107 00DF8E 42 3B FF 0F 42 8B 8F A4      	STA.B	$FFF:$D00A4		; update on-screen IRQ live indicator
  11107 00DF96 00 0D                      
                                           
                                           	; clear the IRQ source
  11110 00DF98 A9 05 00 00 00               	LDA		#$05			; count down, on mpu clock, irq enabled (clears irq)
  11111 00DF9D 42 8B 8D 17 B0               	STA.B	CTR1_CTRL		; set control register clearing interrupt
                                           
                                           	; Set flag for EhBASIC Irq
  11114 00DFA2 42 8B AF DF 00 01            	LDA.B	$100DF		
  11115 00DFA8 09 20 00 00 00               	ORA		#$20
  11116 00DFAD 42 8B 8F DF 00 01            	STA.B	$100DF
                                           	
                                           	; and set the task status to PREEMPT
  11119 00DFB3 42 AB AF 00 20 05            	LDA.H	running_task
  11120 00DFB9 20 6A D9                     	JSR		hTcbToAddr		; get address from handle
  11121 00DFBC AA                           	TAX
  11122 00DFBD A5 04                        	LDA		TickCount		; get the tick count
  11123 00DFBF 95 34                        	STA		TCB_end_tick,X	; store it in end ticks
  11124 00DFC1 38                           	SEC
  11125 00DFC2 F5 30                        	SBC		TCB_start_tick,X; subtract off the latest starting tick
  11126 00DFC4 18                           	CLC						; to get the difference 
  11127 00DFC5 75 38                        	ADC		TCB_ticks,X		; ticks = ticks + (end tick - start tick)
  11128 00DFC7 95 38                        	STA		TCB_ticks,X
  11129 00DFC9 A9 02 00 00 00               	LDA		#TS_PREEMPT
  11130 00DFCE 42 8B 95 2D                  	STA.B	TCB_status,X	; set status of outgoing task to PREEMPT
                                           
                                           	; take care of the timeout list
  11133 00DFD2                             .nextTo:
  11134 00DFD2 A9 01 00 00 00               	LDA		#TOL_DEC		; .A = decrement command #
  11135 00DFD7 42 8B 8F 00 C3 FE            	STA.B	TIMEOUT_LIST	; decrement the timeout list
  11136 00DFDD EA                           	NOP						; might take up to 3 clock cycles
  11137 00DFDE EA                           	NOP
  11138 00DFDF 42 AB AF 02 C3 FE            	LDA.H	TIMEOUT_LIST+2	; get any timedout task
  11139 00DFE5 30 05                        	BMI		.noMoreTos
  11140 00DFE7 20 0F DF                     	JSR		InsertIntoReadyFifo	; placed timedout task on ready list
  11141 00DFEA 80 E6                        	BRA		.nextTo
                                           
                                           	; Switch to the next task to run
  11144 00DFEC                             .noMoreTos:
  11145 00DFEC 42 8B A5 D0                  	LDA.B	TaskSwitchEn	; only switch tasks if enabled
  11146 00DFF0 F0 1A                        	BEQ		.0001
  11147 00DFF2 20 AD DE                     	JSR		SelectTaskToRun
  11148 00DFF5 BA                           	TSX
  11149 00DFF6 42 AB B4 01                  	LDY.H	$1,X			; .Y = outgoing task
  11150 00DFFA 42 AB 95 01                  	STA.H	$1,X			; change return task # on stack
  11151 00DFFE 42 AB 8F 00 20 05            	STA.H	running_task	; update running task var
  11152 00E004 20 6A D9                     	JSR		hTcbToAddr		; convert task handle to address
  11153 00E007 AA                           	TAX
  11154 00E008 A5 04                        	LDA		TickCount		; update starting tick for task
  11155 00E00A 95 30                        	STA		TCB_start_tick,X
  11156 00E00C                             .0001:
  11157 00E00C 40                           	RTI						; return from interrupt
  11158 00E00D 82 6B FF                     	BRL		TimeSliceIRQ	; the next time task1 is run it will start here
                                           
                                           ; We get here if it wasn't a timeslice interrupt. There still might be other
                                           ; devices tied to the same IRQ line which need servicing.
                                           
  11163 00E010                             .notTimeSlice:
  11164 00E010 A2 00 00 00 00               	LDX		#0
  11165 00E015                             .0002:
  11166 00E015 BF 10 20 05                  	LDA		IRQ1Hook,X		; get the hook pointer
  11167 00E019 F0 04                        	BEQ		.noHook			; check if valid
  11168 00E01B DA                           	PHX						; save off .X
  11169 00E01C 42 80                        	JCI						; call the hook routine
  11170 00E01E FA                           	PLX						; restore .X
  11171 00E01F                             .noHook:
  11172 00E01F 42 E8                        	INX4					; move to next hook
  11173 00E021 E0 60 7E 03 00               	CPX		#MAX_IRQ_HOOKS*4
  11174 00E026 D0 ED                        	BNE		.0002			; last allowed hook ?
  11175 00E028 40                           	RTI
  11176 00E029 82 4F FF                     	BRL		TimeSliceIRQ	; the next time task1 is run it will start here
                                           
                                           ;============================================================================
                                           ; End Of Multi-tasking kernel
                                           ;============================================================================
                                           
                                           	MEM		16
                                           	NDX		16
  11184 00E02C                             BtnuIRQ:
  11185 00E02C 42 3B FF 0F 42 8B AF A0      	LDA.B	$FFF:$D00A0
  11185 00E034 00 0D                      
  11186 00E036 1A                           	INA
  11187 00E037 42 3B FF 0F 42 8B 8F A0      	STA.B	$FFF:$D00A0
  11187 00E03F 00 0D                      
                                           ;	JSR		spi_master_init
                                           ;	CMP		#0
                                           ;	BNE		.0001
                                           ;	LDX		#0
                                           ;.0002:
                                           ;	PEA		$000F
                                           ;	TXA
                                           ;	XBA
                                           ;	ASL
                                           ;	PHA
                                           ;	PEA		0
                                           ;	PEA		0
                                           ;	STX		reg_x
                                           ;	JSR		spi_master_read
                                           ;	LDX		reg_x
                                           ;	INX
                                           ;	CPX		#128
                                           ;	BNE		.0002
                                           ;.0001:
  11207 00E041 40                           	RTI
  11208 00E042 80 E8                        	BRA		BtnuIRQ
                                           
                                           ; IRQ handler task - 32 bit
                                           ;
  11212 00E044                             IRQTask:
                                           	MEM		8
                                           	NDX		32
  11215 00E044                             IRQTask1:
  11216 00E044 AD 1F B0                     	LDA		MPU_IRQ_STATUS	; check if counter expired
  11217 00E047 89 02                        	BIT		#2
  11218 00E049 F0 16                        	BEQ		.0001
  11219 00E04B A6 04                        	LDX		TickCount		; increment the tick count
  11220 00E04D E8                           	INX
  11221 00E04E 86 04                        	STX		TickCount
  11222 00E050 42 3B FF 0F 42 8B 42 8E      	STX.B	$FFF:$D00A2			; update on-screen IRQ live indicator
  11222 00E058 A2 00 0D 00                
  11223 00E05C A9 05                        	LDA		#$05			; count down, on mpu clock, irq enabled (clears irq)
  11224 00E05E 8D 17 B0                     	STA		CTR1_CTRL
  11225 00E061                             .0001:
  11226 00E061 42 60                        	RTT					; go back to interrupted task
  11227 00E063 80 DF                        	BRA		IRQTask1	; the next time task is run it will start here
                                           
                                           ; This little task sample runs in native 32 bit mode and displays
                                           ; "Hello World!" on the screen.
                                           
                                           	CPU		FT832
                                           	MEM		8
                                           	NDX		32
                                           
  11236 00E065                             Task2:
  11237 00E065 A2 F8 01 00 00               	LDX		#84*2*3
  11238 00E06A                             .0003:
  11239 00E06A A0 00 00 00 00               	LDY		#0
  11240 00E06F                             .0002:
  11241 00E06F 42 1B B9 8A E0               	LDA		CS:msgHelloWorld,Y
  11242 00E074 F0 10                        	BEQ		.0001
  11243 00E076 20 E1 CA                     	JSR		AsciiToScreen8
  11244 00E079 42 3B FF 0F 9F 00 00 0D      	STA		$FFF:VIDBUF,X
                                         
  11245 00E081 E8                           	INX
  11246 00E082 E8                           	INX
  11247 00E083 C8                           	INY
  11248 00E084 80 E9                        	BRA		.0002
  11249 00E086                             .0001:
  11250 00E086 42 60                        	RTT
  11251 00E088 80 E0                        	BRA		.0003
                                           
  11253 00E08A                             msgHelloWorld:
  11254 00E08A 0D 0A 48 65 6C 6C 6F 20      	.byte	CR,LF,"Hello World!",CR,LF,0
  11254 00E092 57 6F 72 6C 64 21 0D 0A    
  11254 00E09A 00                         
                                           
                                           	NDX		16
                                           	MEM		16
                                           
  11259 00E09B                             BrkTask:
  11260 00E09B 42 EE 00 00 D0 FF            	INC		$FFD00000
  11261 00E0A1 42 60                        	RTT
  11262 00E0A3 80 F6                        	BRA		BrkTask
                                           
                                           ; The following store sequence for the benefit of Supermon816
                                           ;
  11266 00E0A5                             BrkRout:
  11267 00E0A5 0B                           	PHD
  11268 00E0A6 8B                           	PHB
  11269 00E0A7 C2 30                        	REP		#$30
  11270 00E0A9 48                           	PHA
  11271 00E0AA DA                           	PHX
  11272 00E0AB 5A                           	PHY
  11273 00E0AC 6C 02 01                     	JMP		($0102)		; This jump normally points to BrkRout1
                                           
  11275 00E0AF                             BrkRout1:
  11276 00E0AF C2 30                        	REP		#$30
  11277 00E0B1 7A                           	PLY
  11278 00E0B2 FA                           	PLX
  11279 00E0B3 68                           	PLA
  11280 00E0B4 AB                           	PLB
  11281 00E0B5 2B                           	PLD
  11282 00E0B6 E2 20                        	SEP		#$20
  11283 00E0B8 68                           	PLA
  11284 00E0B9 C2 30                        	REP		#$30
  11285 00E0BB 68                           	PLA
  11286 00E0BC 20 CA CD                     	JSR		DispWord
  11287 00E0BF A2 00 00                     	LDX		#0
  11288 00E0C2 A0 40 00                     	LDY		#64
  11289 00E0C5                             .0001:
  11290 00E0C5 42 F0                        	.word	$f042		; pchist
  11291 00E0C7 20 CA CD                     	JSR		DispWord
  11292 00E0CA A9 20 00                     	LDA		#' '
  11293 00E0CD 20 EA CC                     	JSR		OutChar
  11294 00E0D0 E8                           	INX
  11295 00E0D1 88                           	DEY
  11296 00E0D2 D0 F1                        	BNE		.0001
  11297 00E0D4 A9 FF FF                     	LDA		#$FFFF
  11298 00E0D7 8D 00 70                     	STA		$7000
  11299 00E0DA                             Hung:
  11300 00E0DA 80 FE                        	BRA		Hung
                                           
                                           	;--------------------------------------------------------
                                           	;--------------------------------------------------------
                                           	; I/O page is located at $F0xx
                                           	;--------------------------------------------------------
                                           	;--------------------------------------------------------	
                                           	;org		$F100
                                           
  11309 00E0DC                             LineTbl:
  11310 00E0DC 00 00                        	.WORD	0
  11311 00E0DE 54 00                        	.WORD	TEXTCOLS
  11312 00E0E0 A8 00                        	.WORD	TEXTCOLS*2
  11313 00E0E2 FC 00                        	.WORD	TEXTCOLS*3
  11314 00E0E4 50 01                        	.WORD	TEXTCOLS*4
  11315 00E0E6 A4 01                        	.WORD	TEXTCOLS*5
  11316 00E0E8 F8 01                        	.WORD	TEXTCOLS*6
  11317 00E0EA 4C 02                        	.WORD	TEXTCOLS*7
  11318 00E0EC A0 02                        	.WORD	TEXTCOLS*8
  11319 00E0EE F4 02                        	.WORD	TEXTCOLS*9
  11320 00E0F0 48 03                        	.WORD	TEXTCOLS*10
  11321 00E0F2 9C 03                        	.WORD	TEXTCOLS*11
  11322 00E0F4 F0 03                        	.WORD	TEXTCOLS*12
  11323 00E0F6 44 04                        	.WORD	TEXTCOLS*13
  11324 00E0F8 98 04                        	.WORD	TEXTCOLS*14
  11325 00E0FA EC 04                        	.WORD	TEXTCOLS*15
  11326 00E0FC 40 05                        	.WORD	TEXTCOLS*16
  11327 00E0FE 94 05                        	.WORD	TEXTCOLS*17
  11328 00E100 E8 05                        	.WORD	TEXTCOLS*18
  11329 00E102 3C 06                        	.WORD	TEXTCOLS*19
  11330 00E104 90 06                        	.WORD	TEXTCOLS*20
  11331 00E106 E4 06                        	.WORD	TEXTCOLS*21
  11332 00E108 38 07                        	.WORD	TEXTCOLS*22
  11333 00E10A 8C 07                        	.WORD	TEXTCOLS*23
  11334 00E10C E0 07                        	.WORD	TEXTCOLS*24
  11335 00E10E 34 08                        	.WORD	TEXTCOLS*25
  11336 00E110 88 08                        	.WORD	TEXTCOLS*26
  11337 00E112 DC 08                        	.WORD	TEXTCOLS*27
  11338 00E114 30 09                        	.WORD	TEXTCOLS*28
  11339 00E116 84 09                        	.WORD	TEXTCOLS*29
  11340 00E118 D8 09                        	.WORD	TEXTCOLS*30
                                           
  11342 00E11A                             TaskStartTbl:
  11343 00E11A 00 00                        	.WORD	0			; CS
  11344 00E11C 00 00                        	.WORD	0			; DS
  11345 00E11E 00 00                        	.WORD	0			; SS
  11346 00E120 C2 C0                        	.WORD	Task0		; PC
  11347 00E122 00                           	.BYTE	Task0>>16	; PB
  11348 00E123 00 00                        	.WORD	0			; acc
  11349 00E125 00 00                        	.WORD	0
  11350 00E127 00 00                        	.WORD	0			; x
  11351 00E129 00 00                        	.WORD	0
  11352 00E12B 00 00                        	.WORD	0			; y
  11353 00E12D 00 00                        	.WORD	0
  11354 00E12F FF 3F                        	.WORD	$3FFF		; sp
  11355 00E131 00 00                        	.WORD	0
  11356 00E133 04                           	.BYTE	4			; SR	( 16 bit regs )
  11357 00E134 01                           	.BYTE	1			; SR extension ( 16 bit mode)
  11358 00E135 00                           	.BYTE	0			; DB
  11359 00E136 00 00                        	.WORD	0			; DPR
  11360 00E138 00 00                        	.WORD	0
                                           
                                           	; TASK #1
                                           	; Interrupt handler task
  11364 00E13A 00 00                        	.WORD	0			; CS
  11365 00E13C 05 00                        	.WORD	5			; DS
  11366 00E13E 05 00                        	.WORD	5			; SS
  11367 00E140 7B DF                        	.WORD	Task1		; PC
  11368 00E142 00                           	.BYTE	Task1>>16
  11369 00E143 00 00                        	.WORD	0			; acc
  11370 00E145 00 00                        	.WORD	0
  11371 00E147 00 00                        	.WORD	0			; x
  11372 00E149 00 00                        	.WORD	0
  11373 00E14B 00 00                        	.WORD	0			; y
  11374 00E14D 00 00                        	.WORD	0
  11375 00E14F FF 3B                        	.WORD	$3BFF		; sp
  11376 00E151 00 00                        	.WORD	0
  11377 00E153 04                           	.BYTE	4			; SR	(32 bit regs)
  11378 00E154 02                           	.BYTE	2			; SR extension	(32 bit mode)
  11379 00E155 00                           	.BYTE	0			; DB
  11380 00E156 00 00                        	.WORD	0			; DPR
  11381 00E158 00 00                        	.WORD	0
                                           
  11383 00E15A 00 00                        	.WORD	0			; CS
  11384 00E15C 00 00                        	.WORD	0			; DS
  11385 00E15E 00 00                        	.WORD	0			; SS
  11386 00E160 65 E0                        	.WORD	Task2		; PC
  11387 00E162 00                           	.BYTE	Task2>>16
  11388 00E163 00 00                        	.WORD	0			; acc
  11389 00E165 00 00                        	.WORD	0
  11390 00E167 00 00                        	.WORD	0			; x
  11391 00E169 00 00                        	.WORD	0
  11392 00E16B 00 00                        	.WORD	0			; y
  11393 00E16D 00 00                        	.WORD	0
  11394 00E16F FF 37                        	.WORD	$37FF		; sp
  11395 00E171 00 00                        	.WORD	0
  11396 00E173 20                           	.BYTE	$20			; SR			; eight bit mem
  11397 00E174 02                           	.BYTE	2			; SR extension
  11398 00E175 00                           	.BYTE	0			; DB
  11399 00E176 00 00                        	.WORD	0			; DPR
  11400 00E178 00 00                        	.WORD	0
                                           
                                           	; TASK #3
                                           	; Button Interrupt handler task
  11404 00E17A 00 00                        	.WORD	0			; CS
  11405 00E17C 05 00                        	.WORD	5			; DS
  11406 00E17E 05 00                        	.WORD	5			; SS
  11407 00E180 2C E0                        	.WORD	BtnuIRQ		; PC
  11408 00E182 00                           	.BYTE	BtnuIRQ>>16
  11409 00E183 00 00                        	.WORD	0			; acc
  11410 00E185 00 00                        	.WORD	0
  11411 00E187 00 00                        	.WORD	0			; x
  11412 00E189 00 00                        	.WORD	0
  11413 00E18B 00 00                        	.WORD	0			; y
  11414 00E18D 00 00                        	.WORD	0
  11415 00E18F FF 3A                        	.WORD	$3AFF		; sp
  11416 00E191 00 00                        	.WORD	0
  11417 00E193 04                           	.BYTE	4			; SR
  11418 00E194 01                           	.BYTE	1			; SR extension
  11419 00E195 00                           	.BYTE	0			; DB
  11420 00E196 00 00                        	.WORD	0			; DPR
  11421 00E198 00 00                        	.WORD	0
                                           
  11423 00E19A 00 00                        	.WORD	0			; CS
  11424 00E19C 00 00                        	.WORD	0			; DS
  11425 00E19E 00 00                        	.WORD	0			; SS
  11426 00E1A0 9B E0                        	.WORD	BrkTask		; PC
  11427 00E1A2 00                           	.BYTE	BrkTask>>16
  11428 00E1A3 00 00                        	.WORD	0			; acc
  11429 00E1A5 00 00                        	.WORD	0
  11430 00E1A7 00 00                        	.WORD	0			; x
  11431 00E1A9 00 00                        	.WORD	0
  11432 00E1AB 00 00                        	.WORD	0			; y
  11433 00E1AD 00 00                        	.WORD	0
  11434 00E1AF FF 2F                        	.WORD	$2FFF		; sp
  11435 00E1B1 00 00                        	.WORD	0
  11436 00E1B3 00                           	.BYTE	0			; SR
  11437 00E1B4 01                           	.BYTE	1			; SR extension
  11438 00E1B5 00                           	.BYTE	0			; DB
  11439 00E1B6 00 00                        	.WORD	0			; DPR
  11440 00E1B8 00 00                        	.WORD	0
                                           
                                           	; task #5
                                           	; DS is placed at $7800
  11444 00E1BA 00 00                        	.WORD	0			; CS
  11445 00E1BC 00 00                        	.WORD	0    		; DS
  11446 00E1BE 00 00                        	.WORD	0			; SS
  11447 00E1C0 EB 98                        	.WORD	InvadersTask	; PC
  11448 00E1C2 00                           	.BYTE	InvadersTask>>16
  11449 00E1C3 00 00                        	.WORD	0			; acc
  11450 00E1C5 00 00                        	.WORD	0
  11451 00E1C7 00 00                        	.WORD	0			; x
  11452 00E1C9 00 00                        	.WORD	0
  11453 00E1CB 00 00                        	.WORD	0			; y
  11454 00E1CD 00 00                        	.WORD	0
  11455 00E1CF FF 2B                        	.WORD	$2BFF		; sp
  11456 00E1D1 00 00                        	.WORD	0
  11457 00E1D3 00                           	.BYTE	0			; SR
  11458 00E1D4 01                           	.BYTE	1			; SR extension
  11459 00E1D5 00                           	.BYTE	0			; DB
  11460 00E1D6 00 00                        	.WORD	0			; DPR
  11461 00E1D8 00 00                        	.WORD	0
                                           
  11463 00E1DA 00 00                        	.WORD	0			; CS
  11464 00E1DC 00 00                        	.WORD	0			; DS
  11465 00E1DE 00 00                        	.WORD	0			; SS
  11466 00E1E0 44 E0                        	.WORD	IRQTask		; PC
  11467 00E1E2 00                           	.BYTE	IRQTask>>16
  11468 00E1E3 00 00                        	.WORD	0			; acc
  11469 00E1E5 00 00                        	.WORD	0
  11470 00E1E7 00 00                        	.WORD	0			; x
  11471 00E1E9 00 00                        	.WORD	0
  11472 00E1EB 00 00                        	.WORD	0			; y
  11473 00E1ED 00 00                        	.WORD	0
  11474 00E1EF FF 27                        	.WORD	$27FF		; sp
  11475 00E1F1 00 00                        	.WORD	0
  11476 00E1F3 24                           	.BYTE	$24			; SR	8 bit acc, mask interrupts
  11477 00E1F4 02                           	.BYTE	2			; SR extension - 832 mode
  11478 00E1F5 00                           	.BYTE	0			; DB
  11479 00E1F6 00 00                        	.WORD	0			; DPR
  11480 00E1F8 00 00                        	.WORD	0
                                           
                                           	; task 7 (Basic)
  11483 00E1FA FD 0F                        	.WORD	$FFD		; CS
  11484 00E1FC FD 0F                        	.WORD	$FFD		; DS
  11485 00E1FE FD 0F                        	.WORD	$FFD		; SS
  11486 00E200 00 C0                        	.WORD	$C000		; PC
  11487 00E202 00                           	.BYTE	$00
  11488 00E203 00 00                        	.WORD	0			; acc
  11489 00E205 00 00                        	.WORD	0
  11490 00E207 00 00                        	.WORD	0			; x
  11491 00E209 00 00                        	.WORD	0
  11492 00E20B 00 00                        	.WORD	0			; y
  11493 00E20D 00 00                        	.WORD	0
  11494 00E20F FF 01                        	.WORD	$01FF		; sp
  11495 00E211 00 00                        	.WORD	0
  11496 00E213 00                           	.BYTE	0			; SR
  11497 00E214 00                           	.BYTE	0			; SR extension - 02 mode
  11498 00E215 00                           	.BYTE	0			; DB
  11499 00E216 00 00                        	.WORD	0			; DPR
  11500 00E218 3F 00                        	.WORD	63			; map
                                           
                                           	; task 8 (Supermon)
  11503 00E21A 00 00                        	.WORD	$0			; CS
  11504 00E21C 05 00                        	.WORD	$5			; DS
  11505 00E21E 05 00                        	.WORD	$5			; SS
  11506 00E220 00 80                        	.WORD	$8000		; PC
  11507 00E222 00                           	.BYTE	$00
  11508 00E223 00 00                        	.WORD	0			; acc
  11509 00E225 00 00                        	.WORD	0
  11510 00E227 00 00                        	.WORD	0			; x
  11511 00E229 00 00                        	.WORD	0
  11512 00E22B 00 00                        	.WORD	0			; y
  11513 00E22D 00 00                        	.WORD	0
  11514 00E22F FF 2B                        	.WORD	$2BFF		; sp
  11515 00E231 00 00                        	.WORD	0
  11516 00E233 00                           	.BYTE	0			; SR
  11517 00E234 01                           	.BYTE	1			; SR extension - 816 mode
  11518 00E235 00                           	.BYTE	0			; DB
  11519 00E236 00 00                        	.WORD	0			; DPR
  11520 00E238 00 00                        	.WORD	0			; map
                                           
                                           	; task 9 (single step)
  11523 00E23A 00 00                        	.WORD	0			; CS
  11524 00E23C 00 00                        	.WORD	0			; DS
  11525 00E23E 00 00                        	.WORD	0			; SS
  11526 00E240 A0 C9                        	.WORD	SSMInit		; PC
  11527 00E242 00                           	.BYTE	SSMInit>>16
  11528 00E243 00 00                        	.WORD	0			; acc
  11529 00E245 00 00                        	.WORD	0
  11530 00E247 00 00                        	.WORD	0			; x
  11531 00E249 00 00                        	.WORD	0
  11532 00E24B 00 00                        	.WORD	0			; y
  11533 00E24D 00 00                        	.WORD	0
  11534 00E24F FF 33                        	.WORD	$33FF		; sp
  11535 00E251 00 00                        	.WORD	0
  11536 00E253 04                           	.BYTE	$4			; SR	16 bit regs, mask interrupts
  11537 00E254 01                           	.BYTE	1			; SR extension - 816 mode
  11538 00E255 00                           	.BYTE	0			; DB
  11539 00E256 00 00                        	.WORD	0			; DPR
  11540 00E258 00 00                        	.WORD	0
                                           
                                           	; task 10 - BRK routine
  11543 00E25A 00 00                        	.WORD	0			; CS
  11544 00E25C 00 00                        	.WORD	0			; DS
  11545 00E25E 00 00                        	.WORD	0			; SS
  11546 00E260 A5 E0                        	.WORD	BrkRout		; PC
  11547 00E262 00                           	.BYTE	BrkRout>>16
  11548 00E263 00 00                        	.WORD	0			; acc
  11549 00E265 00 00                        	.WORD	0
  11550 00E267 00 00                        	.WORD	0			; x
  11551 00E269 00 00                        	.WORD	0
  11552 00E26B 00 00                        	.WORD	0			; y
  11553 00E26D 00 00                        	.WORD	0
  11554 00E26F FF 32                        	.WORD	$32FF		; sp
  11555 00E271 00 00                        	.WORD	0
  11556 00E273 04                           	.BYTE	$4			; SR	32 bit regs, mask interrupts
  11557 00E274 02                           	.BYTE	2			; SR extension - 832 mode
  11558 00E275 00                           	.BYTE	0			; DB
  11559 00E276 00 00                        	.WORD	0			; DPR
  11560 00E278 00 00                        	.WORD	0
                                           
  11562 00E27A                             msgRegs:
  11563 00E27A 0D 0A                        	.byte	CR,LF
  11564 00E27C 20 20 20 20 20 20 20 20          .byte   "             xxxsxi31",CR,LF
  11564 00E284 20 20 20 20 20 78 78 78    
  11564 00E28C 73 78 69 33 31 0D 0A       
  11565 00E293 20 20 43 53 20 20 50 42          .byte   "  CS  PB PC  xxxsxn26NVmxDIZC    .A       .X       .Y       SP  ",CR,LF,0
  11565 00E29B 20 50 43 20 20 78 78 78    
  11565 00E2A3 73 78 6E 32 36 4E 56 6D    
  11565 00E2AB 78 44 49 5A 43 20 20 20    
  11565 00E2B3 20 2E 41 20 20 20 20 20    
  11565 00E2BB 20 20 2E 58 20 20 20 20    
  11565 00E2C3 20 20 20 2E 59 20 20 20    
  11565 00E2CB 20 20 20 20 53 50 20 20    
  11565 00E2D3 0D 0A 00                   
  11566 00E2D6                             msgRegs2:
  11567 00E2D6 0D 0A                        	.byte	CR,LF
  11568 00E2D8 20 20 53 53 20 20 20 44      	.byte	"  SS   DS  DB  DP   BL  MP",CR,LF,0
  11568 00E2E0 53 20 20 44 42 20 20 44    
  11568 00E2E8 50 20 20 20 42 4C 20 20    
  11568 00E2F0 4D 50 0D 0A 00             
  11569 00E2F5                             msgErr:
  11570 00E2F5 2A 2A 2A 45 72 72 0D 0A      	.byte	"***Err",CR,LF,0
  11570 00E2FD 00                         
                                           
                                           ;	cpu		FT832
                                           ;	MEM		32
                                           ;	NDX		32
                                           ;	LDA		#$12345678
                                           ;	LDX		#$98765432
                                           ;	STA.B	{$23},Y
                                           ;	LDY.UH	$44455556,X
                                           ;	LDA.H	CS:$44455556,X
                                           ;	LDA.UB	SEG $8888:$1234,Y
                                           ;	JSF	    $0000:start
                                           ;	RTF
                                           ;	ADC     SEG $9821:$1200,X
                                           ;	EOR     $821:$1200,X
                                           ;	EOR     $841:$12
                                           ;	SBC     FAR {$24},Y
                                           ;	AND     FAR($25)
                                           ;	ORA     FAR ($26,x)
                                           ;	TSK		#2
                                           ;	TSK
                                           ;	LDT		$10000,X
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ; +---------------------------+
                                           ; | block status / ptr to free|
                                           ; +---------------------------+
                                           ; | pointer to previous block |
                                           ; +---------------------------+
                                           ; | pointer to next block     |
                                           ; +---------------------------+
                                           ;
                                           	MEM		32
                                           	NDX		32
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
  11610 00E2FE                             FreeSysMem:
  11611 00E2FE 38                           	SEC
  11612 00E2FF E9 0C 00 00 00               	SBC		#12		;	backup to block header
  11613 00E304 A8                           	TAY				;	.Y = pointer to block to free (this)
  11614 00E305 08                           	PHP				; save interrupt mask
  11615 00E306 78                           	SEI				; no interrupts
                                           	STZ		$0,Y	; set status as free
  11617 00E307 B6 08                        	LDX		$8,Y	;	.X = pointer to next block
  11618 00E309 B5 00                        	LDA		$0,X	;	.A = next->status
  11619 00E30B F0 39                        	BEQ		.0001	;	branch if not free
                                           	; merge block with next free block
  11621 00E30D B5 08                        	LDA		$8,X	;   .A = pointer to next next block
  11622 00E30F 99 08 00                     	STA		$8,Y	;
  11623 00E312 AA                           	TAX
  11624 00E313 94 04                        	STY		$4,X	;	next->next->prev = this
  11625 00E315                             .0001:
                                           	; merge block with a previous free block
  11627 00E315 B6 04                        	LDX		$4,Y	;	.X = pointer to prev block
  11628 00E317 B5 00                        	LDA		$0,X	;	.A = prev->status
  11629 00E319 F0 1F                        	BEQ		.0002	;	branch if not free
  11630 00E31B B9 08 00                     	LDA		$8,Y	;   prev->next = this->next
  11631 00E31E 95 08                        	STA		$8,X
  11632 00E320 A8                           	TAY				;	.Y = this->next
  11633 00E321 96 04                        	STX		$4,Y	;	this->next->prev = this->prev
  11634 00E323 9B                           	TXY
  11635 00E324                             .0002:
  11636 00E324 AD 9B E2                     	LDA		heap_free_ptr
  11637 00E327 99 00 00                     	STA		$0,Y
  11638 00E32A 8C 9B E2                     	STY		heap_free_ptr
  11639 00E32D 28                           	PLP
  11640 00E32E 60                           	RTS
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           	; round allocation size to mmu available sizes
                                           
  11646 00E32F A2 00 00 00 00               	LDX		#0
  11647 00E334 18                           	CLC				; add room for header
  11648 00E335 69 0C 00 00 00               	ADC		#12
  11649 00E33A                             .0002:
  11650 00E33A DD 6F E3                     	CMP		mmas,X
  11651 00E33D 42 B0 D5                     	BLE		.0001
  11652 00E340 E8                           	INX
  11653 00E341 E8                           	INX
  11654 00E342 E8                           	INX
  11655 00E343 E8                           	INX
  11656 00E344 80 F4                        	BRA		.0002
  11657 00E346                             .0001:
  11658 00E346 BD 6F E3                     	LDA		mmas,X
  11659 00E349 AA                           	TAX
  11660 00E34A AC BF E2                     	LDY		free_heap_ptr
                                           	; subtract .Y from .A
  11662 00E34D 38                           	SEC
  11663 00E34E B9 08 00                     	LDA		$8,Y
  11664 00E351 8C C5 E2                     	STY		tmpy
  11665 00E354 ED C5 E2                     	SBC		tmpy
  11666 00E357 DD 6F E3                     	CMP		mmas,X
  11667 00E35A 30 FF                        	BLT		.0003
                                           	; here block is big enough
  11669 00E35C 48                           	PHA
  11670 00E35D B9 00 00                     	LDA		$0,Y
  11671 00E360 8D BF E2                     	STA		free_heap_ptr
                                           	STZ		$0,Y
  11673 00E363 68                           	PLA
  11674 00E364 38                           	SEC
  11675 00E365 FD 6F E3                     	SBC		mmas,X
  11676 00E368 C9 FF 00 00 00               	CMP		#$0FF
  11677 00E36D 30 00                        	BLT		.0004
                                           
  11679 00E36F                             .0004:
                                           	
                                           
                                           ; Memory management allocation sizes
                                           ;
  11684 00E36F                             mmas:
  11685 00E36F 00 00 00 00                  	WORD	$0000,$0000
  11686 00E373 FF 00 00 00                  	WORD	$00FF,$0000
  11687 00E377 FF 03 00 00                  	WORD	$03FF,$0000
  11688 00E37B FF 0F 00 00                  	WORD	$0FFF,$0000
  11689 00E37F FF 3F 00 00                  	WORD	$3FFF,$0000
  11690 00E383 FF FF 00 00                  	WORD	$FFFF,$0000
  11691 00E387 FF FF 03 00                  	WORD	$FFFF,$0003
  11692 00E38B FF FF 0F 00                  	WORD	$FFFF,$000F
  11693 00E38F FF FF 3F 00                  	WORD	$FFFF,$003F
  11694 00E393 FF FF FF 00                  	WORD	$FFFF,$00FF
  11695 00E397 FF FF FF 03                  	WORD	$FFFF,$03FF
  11696 00E39B FF FF FF 0F                  	WORD	$FFFF,$0FFF
  11697 00E39F FF FF FF 3F                  	WORD	$FFFF,$3FFF
  11698 00E3A3 FF FF FF FF                  	WORD	$FFFF,$FFFF
                                           
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           ;------------------------------------------------------------------------------
                                           	MEM		16
                                           	NDX		16
  11706 00E3A7 4C 6F E4                     	JMP		MusicPlay
  11707 00E3AA                             beep:
  11708 00E3AA A9 0F 00                     	LDA		#15					; set volume to max
  11709 00E3AD 42 3B FF 0F 8F B0 B0 0E      	STA		$FFF:SID+SID_VOLUME		
                                         
  11710 00E3B5 A9 6F 0C                     	LDA		#$0C6F				; 10C6F = 800 Hz
  11711 00E3B8 42 3B FF 0F 8F 00 B0 0E      	STA		$FFF:SID+SID_FREQ0
                                         
  11712 00E3C0 A9 01 00                     	LDA		#1
  11713 00E3C3 42 3B FF 0F 8F 02 B0 0E      	STA		$FFF:SID+SID_FREQ0+2
                                         
  11714 00E3CB A9 C3 00                     	LDA		#195				; 2ms
  11715 00E3CE 42 3B FF 0F 8F 0C B0 0E      	STA		$FFF:SID+SID_ATTACK0
                                         
  11716 00E3D6 42 3B FF 0F 42 9C 0E B0      	STZ		$FFF:SID+SID_ATTACK0+2
  11716 00E3DE 0E 00                      
  11717 00E3E0 A9 28 09                     	LDA		#2344				; 24 ms decay
  11718 00E3E3 42 3B FF 0F 8F 10 B0 0E      	STA		$FFF:SID+SID_DECAY0
                                         
  11719 00E3EB 42 3B FF 0F 42 9C 12 B0      	STZ		$FFF:SID+SID_DECAY0+2
  11719 00E3F3 0E 00                      
  11720 00E3F5 A9 80 00                     	LDA		#$80				; 50% sustain level
  11721 00E3F8 42 3B FF 0F 8F 14 B0 0E      	STA		$FFF:SID+SID_SUSTAIN0
                                         
  11722 00E400 A9 BC BE                     	LDA		#48828				; 500 ms release
  11723 00E403 42 3B FF 0F 8F 18 B0 0E      	STA		$FFF:SID+SID_RELEASE0
                                         
  11724 00E40B 42 3B FF 0F 42 9C 1A B0      	STZ		$FFF:SID+SID_RELEASE0+2
  11724 00E413 0E 00                      
  11725 00E415 A9 01 00                     	LDA		#1					; reset envelope generator
  11726 00E418 42 3B FF 0F 8F 0A B0 0E      	STA		$FFF:SID+SID_CTRL0+2
                                         
  11727 00E420 EA                           	NOP
  11728 00E421 EA                           	NOP
  11729 00E422 42 3B FF 0F 42 9C 0A B0      	STZ		$FFF:SID+SID_CTRL0+2
  11729 00E42A 0E 00                      
  11730 00E42C A9 04 15                     	LDA		#$1504				; gate on
  11731 00E42F 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
                                           	; delay for about 1s
  11733 00E437 A0 27 00                     	LDY		#39
  11734 00E43A                             .0002:
  11735 00E43A A2 FF FF                     	LDX		#65535
  11736 00E43D                             .0001:
  11737 00E43D CA                           	DEX
  11738 00E43E D0 FD                        	BNE		.0001
  11739 00E440 88                           	DEY
  11740 00E441 D0 F7                        	BNE		.0002
  11741 00E443 A9 04 05                     	LDA		#$0504				; gate off
  11742 00E446 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11743 00E44E 60                           	RTS
  11744 00E44F                             	
  11745 00E44F 01 00                        	dh	1
  11746 00E451 89 83                        	dw	33673		; G4
  11747 00E453 0C 00                        	dw	12			; 1/8 sec
  11748 00E455 04 00                        	dw	4			; space
                                           
  11750 00E457 01 00                        	dh	1
  11751 00E459 89 83                        	dw	33673		; G4
  11752 00E45B 0C 00                        	dw	12			; 1/8
  11753 00E45D 04 00                        	dw	4			; space
                                           
  11755 00E45F 01 00                        	dh	1
  11756 00E461 89 83                        	dw	33673		; G4
  11757 00E463 0C 00                        	dw	12			; 1/8
  11758 00E465 04 00                        	dw	4			; space
                                           
  11760 00E467 00 00                        	dh	0
  11761 00E469 00 00                        	dw	0			; G4
  11762 00E46B 00 00                        	dw	0			; 1/8
  11763 00E46D 00 00                        	dw	0			; space
                                           
  11765 00E46F                             MusicPlay:
  11766 00E46F A2 00 00                     	LDX		#0
  11767 00E472 A9 C3 00                     	LDA		#195				; 2ms
  11768 00E475 42 3B FF 0F 8F 0C B0 0E      	STA		$FFF:SID+SID_ATTACK0
                                         
  11769 00E47D 42 3B FF 0F 42 9C 0E B0      	STZ		$FFF:SID+SID_ATTACK0+2
  11769 00E485 0E 00                      
  11770 00E487 A9 28 09                     	LDA		#2344				; 24 ms decay
  11771 00E48A 42 3B FF 0F 8F 10 B0 0E      	STA		$FFF:SID+SID_DECAY0
                                         
  11772 00E492 42 3B FF 0F 42 9C 12 B0      	STZ		$FFF:SID+SID_DECAY0+2
  11772 00E49A 0E 00                      
  11773 00E49C A9 D0 00                     	LDA		#$D0				; sustain level
  11774 00E49F 42 3B FF 0F 8F 14 B0 0E      	STA		$FFF:SID+SID_SUSTAIN0
                                         
  11775 00E4A7 A9 F8 11                     	LDA		#4600				; ??? ms release
  11776 00E4AA 42 3B FF 0F 8F 18 B0 0E      	STA		$FFF:SID+SID_RELEASE0
                                         
  11777 00E4B2 42 3B FF 0F 42 9C 1A B0      	STZ		$FFF:SID+SID_RELEASE0+2
  11777 00E4BA 0E 00                      
  11778 00E4BC                             .0001:
  11779 00E4BC BD 4F E4                     	LDA		music_tbl,x			; check for last note
  11780 00E4BF F0 56                        	BEQ		.xit
  11781 00E4C1 BD 51 E4                     	LDA		music_tbl+2,x			; set the frequency
  11782 00E4C4 42 3B FF 0F 8F 00 B0 0E      	STA		$FFF:SID+SID_FREQ0
                                         
  11783 00E4CC BD 53 E4                     	LDA		music_tbl+4,x
  11784 00E4CF 42 3B FF 0F 8F 02 B0 0E      	STA		$FFF:SID+SID_FREQ0+2
                                         
  11785 00E4D7 A9 04 15                     	LDA		#$1504				; gate on
  11786 00E4DA 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11787 00E4E2 78                           	SEI
  11788 00E4E3 BD 55 E4                     	LDA		music_tbl+6,x
  11789 00E4E6 8D 04 01                     	STA		timeout1
  11790 00E4E9 BD 57 E4                     	LDA		music_tbl+8,x
  11791 00E4EC 8D 06 01                     	STA		timeout1+2
  11792 00E4EF 20 18 E5                     	JSR		MusicWaitTimeout
  11793 00E4F2 A9 04 05                     	LDA		#$0504				; gate off
  11794 00E4F5 42 3B FF 0F 8F 08 B0 0E      	STA		$FFF:SID+SID_CTRL0
                                         
  11795 00E4FD 78                           	SEI
  11796 00E4FE BD 59 E4                     	LDA		music_tbl+10,x		; note release delay
  11797 00E501 8D 04 01                     	STA		timeout1
  11798 00E504 BD 5B E4                     	LDA		music_tbl+12,x
  11799 00E507 8D 06 01                     	STA		timeout1+2
  11800 00E50A 20 18 E5                     	JSR		MusicWaitTimeout
  11801 00E50D E8                           	INX
  11802 00E50E E8                           	INX
  11803 00E50F 42 E8                        	INX4
  11804 00E511 42 E8                        	INX4
  11805 00E513 42 E8                        	INX4
  11806 00E515 80 A5                        	BRA		.0001
  11807 00E517                             .xit:
  11808 00E517 60                           	RTS
                                           
  11810 00E518                             MusicWaitTimeout:
  11811 00E518                             .0001:
  11812 00E518 58                           	CLI
  11813 00E519 EA                           	NOP
  11814 00E51A EA                           	NOP
  11815 00E51B 78                           	SEI
  11816 00E51C AD 04 01                     	LDA		timeout1
  11817 00E51F 0D 06 01                     	ORA		timeout1+2
  11818 00E522 D0 F4                        	BNE		.0001
  11819 00E524 58                           	CLI
  11820 00E525 60                           	RTS
                                           
  11822 00E526                             MusicTimeoutIRQ:
  11823 00E526 C2 30                        	REP		#$30
                                           	MEM		16
                                           	NDX		16
  11826 00E528 AD 04 01                     	LDA		timeout1
  11827 00E52B 0D 06 01                     	ORA		timeout1+2
  11828 00E52E F0 13                        	BEQ		.0001
  11829 00E530 38                           	SEC
  11830 00E531 AD 04 01                     	LDA		timeout1
  11831 00E534 E9 01 00                     	SBC		#1
  11832 00E537 8D 04 01                     	STA		timeout1
  11833 00E53A AD 06 01                     	LDA		timeout1+2
  11834 00E53D E9 00 00                     	SBC		#0
  11835 00E540 8D 06 01                     	STA		timeout1+2
  11836 00E543                             .0001:
  11837 00E543 60                           	RTS
                                           
  11839 00E544 FF FF FF FF FF FF FF FF      	.org	$FE00
  11839 00E54C FF FF FF FF FF FF FF FF    
  11839 00E554 FF FF FF FF FF FF FF FF    
  11839 00E55C FF FF FF FF FF FF FF FF    
  11839 00E564 FF FF FF FF FF FF FF FF    
  11839 00E56C FF FF FF FF FF FF FF FF    
  11839 00E574 FF FF FF FF FF FF FF FF    
  11839 00E57C FF FF FF FF FF FF FF FF    
  11839 00E584 FF FF FF FF FF FF FF FF    
  11839 00E58C FF FF FF FF FF FF FF FF    
  11839 00E594 FF FF FF FF FF FF FF FF    
  11839 00E59C FF FF FF FF FF FF FF FF    
  11839 00E5A4 FF FF FF FF FF FF FF FF    
  11839 00E5AC FF FF FF FF FF FF FF FF    
  11839 00E5B4 FF FF FF FF FF FF FF FF    
  11839 00E5BC FF FF FF FF FF FF FF FF    
  11839 00E5C4 FF FF FF FF FF FF FF FF    
  11839 00E5CC FF FF FF FF FF FF FF FF    
  11839 00E5D4 FF FF FF FF FF FF FF FF    
  11839 00E5DC FF FF FF FF FF FF FF FF    
  11839 00E5E4 FF FF FF FF FF FF FF FF    
  11839 00E5EC FF FF FF FF FF FF FF FF    
  11839 00E5F4 FF FF FF FF FF FF FF FF    
  11839 00E5FC FF FF FF FF FF FF FF FF    
  11839 00E604 FF FF FF FF FF FF FF FF    
  11839 00E60C FF FF FF FF FF FF FF FF    
  11839 00E614 FF FF FF FF FF FF FF FF    
  11839 00E61C FF FF FF FF FF FF FF FF    
  11839 00E624 FF FF FF FF FF FF FF FF    
  11839 00E62C FF FF FF FF FF FF FF FF    
  11839 00E634 FF FF FF FF FF FF FF FF    
  11839 00E63C FF FF FF FF FF FF FF FF    
  11839 00E644 FF FF FF FF FF FF FF FF    
  11839 00E64C FF FF FF FF FF FF FF FF    
  11839 00E654 FF FF FF FF FF FF FF FF    
  11839 00E65C FF FF FF FF FF FF FF FF    
  11839 00E664 FF FF FF FF FF FF FF FF    
  11839 00E66C FF FF FF FF FF FF FF FF    
  11839 00E674 FF FF FF FF FF FF FF FF    
  11839 00E67C FF FF FF FF FF FF FF FF    
  11839 00E684 FF FF FF FF FF FF FF FF    
  11839 00E68C FF FF FF FF FF FF FF FF    
  11839 00E694 FF FF FF FF FF FF FF FF    
  11839 00E69C FF FF FF FF FF FF FF FF    
  11839 00E6A4 FF FF FF FF FF FF FF FF    
  11839 00E6AC FF FF FF FF FF FF FF FF    
  11839 00E6B4 FF FF FF FF FF FF FF FF    
  11839 00E6BC FF FF FF FF FF FF FF FF    
  11839 00E6C4 FF FF FF FF FF FF FF FF    
  11839 00E6CC FF FF FF FF FF FF FF FF    
  11839 00E6D4 FF FF FF FF FF FF FF FF    
  11839 00E6DC FF FF FF FF FF FF FF FF    
  11839 00E6E4 FF FF FF FF FF FF FF FF    
  11839 00E6EC FF FF FF FF FF FF FF FF    
  11839 00E6F4 FF FF FF FF FF FF FF FF    
  11839 00E6FC FF FF FF FF FF FF FF FF    
  11839 00E704 FF FF FF FF FF FF FF FF    
  11839 00E70C FF FF FF FF FF FF FF FF    
  11839 00E714 FF FF FF FF FF FF FF FF    
  11839 00E71C FF FF FF FF FF FF FF FF    
  11839 00E724 FF FF FF FF FF FF FF FF    
  11839 00E72C FF FF FF FF FF FF FF FF    
  11839 00E734 FF FF FF FF FF FF FF FF    
  11839 00E73C FF FF FF FF FF FF FF FF    
  11839 00E744 FF FF FF FF FF FF FF FF    
  11839 00E74C FF FF FF FF FF FF FF FF    
  11839 00E754 FF FF FF FF FF FF FF FF    
  11839 00E75C FF FF FF FF FF FF FF FF    
  11839 00E764 FF FF FF FF FF FF FF FF    
  11839 00E76C FF FF FF FF FF FF FF FF    
  11839 00E774 FF FF FF FF FF FF FF FF    
  11839 00E77C FF FF FF FF FF FF FF FF    
  11839 00E784 FF FF FF FF FF FF FF FF    
  11839 00E78C FF FF FF FF FF FF FF FF    
  11839 00E794 FF FF FF FF FF FF FF FF    
  11839 00E79C FF FF FF FF FF FF FF FF    
  11839 00E7A4 FF FF FF FF FF FF FF FF    
  11839 00E7AC FF FF FF FF FF FF FF FF    
  11839 00E7B4 FF FF FF FF FF FF FF FF    
  11839 00E7BC FF FF FF FF FF FF FF FF    
  11839 00E7C4 FF FF FF FF FF FF FF FF    
  11839 00E7CC FF FF FF FF FF FF FF FF    
  11839 00E7D4 FF FF FF FF FF FF FF FF    
  11839 00E7DC FF FF FF FF FF FF FF FF    
  11839 00E7E4 FF FF FF FF FF FF FF FF    
  11839 00E7EC FF FF FF FF FF FF FF FF    
  11839 00E7F4 FF FF FF FF FF FF FF FF    
  11839 00E7FC FF FF FF FF FF FF FF FF    
  11839 00E804 FF FF FF FF FF FF FF FF    
  11839 00E80C FF FF FF FF FF FF FF FF    
  11839 00E814 FF FF FF FF FF FF FF FF    
  11839 00E81C FF FF FF FF FF FF FF FF    
  11839 00E824 FF FF FF FF FF FF FF FF    
  11839 00E82C FF FF FF FF FF FF FF FF    
  11839 00E834 FF FF FF FF FF FF FF FF    
  11839 00E83C FF FF FF FF FF FF FF FF    
  11839 00E844 FF FF FF FF FF FF FF FF    
  11839 00E84C FF FF FF FF FF FF FF FF    
  11839 00E854 FF FF FF FF FF FF FF FF    
  11839 00E85C FF FF FF FF FF FF FF FF    
  11839 00E864 FF FF FF FF FF FF FF FF    
  11839 00E86C FF FF FF FF FF FF FF FF    
  11839 00E874 FF FF FF FF FF FF FF FF    
  11839 00E87C FF FF FF FF FF FF FF FF    
  11839 00E884 FF FF FF FF FF FF FF FF    
  11839 00E88C FF FF FF FF FF FF FF FF    
  11839 00E894 FF FF FF FF FF FF FF FF    
  11839 00E89C FF FF FF FF FF FF FF FF    
  11839 00E8A4 FF FF FF FF FF FF FF FF    
  11839 00E8AC FF FF FF FF FF FF FF FF    
  11839 00E8B4 FF FF FF FF FF FF FF FF    
  11839 00E8BC FF FF FF FF FF FF FF FF    
  11839 00E8C4 FF FF FF FF FF FF FF FF    
  11839 00E8CC FF FF FF FF FF FF FF FF    
  11839 00E8D4 FF FF FF FF FF FF FF FF    
  11839 00E8DC FF FF FF FF FF FF FF FF    
  11839 00E8E4 FF FF FF FF FF FF FF FF    
  11839 00E8EC FF FF FF FF FF FF FF FF    
  11839 00E8F4 FF FF FF FF FF FF FF FF    
  11839 00E8FC FF FF FF FF FF FF FF FF    
  11839 00E904 FF FF FF FF FF FF FF FF    
  11839 00E90C FF FF FF FF FF FF FF FF    
  11839 00E914 FF FF FF FF FF FF FF FF    
  11839 00E91C FF FF FF FF FF FF FF FF    
  11839 00E924 FF FF FF FF FF FF FF FF    
  11839 00E92C FF FF FF FF FF FF FF FF    
  11839 00E934 FF FF FF FF FF FF FF FF    
  11839 00E93C FF FF FF FF FF FF FF FF    
  11839 00E944 FF FF FF FF FF FF FF FF    
  11839 00E94C FF FF FF FF FF FF FF FF    
  11839 00E954 FF FF FF FF FF FF FF FF    
  11839 00E95C FF FF FF FF FF FF FF FF    
  11839 00E964 FF FF FF FF FF FF FF FF    
  11839 00E96C FF FF FF FF FF FF FF FF    
  11839 00E974 FF FF FF FF FF FF FF FF    
  11839 00E97C FF FF FF FF FF FF FF FF    
  11839 00E984 FF FF FF FF FF FF FF FF    
  11839 00E98C FF FF FF FF FF FF FF FF    
  11839 00E994 FF FF FF FF FF FF FF FF    
  11839 00E99C FF FF FF FF FF FF FF FF    
  11839 00E9A4 FF FF FF FF FF FF FF FF    
  11839 00E9AC FF FF FF FF FF FF FF FF    
  11839 00E9B4 FF FF FF FF FF FF FF FF    
  11839 00E9BC FF FF FF FF FF FF FF FF    
  11839 00E9C4 FF FF FF FF FF FF FF FF    
  11839 00E9CC FF FF FF FF FF FF FF FF    
  11839 00E9D4 FF FF FF FF FF FF FF FF    
  11839 00E9DC FF FF FF FF FF FF FF FF    
  11839 00E9E4 FF FF FF FF FF FF FF FF    
  11839 00E9EC FF FF FF FF FF FF FF FF    
  11839 00E9F4 FF FF FF FF FF FF FF FF    
  11839 00E9FC FF FF FF FF FF FF FF FF    
  11839 00EA04 FF FF FF FF FF FF FF FF    
  11839 00EA0C FF FF FF FF FF FF FF FF    
  11839 00EA14 FF FF FF FF FF FF FF FF    
  11839 00EA1C FF FF FF FF FF FF FF FF    
  11839 00EA24 FF FF FF FF FF FF FF FF    
  11839 00EA2C FF FF FF FF FF FF FF FF    
  11839 00EA34 FF FF FF FF FF FF FF FF    
  11839 00EA3C FF FF FF FF FF FF FF FF    
  11839 00EA44 FF FF FF FF FF FF FF FF    
  11839 00EA4C FF FF FF FF FF FF FF FF    
  11839 00EA54 FF FF FF FF FF FF FF FF    
  11839 00EA5C FF FF FF FF FF FF FF FF    
  11839 00EA64 FF FF FF FF FF FF FF FF    
  11839 00EA6C FF FF FF FF FF FF FF FF    
  11839 00EA74 FF FF FF FF FF FF FF FF    
  11839 00EA7C FF FF FF FF FF FF FF FF    
  11839 00EA84 FF FF FF FF FF FF FF FF    
  11839 00EA8C FF FF FF FF FF FF FF FF    
  11839 00EA94 FF FF FF FF FF FF FF FF    
  11839 00EA9C FF FF FF FF FF FF FF FF    
  11839 00EAA4 FF FF FF FF FF FF FF FF    
  11839 00EAAC FF FF FF FF FF FF FF FF    
  11839 00EAB4 FF FF FF FF FF FF FF FF    
  11839 00EABC FF FF FF FF FF FF FF FF    
  11839 00EAC4 FF FF FF FF FF FF FF FF    
  11839 00EACC FF FF FF FF FF FF FF FF    
  11839 00EAD4 FF FF FF FF FF FF FF FF    
  11839 00EADC FF FF FF FF FF FF FF FF    
  11839 00EAE4 FF FF FF FF FF FF FF FF    
  11839 00EAEC FF FF FF FF FF FF FF FF    
  11839 00EAF4 FF FF FF FF FF FF FF FF    
  11839 00EAFC FF FF FF FF FF FF FF FF    
  11839 00EB04 FF FF FF FF FF FF FF FF    
  11839 00EB0C FF FF FF FF FF FF FF FF    
  11839 00EB14 FF FF FF FF FF FF FF FF    
  11839 00EB1C FF FF FF FF FF FF FF FF    
  11839 00EB24 FF FF FF FF FF FF FF FF    
  11839 00EB2C FF FF FF FF FF FF FF FF    
  11839 00EB34 FF FF FF FF FF FF FF FF    
  11839 00EB3C FF FF FF FF FF FF FF FF    
  11839 00EB44 FF FF FF FF FF FF FF FF    
  11839 00EB4C FF FF FF FF FF FF FF FF    
  11839 00EB54 FF FF FF FF FF FF FF FF    
  11839 00EB5C FF FF FF FF FF FF FF FF    
  11839 00EB64 FF FF FF FF FF FF FF FF    
  11839 00EB6C FF FF FF FF FF FF FF FF    
  11839 00EB74 FF FF FF FF FF FF FF FF    
  11839 00EB7C FF FF FF FF FF FF FF FF    
  11839 00EB84 FF FF FF FF FF FF FF FF    
  11839 00EB8C FF FF FF FF FF FF FF FF    
  11839 00EB94 FF FF FF FF FF FF FF FF    
  11839 00EB9C FF FF FF FF FF FF FF FF    
  11839 00EBA4 FF FF FF FF FF FF FF FF    
  11839 00EBAC FF FF FF FF FF FF FF FF    
  11839 00EBB4 FF FF FF FF FF FF FF FF    
  11839 00EBBC FF FF FF FF FF FF FF FF    
  11839 00EBC4 FF FF FF FF FF FF FF FF    
  11839 00EBCC FF FF FF FF FF FF FF FF    
  11839 00EBD4 FF FF FF FF FF FF FF FF    
  11839 00EBDC FF FF FF FF FF FF FF FF    
  11839 00EBE4 FF FF FF FF FF FF FF FF    
  11839 00EBEC FF FF FF FF FF FF FF FF    
  11839 00EBF4 FF FF FF FF FF FF FF FF    
  11839 00EBFC FF FF FF FF FF FF FF FF    
  11839 00EC04 FF FF FF FF FF FF FF FF    
  11839 00EC0C FF FF FF FF FF FF FF FF    
  11839 00EC14 FF FF FF FF FF FF FF FF    
  11839 00EC1C FF FF FF FF FF FF FF FF    
  11839 00EC24 FF FF FF FF FF FF FF FF    
  11839 00EC2C FF FF FF FF FF FF FF FF    
  11839 00EC34 FF FF FF FF FF FF FF FF    
  11839 00EC3C FF FF FF FF FF FF FF FF    
  11839 00EC44 FF FF FF FF FF FF FF FF    
  11839 00EC4C FF FF FF FF FF FF FF FF    
  11839 00EC54 FF FF FF FF FF FF FF FF    
  11839 00EC5C FF FF FF FF FF FF FF FF    
  11839 00EC64 FF FF FF FF FF FF FF FF    
  11839 00EC6C FF FF FF FF FF FF FF FF    
  11839 00EC74 FF FF FF FF FF FF FF FF    
  11839 00EC7C FF FF FF FF FF FF FF FF    
  11839 00EC84 FF FF FF FF FF FF FF FF    
  11839 00EC8C FF FF FF FF FF FF FF FF    
  11839 00EC94 FF FF FF FF FF FF FF FF    
  11839 00EC9C FF FF FF FF FF FF FF FF    
  11839 00ECA4 FF FF FF FF FF FF FF FF    
  11839 00ECAC FF FF FF FF FF FF FF FF    
  11839 00ECB4 FF FF FF FF FF FF FF FF    
  11839 00ECBC FF FF FF FF FF FF FF FF    
  11839 00ECC4 FF FF FF FF FF FF FF FF    
  11839 00ECCC FF FF FF FF FF FF FF FF    
  11839 00ECD4 FF FF FF FF FF FF FF FF    
  11839 00ECDC FF FF FF FF FF FF FF FF    
  11839 00ECE4 FF FF FF FF FF FF FF FF    
  11839 00ECEC FF FF FF FF FF FF FF FF    
  11839 00ECF4 FF FF FF FF FF FF FF FF    
  11839 00ECFC FF FF FF FF FF FF FF FF    
  11839 00ED04 FF FF FF FF FF FF FF FF    
  11839 00ED0C FF FF FF FF FF FF FF FF    
  11839 00ED14 FF FF FF FF FF FF FF FF    
  11839 00ED1C FF FF FF FF FF FF FF FF    
  11839 00ED24 FF FF FF FF FF FF FF FF    
  11839 00ED2C FF FF FF FF FF FF FF FF    
  11839 00ED34 FF FF FF FF FF FF FF FF    
  11839 00ED3C FF FF FF FF FF FF FF FF    
  11839 00ED44 FF FF FF FF FF FF FF FF    
  11839 00ED4C FF FF FF FF FF FF FF FF    
  11839 00ED54 FF FF FF FF FF FF FF FF    
  11839 00ED5C FF FF FF FF FF FF FF FF    
  11839 00ED64 FF FF FF FF FF FF FF FF    
  11839 00ED6C FF FF FF FF FF FF FF FF    
  11839 00ED74 FF FF FF FF FF FF FF FF    
  11839 00ED7C FF FF FF FF FF FF FF FF    
  11839 00ED84 FF FF FF FF FF FF FF FF    
  11839 00ED8C FF FF FF FF FF FF FF FF    
  11839 00ED94 FF FF FF FF FF FF FF FF    
  11839 00ED9C FF FF FF FF FF FF FF FF    
  11839 00EDA4 FF FF FF FF FF FF FF FF    
  11839 00EDAC FF FF FF FF FF FF FF FF    
  11839 00EDB4 FF FF FF FF FF FF FF FF    
  11839 00EDBC FF FF FF FF FF FF FF FF    
  11839 00EDC4 FF FF FF FF FF FF FF FF    
  11839 00EDCC FF FF FF FF FF FF FF FF    
  11839 00EDD4 FF FF FF FF FF FF FF FF    
  11839 00EDDC FF FF FF FF FF FF FF FF    
  11839 00EDE4 FF FF FF FF FF FF FF FF    
  11839 00EDEC FF FF FF FF FF FF FF FF    
  11839 00EDF4 FF FF FF FF FF FF FF FF    
  11839 00EDFC FF FF FF FF FF FF FF FF    
  11839 00EE04 FF FF FF FF FF FF FF FF    
  11839 00EE0C FF FF FF FF FF FF FF FF    
  11839 00EE14 FF FF FF FF FF FF FF FF    
  11839 00EE1C FF FF FF FF FF FF FF FF    
  11839 00EE24 FF FF FF FF FF FF FF FF    
  11839 00EE2C FF FF FF FF FF FF FF FF    
  11839 00EE34 FF FF FF FF FF FF FF FF    
  11839 00EE3C FF FF FF FF FF FF FF FF    
  11839 00EE44 FF FF FF FF FF FF FF FF    
  11839 00EE4C FF FF FF FF FF FF FF FF    
  11839 00EE54 FF FF FF FF FF FF FF FF    
  11839 00EE5C FF FF FF FF FF FF FF FF    
  11839 00EE64 FF FF FF FF FF FF FF FF    
  11839 00EE6C FF FF FF FF FF FF FF FF    
  11839 00EE74 FF FF FF FF FF FF FF FF    
  11839 00EE7C FF FF FF FF FF FF FF FF    
  11839 00EE84 FF FF FF FF FF FF FF FF    
  11839 00EE8C FF FF FF FF FF FF FF FF    
  11839 00EE94 FF FF FF FF FF FF FF FF    
  11839 00EE9C FF FF FF FF FF FF FF FF    
  11839 00EEA4 FF FF FF FF FF FF FF FF    
  11839 00EEAC FF FF FF FF FF FF FF FF    
  11839 00EEB4 FF FF FF FF FF FF FF FF    
  11839 00EEBC FF FF FF FF FF FF FF FF    
  11839 00EEC4 FF FF FF FF FF FF FF FF    
  11839 00EECC FF FF FF FF FF FF FF FF    
  11839 00EED4 FF FF FF FF FF FF FF FF    
  11839 00EEDC FF FF FF FF FF FF FF FF    
  11839 00EEE4 FF FF FF FF FF FF FF FF    
  11839 00EEEC FF FF FF FF FF FF FF FF    
  11839 00EEF4 FF FF FF FF FF FF FF FF    
  11839 00EEFC FF FF FF FF FF FF FF FF    
  11839 00EF04 FF FF FF FF FF FF FF FF    
  11839 00EF0C FF FF FF FF FF FF FF FF    
  11839 00EF14 FF FF FF FF FF FF FF FF    
  11839 00EF1C FF FF FF FF FF FF FF FF    
  11839 00EF24 FF FF FF FF FF FF FF FF    
  11839 00EF2C FF FF FF FF FF FF FF FF    
  11839 00EF34 FF FF FF FF FF FF FF FF    
  11839 00EF3C FF FF FF FF FF FF FF FF    
  11839 00EF44 FF FF FF FF FF FF FF FF    
  11839 00EF4C FF FF FF FF FF FF FF FF    
  11839 00EF54 FF FF FF FF FF FF FF FF    
  11839 00EF5C FF FF FF FF FF FF FF FF    
  11839 00EF64 FF FF FF FF FF FF FF FF    
  11839 00EF6C FF FF FF FF FF FF FF FF    
  11839 00EF74 FF FF FF FF FF FF FF FF    
  11839 00EF7C FF FF FF FF FF FF FF FF    
  11839 00EF84 FF FF FF FF FF FF FF FF    
  11839 00EF8C FF FF FF FF FF FF FF FF    
  11839 00EF94 FF FF FF FF FF FF FF FF    
  11839 00EF9C FF FF FF FF FF FF FF FF    
  11839 00EFA4 FF FF FF FF FF FF FF FF    
  11839 00EFAC FF FF FF FF FF FF FF FF    
  11839 00EFB4 FF FF FF FF FF FF FF FF    
  11839 00EFBC FF FF FF FF FF FF FF FF    
  11839 00EFC4 FF FF FF FF FF FF FF FF    
  11839 00EFCC FF FF FF FF FF FF FF FF    
  11839 00EFD4 FF FF FF FF FF FF FF FF    
  11839 00EFDC FF FF FF FF FF FF FF FF    
  11839 00EFE4 FF FF FF FF FF FF FF FF    
  11839 00EFEC FF FF FF FF FF FF FF FF    
  11839 00EFF4 FF FF FF FF FF FF FF FF    
  11839 00EFFC FF FF FF FF FF FF FF FF    
  11839 00F004 FF FF FF FF FF FF FF FF    
  11839 00F00C FF FF FF FF FF FF FF FF    
  11839 00F014 FF FF FF FF FF FF FF FF    
  11839 00F01C FF FF FF FF FF FF FF FF    
  11839 00F024 FF FF FF FF FF FF FF FF    
  11839 00F02C FF FF FF FF FF FF FF FF    
  11839 00F034 FF FF FF FF FF FF FF FF    
  11839 00F03C FF FF FF FF FF FF FF FF    
  11839 00F044 FF FF FF FF FF FF FF FF    
  11839 00F04C FF FF FF FF FF FF FF FF    
  11839 00F054 FF FF FF FF FF FF FF FF    
  11839 00F05C FF FF FF FF FF FF FF FF    
  11839 00F064 FF FF FF FF FF FF FF FF    
  11839 00F06C FF FF FF FF FF FF FF FF    
  11839 00F074 FF FF FF FF FF FF FF FF    
  11839 00F07C FF FF FF FF FF FF FF FF    
  11839 00F084 FF FF FF FF FF FF FF FF    
  11839 00F08C FF FF FF FF FF FF FF FF    
  11839 00F094 FF FF FF FF FF FF FF FF    
  11839 00F09C FF FF FF FF FF FF FF FF    
  11839 00F0A4 FF FF FF FF FF FF FF FF    
  11839 00F0AC FF FF FF FF FF FF FF FF    
  11839 00F0B4 FF FF FF FF FF FF FF FF    
  11839 00F0BC FF FF FF FF FF FF FF FF    
  11839 00F0C4 FF FF FF FF FF FF FF FF    
  11839 00F0CC FF FF FF FF FF FF FF FF    
  11839 00F0D4 FF FF FF FF FF FF FF FF    
  11839 00F0DC FF FF FF FF FF FF FF FF    
  11839 00F0E4 FF FF FF FF FF FF FF FF    
  11839 00F0EC FF FF FF FF FF FF FF FF    
  11839 00F0F4 FF FF FF FF FF FF FF FF    
  11839 00F0FC FF FF FF FF FF FF FF FF    
  11839 00F104 FF FF FF FF FF FF FF FF    
  11839 00F10C FF FF FF FF FF FF FF FF    
  11839 00F114 FF FF FF FF FF FF FF FF    
  11839 00F11C FF FF FF FF FF FF FF FF    
  11839 00F124 FF FF FF FF FF FF FF FF    
  11839 00F12C FF FF FF FF FF FF FF FF    
  11839 00F134 FF FF FF FF FF FF FF FF    
  11839 00F13C FF FF FF FF FF FF FF FF    
  11839 00F144 FF FF FF FF FF FF FF FF    
  11839 00F14C FF FF FF FF FF FF FF FF    
  11839 00F154 FF FF FF FF FF FF FF FF    
  11839 00F15C FF FF FF FF FF FF FF FF    
  11839 00F164 FF FF FF FF FF FF FF FF    
  11839 00F16C FF FF FF FF FF FF FF FF    
  11839 00F174 FF FF FF FF FF FF FF FF    
  11839 00F17C FF FF FF FF FF FF FF FF    
  11839 00F184 FF FF FF FF FF FF FF FF    
  11839 00F18C FF FF FF FF FF FF FF FF    
  11839 00F194 FF FF FF FF FF FF FF FF    
  11839 00F19C FF FF FF FF FF FF FF FF    
  11839 00F1A4 FF FF FF FF FF FF FF FF    
  11839 00F1AC FF FF FF FF FF FF FF FF    
  11839 00F1B4 FF FF FF FF FF FF FF FF    
  11839 00F1BC FF FF FF FF FF FF FF FF    
  11839 00F1C4 FF FF FF FF FF FF FF FF    
  11839 00F1CC FF FF FF FF FF FF FF FF    
  11839 00F1D4 FF FF FF FF FF FF FF FF    
  11839 00F1DC FF FF FF FF FF FF FF FF    
  11839 00F1E4 FF FF FF FF FF FF FF FF    
  11839 00F1EC FF FF FF FF FF FF FF FF    
  11839 00F1F4 FF FF FF FF FF FF FF FF    
  11839 00F1FC FF FF FF FF FF FF FF FF    
  11839 00F204 FF FF FF FF FF FF FF FF    
  11839 00F20C FF FF FF FF FF FF FF FF    
  11839 00F214 FF FF FF FF FF FF FF FF    
  11839 00F21C FF FF FF FF FF FF FF FF    
  11839 00F224 FF FF FF FF FF FF FF FF    
  11839 00F22C FF FF FF FF FF FF FF FF    
  11839 00F234 FF FF FF FF FF FF FF FF    
  11839 00F23C FF FF FF FF FF FF FF FF    
  11839 00F244 FF FF FF FF FF FF FF FF    
  11839 00F24C FF FF FF FF FF FF FF FF    
  11839 00F254 FF FF FF FF FF FF FF FF    
  11839 00F25C FF FF FF FF FF FF FF FF    
  11839 00F264 FF FF FF FF FF FF FF FF    
  11839 00F26C FF FF FF FF FF FF FF FF    
  11839 00F274 FF FF FF FF FF FF FF FF    
  11839 00F27C FF FF FF FF FF FF FF FF    
  11839 00F284 FF FF FF FF FF FF FF FF    
  11839 00F28C FF FF FF FF FF FF FF FF    
  11839 00F294 FF FF FF FF FF FF FF FF    
  11839 00F29C FF FF FF FF FF FF FF FF    
  11839 00F2A4 FF FF FF FF FF FF FF FF    
  11839 00F2AC FF FF FF FF FF FF FF FF    
  11839 00F2B4 FF FF FF FF FF FF FF FF    
  11839 00F2BC FF FF FF FF FF FF FF FF    
  11839 00F2C4 FF FF FF FF FF FF FF FF    
  11839 00F2CC FF FF FF FF FF FF FF FF    
  11839 00F2D4 FF FF FF FF FF FF FF FF    
  11839 00F2DC FF FF FF FF FF FF FF FF    
  11839 00F2E4 FF FF FF FF FF FF FF FF    
  11839 00F2EC FF FF FF FF FF FF FF FF    
  11839 00F2F4 FF FF FF FF FF FF FF FF    
  11839 00F2FC FF FF FF FF FF FF FF FF    
  11839 00F304 FF FF FF FF FF FF FF FF    
  11839 00F30C FF FF FF FF FF FF FF FF    
  11839 00F314 FF FF FF FF FF FF FF FF    
  11839 00F31C FF FF FF FF FF FF FF FF    
  11839 00F324 FF FF FF FF FF FF FF FF    
  11839 00F32C FF FF FF FF FF FF FF FF    
  11839 00F334 FF FF FF FF FF FF FF FF    
  11839 00F33C FF FF FF FF FF FF FF FF    
  11839 00F344 FF FF FF FF FF FF FF FF    
  11839 00F34C FF FF FF FF FF FF FF FF    
  11839 00F354 FF FF FF FF FF FF FF FF    
  11839 00F35C FF FF FF FF FF FF FF FF    
  11839 00F364 FF FF FF FF FF FF FF FF    
  11839 00F36C FF FF FF FF FF FF FF FF    
  11839 00F374 FF FF FF FF FF FF FF FF    
  11839 00F37C FF FF FF FF FF FF FF FF    
  11839 00F384 FF FF FF FF FF FF FF FF    
  11839 00F38C FF FF FF FF FF FF FF FF    
  11839 00F394 FF FF FF FF FF FF FF FF    
  11839 00F39C FF FF FF FF FF FF FF FF    
  11839 00F3A4 FF FF FF FF FF FF FF FF    
  11839 00F3AC FF FF FF FF FF FF FF FF    
  11839 00F3B4 FF FF FF FF FF FF FF FF    
  11839 00F3BC FF FF FF FF FF FF FF FF    
  11839 00F3C4 FF FF FF FF FF FF FF FF    
  11839 00F3CC FF FF FF FF FF FF FF FF    
  11839 00F3D4 FF FF FF FF FF FF FF FF    
  11839 00F3DC FF FF FF FF FF FF FF FF    
  11839 00F3E4 FF FF FF FF FF FF FF FF    
  11839 00F3EC FF FF FF FF FF FF FF FF    
  11839 00F3F4 FF FF FF FF FF FF FF FF    
  11839 00F3FC FF FF FF FF FF FF FF FF    
  11839 00F404 FF FF FF FF FF FF FF FF    
  11839 00F40C FF FF FF FF FF FF FF FF    
  11839 00F414 FF FF FF FF FF FF FF FF    
  11839 00F41C FF FF FF FF FF FF FF FF    
  11839 00F424 FF FF FF FF FF FF FF FF    
  11839 00F42C FF FF FF FF FF FF FF FF    
  11839 00F434 FF FF FF FF FF FF FF FF    
  11839 00F43C FF FF FF FF FF FF FF FF    
  11839 00F444 FF FF FF FF FF FF FF FF    
  11839 00F44C FF FF FF FF FF FF FF FF    
  11839 00F454 FF FF FF FF FF FF FF FF    
  11839 00F45C FF FF FF FF FF FF FF FF    
  11839 00F464 FF FF FF FF FF FF FF FF    
  11839 00F46C FF FF FF FF FF FF FF FF    
  11839 00F474 FF FF FF FF FF FF FF FF    
  11839 00F47C FF FF FF FF FF FF FF FF    
  11839 00F484 FF FF FF FF FF FF FF FF    
  11839 00F48C FF FF FF FF FF FF FF FF    
  11839 00F494 FF FF FF FF FF FF FF FF    
  11839 00F49C FF FF FF FF FF FF FF FF    
  11839 00F4A4 FF FF FF FF FF FF FF FF    
  11839 00F4AC FF FF FF FF FF FF FF FF    
  11839 00F4B4 FF FF FF FF FF FF FF FF    
  11839 00F4BC FF FF FF FF FF FF FF FF    
  11839 00F4C4 FF FF FF FF FF FF FF FF    
  11839 00F4CC FF FF FF FF FF FF FF FF    
  11839 00F4D4 FF FF FF FF FF FF FF FF    
  11839 00F4DC FF FF FF FF FF FF FF FF    
  11839 00F4E4 FF FF FF FF FF FF FF FF    
  11839 00F4EC FF FF FF FF FF FF FF FF    
  11839 00F4F4 FF FF FF FF FF FF FF FF    
  11839 00F4FC FF FF FF FF FF FF FF FF    
  11839 00F504 FF FF FF FF FF FF FF FF    
  11839 00F50C FF FF FF FF FF FF FF FF    
  11839 00F514 FF FF FF FF FF FF FF FF    
  11839 00F51C FF FF FF FF FF FF FF FF    
  11839 00F524 FF FF FF FF FF FF FF FF    
  11839 00F52C FF FF FF FF FF FF FF FF    
  11839 00F534 FF FF FF FF FF FF FF FF    
  11839 00F53C FF FF FF FF FF FF FF FF    
  11839 00F544 FF FF FF FF FF FF FF FF    
  11839 00F54C FF FF FF FF FF FF FF FF    
  11839 00F554 FF FF FF FF FF FF FF FF    
  11839 00F55C FF FF FF FF FF FF FF FF    
  11839 00F564 FF FF FF FF FF FF FF FF    
  11839 00F56C FF FF FF FF FF FF FF FF    
  11839 00F574 FF FF FF FF FF FF FF FF    
  11839 00F57C FF FF FF FF FF FF FF FF    
  11839 00F584 FF FF FF FF FF FF FF FF    
  11839 00F58C FF FF FF FF FF FF FF FF    
  11839 00F594 FF FF FF FF FF FF FF FF    
  11839 00F59C FF FF FF FF FF FF FF FF    
  11839 00F5A4 FF FF FF FF FF FF FF FF    
  11839 00F5AC FF FF FF FF FF FF FF FF    
  11839 00F5B4 FF FF FF FF FF FF FF FF    
  11839 00F5BC FF FF FF FF FF FF FF FF    
  11839 00F5C4 FF FF FF FF FF FF FF FF    
  11839 00F5CC FF FF FF FF FF FF FF FF    
  11839 00F5D4 FF FF FF FF FF FF FF FF    
  11839 00F5DC FF FF FF FF FF FF FF FF    
  11839 00F5E4 FF FF FF FF FF FF FF FF    
  11839 00F5EC FF FF FF FF FF FF FF FF    
  11839 00F5F4 FF FF FF FF FF FF FF FF    
  11839 00F5FC FF FF FF FF FF FF FF FF    
  11839 00F604 FF FF FF FF FF FF FF FF    
  11839 00F60C FF FF FF FF FF FF FF FF    
  11839 00F614 FF FF FF FF FF FF FF FF    
  11839 00F61C FF FF FF FF FF FF FF FF    
  11839 00F624 FF FF FF FF FF FF FF FF    
  11839 00F62C FF FF FF FF FF FF FF FF    
  11839 00F634 FF FF FF FF FF FF FF FF    
  11839 00F63C FF FF FF FF FF FF FF FF    
  11839 00F644 FF FF FF FF FF FF FF FF    
  11839 00F64C FF FF FF FF FF FF FF FF    
  11839 00F654 FF FF FF FF FF FF FF FF    
  11839 00F65C FF FF FF FF FF FF FF FF    
  11839 00F664 FF FF FF FF FF FF FF FF    
  11839 00F66C FF FF FF FF FF FF FF FF    
  11839 00F674 FF FF FF FF FF FF FF FF    
  11839 00F67C FF FF FF FF FF FF FF FF    
  11839 00F684 FF FF FF FF FF FF FF FF    
  11839 00F68C FF FF FF FF FF FF FF FF    
  11839 00F694 FF FF FF FF FF FF FF FF    
  11839 00F69C FF FF FF FF FF FF FF FF    
  11839 00F6A4 FF FF FF FF FF FF FF FF    
  11839 00F6AC FF FF FF FF FF FF FF FF    
  11839 00F6B4 FF FF FF FF FF FF FF FF    
  11839 00F6BC FF FF FF FF FF FF FF FF    
  11839 00F6C4 FF FF FF FF FF FF FF FF    
  11839 00F6CC FF FF FF FF FF FF FF FF    
  11839 00F6D4 FF FF FF FF FF FF FF FF    
  11839 00F6DC FF FF FF FF FF FF FF FF    
  11839 00F6E4 FF FF FF FF FF FF FF FF    
  11839 00F6EC FF FF FF FF FF FF FF FF    
  11839 00F6F4 FF FF FF FF FF FF FF FF    
  11839 00F6FC FF FF FF FF FF FF FF FF    
  11839 00F704 FF FF FF FF FF FF FF FF    
  11839 00F70C FF FF FF FF FF FF FF FF    
  11839 00F714 FF FF FF FF FF FF FF FF    
  11839 00F71C FF FF FF FF FF FF FF FF    
  11839 00F724 FF FF FF FF FF FF FF FF    
  11839 00F72C FF FF FF FF FF FF FF FF    
  11839 00F734 FF FF FF FF FF FF FF FF    
  11839 00F73C FF FF FF FF FF FF FF FF    
  11839 00F744 FF FF FF FF FF FF FF FF    
  11839 00F74C FF FF FF FF FF FF FF FF    
  11839 00F754 FF FF FF FF FF FF FF FF    
  11839 00F75C FF FF FF FF FF FF FF FF    
  11839 00F764 FF FF FF FF FF FF FF FF    
  11839 00F76C FF FF FF FF FF FF FF FF    
  11839 00F774 FF FF FF FF FF FF FF FF    
  11839 00F77C FF FF FF FF FF FF FF FF    
  11839 00F784 FF FF FF FF FF FF FF FF    
  11839 00F78C FF FF FF FF FF FF FF FF    
  11839 00F794 FF FF FF FF FF FF FF FF    
  11839 00F79C FF FF FF FF FF FF FF FF    
  11839 00F7A4 FF FF FF FF FF FF FF FF    
  11839 00F7AC FF FF FF FF FF FF FF FF    
  11839 00F7B4 FF FF FF FF FF FF FF FF    
  11839 00F7BC FF FF FF FF FF FF FF FF    
  11839 00F7C4 FF FF FF FF FF FF FF FF    
  11839 00F7CC FF FF FF FF FF FF FF FF    
  11839 00F7D4 FF FF FF FF FF FF FF FF    
  11839 00F7DC FF FF FF FF FF FF FF FF    
  11839 00F7E4 FF FF FF FF FF FF FF FF    
  11839 00F7EC FF FF FF FF FF FF FF FF    
  11839 00F7F4 FF FF FF FF FF FF FF FF    
  11839 00F7FC FF FF FF FF FF FF FF FF    
  11839 00F804 FF FF FF FF FF FF FF FF    
  11839 00F80C FF FF FF FF FF FF FF FF    
  11839 00F814 FF FF FF FF FF FF FF FF    
  11839 00F81C FF FF FF FF FF FF FF FF    
  11839 00F824 FF FF FF FF FF FF FF FF    
  11839 00F82C FF FF FF FF FF FF FF FF    
  11839 00F834 FF FF FF FF FF FF FF FF    
  11839 00F83C FF FF FF FF FF FF FF FF    
  11839 00F844 FF FF FF FF FF FF FF FF    
  11839 00F84C FF FF FF FF FF FF FF FF    
  11839 00F854 FF FF FF FF FF FF FF FF    
  11839 00F85C FF FF FF FF FF FF FF FF    
  11839 00F864 FF FF FF FF FF FF FF FF    
  11839 00F86C FF FF FF FF FF FF FF FF    
  11839 00F874 FF FF FF FF FF FF FF FF    
  11839 00F87C FF FF FF FF FF FF FF FF    
  11839 00F884 FF FF FF FF FF FF FF FF    
  11839 00F88C FF FF FF FF FF FF FF FF    
  11839 00F894 FF FF FF FF FF FF FF FF    
  11839 00F89C FF FF FF FF FF FF FF FF    
  11839 00F8A4 FF FF FF FF FF FF FF FF    
  11839 00F8AC FF FF FF FF FF FF FF FF    
  11839 00F8B4 FF FF FF FF FF FF FF FF    
  11839 00F8BC FF FF FF FF FF FF FF FF    
  11839 00F8C4 FF FF FF FF FF FF FF FF    
  11839 00F8CC FF FF FF FF FF FF FF FF    
  11839 00F8D4 FF FF FF FF FF FF FF FF    
  11839 00F8DC FF FF FF FF FF FF FF FF    
  11839 00F8E4 FF FF FF FF FF FF FF FF    
  11839 00F8EC FF FF FF FF FF FF FF FF    
  11839 00F8F4 FF FF FF FF FF FF FF FF    
  11839 00F8FC FF FF FF FF FF FF FF FF    
  11839 00F904 FF FF FF FF FF FF FF FF    
  11839 00F90C FF FF FF FF FF FF FF FF    
  11839 00F914 FF FF FF FF FF FF FF FF    
  11839 00F91C FF FF FF FF FF FF FF FF    
  11839 00F924 FF FF FF FF FF FF FF FF    
  11839 00F92C FF FF FF FF FF FF FF FF    
  11839 00F934 FF FF FF FF FF FF FF FF    
  11839 00F93C FF FF FF FF FF FF FF FF    
  11839 00F944 FF FF FF FF FF FF FF FF    
  11839 00F94C FF FF FF FF FF FF FF FF    
  11839 00F954 FF FF FF FF FF FF FF FF    
  11839 00F95C FF FF FF FF FF FF FF FF    
  11839 00F964 FF FF FF FF FF FF FF FF    
  11839 00F96C FF FF FF FF FF FF FF FF    
  11839 00F974 FF FF FF FF FF FF FF FF    
  11839 00F97C FF FF FF FF FF FF FF FF    
  11839 00F984 FF FF FF FF FF FF FF FF    
  11839 00F98C FF FF FF FF FF FF FF FF    
  11839 00F994 FF FF FF FF FF FF FF FF    
  11839 00F99C FF FF FF FF FF FF FF FF    
  11839 00F9A4 FF FF FF FF FF FF FF FF    
  11839 00F9AC FF FF FF FF FF FF FF FF    
  11839 00F9B4 FF FF FF FF FF FF FF FF    
  11839 00F9BC FF FF FF FF FF FF FF FF    
  11839 00F9C4 FF FF FF FF FF FF FF FF    
  11839 00F9CC FF FF FF FF FF FF FF FF    
  11839 00F9D4 FF FF FF FF FF FF FF FF    
  11839 00F9DC FF FF FF FF FF FF FF FF    
  11839 00F9E4 FF FF FF FF FF FF FF FF    
  11839 00F9EC FF FF FF FF FF FF FF FF    
  11839 00F9F4 FF FF FF FF FF FF FF FF    
  11839 00F9FC FF FF FF FF FF FF FF FF    
  11839 00FA04 FF FF FF FF FF FF FF FF    
  11839 00FA0C FF FF FF FF FF FF FF FF    
  11839 00FA14 FF FF FF FF FF FF FF FF    
  11839 00FA1C FF FF FF FF FF FF FF FF    
  11839 00FA24 FF FF FF FF FF FF FF FF    
  11839 00FA2C FF FF FF FF FF FF FF FF    
  11839 00FA34 FF FF FF FF FF FF FF FF    
  11839 00FA3C FF FF FF FF FF FF FF FF    
  11839 00FA44 FF FF FF FF FF FF FF FF    
  11839 00FA4C FF FF FF FF FF FF FF FF    
  11839 00FA54 FF FF FF FF FF FF FF FF    
  11839 00FA5C FF FF FF FF FF FF FF FF    
  11839 00FA64 FF FF FF FF FF FF FF FF    
  11839 00FA6C FF FF FF FF FF FF FF FF    
  11839 00FA74 FF FF FF FF FF FF FF FF    
  11839 00FA7C FF FF FF FF FF FF FF FF    
  11839 00FA84 FF FF FF FF FF FF FF FF    
  11839 00FA8C FF FF FF FF FF FF FF FF    
  11839 00FA94 FF FF FF FF FF FF FF FF    
  11839 00FA9C FF FF FF FF FF FF FF FF    
  11839 00FAA4 FF FF FF FF FF FF FF FF    
  11839 00FAAC FF FF FF FF FF FF FF FF    
  11839 00FAB4 FF FF FF FF FF FF FF FF    
  11839 00FABC FF FF FF FF FF FF FF FF    
  11839 00FAC4 FF FF FF FF FF FF FF FF    
  11839 00FACC FF FF FF FF FF FF FF FF    
  11839 00FAD4 FF FF FF FF FF FF FF FF    
  11839 00FADC FF FF FF FF FF FF FF FF    
  11839 00FAE4 FF FF FF FF FF FF FF FF    
  11839 00FAEC FF FF FF FF FF FF FF FF    
  11839 00FAF4 FF FF FF FF FF FF FF FF    
  11839 00FAFC FF FF FF FF FF FF FF FF    
  11839 00FB04 FF FF FF FF FF FF FF FF    
  11839 00FB0C FF FF FF FF FF FF FF FF    
  11839 00FB14 FF FF FF FF FF FF FF FF    
  11839 00FB1C FF FF FF FF FF FF FF FF    
  11839 00FB24 FF FF FF FF FF FF FF FF    
  11839 00FB2C FF FF FF FF FF FF FF FF    
  11839 00FB34 FF FF FF FF FF FF FF FF    
  11839 00FB3C FF FF FF FF FF FF FF FF    
  11839 00FB44 FF FF FF FF FF FF FF FF    
  11839 00FB4C FF FF FF FF FF FF FF FF    
  11839 00FB54 FF FF FF FF FF FF FF FF    
  11839 00FB5C FF FF FF FF FF FF FF FF    
  11839 00FB64 FF FF FF FF FF FF FF FF    
  11839 00FB6C FF FF FF FF FF FF FF FF    
  11839 00FB74 FF FF FF FF FF FF FF FF    
  11839 00FB7C FF FF FF FF FF FF FF FF    
  11839 00FB84 FF FF FF FF FF FF FF FF    
  11839 00FB8C FF FF FF FF FF FF FF FF    
  11839 00FB94 FF FF FF FF FF FF FF FF    
  11839 00FB9C FF FF FF FF FF FF FF FF    
  11839 00FBA4 FF FF FF FF FF FF FF FF    
  11839 00FBAC FF FF FF FF FF FF FF FF    
  11839 00FBB4 FF FF FF FF FF FF FF FF    
  11839 00FBBC FF FF FF FF FF FF FF FF    
  11839 00FBC4 FF FF FF FF FF FF FF FF    
  11839 00FBCC FF FF FF FF FF FF FF FF    
  11839 00FBD4 FF FF FF FF FF FF FF FF    
  11839 00FBDC FF FF FF FF FF FF FF FF    
  11839 00FBE4 FF FF FF FF FF FF FF FF    
  11839 00FBEC FF FF FF FF FF FF FF FF    
  11839 00FBF4 FF FF FF FF FF FF FF FF    
  11839 00FBFC FF FF FF FF FF FF FF FF    
  11839 00FC04 FF FF FF FF FF FF FF FF    
  11839 00FC0C FF FF FF FF FF FF FF FF    
  11839 00FC14 FF FF FF FF FF FF FF FF    
  11839 00FC1C FF FF FF FF FF FF FF FF    
  11839 00FC24 FF FF FF FF FF FF FF FF    
  11839 00FC2C FF FF FF FF FF FF FF FF    
  11839 00FC34 FF FF FF FF FF FF FF FF    
  11839 00FC3C FF FF FF FF FF FF FF FF    
  11839 00FC44 FF FF FF FF FF FF FF FF    
  11839 00FC4C FF FF FF FF FF FF FF FF    
  11839 00FC54 FF FF FF FF FF FF FF FF    
  11839 00FC5C FF FF FF FF FF FF FF FF    
  11839 00FC64 FF FF FF FF FF FF FF FF    
  11839 00FC6C FF FF FF FF FF FF FF FF    
  11839 00FC74 FF FF FF FF FF FF FF FF    
  11839 00FC7C FF FF FF FF FF FF FF FF    
  11839 00FC84 FF FF FF FF FF FF FF FF    
  11839 00FC8C FF FF FF FF FF FF FF FF    
  11839 00FC94 FF FF FF FF FF FF FF FF    
  11839 00FC9C FF FF FF FF FF FF FF FF    
  11839 00FCA4 FF FF FF FF FF FF FF FF    
  11839 00FCAC FF FF FF FF FF FF FF FF    
  11839 00FCB4 FF FF FF FF FF FF FF FF    
  11839 00FCBC FF FF FF FF FF FF FF FF    
  11839 00FCC4 FF FF FF FF FF FF FF FF    
  11839 00FCCC FF FF FF FF FF FF FF FF    
  11839 00FCD4 FF FF FF FF FF FF FF FF    
  11839 00FCDC FF FF FF FF FF FF FF FF    
  11839 00FCE4 FF FF FF FF FF FF FF FF    
  11839 00FCEC FF FF FF FF FF FF FF FF    
  11839 00FCF4 FF FF FF FF FF FF FF FF    
  11839 00FCFC FF FF FF FF FF FF FF FF    
  11839 00FD04 FF FF FF FF FF FF FF FF    
  11839 00FD0C FF FF FF FF FF FF FF FF    
  11839 00FD14 FF FF FF FF FF FF FF FF    
  11839 00FD1C FF FF FF FF FF FF FF FF    
  11839 00FD24 FF FF FF FF FF FF FF FF    
  11839 00FD2C FF FF FF FF FF FF FF FF    
  11839 00FD34 FF FF FF FF FF FF FF FF    
  11839 00FD3C FF FF FF FF FF FF FF FF    
  11839 00FD44 FF FF FF FF FF FF FF FF    
  11839 00FD4C FF FF FF FF FF FF FF FF    
  11839 00FD54 FF FF FF FF FF FF FF FF    
  11839 00FD5C FF FF FF FF FF FF FF FF    
  11839 00FD64 FF FF FF FF FF FF FF FF    
  11839 00FD6C FF FF FF FF FF FF FF FF    
  11839 00FD74 FF FF FF FF FF FF FF FF    
  11839 00FD7C FF FF FF FF FF FF FF FF    
  11839 00FD84 FF FF FF FF FF FF FF FF    
  11839 00FD8C FF FF FF FF FF FF FF FF    
  11839 00FD94 FF FF FF FF FF FF FF FF    
  11839 00FD9C FF FF FF FF FF FF FF FF    
  11839 00FDA4 FF FF FF FF FF FF FF FF    
  11839 00FDAC FF FF FF FF FF FF FF FF    
  11839 00FDB4 FF FF FF FF FF FF FF FF    
  11839 00FDBC FF FF FF FF FF FF FF FF    
  11839 00FDC4 FF FF FF FF FF FF FF FF    
  11839 00FDCC FF FF FF FF FF FF FF FF    
  11839 00FDD4 FF FF FF FF FF FF FF FF    
  11839 00FDDC FF FF FF FF FF FF FF FF    
  11839 00FDE4 FF FF FF FF FF FF FF FF    
  11839 00FDEC FF FF FF FF FF FF FF FF    
  11839 00FDF4 FF FF FF FF FF FF FF FF    
  11839 00FDFC FF FF FF FF                
  11840 00FE00 4C 1B D7                     	JMP		SuperGetch		; FE00
  11841 00FE03 4C 56 D7                     	JMP		warm_start		; FE03
  11842 00FE06 4C 27 D7                     	JMP		SuperPutch		; FE06
  11843 00FE09 4C FF C8                     	JMP		BIOSInput		; FE09
  11844 00FE0C 4C 30 D7                     	JMP		BasicGetch		; FE0C
  11845 00FE0F 4C 44 D7                     	JMP		xitBasic		; FE0F
  11846 00FE12 4C E8 D8                     	JMP		BASIC_Loadfile	; FE12
  11847 00FE15 4C CF D8                     	JMP		BASIC_Savefile	; FE15
                                           
  11849 00FE18 4C 41 DF                     	JMP		ScheduleTask	; FE18
  11850 00FE1B 4C 5D DB                     	JMP		FMTK_AllocMbx
  11851 00FE1E 4C 00 00                     	JMP		$0				; reserved for FreeMbx
  11852 00FE21 4C C5 DB                     	JMP		FMTK_SendMsg
  11853 00FE24 4C C5 DB                     	JMP		FMTK_PostMsg
  11854 00FE27 4C CF DC                     	JMP		FMTK_WaitMsg
  11855 00FE2A 4C 7B DE                     	JMP		FMTK_PeekMsg
  11856 00FE2D 4C CE DD                     	JMP		FMTK_CheckMsg
                                           
  11858 00FE30 FF FF FF FF FF FF FF FF      	.org 	$FFD6
  11858 00FE38 FF FF FF FF FF FF FF FF    
  11858 00FE40 FF FF FF FF FF FF FF FF    
  11858 00FE48 FF FF FF FF FF FF FF FF    
  11858 00FE50 FF FF FF FF FF FF FF FF    
  11858 00FE58 FF FF FF FF FF FF FF FF    
  11858 00FE60 FF FF FF FF FF FF FF FF    
  11858 00FE68 FF FF FF FF FF FF FF FF    
  11858 00FE70 FF FF FF FF FF FF FF FF    
  11858 00FE78 FF FF FF FF FF FF FF FF    
  11858 00FE80 FF FF FF FF FF FF FF FF    
  11858 00FE88 FF FF FF FF FF FF FF FF    
  11858 00FE90 FF FF FF FF FF FF FF FF    
  11858 00FE98 FF FF FF FF FF FF FF FF    
  11858 00FEA0 FF FF FF FF FF FF FF FF    
  11858 00FEA8 FF FF FF FF FF FF FF FF    
  11858 00FEB0 FF FF FF FF FF FF FF FF    
  11858 00FEB8 FF FF FF FF FF FF FF FF    
  11858 00FEC0 FF FF FF FF FF FF FF FF    
  11858 00FEC8 FF FF FF FF FF FF FF FF    
  11858 00FED0 FF FF FF FF FF FF FF FF    
  11858 00FED8 FF FF FF FF FF FF FF FF    
  11858 00FEE0 FF FF FF FF FF FF FF FF    
  11858 00FEE8 FF FF FF FF FF FF FF FF    
  11858 00FEF0 FF FF FF FF FF FF FF FF    
  11858 00FEF8 FF FF FF FF FF FF FF FF    
  11858 00FF00 FF FF FF FF FF FF FF FF    
  11858 00FF08 FF FF FF FF FF FF FF FF    
  11858 00FF10 FF FF FF FF FF FF FF FF    
  11858 00FF18 FF FF FF FF FF FF FF FF    
  11858 00FF20 FF FF FF FF FF FF FF FF    
  11858 00FF28 FF FF FF FF FF FF FF FF    
  11858 00FF30 FF FF FF FF FF FF FF FF    
  11858 00FF38 FF FF FF FF FF FF FF FF    
  11858 00FF40 FF FF FF FF FF FF FF FF    
  11858 00FF48 FF FF FF FF FF FF FF FF    
  11858 00FF50 FF FF FF FF FF FF FF FF    
  11858 00FF58 FF FF FF FF FF FF FF FF    
  11858 00FF60 FF FF FF FF FF FF FF FF    
  11858 00FF68 FF FF FF FF FF FF FF FF    
  11858 00FF70 FF FF FF FF FF FF FF FF    
  11858 00FF78 FF FF FF FF FF FF FF FF    
  11858 00FF80 FF FF FF FF FF FF FF FF    
  11858 00FF88 FF FF FF FF FF FF FF FF    
  11858 00FF90 FF FF FF FF FF FF FF FF    
  11858 00FF98 FF FF FF FF FF FF FF FF    
  11858 00FFA0 FF FF FF FF FF FF FF FF    
  11858 00FFA8 FF FF FF FF FF FF FF FF    
  11858 00FFB0 FF FF FF FF FF FF FF FF    
  11858 00FFB8 FF FF FF FF FF FF FF FF    
  11858 00FFC0 FF FF FF FF FF FF FF FF    
  11858 00FFC8 FF FF FF FF FF FF FF FF    
  11858 00FFD0 FF FF FF FF FF FF          
  11859 00FFD6 04 00                        	dw		4			; task #4
                                           
  11861 00FFD8 FF FF FF FF FF FF            	.org	$FFDE		; '832 IRQ vector
  11862 00FFDE 01 00                        	dw		1			;
                                           
                                           	.org	$FFE0		; IRQ3 vector
  11865 00FFE0 03 00                        	dw		3
                                           
  11867 00FFE2 FF FF FF FF                  	.org 	$FFE6
  11868 00FFE6 A5 E0                        	dw		BrkRout
                                           
  11870 00FFE8 FF FF FF FF FF FF            	.org	$FFEE		; '816 IRQ vector
  11871 00FFEE 01 00                        	dw		1			; IRQRout816
                                           
  11873 00FFF0 FF FF FF FF FF FF FF FF      	.org	$FFFC		; reset vector
  11873 00FFF8 FF FF FF FF                
  11874 00FFFC 00 C0                        	dw		$C000
                                           
                                           	.org	$FFFE
  11877 00FFFE 01 00                        	dw		1			; IRQRout02

Checksum=70C2CE12

Number of instructions processed: 5334
Number of opcode bytes: 12766
Bytes per instruction: 2.393326 (19.146607 bits)
Clock cycle count: 5497
Clocks per instruction: 1.030559

The above statistics are only estimates.

	The CPI assumes data memory access requires two clock cycles and instruction
	access is single cycle. The actual CPI may be higher if there are memory wait 
	states, or lower if data is found in the cache.
